<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ooRexx: SysFileSystem.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('unix_2_sys_file_system_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">unix/SysFileSystem.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unix_2_sys_file_system_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2025 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* https://www.oorexx.org/license.html                                        */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/* REXX Kernel                                                                */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/* Unix implementation of the SysFileSystem class.                            */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_core_8h.html">RexxCore.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifdef HAVE_CONFIG_H</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor"># include &quot;config.h&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;utime.h&gt;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &lt;pwd.h&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &lt;fnmatch.h&gt;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#ifdef HAVE_FS_CASEFOLD_FL</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor"># include &lt;linux/fs.h&gt;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor"># include &lt;sys/ioctl.h&gt;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="windows_2_sys_file_system_8hpp.html">SysFileSystem.hpp</a>&quot;</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_utilities_8hpp.html">Utilities.hpp</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_activity_manager_8hpp.html">ActivityManager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_file_name_buffer_8hpp.html">FileNameBuffer.hpp</a>&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_sys_file_system.html#ad8361dd58cb90aaa686c34f6268f3c15">SysFileSystem::EOF_Marker</a> = 0x1A;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="class_sys_file_system.html#a5fa517d8ac2128851186e3c0028b99cf">SysFileSystem::EOL_Marker</a> = <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_sys_file_system.html#a9d4c0462f4c948afce736454207e7146">SysFileSystem::PathDelimiter</a> = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_sys_file_system.html#afba1c629bb68f4cfa3206f39343f773d">SysFileSystem::NewLine</a> = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="class_sys_file_system.html#addecd83d7590310e772d60acf02febe6">SysFileSystem::CarriageReturn</a> = <span class="charliteral">&#39;\r&#39;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">// .DateTime~new(1970, 1, 1) - .DateTime~new(1, 1, 1)~totalSeconds</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a6bcc082569c38f850dbdcf973febd53f">   79</a></span>&#160;<span class="keyword">const</span> <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code" href="unix_2_sys_file_system_8cpp.html#a6bcc082569c38f850dbdcf973febd53f">StatEpoch</a> = 62135596800;           <span class="comment">// seconds between 0001-01-01 and 1970-01-01</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a4232af97e0837a34645e36f2b432981f">   80</a></span>&#160;<span class="keyword">const</span> <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code" href="unix_2_sys_file_system_8cpp.html#a4232af97e0837a34645e36f2b432981f">NoTimeStamp</a> = -999999999999999999; <span class="comment">// invalid file time</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * Search for a given filename, returning the fully</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> * resolved name if it is found.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> * @param name     The original name.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> * @param fullName A pointer to the buffer where the resolved name is returned.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> * @return True if the file was found, false otherwise.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a97af14f883e32e40c218beae8ea5db8d">   91</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a97af14f883e32e40c218beae8ea5db8d">SysFileSystem::searchFileName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;fullName)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;{</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">size_t</span> nameLength = strlen(name);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">/* does the filename already have a path? */</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">/* or does it start with &quot;~&quot; ? */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">/* (beware, don&#39;t test &quot;.&quot; because files like &quot;.hidden&quot; alone are candidate for search in PATH */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span> (strstr(name, <span class="stringliteral">&quot;/&quot;</span>) != NULL || name[0] == <span class="charliteral">&#39;~&#39;</span> || name[0] == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordtype">bool</span> done = <a class="code" href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">canonicalizeName</a>(fullName);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (done == <span class="keyword">false</span> || <a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">fileExists</a>(fullName) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            fullName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(0) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Get the current working directory</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">getCurrentDirectory</a>(fullName))</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// now add on to the front of the name</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    fullName += <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    fullName += name;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// if the file exists, then return it</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">fileExists</a>(fullName))</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// it was not in the current directory so search the PATH</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *currentPath = getenv(<span class="stringliteral">&quot;PATH&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (currentPath == NULL)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        fullName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *sep = strchr(currentPath, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">while</span> (sep != NULL)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="comment">/* try each entry in the PATH */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordtype">int</span> i = sep - currentPath;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        fullName.<a class="code" href="class_file_name_buffer.html#a914cfc5e0ca08b748eeb7a72ed774860">set</a>(currentPath, i);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        fullName += <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        fullName += name;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">fileExists</a>(fullName) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        currentPath = sep + 1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        sep = strchr(currentPath, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">/* the last entry in the PATH might not be terminated by a colon */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (*currentPath != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        fullName = currentPath;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        fullName += currentPath;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        fullName += name;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">fileExists</a>(fullName) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// not found, return a null string</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    fullName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * Get the fully qualified name for a file.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * @param name     The input file name.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * @param fullName The return full file name</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#adb998d580812a27c13a6ee316f00cd03">  172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_sys_file_system.html#adb998d580812a27c13a6ee316f00cd03">SysFileSystem::qualifyStreamName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;fullName)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// if already expanded, then do nothing</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (fullName.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() != 0)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span>;                           <span class="comment">/* nothing more to do               */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// copy this over and canonicalize the name</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    fullName = name;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">SysFileSystem::canonicalizeName</a>(fullName))</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// reset to a null string for any failures</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        fullName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> * Test if a given file exists.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * @param fname  The target file name.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> * @return true if the file exists, false otherwise.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">  198</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">SysFileSystem::fileExists</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">struct </span>stat64 filestat;              <span class="comment">// file attributes</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">int</span> rc;                              <span class="comment">// stat function return code</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    rc = stat64(fname, &amp;filestat);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (rc == 0)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (S_ISREG(filestat.st_mode))</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> * Extract directory information from a file name.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"> * @param file   The input file name.  If this represents a real source file,</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"> *               this will be fully resolved.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> * @return The directory portion of the file name.  If the file name</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment"> *         does not include a directory portion, then OREF_NULL is returned.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a8808de93d4cff628e28033e353a1e43c">  224</a></span>&#160;<a class="code" href="class_rexx_string.html">RexxString</a>* <a class="code" href="class_sys_file_system.html#a8808de93d4cff628e28033e353a1e43c">SysFileSystem::extractDirectory</a>(<a class="code" href="class_rexx_string.html">RexxString</a> *file)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pathName = file-&gt;<a class="code" href="class_rexx_string.html#aaf47ec1ef2009a65092c14cea082a7f9">getStringData</a>();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *endPtr = pathName + file-&gt;<a class="code" href="class_rexx_string.html#a3a3cc92645c7d4318f623068884c812b">getLength</a>() - 1;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// scan backwards looking for a directory delimiter.  This name should</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// be fully qualified, so we don&#39;t have to deal with drive letters</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">while</span> (pathName &lt; endPtr)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">// find the first directory element?</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (*endPtr == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">// extract the directory information, including the final delimiter</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">// and return as a string object.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="_string_class_8hpp.html#a4a9c05b5920cf789e1f3629037c9921a">new_string</a>(pathName, endPtr - pathName + 1);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        endPtr--;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>;      <span class="comment">// not available</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"> * Extract extension information from a file name.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> * @param file   The input file name.  If this represents a real source file,</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> *               this will be fully resolved.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"> * @return The extension portion of the file name.  If the file</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> *         name does not include an extension portion, then</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> *         OREF_NULL is returned.</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a8f0ef0bb39826ebf6209cb8739590bb8">  256</a></span>&#160;<a class="code" href="class_rexx_string.html">RexxString</a>* <a class="code" href="class_sys_file_system.html#a8f0ef0bb39826ebf6209cb8739590bb8">SysFileSystem::extractExtension</a>(<a class="code" href="class_rexx_string.html">RexxString</a> *file)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;{</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pathName = file-&gt;<a class="code" href="class_rexx_string.html#aaf47ec1ef2009a65092c14cea082a7f9">getStringData</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *endPtr = pathName + file-&gt;<a class="code" href="class_rexx_string.html#a3a3cc92645c7d4318f623068884c812b">getLength</a>() - 1;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// scan backwards looking for a directory delimiter.  This name should</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// be fully qualified, so we don&#39;t have to deal with drive letters</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">while</span> (pathName &lt; endPtr)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// find the first directory element?</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">if</span> (*endPtr == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>;    <span class="comment">// found a directory portion before an extension...we&#39;re extensionless</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// is this the extension dot?</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*endPtr == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">// return everything from the period on.  Keeping the period on is a convenience.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="_string_class_8hpp.html#a4a9c05b5920cf789e1f3629037c9921a">new_string</a>(endPtr);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        endPtr--;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>;      <span class="comment">// not available</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> * Extract file information from a file name.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> * @param file   The input file name.  If this represents a real source file,</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> *               this will be fully resolved.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> * @return The file portion of the file name.  If the file name</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> *         does not include a directory portion, then the entire</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> *         string is returned</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a541fd681c22e2aaaf91d31f78192f239">  292</a></span>&#160;<a class="code" href="class_rexx_string.html">RexxString</a>* <a class="code" href="class_sys_file_system.html#a541fd681c22e2aaaf91d31f78192f239">SysFileSystem::extractFile</a>(<a class="code" href="class_rexx_string.html">RexxString</a> *file)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pathName = file-&gt;<a class="code" href="class_rexx_string.html#aaf47ec1ef2009a65092c14cea082a7f9">getStringData</a>();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *endPtr = pathName + file-&gt;<a class="code" href="class_rexx_string.html#a3a3cc92645c7d4318f623068884c812b">getLength</a>() - 1;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// scan backwards looking for a directory delimiter.  This name should</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// be fully qualified, so we don&#39;t have to deal with drive letters</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">while</span> (pathName &lt; endPtr)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// find the first directory element?</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span> (*endPtr == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="comment">// extract the directory information, including the final delimiter</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="comment">// and return as a string object.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="_string_class_8hpp.html#a4a9c05b5920cf789e1f3629037c9921a">new_string</a>(endPtr);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        endPtr--;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">return</span> file;     <span class="comment">// this is all filename</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> * Test if a filename has an extension.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> * @param name   The name to check.</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> * @return true if an extension was found on the file, false if there</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> *         is no extension.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ad14ef8949d51c2862e2094287776e3e5">  322</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ad14ef8949d51c2862e2094287776e3e5">SysFileSystem::hasExtension</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *endPtr = name + strlen(name) - 1;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// scan backwards looking for a directory delimiter.  This name should</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// be fully qualified, so we don&#39;t have to deal with drive letters</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">while</span> (name &lt; endPtr)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment">// find the first directory element?</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span> (*endPtr == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;        <span class="comment">// found a directory portion before an extension...we&#39;re extensionless</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="comment">// is this the extension dot?</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*endPtr == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="comment">// return everything from the period on.  Keeping the period on is a convenience.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        endPtr--;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;          <span class="comment">// not available</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> * Test if a filename has a directory portion</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"> * @param name   The name to check.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> * @return true if a directory was found on the file, false if</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> *         there is no directory.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00355"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a617d52cfc7be506cebb68737ea80a5f0">  355</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a617d52cfc7be506cebb68737ea80a5f0">SysFileSystem::hasDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// hasDirectory() means we have enough absolute directory</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// information at the beginning to bypass performing path searches.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span> name[0] == <span class="charliteral">&#39;~&#39;</span> || name[0] == <span class="charliteral">&#39;/&#39;</span> ||</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          (name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; name[1] == <span class="charliteral">&#39;/&#39;</span>) ||</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          (name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; name[1] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; name[2] == <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> * Do a search for a single variation of a filename.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"> * @param name      The name to search for.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"> * @param path      The path to search over (can be NULL)</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"> * @param extension A potential extension to add to the file name (can be NULL).</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> * @param resolvedName</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> *                  The buffer used to return the resolved file name.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"> * @return true if the file was located.  A true returns indicates the</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"> *         resolved file name has been placed in the provided buffer.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a7e4f398fc2ed0fcdd0fe21d94e445458">  377</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a7e4f398fc2ed0fcdd0fe21d94e445458">SysFileSystem::searchName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keyword">const</span> <span class="keywordtype">char</span> *extension, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;resolvedName)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="class_unsafe_block.html">UnsafeBlock</a> releaser;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_sys_file_system.html#af3f69f5d567b4f828c27283e948cf07d">primitiveSearchName</a>(name, path, extension, resolvedName);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"> * Do a search for a single variation of a filename.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> * @param name      The name to search for.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"> * @param path      The path to search over</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"> * @param extension A potential extension to add to the file name (can be NULL).</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> * @param resolvedName</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"> *                  The buffer used to return the resolved file name.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment"> * @return true if the file was located.  A true returns indicates the</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"> *         resolved file name has been placed in the provided buffer.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#af3f69f5d567b4f828c27283e948cf07d">  396</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#af3f69f5d567b4f828c27283e948cf07d">SysFileSystem::primitiveSearchName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keyword">const</span> <span class="keywordtype">char</span> *extension, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;resolvedName)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> asIs, lower;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    asIs = name;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    lower = name;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="class_utilities.html#a84b19457dd57d0b2cf3eba8d129765b2">Utilities::strlower</a>((<span class="keywordtype">char</span> *)lower);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// name may already be in lower case so we won&#39;t need a second iteration</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">int</span> iterations = strcmp((<span class="keywordtype">char</span> *)asIs, (<span class="keywordtype">char</span> *)lower) == 0 ? 1 : 2;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// for each name, check in both the provided case and lower case.</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iterations; i++)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">// construct the search name, potentially adding on an extension</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="comment">// we always keep the extension in the case provided.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span> (extension != NULL)</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            asIs += extension;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="comment">// do the direct search if this is qualified enough</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="comment">// if not, try to locate it along the path</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a617d52cfc7be506cebb68737ea80a5f0">hasDirectory</a>(asIs) ? <a class="code" href="class_sys_file_system.html#a1f8400d507c08b216502ec54dd75373c">checkCurrentFile</a>(asIs, resolvedName) : <a class="code" href="class_sys_file_system.html#a956e05fb8ed5d9d54a3b800f77655d00">searchPath</a>(asIs, path, resolvedName))</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// try again in lower case</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        asIs = lower;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"> * Try to locate a file using just the raw name passed in, as</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment"> * opposed to searching along a path for the name.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"> * @param name   The name to use for the search.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"> * @param resolvedName</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment"> *               The buffer for the returned name.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment"> * @return true if the file was located, false otherwise.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a1f8400d507c08b216502ec54dd75373c">  438</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a1f8400d507c08b216502ec54dd75373c">SysFileSystem::checkCurrentFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;resolvedName)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    resolvedName = name;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// take care of any special conditions in the name structure</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// a failure here means an invalid name of some sort</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">canonicalizeName</a>(resolvedName))</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        resolvedName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// this needs to exists and be a regular file</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keyword">struct </span>stat64 dummy;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (stat64(resolvedName, &amp;dummy) == 0 &amp;&amp;  S_ISREG(dummy.st_mode))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// not found</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    resolvedName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;}</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> * Do a path search for a file.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment"> * @param name   The name to search for.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment"> * @param path   The search path to use.</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment"> * @param resolvedName</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment"> *               A buffer used for returning the resolved name.</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment"> * @return Returns true if the file was located.  If true, the resolvedName</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment"> *         buffer will contain the returned name.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a956e05fb8ed5d9d54a3b800f77655d00">  473</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a956e05fb8ed5d9d54a3b800f77655d00">SysFileSystem::searchPath</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;resolvedName)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// if we have enough absolute directory information at the beginning</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// we can bypass performing path searches.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a617d52cfc7be506cebb68737ea80a5f0">hasDirectory</a>(name))</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        resolvedName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_sys_file_system.html#a1f8400d507c08b216502ec54dd75373c">checkCurrentFile</a>(name, resolvedName);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// get an end pointer</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pathEnd = path + strlen(path);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = path;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *q = strchr(p, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// for each directory in searchpath</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">for</span> (; p &lt; pathEnd; p = q + 1, q = strchr(p, <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">// it&#39;s possible we&#39;ve hit the end, in which case, point the delimiter marker past the end of the</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// string</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">if</span> (q == NULL)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            q = pathEnd;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordtype">size_t</span> subLength = q - p;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> (subLength == 0)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="comment">// case &quot;::&quot; in path</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        resolvedName.<a class="code" href="class_file_name_buffer.html#a914cfc5e0ca08b748eeb7a72ed774860">set</a>(p, subLength);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">if</span> (!resolvedName.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="charliteral">&#39;/&#39;</span>))</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            resolvedName += <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        resolvedName += name;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">// take care of any special conditions in the name structure</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// a failure here means an invalid name of some sort</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">canonicalizeName</a>(resolvedName))</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keyword">struct </span>stat64 dummy;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="keywordflow">if</span> (stat64(resolvedName, &amp;dummy) == 0)   <span class="comment">/* If file is found,     */</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="comment">// this needs to be a regular file</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keywordflow">if</span> (S_ISREG(dummy.st_mode))</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                resolvedName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    resolvedName = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"> * resolve the user home directory portion of a file name</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"> * @param name       The current working name. This is updated in place.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"> * @param nameLength The length of the working buffer</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"> * @return true if this was valid enough to normalize.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a16834b7d64f698dc1d1ffdde6d920167">  541</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a16834b7d64f698dc1d1ffdde6d920167">SysFileSystem::resolveTilde</a>(<a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;name)</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// save a copy of the name</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="class_auto_file_name_buffer.html">AutoFileNameBuffer</a> tempName(name);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">// does it start with the user home marker?</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// this is the typical case.  This is a directory based off of</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// the current users home directory.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (name.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(1) == <span class="charliteral">&#39;\0&#39;</span> || name.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(1) == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">// save everything after the first character</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        tempName = ((<span class="keyword">const</span> <span class="keywordtype">char</span> *)name) + 1;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="comment">// start with the home directory</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        name = getenv(<span class="stringliteral">&quot;HOME&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="comment">// We don&#39;t need to add a slash : If we have &quot;~&quot; alone, then no final slash expected (same as for &quot;~user&quot;). If &quot;~/...&quot; then we have the slash already</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        name += (<span class="keyword">const</span> <span class="keywordtype">char</span> *)tempName;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">// referencing a file in some other user&#39;s home directory.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="comment">// we need to extract the username and resolve that home directory</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="class_auto_file_name_buffer.html">AutoFileNameBuffer</a> userName(name);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">// copy the whole original name into the temporary</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        tempName = (<span class="keyword">const</span> <span class="keywordtype">char</span> *)name;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="comment">// look for the start of a directory</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *slash = strchr((<span class="keyword">const</span> <span class="keywordtype">char</span> *)tempName, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">// if there is a directory after the username, we need</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="comment">// to copy just the name piece</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keywordflow">if</span> (slash != NULL)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keywordtype">size_t</span> nameLen = slash - ((<span class="keyword">const</span> <span class="keywordtype">char</span> *)tempName) - 1;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            userName.<a class="code" href="class_file_name_buffer.html#a914cfc5e0ca08b748eeb7a72ed774860">set</a>(((<span class="keyword">const</span> <span class="keywordtype">char</span> *)tempName) + 1, nameLen);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">// all username, just copy</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            userName = ((<span class="keyword">const</span> <span class="keywordtype">char</span> *)tempName) + 1;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">// see if we can retrieve the information</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keyword">struct </span>passwd *ppwd = getpwnam(userName);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (ppwd == NULL)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="comment">// this is not valid without user information, so just fail the operation</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="comment">// if we can&#39;t get this.</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;                    <span class="comment">/* nothing happend            */</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// copy the home dir</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        name = ppwd-&gt;pw_dir;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="comment">// if we have a directory after the username, copy the whole thing</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">// from that point</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">if</span> (slash != NULL)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            name += slash;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"> * Process a file name to add the current working directory</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"> * or the home directory, as needed, then remove all of the</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment"> * . and .. elements.</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"> * @param name   The current working name.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"> * @return true if this was valid enough to normalize.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">  613</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">SysFileSystem::canonicalizeName</a>(<a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;name)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="comment">// the nullstring is an invalid filename; nothing we can do here</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">if</span> (name.<a class="code" href="class_file_name_buffer.html#a8532e5858a45084da333d8a4b56e5f16">isEmpty</a>())</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// does it start with the user home marker?</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (name.<a class="code" href="class_file_name_buffer.html#abe2e58760c5c2553845be516a5f94e89">startsWith</a>(<span class="charliteral">&#39;~&#39;</span>))</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="class_sys_file_system.html#a16834b7d64f698dc1d1ffdde6d920167">resolveTilde</a>(name);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// if we&#39;re not starting with root, we need to add the</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// current working directory.  This will also handle the</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// &quot;.&quot; and &quot;..&quot; cases, which will be removed by the canonicalization</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// process.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!name.<a class="code" href="class_file_name_buffer.html#abe2e58760c5c2553845be516a5f94e89">startsWith</a>(<span class="charliteral">&#39;/&#39;</span>))</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="comment">// copy the name</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> tempName = name;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="comment">// get the current directory in the name buffer</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">getCurrentDirectory</a>(name))</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        name += <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        name += tempName;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// NOTE:  realpath() is more portable than canonicalize_file_name().</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">// However, they both have problems in that they both fail if the file does</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">// not exist.  There are a number of places where the interpreter needs to</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="comment">// canonicalize a path name whether the file exists or not.  So we use our</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">// own function to normalize the name.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> tempName;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a308b8de6e3ccbcc635688fafb7fb461b">normalizePathName</a>(name, tempName))</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        name = tempName;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"> * Normalize an absolute Unix path name.  Removes duplicate and trailing</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"> * slashes, resolves and removes ./ or ../  This works for any path name,</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> * whether the resovled name exists or not.</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> * @param name      The path name to normalize.</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"> * @param resolved  On success the normalized name is returned here.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"> * @return True on success, otherwise false.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> * @assumes  Name is null-terminated and that resolved is an adequate buffer.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a308b8de6e3ccbcc635688fafb7fb461b">  672</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a308b8de6e3ccbcc635688fafb7fb461b">SysFileSystem::normalizePathName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;resolvedName)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// Path name has to be absolute.</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (*name != <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// we copy caracter-by-character</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordtype">size_t</span> dest = 0;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordtype">size_t</span> previousSlash = dest;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(dest) = <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// For each character in the path name, decide whether, and where, to copy.</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *p = name; *p != <span class="charliteral">&#39;\0&#39;</span>; p++)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="comment">// Only adjust previousSlash if we don&#39;t have a &quot;.&quot; coming up next.</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">if</span> (*(p + 1) != <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                previousSlash = dest;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">if</span> (resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(dest) == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                <span class="comment">// Remove double &quot;/&quot;</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(++dest) = *p;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="keywordflow">if</span> (resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(dest) == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keywordtype">char</span> next = *(p + 1);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="keywordflow">if</span> (next == <span class="charliteral">&#39;\0&#39;</span> || next == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="comment">// Don&#39;t copy the &quot;.&quot;, if at the end, the trailing &quot;/&quot; will</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    <span class="comment">// be removed in the final step. If it is: &quot;./&quot;, the double</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                    <span class="comment">// &quot;//&quot; will be removed in the next iteration.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <span class="comment">// We have &quot;..&quot;, but we don&#39;t do anything unless the next</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="comment">// position is a &quot;/&quot; or the end.  (In case of a file like:</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <span class="comment">// ..my.file)</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    next = *(p + 2);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    <span class="keywordflow">if</span> (next == <span class="charliteral">&#39;\0&#39;</span> || next == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        p++;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        dest = previousSlash;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                        <span class="comment">// Now we probably have to push prevSl back, unless we</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        <span class="comment">// are at the root of the file system.</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                        <span class="keywordflow">while</span> (previousSlash &gt; 0)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                        {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                            <span class="keywordflow">if</span> (resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(--previousSlash) == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                            {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                            }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(++dest) = *p;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(++dest) = *p;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(++dest) = *p;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="comment">// Terminate. Where, depends on several things.</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">if</span> (resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(dest) == <span class="charliteral">&#39;/&#39;</span> &amp;&amp; dest != 0)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">// overwrite a trailing slash</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(dest) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        resolvedName.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(++dest) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;}</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment"> * Delete a file from the file system.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"> * @param name   The fully qualified name of the file.</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"> * @return The return code from the delete operation.</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ab79963d7b5c5239834cbc4813f8f6fd1">  771</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_sys_file_system.html#ab79963d7b5c5239834cbc4813f8f6fd1">SysFileSystem::deleteFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;{</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="comment">// only delete files if we have write permision</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#ac0c4fff0e30fe22b13c6027c99e90ff7">canWrite</a>(name))</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">return</span> EACCES;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">return</span> unlink(name) == 0 ? 0 : errno;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;}</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"> * Delete a directory from the file system.</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"> * @param name   The name of the target directory.</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"> * @return The return code from the delete operation.</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00788"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#adff4f5ceb67103485f03017d3b3b6bde">  788</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_sys_file_system.html#adff4f5ceb67103485f03017d3b3b6bde">SysFileSystem::deleteDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;{</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span> remove(name) == 0 ? 0 : errno;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"> * Test if a given file name is for a directory.</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> * @return true if the file is a directory, false for any other</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> *         type of entity.</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00802"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ab90abfbdd7dcdf622776e21f32371ba3">  802</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ab90abfbdd7dcdf622776e21f32371ba3">SysFileSystem::isDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;{</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keyword">struct </span>stat64 finfo;                 <span class="comment">/* return buf for the finfo   */</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordtype">int</span> rc = stat64(name, &amp;finfo);       <span class="comment">/* read the info about it     */</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> rc == 0 &amp;&amp; S_ISDIR(finfo.st_mode);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;}</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment"> * Test is a file is read only.</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment"> * @param name   The target file name.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment"> * @return true if the file is marked as read-only.</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#af7fbd8ec5f7992b7d23c0d11c6dc56b8">  818</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#af7fbd8ec5f7992b7d23c0d11c6dc56b8">SysFileSystem::isReadOnly</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;{</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">return</span> access(name, W_OK) != 0 &amp;&amp; access(name, R_OK) == 0;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;}</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> * Test is a file is readable .</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> * @param name   The target file name.</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment"> * @return true if the file can be read.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a05c46424e20d9c4a2310e9d489edd4a2">  831</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a05c46424e20d9c4a2310e9d489edd4a2">SysFileSystem::canRead</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;{</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">return</span> access(name, R_OK) == 0;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;}</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment"> * Test if a file is marked as write-only.</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment"> * @param name   The target file name.</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment"> * @return true if the file is only writeable.  false if read</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"> *         operations are permitted.</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00846"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ac8c48476470d2e19c600bbadc61b5685">  846</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ac8c48476470d2e19c600bbadc61b5685">SysFileSystem::isWriteOnly</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;{</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">return</span> access(name, R_OK) != 0 &amp;&amp; access(name, W_OK) == 0;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment"> * Test if the process can write to the file. This is not the</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment"> * same as being read only</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment"> * @param name   The target file name.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment"> * @return true if the file is only writeable.  false if read</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"> *         operations are permitted.</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ac0c4fff0e30fe22b13c6027c99e90ff7">  861</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ac0c4fff0e30fe22b13c6027c99e90ff7">SysFileSystem::canWrite</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;{</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">return</span> access(name, W_OK) == 0;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment"> * Test if a give file name is for a real file (not</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment"> * a directory).</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment"> * @param name   The target file name.</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment"> * @return true if the file is a real file, false if some other</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment"> *         filesystem entity.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00877"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#aff112763947c164692ad49653d124474">  877</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#aff112763947c164692ad49653d124474">SysFileSystem::isFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;{</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keyword">struct </span>stat64 finfo;                 <span class="comment">/* return buf for the finfo   */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">int</span> rc = stat64(name, &amp;finfo);       <span class="comment">/* read the info about it     */</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">return</span> rc == 0 &amp;&amp; (S_ISREG(finfo.st_mode) || S_ISBLK(finfo.st_mode));</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment"> * Test if a file or directory exists using a fully qualified name.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment"> * @param name   The target file or directory name.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment"> * @return True if the file or directory exists, false if it is unknown.</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00893"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#afd5106b26c6a68d9a01e3ef101665221">  893</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#afd5106b26c6a68d9a01e3ef101665221">SysFileSystem::exists</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;{</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keyword">struct </span>stat64 finfo;                 <span class="comment">/* return buf for the finfo   */</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordtype">int</span> rc = stat64(name, &amp;finfo);       <span class="comment">/* read the info about it     */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">return</span> rc == 0;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;}</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment"> * Determine if the given file is a symbolic link to another file.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"> * @param name   The file name.</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"> * @return True if the file is considered a link, false if this is the real</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment"> *         file object.</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00910"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#af53b0c972ca242b539bf359fc8376ecc">  910</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#af53b0c972ca242b539bf359fc8376ecc">SysFileSystem::isLink</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;{</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keyword">struct </span>stat64 finfo;                   <span class="comment">/* return buf for the finfo   */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordtype">int</span> rc = lstat64(name, &amp;finfo);        <span class="comment">/* read the info about it     */</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">return</span> rc == 0 &amp;&amp; S_ISLNK(finfo.st_mode);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;}</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="comment"> * helper function to convert UTC time to local time.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment"> * @param utc    Calendar time (UTC) in seconds elapsed since 1970-01-01T00:00:00Z.</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"> * @param loc    Local time in microseconds since 0001-01-01T00:00:00.</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="comment"> * @return true if local time can be converted to UTC, false otherwise.</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00927"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#abdc7f00eb3d6ff658cae4b6cfbf6825b">  927</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#abdc7f00eb3d6ff658cae4b6cfbf6825b">utcToLocal</a>(time_t utc, <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> *loc)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;{</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keyword">struct </span>tm gmt, local;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> offset;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">// to calculate the UTC offset (including DST) we subtract the</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// localtime() timestamp from the gmtime() timestamp</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (gmtime_r(&amp;utc, &amp;gmt) == NULL ||</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        localtime_r(&amp;utc, &amp;local) == NULL)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">// if both local and UTC timestamps fall on the same day, this is the UTC/DST offset</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    offset = ((local.tm_hour - gmt.tm_hour) * 60</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            + (local.tm_min - gmt.tm_min)) * 60</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;             + local.tm_sec - gmt.tm_sec;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="comment">// if the local day is earlier than its UTC counterpart, we&#39;re dealing with</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="comment">// a negative UTC/DST offset which extends into the prior day</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="comment">// we&#39;ll have to subtract a full day from &#39;offset&#39; to compensate</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="cmdparse_8cpp.html#ab3454b1e7e7c4c0b732dfeb74a0c040f">if</a> (local.tm_year &lt; gmt.tm_year ||</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;       (local.tm_year == gmt.tm_year &amp;&amp; local.tm_yday &lt; gmt.tm_yday))</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        offset -= 24 * 3600;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// similar to above, if we&#39;re dealing with a positive UTC/DST offset extending</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="comment">// into the next day, we&#39;ll have to add a full day to &#39;offset&#39; to compensate</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (local.tm_year &gt; gmt.tm_year ||</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;       (local.tm_year == gmt.tm_year &amp;&amp; local.tm_yday &gt; gmt.tm_yday))</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        offset += 24 * 3600;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">// time_t shouldn&#39;t be cast to int64_t, but seems to be no way around</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    *loc = (<a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a>)utc + offset + <a class="code" href="unix_2_sys_file_system_8cpp.html#a6bcc082569c38f850dbdcf973febd53f">StatEpoch</a>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;}</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment"> * helper function to convert local time to UTC time.</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment"> * @param time   Local time in microseconds since 0001-01-01T00:00:00.</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment"> * @param utc    Calendar time (UTC) in seconds elapsed since 1970-01-01T00:00:00Z.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment"> * @return true if local time can be converted to UTC, false otherwise.</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00976"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a61de47724d2c415732bcbcd69fa71b24">  976</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a61de47724d2c415732bcbcd69fa71b24">localToUtc</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> loc, time_t *utc)</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;{</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keyword">struct </span>tm local;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    time_t seconds;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="comment">// we shouldn&#39;t convert int64_t to time_t, but seems to be no way around</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    seconds = loc / 1000000 - <a class="code" href="unix_2_sys_file_system_8cpp.html#a6bcc082569c38f850dbdcf973febd53f">StatEpoch</a>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="comment">// (mis-)use gmtime() to break our local time into its components</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> (gmtime_r(&amp;seconds, &amp;local) == NULL)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    local.tm_isdst = -1; <span class="comment">// mktime determines whether DST is in effect</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    *utc = mktime(&amp;local);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="comment">// If mktime() fails it returns (time_t)-1, but -1 might also be the</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// valid date 1969-12-31T23:59:59Z.  But as we may have a timezone</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">// shift of +/- 12 (or even more) hours, we have no reliable way of</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="comment">// distinguishing those cases.  So we&#39;ll accept -1 as valid if the</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// date was either 1969-12-31 or 1970-01-01.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">return</span> *utc != (time_t)-1 ||</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      (local.tm_year == 1969 - 1900 &amp;&amp; local.tm_mon == 12 - 1 &amp;&amp; local.tm_mday == 31) ||</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      (local.tm_year == 1970 - 1900 &amp;&amp; local.tm_mon == 1 - 1 &amp;&amp; local.tm_mday == 1);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"> * Get the last modified file date as a file time value.</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment"> * @return the file time value for the modified date, or -999999999999999999</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment"> *         for any errors.  The time is returned in microseconds.</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a6a0ab23b9aef8d958aa6eaaf82819191"> 1010</a></span>&#160;<a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code" href="class_sys_file_system.html#a6a0ab23b9aef8d958aa6eaaf82819191">SysFileSystem::getLastModifiedDate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;{</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keyword">struct </span>stat64 st;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> temp;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;st) || !<a class="code" href="unix_2_sys_file_system_8cpp.html#abdc7f00eb3d6ff658cae4b6cfbf6825b">utcToLocal</a>(st.st_mtime, &amp;temp))</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a4232af97e0837a34645e36f2b432981f">NoTimeStamp</a>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    temp *= 1000000;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">// add microseconds, if available</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="preprocessor">#ifdef HAVE_STAT_ST_MTIM</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    temp += st.st_mtim.tv_nsec / 1000;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">#elif defined HAVE_STAT_ST_MTIMESPEC</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    temp += st.st_mtimespec.tv_nsec / 1000;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">return</span> temp;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment"> * Get the file last access date as a file time value.</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"> * @return the file time value for the modified date, or -999999999999999999</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment"> *         for any errors.  The time is returned in microseconds.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ab9b20df6500c330ac0cfb26a136d62a0"> 1040</a></span>&#160;<a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> <a class="code" href="class_sys_file_system.html#ab9b20df6500c330ac0cfb26a136d62a0">SysFileSystem::getLastAccessDate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;{</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keyword">struct </span>stat64 st;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> temp;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;st) || !<a class="code" href="unix_2_sys_file_system_8cpp.html#abdc7f00eb3d6ff658cae4b6cfbf6825b">utcToLocal</a>(st.st_atime, &amp;temp))</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a4232af97e0837a34645e36f2b432981f">NoTimeStamp</a>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    temp *= 1000000;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">// add microseconds, if available</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#ifdef HAVE_STAT_ST_MTIM</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    temp += st.st_atim.tv_nsec / 1000;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="preprocessor">#elif defined HAVE_STAT_ST_MTIMESPEC</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    temp += st.st_atimespec.tv_nsec / 1000;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">return</span> temp;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment"> * Retrieve the size of a file.</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment"> * @param name   The name of the target file.</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment"> * @return the 64-bit file size.</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ac3170f58e5561e49783ce4fc6c610c5e"> 1069</a></span>&#160;<a class="code" href="windows_2rexxapitypes_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> <a class="code" href="class_sys_file_system.html#ac3170f58e5561e49783ce4fc6c610c5e">SysFileSystem::getFileLength</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keyword">struct </span>stat64 st;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;st) != 0)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">return</span> st.st_size;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment"> * Create a directory in the file system.</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment"> * @return The success/failure flag.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a84a4c8e4df1af3566b64b1eab8b7af2c"> 1087</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a84a4c8e4df1af3566b64b1eab8b7af2c">SysFileSystem::makeDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordflow">return</span> mkdir(name, S_IRWXU | S_IRWXG | S_IRWXO) != -1;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;}</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment"> * Test if a given file or directory is hidden.</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment"> * @return true if the file or directory is hidden, false otherwise.</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#af2ee5d602a15223c1a49ae774698cc99"> 1100</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#af2ee5d602a15223c1a49ae774698cc99">SysFileSystem::isHidden</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;{</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// it must exist</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#afd5106b26c6a68d9a01e3ef101665221">exists</a>(name))</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    }</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordtype">size_t</span> length = strlen(name);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index = length - 1; index &gt; 0; index--)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keywordflow">if</span> (name[index] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; (index &gt; 0 &amp;&amp; name[index - 1] == <span class="charliteral">&#39;/&#39;</span>))</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;}</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160; </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment"> * Set the last modified date for a file.</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment"> * @param name   The file or directory name.</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment"> * @param time   The new file time in local time given as</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment"> *               microseconds since 0001-01-01T00:00:00</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="comment"> * @return true if the filedate was set correctly, false otherwise.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a26781292701bfbb2f89009ab74f6a9ae"> 1130</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a26781292701bfbb2f89009ab74f6a9ae">SysFileSystem::setLastModifiedDate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> time)</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;{</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keyword">struct </span>stat64 st;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    time_t utc;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keyword">struct </span>timeval times[2];</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;st) != 0)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// get microseconds, if available</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> usec_a = 0;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="preprocessor">#ifdef HAVE_STAT_ST_MTIM</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    usec_a = st.st_atim.tv_nsec / 1000;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="preprocessor">#elif defined HAVE_STAT_ST_MTIMESPEC</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    usec_a = st.st_atimespec.tv_nsec / 1000;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    times[0].tv_sec = st.st_atime;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    times[0].tv_usec = usec_a;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="unix_2_sys_file_system_8cpp.html#a61de47724d2c415732bcbcd69fa71b24">localToUtc</a>(time, &amp;utc))</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    times[1].tv_sec = utc;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    times[1].tv_usec = time % 1000000;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">return</span> utimes(name, times) == 0;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;}</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment"> * Set the last access date for a file.</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment"> * @param time   The new file time (in ticks).</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment"> * @return true if the filedate was set correctly, false otherwise.</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ab76e8ae39191f3e68e66ed0edf7c8b89"> 1169</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ab76e8ae39191f3e68e66ed0edf7c8b89">SysFileSystem::setLastAccessDate</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> time)</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;{</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">struct </span>stat64 st;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    time_t utc;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keyword">struct </span>timeval times[2];</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;st) != 0)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// get microseconds, if available</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a> usec_m = 0;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="preprocessor">#ifdef HAVE_STAT_ST_MTIM</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    usec_m = st.st_mtim.tv_nsec / 1000;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="preprocessor">#elif defined HAVE_STAT_ST_MTIMESPEC</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    usec_m = st.st_mtimespec.tv_nsec / 1000;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    times[1].tv_sec = st.st_mtime;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    times[1].tv_usec = usec_m;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="unix_2_sys_file_system_8cpp.html#a61de47724d2c415732bcbcd69fa71b24">localToUtc</a>(time, &amp;utc))</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    times[0].tv_sec = utc;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    times[0].tv_usec = time % 1000000;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">return</span> utimes(name, times) == 0;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;}</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment"> * Set the read-only attribute on a file or directory.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment"> * @return true if the attribute was set, false otherwise.</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a5dfb59471524e6d18d10725f41e30807"> 1208</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a5dfb59471524e6d18d10725f41e30807">SysFileSystem::setFileReadOnly</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;{</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keyword">struct </span>stat64 buffer;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;buffer) != 0)</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    mode_t mode = buffer.st_mode;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="comment">// this really turns off the write permissions</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    mode = mode &amp; ~(S_IWUSR | S_IWGRP | S_IWOTH);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">return</span> chmod(name, mode) == 0;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment"> * Set the write attribute on a file or directory.</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment"> * @param name   The target name.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment"> * @return true if the attribute was set, false otherwise.</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#aed6b850df4e894eaec591627504fb029"> 1230</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#aed6b850df4e894eaec591627504fb029">SysFileSystem::setFileWritable</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;{</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keyword">struct </span>stat64 buffer;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">if</span> (stat64(name, &amp;buffer) != 0)</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    mode_t mode = buffer.st_mode;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// this really turns on the write permissions</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    mode = mode | (S_IWUSR | S_IWGRP | S_IWOTH);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">return</span> chmod(name, mode) == 0;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;}</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment"> * indicate whether the file system is case sensitive.</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="comment"> * @return true if root (/) is case-sensitive.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5"> 1251</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5">SysFileSystem::isCaseSensitive</a>()</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;{</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5">isCaseSensitive</a>(<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;}</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"> * test if an individual file is a case sensitive name</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment"> * Most Unix file systems by default are case-sensitive (with the exception</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment"> * of e. g. Darwin).  But since Linux kernel 5.2 a per-directory</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment"> * case-insensitivity is supported on ext4 file systems.</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment"> * On Darwin, partitions may be configured to be case *sensitive*.</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment"> * @return true if the given file is located within a case-sensitive directory.</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a69663a7e8d302f80a8069b67a4dae08e"> 1267</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5">SysFileSystem::isCaseSensitive</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;{</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="preprocessor">#if defined HAVE_PC_CASE_SENSITIVE || defined HAVE_FS_CASEFOLD_FL</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> tmp = strdup(name);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">while</span> (!<a class="code" href="class_sys_file_system.html#afd5106b26c6a68d9a01e3ef101665221">SysFileSystem::exists</a>(tmp))</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordtype">size_t</span> len = strlen(tmp);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="comment">// scan backwards to find the previous directory delimiter</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">for</span> (; len &gt; 0; len--)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="comment">// is this the directory delimiter?</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <span class="keywordflow">if</span> (tmp[len] == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                tmp[len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="comment">// ugly hack . . . to preserve the &quot;/&quot;</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">if</span> (len == 0)</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            tmp[len + 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="comment">// at this point the tmp variable contains something that exists</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="preprocessor">#if defined HAVE_PC_CASE_SENSITIVE</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="comment">// Darwin supports case *sensitive* partitions</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordtype">long</span> res = pathconf(tmp, _PC_CASE_SENSITIVE);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">if</span> (res != -1)</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    {</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="keywordflow">return</span> (res == 1);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="comment">// any error means this value is not supported for this file system</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="comment">// so the result is most likely true (unix standard)</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="preprocessor">#elif defined HAVE_FS_CASEFOLD_FL</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// Linux kernel 5.2 now supports per-directory case-insensitivity on</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="comment">// ext4 file systems</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordtype">int</span> attr = 0;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordtype">int</span> fd = open(tmp, O_RDONLY | O_NONBLOCK);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordflow">if</span> (fd &gt;= 0)</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        ioctl(fd, FS_IOC_GETFLAGS, &amp;attr);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        close(fd);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        <span class="keywordflow">return</span> (attr &amp; FS_CASEFOLD_FL) == 0;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// non-determined, just return true</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;}</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment"> * Retrieve the file system root elements.  On Windows,</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment"> * each of the drives is a root element.</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment"> * @return The number of roots located.</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#af43b1d0db44c0a18d0e77135d2eb5b07"> 1330</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_sys_file_system.html#af43b1d0db44c0a18d0e77135d2eb5b07">SysFileSystem::getRoots</a>(<a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;roots)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;{</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">// just one root to return</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    roots = <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;}</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment"> * Return the separator used for separating path names.</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment"> * @return The ASCII-Z version of the path separator.</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a3670a938a91b57d519fe4ddce5029298"> 1343</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sys_file_system.html#a3670a938a91b57d519fe4ddce5029298">SysFileSystem::getSeparator</a>()</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;{</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;}</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment"> * Return the separator used for separating search path elements</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment"> * @return The ASCII-Z version of the path separator.</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a6a41c4b0c2ff04ba1478233d423d701b"> 1354</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sys_file_system.html#a6a41c4b0c2ff04ba1478233d423d701b">SysFileSystem::getPathSeparator</a>()</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;{</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;:&quot;</span>;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;}</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment"> * Return the string used as a line-end separator.</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment"> * @return The ASCII-Z version of the line end sequence.</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a92d9171935ae2fc255eb751b9ee08be1"> 1365</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sys_file_system.html#a92d9171935ae2fc255eb751b9ee08be1">SysFileSystem::getLineEnd</a>()</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;{</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;}</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment"> * Retrieve the current working directory into a FileNameBuffer.</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment"> * @param directory The return directory name.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment"> * @return true if this was retrieved, false otherwise.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a5285362313e300248657f32b782bc316"> 1378</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">SysFileSystem::getCurrentDirectory</a>(<a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;directory)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;{</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">if</span> (getcwd(directory, directory.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>()) != NULL)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="comment">// erange indicates the buffer was too small. Anything else is a</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="comment">// full failure</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">if</span> (errno != ERANGE)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="comment">// expand by an arbitrary amount.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        directory.<a class="code" href="class_file_name_buffer.html#ab7a24ab0187fddedcd070b5cc7cac085">expandCapacity</a>(256);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;}</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment"> * Set the current working directory</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment"> * @param directory The new directory set.</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment"> * @return True if this worked, false for any failures</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a027006c7cde375f689293a47d19dc987"> 1406</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a027006c7cde375f689293a47d19dc987">SysFileSystem::setCurrentDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *directory)</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;{</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordflow">return</span> chdir(directory) == 0;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;}</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment"> * Check to see if two paths are identical</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment"> * @param path1  The the first path to check</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment"> * @param path2  The second path to check.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"> * @return true if these paths map to the same existing file, false if they are distinct.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a8f77159ae2de71384402686c8f99264d"> 1421</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a8f77159ae2de71384402686c8f99264d">samePaths</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path1, <span class="keyword">const</span> <span class="keywordtype">char</span> *path2)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;{</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> actualPath1 = realpath(path1, NULL);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">// realpath() gives a NULL return if the file does not exist. For this operation</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="comment">// at least one of the file must exist. If either does not exist, they cannot be bad.</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (actualPath1 == NULL)</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    {</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> actualPath2 = realpath(path2, NULL);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> (actualPath2 == NULL)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">// and compare them. Note that if we have a file in a case-insensitive file</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="comment">// system, we need to perform a caseless compare.</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5">SysFileSystem::isCaseSensitive</a>(actualPath1))</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">return</span> strcasecmp((<span class="keyword">const</span> <span class="keywordtype">char</span> *)actualPath1, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)actualPath2) == 0;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    }</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <span class="keywordflow">return</span> strcmp((<span class="keyword">const</span> <span class="keywordtype">char</span> *)actualPath1, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)actualPath2) == 0;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    }</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;}</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment"> * Copy a file to another file location with dereferencing of symbolic links.</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment"> *  If the source file is a symbolic link, the actual file copied is the target of the symbolic link.</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="comment"> *  If the destination file already exists and is a symbolic link, the target of the symbolic link is overwritten by the source file.</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="comment"> * If the destination file does not exist then it is created with the access mode of the source file (if possible).</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="comment"> * @param fromFile The file we&#39;re copying from.</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="comment"> * @param toFile   The file we&#39;re copying to</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="comment"> * @param preserveTimestamps</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="comment"> *                 if true, the copied file will have the same timestamps.</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="comment"> * @param preserveMode</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment"> *                 If true, the file modes are preserved in the new file.</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="comment"> * @return 0 if successful, or an error code for any failure.</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a42655e857442f171ce6430530625f454"> 1467</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a42655e857442f171ce6430530625f454">copyFileDereferenceSymbolicLinks</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fromFile, <span class="keyword">const</span> <span class="keywordtype">char</span> *toFile, <span class="keywordtype">bool</span> preserveTimestamps, <span class="keywordtype">bool</span> preserveMode)</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;{</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// first verify we&#39;re not trying to copy a file onto itself.</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unix_2_sys_file_system_8cpp.html#a8f77159ae2de71384402686c8f99264d">samePaths</a>(fromFile, toFile))</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keywordflow">return</span> EEXIST;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">// the from file must exist</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keyword">struct </span>stat64 fromStat;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span> (stat64(fromFile, &amp;fromStat) == -1)</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    }</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">// and we must be abl to open it for reading</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="class_auto_close.html">AutoClose</a> fromHandle = open64(fromFile, O_RDONLY);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="keywordflow">if</span> (fromHandle == -1)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160; </div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="comment">// and we need to be able to</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keyword">struct </span>stat64 toStat;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <span class="keywordtype">bool</span> toFileCreated = (stat64(toFile, &amp;toStat) == -1);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="class_auto_close.html">AutoClose</a> toHandle = open64(toFile, O_WRONLY | O_CREAT | O_TRUNC, 0666); <span class="comment">// default access mode for the moment (like fopen)</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <span class="keywordflow">if</span> (toHandle == -1)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordtype">char</span> buffer[4096];          <span class="comment">// a buffer of reasonable size for copying</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <span class="keywordtype">int</span> count = read(fromHandle, &amp;buffer, <span class="keyword">sizeof</span>(buffer));</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="keywordflow">if</span> (count == -1)</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="keywordflow">if</span> (count == 0)</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// EOF</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">if</span> (write(toHandle, buffer, count) == -1)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (fromHandle.<a class="code" href="class_auto_close.html#a6e9ff91638d07c09e71a4abaa0d96434">close</a>() == -1)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="keywordflow">if</span> (toHandle.<a class="code" href="class_auto_close.html#a6e9ff91638d07c09e71a4abaa0d96434">close</a>() == -1)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    }</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">// if asked to preserve the timestamps, then</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">// copy the stat information from the from file.</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="comment">// NB, the access time is the last access before this copy operation.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">if</span> (preserveTimestamps)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="keyword">struct </span>utimbuf timebuf;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        timebuf.actime = fromStat.st_atime;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        timebuf.modtime = fromStat.st_mtime;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        utime(toFile, &amp;timebuf);</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">// if we created this file or preserveMode was specified,</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// set the mode to the same as the from file.</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">if</span> (toFileCreated || preserveMode)</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    {</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        chmod(toFile, fromStat.st_mode);</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;}</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160; </div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">Returns a new filename whose directory path is the same as filename&#39;s directory</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">and that is not the same as the name of an existing file in this directory.</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">Used to temporarily rename a file in place (i.e. in its directory).</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">This new filename must be freed when no longer needed.</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a1e463e85bad88125b37c28f2cd4231f6"> 1551</a></span>&#160;<span class="keywordtype">char</span>* <a class="code" href="unix_2_sys_file_system_8cpp.html#a1e463e85bad88125b37c28f2cd4231f6">temporaryFilename</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keywordtype">int</span> &amp;errInfo)</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;{</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// allocate a buffer large enough to hold the file name plus the extra characters</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="comment">// we add to the end.</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordtype">size_t</span> fullLength = strlen(filename) + 8;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordtype">char</span> *tempFileName = (<span class="keywordtype">char</span> *)malloc(fullLength);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">if</span> (tempFileName == NULL)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="comment">// generate a random starting point</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    srand((<span class="keywordtype">int</span>)time(NULL));</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordtype">size_t</span> num = rand();</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">// we only handle the lower six digits</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    num = num % 6;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordtype">size_t</span> start = num;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        <span class="keywordtype">char</span> numstr[8];</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="comment">// append 6 random digits to the base file name</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        snprintf(tempFileName, <span class="keyword">sizeof</span>(numstr), <span class="stringliteral">&quot;%s%06zu&quot;</span>, filename, num);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160; </div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="comment">// if there&#39;s no matching file, we&#39;re finished.</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">SysFileSystem::fileExists</a>(tempFileName))</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            <span class="keywordflow">return</span> tempFileName;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">// generate a new number for filling in the name</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        num = (num + 1) % 6;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="comment">// if we&#39;ve wrapped around to where we started, time to give up</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="keywordflow">if</span> (num == start)</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;}</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment"> * Copy a file without dereferencing the symbolic links.</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment"> *  If the source file is a symbolic link, the actual file copied is the symbolic link itself.</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment"> *  If the destination file already exists and is a symbolic link, the target of the symbolic link is not overwritten by the source file.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment"> * again, the source and the target cannot be the same</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment"> * @param fromFile The file to copy from.</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment"> * @param toFile   The file to copy to</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment"> * @param force    Force the rename if the target exists as a symbolic link</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment"> * @param preserveTimestamps</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="comment"> *                 preserve the time stamps (if possible)</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="comment"> * @param preserveMode</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="comment"> *                 Preserve the file mode (if possible)</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment"> * @return 0 if successful, or the appropriate error code.</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"><a class="line" href="unix_2_sys_file_system_8cpp.html#a229ea589f5b056245f273bc598699b9b"> 1610</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a229ea589f5b056245f273bc598699b9b">copyFileDontDereferenceSymbolicLinks</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fromFile, <span class="keyword">const</span> <span class="keywordtype">char</span> *toFile, <span class="keywordtype">bool</span> force, <span class="keywordtype">bool</span> preserveTimestamps, <span class="keywordtype">bool</span> preserveMode)</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;{</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="comment">// again, the source and the target cannot be the same</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unix_2_sys_file_system_8cpp.html#a8f77159ae2de71384402686c8f99264d">samePaths</a>(fromFile, toFile))</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <span class="keywordflow">return</span> EEXIST;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keyword">struct </span>stat64 fromStat;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordflow">if</span> (lstat64(fromFile, &amp;fromStat) == -1)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// remember if we are copying from a symbolic link</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordtype">bool</span> fromFileIsSymbolicLink = S_ISLNK(fromStat.st_mode);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; </div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">// and also get the link state for the copy target.</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keyword">struct </span>stat64 toStat;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordtype">bool</span> toFileExists = (lstat64(toFile, &amp;toStat) == 0);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordtype">bool</span> toFileIsSymbolicLink = (toFileExists &amp;&amp; S_ISLNK(toStat.st_mode));</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> toFileNewname;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="comment">// if we have an existing file and either is a symbolic link, we need to</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// create a temporary file.</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">if</span> (toFileExists &amp;&amp; (fromFileIsSymbolicLink || toFileIsSymbolicLink))</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="comment">// Must remove toFile when fromFile is a symbolic link, to let copy the link.</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="comment">// Must remove toFile when toFile is a symbolic link, to not follow the link.</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="comment">// But do that safely : first rename toFile, then do the copy and finally remove the renamed toFile.</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">if</span> (force == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;            <span class="keywordflow">return</span> EEXIST; <span class="comment">// Not allowed by caller to remove it</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        <span class="keywordtype">int</span> errInfo;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <span class="comment">// create a temporary file name in the same path location as the toFile</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        toFileNewname = <a class="code" href="unix_2_sys_file_system_8cpp.html#a1e463e85bad88125b37c28f2cd4231f6">temporaryFilename</a>(toFile, errInfo);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        <span class="keywordflow">if</span> (errInfo != 0)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;            <span class="keywordflow">return</span> errInfo;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    }</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">// we are dealing with a symbolic link for the source. We are going to create the target as</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="comment">// a symbolic link back to the original file rather than copy the data</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (fromFileIsSymbolicLink)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        off_t pathSize = fromStat.st_size; <span class="comment">// The length in bytes of the pathname contained in the symbolic link</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <a class="code" href="class_auto_free.html">AutoFree</a> pathBuffer = (<span class="keywordtype">char</span> *)malloc(pathSize + 1);</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="keywordflow">if</span> (pathBuffer == NULL)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keywordflow">if</span> (readlink(fromFile, pathBuffer, pathSize) == -1)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        pathBuffer[pathSize] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160; </div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="comment">// if the target file exists, rename to the temporary file name (if we can)</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        <span class="keywordflow">if</span> (toFileNewname != NULL &amp;&amp; rename(toFile, toFileNewname) == -1)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        <span class="comment">// Now create a symbolic link between the linked name and the target file.</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">if</span> (symlink(pathBuffer, toFile) == -1)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            <span class="keywordtype">int</span> errInfo = errno;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            <span class="comment">// Undo the renaming</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            <span class="keywordflow">if</span> (toFileNewname != NULL)</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;                rename(toFileNewname, toFile);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            <span class="keywordflow">return</span> errInfo;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        <span class="comment">// Note : there is no API to preserve the timestamps and mode of a symbolic link</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="comment">// do we need to rename the target?</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keywordflow">if</span> (toFileNewname != NULL &amp;&amp; rename(toFile, toFileNewname) == -1)</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;            <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        }</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="comment">// this is a real copy operation</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="keywordtype">int</span> errInfo = <a class="code" href="unix_2_sys_file_system_8cpp.html#a42655e857442f171ce6430530625f454">copyFileDereferenceSymbolicLinks</a>(fromFile, toFile, preserveTimestamps, preserveMode);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">if</span> (errInfo != 0)</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            <span class="comment">// Undo the renaming</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;            <span class="keywordflow">if</span> (toFileNewname != NULL)</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                rename(toFileNewname, toFile);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            <span class="keywordflow">return</span> errInfo;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// The copy has been done, now can remove the backup</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">if</span> (toFileNewname != NULL)</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        unlink(toFileNewname);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;}</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment"> * Implementation of a copy file operation.</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment"> * @param fromFile The from file of the copy operation</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment"> * @param toFile   The to file of the copy operation.</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment"> * @return Any error codes.</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#afdbfc64abd8f4454f11a7eb58dcd8f41"> 1728</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_sys_file_system.html#afdbfc64abd8f4454f11a7eb58dcd8f41">SysFileSystem::copyFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fromFile, <span class="keyword">const</span> <span class="keywordtype">char</span> *toFile)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;{</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// this is a direct copy operation. We preserve the timestamps, but not</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">// the mode.</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unix_2_sys_file_system_8cpp.html#a42655e857442f171ce6430530625f454">copyFileDereferenceSymbolicLinks</a>(fromFile, toFile, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;}</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160; </div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment"> * Move a file from one location to another. This is typically just a rename, but if necessary, the file will be copied and the original unlinked.</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment"> * @param fromFile The file we&#39;re copying from.</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment"> * @param toFile   The target file.</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment"> * @return 0 if this was successful, otherwise the system error code.</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a0e218432286a21e48a9fbeed655e5cee"> 1744</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_sys_file_system.html#a0e218432286a21e48a9fbeed655e5cee">SysFileSystem::moveFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fromFile, <span class="keyword">const</span> <span class="keywordtype">char</span> *toFile)</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;{</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">// rename does not return an error if both files resolve to the same file</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="comment">// but we want to return an error in this case, to follow the behavior of mv</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="unix_2_sys_file_system_8cpp.html#a8f77159ae2de71384402686c8f99264d">samePaths</a>(fromFile, toFile))</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordflow">return</span> EEXIST; <span class="comment">// did not find a better error code to return</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// for consistency with other platforms, we don&#39;t do the move if the target is</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="comment">// and existing file.</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">fileExists</a>(toFile))</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <span class="keywordflow">return</span> EEXIST;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">if</span> (rename(fromFile, toFile) == 0)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">return</span> 0; <span class="comment">// move done</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">if</span> (errno != EXDEV)</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        <span class="keywordflow">return</span> errno; <span class="comment">// move ko, no fallback</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    }</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// Before trying the fallback copy+unlink, ensure that we can unlink fromFile.</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// If we can rename it in place, then we can unlink it.</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordtype">int</span> errInfo;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> fromFileNewname = <a class="code" href="unix_2_sys_file_system_8cpp.html#a1e463e85bad88125b37c28f2cd4231f6">temporaryFilename</a>(fromFile, errInfo);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordflow">if</span> (errInfo != 0)</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">return</span> errInfo;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">if</span> (rename(fromFile, fromFileNewname) == -1)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="keywordflow">return</span> errno;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="comment">// Good, here we know we can unlink fromFile, undo the rename</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">if</span> (rename(fromFileNewname, fromFile) == -1)</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <span class="keywordflow">return</span> errno; <span class="comment">// should not happen, but...</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="comment">// The files are on different file systems and the implementation does not support that.</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">// Try to copy then unlink</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keywordtype">int</span> copyStatus = <a class="code" href="unix_2_sys_file_system_8cpp.html#a229ea589f5b056245f273bc598699b9b">copyFileDontDereferenceSymbolicLinks</a>(fromFile, toFile, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>); <span class="comment">// 3rd arg=false : dont&#39;t force (good choice ?)</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="keywordflow">if</span> (copyStatus != 0)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="keywordflow">return</span> copyStatus; <span class="comment">// fallback ko</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">// Note : no error returned if timestamps or mode not preserved</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="comment">// copy to is ok, now unlink from</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">// in case of error, don&#39;t remove toFile, it&#39;s a bad idea !</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordflow">return</span> unlink(fromFile);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;}</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment"> * Locate the last directory delimiter in a file spec name</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment"> * @param name   The give name.</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment"> * @return The location of the last directory delimiter, or NULL if one is</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment"> *         not found.</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a6768602e0467b409e66a51a609eada65"> 1811</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sys_file_system.html#a6768602e0467b409e66a51a609eada65">SysFileSystem::getPathEnd</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;{</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordflow">return</span> strrchr(name, <a class="code" href="class_sys_file_system.html#a9d4c0462f4c948afce736454207e7146">PathDelimiter</a>);             <span class="comment">// find the last backslash in name</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;}</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment"> * Locate the last directory delimiter in a file spec name</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment"> * @param name   The give name.</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment"> * @return The location of the last directory delimiter, or NULL if one is</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment"> *         not found.</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a22c61953e6cbf741849e73a3d8babebd"> 1825</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="class_sys_file_system.html#a22c61953e6cbf741849e73a3d8babebd">SysFileSystem::getPathStart</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name)</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;{</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">// this always starts with the name</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">return</span> name;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;}</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment"> * Retrieve the location where temporary files should be stored.</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment"> * This will be the value of environment variable TMPDIR, if defined, or /tmp.</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment"> * @return true if successful, false otherwise.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"><a class="line" href="class_sys_file_system.html#a50169d0cf7ac0174b254252dff71817f"> 1837</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_system.html#a50169d0cf7ac0174b254252dff71817f">SysFileSystem::getTemporaryPath</a>(<a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;temporary)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;{</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="class_system_interpreter.html#a76c0a3bc6ecf53d054da7a8533a29f96">SystemInterpreter::getEnvironmentVariable</a>(<span class="stringliteral">&quot;TMPDIR&quot;</span>, temporary))</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        temporary = <span class="stringliteral">&quot;/tmp&quot;</span>;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    }</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;}</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment"> * Create a new SysFileIterator instance.</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment"> * @param path    The path we&#39;re going to be searching in</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment"> * @param pattern The pattern to use. If NULL, then everything in the path will be returned.</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment"> * @param buffer  A FileNameBuffer object used to construct the path name.</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"><a class="line" href="class_sys_file_iterator.html#afb172874f89c4caf81b00d927c9a05a2"> 1855</a></span>&#160;<a class="code" href="class_sys_file_iterator.html#afb172874f89c4caf81b00d927c9a05a2">SysFileIterator::SysFileIterator</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keyword">const</span> <span class="keywordtype">char</span> *pattern, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;buffer, <span class="keywordtype">bool</span> c)</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;{</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="comment">// save the pattern spec to check agains each path entry</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a> = pattern;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="comment">// and also save the directory we are searching in</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <a class="code" href="class_sys_file_iterator.html#a5a03eea9b54e3122ac2cef47ba040ba3">directory</a> = path;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <span class="comment">// caseLess can be explicit or implicit, based on the characteristics of the path.</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="comment">// Mac file systems are generally case insensitive, but other unix variants are</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="comment">// usually case sensitive.</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <a class="code" href="class_sys_file_iterator.html#a53d8a82540a20260020d1dd0a16576e9">caseLess</a> = c || !<a class="code" href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5">SysFileSystem::isCaseSensitive</a>(path);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="preprocessor">#ifndef HAVE_FNM_CASEFOLD</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">// if we&#39;re tasked with doing a caseless search but the option is</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">// not available with fnmatch(), then we need to copy the pattern</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">// spec and uppercase it.</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#a53d8a82540a20260020d1dd0a16576e9">caseLess</a> &amp;&amp; <a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a> != NULL)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="keywordtype">char</span> *upperString = strdup(<a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a>);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <a class="code" href="class_utilities.html#a48f8b5eee5a201ee55dcd874206189b4">Utilities::strupper</a>(upperString);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a> = upperString;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// this assumes we&#39;ll fail...if we find something,</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="comment">// we&#39;ll flip this</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <a class="code" href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">completed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a> = opendir(path);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="comment">// if didn&#39;t open, this either doesn&#39;t exist or</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">// isn&#39;t a directory</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a> == NULL)</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <span class="comment">// ok, we potentially have something to return</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    <a class="code" href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">completed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="comment">// go locate the first matching entry (if it can)</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="class_sys_file_iterator.html#aca803aff60c94290e26104a7bf721f1e">findNextEntry</a>();</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;}</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="comment"> * Destructor for the iteration operation.</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"><a class="line" href="class_sys_file_iterator.html#a84204b51458b5bac258456d00044fde9"> 1899</a></span>&#160;<a class="code" href="class_sys_file_iterator.html#a84204b51458b5bac258456d00044fde9">SysFileIterator::~SysFileIterator</a>()</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;{</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="class_sys_file_iterator.html#a1eceec79d2c57a598bbbdd10dfc81da4">close</a>();</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;}</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment"> * close the iterator.</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"><a class="line" href="class_sys_file_iterator.html#a1eceec79d2c57a598bbbdd10dfc81da4"> 1908</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_sys_file_iterator.html#a1eceec79d2c57a598bbbdd10dfc81da4">SysFileIterator::close</a>()</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;{</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a> != 0)</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;        closedir(<a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a>);</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        <a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a> = 0;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="preprocessor">#ifndef HAVE_FNM_CASEFOLD</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">// if we had to copy the patternSpec, make sure we free the copy up</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#a53d8a82540a20260020d1dd0a16576e9">caseLess</a> &amp;&amp; <a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a> != NULL)</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        free((<span class="keywordtype">void</span> *)<a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a>);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a> = NULL;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    }</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;}</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment"> * Check if the iterator has new results it can return.</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment"> * @return true if the iterator has another value to return, false if</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment"> *         the iteration is complete.</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"><a class="line" href="class_sys_file_iterator.html#a3dd162e408c35a56ab6407608c7ab154"> 1932</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_sys_file_iterator.html#a3dd162e408c35a56ab6407608c7ab154">SysFileIterator::hasNext</a>()</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;{</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordflow">return</span> !<a class="code" href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">completed</a>;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;}</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment"> * Retrieve the next iteration value.</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment"> * @param buffer     The buffer used to return the value.</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment"> * @param attributes The returned system-dependent attributes of the next file.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"><a class="line" href="class_sys_file_iterator.html#ab20fd83c4ab838761f491c332d387382"> 1944</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_sys_file_iterator.html#ab20fd83c4ab838761f491c332d387382">SysFileIterator::next</a>(<a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;buffer, <a class="code" href="class_sys_file_iterator_1_1_file_attributes.html">SysFileIterator::FileAttributes</a> &amp;attributes)</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;{</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">completed</a>)</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        buffer = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        buffer = <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a> = <a class="code" href="class_sys_file_iterator.html#a9b0da1b1e1ff5969213ad19580a0f066">findFileData</a>;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <a class="code" href="class_sys_file_iterator.html#aca803aff60c94290e26104a7bf721f1e">findNextEntry</a>();</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;}</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="comment"> * Scan forward through the directory to find the next matching entry.</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;<span class="comment"> * @return true if a matching entry was found, false for any error or nothign found.</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"><a class="line" href="class_sys_file_iterator.html#aca803aff60c94290e26104a7bf721f1e"> 1965</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_sys_file_iterator.html#aca803aff60c94290e26104a7bf721f1e">SysFileIterator::findNextEntry</a>()</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;{</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a> = readdir(<a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a>);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a> == NULL)</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    {</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="comment">// we&#39;re done once we hit a failure</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <a class="code" href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">completed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <a class="code" href="class_sys_file_iterator.html#a1eceec79d2c57a598bbbdd10dfc81da4">close</a>();</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// requesting everything? we&#39;ve got what we want</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a> == NULL)</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        <span class="comment">// we need to perform the stat64() using the fully resolved name.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">// if there is an allocation error here, we have limited ability to raise</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="comment">// an error here so we will just fail silently and return incorrect information.</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="comment">// There is very low probability anybody will ever see this error.</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="keywordtype">size_t</span> bufferLength = strlen(<a class="code" href="class_sys_file_iterator.html#a5a03eea9b54e3122ac2cef47ba040ba3">directory</a>) + strlen(<a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name) + 8;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160; </div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <a class="code" href="class_auto_free.html">AutoFree</a> fullName = (<span class="keywordtype">char</span> *)malloc(bufferLength);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keywordflow">if</span> (fullName == (<span class="keywordtype">char</span> *)NULL)</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        }</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        snprintf(fullName, bufferLength, <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="class_sys_file_iterator.html#a5a03eea9b54e3122ac2cef47ba040ba3">directory</a>, <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        <span class="comment">// save the attribute information for this file</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        stat64(fullName, &amp;<a class="code" href="class_sys_file_iterator.html#a9b0da1b1e1ff5969213ad19580a0f066">findFileData</a>);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordtype">int</span> flags = FNM_NOESCAPE | FNM_PATHNAME;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *testName = <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">// if this is a caseless search, there are two ways to</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="comment">// implement this. The easy way is to use the FNM_CASEFOLD</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="comment">// extension of fnmatch(). If this is not available, we need</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="comment">// to create an uppercase version of the name we&#39;re matching against</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="comment">// and compare against the already uppercased pattern.</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#a53d8a82540a20260020d1dd0a16576e9">caseLess</a>)</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    {</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="preprocessor">#ifdef HAVE_FNM_CASEFOLD</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        flags |= FNM_CASEFOLD;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="keywordtype">char</span> *upperName = strdup(testName);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <a class="code" href="class_utilities.html#a48f8b5eee5a201ee55dcd874206189b4">Utilities::strupper</a>(upperName);</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        testName = upperName;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="comment">// use fnmatch() to handle all of the globbing</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordflow">while</span> (fnmatch(<a class="code" href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">patternSpec</a>, testName, flags) != 0)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="preprocessor">#ifndef HAVE_FNM_CASEFOLD</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="comment">// free the uppercase copy of the last test</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        free((<span class="keywordtype">void</span> *)testName);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a> = readdir(<a class="code" href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">handle</a>);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a> == NULL)</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;        {</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            <span class="comment">// we&#39;re done once we hit a failure</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            <a class="code" href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">completed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            <a class="code" href="class_sys_file_iterator.html#a1eceec79d2c57a598bbbdd10dfc81da4">close</a>();</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        }</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        testName = <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="preprocessor">#ifndef HAVE_FNM_CASEFOLD</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordtype">char</span> *upperName = strdup(testName);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        <a class="code" href="class_utilities.html#a48f8b5eee5a201ee55dcd874206189b4">Utilities::strupper</a>(upperName);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        testName = upperName;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="preprocessor">#ifndef HAVE_FNM_CASEFOLD</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// free the uppercase copy of the last test</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    free((<span class="keywordtype">void</span> *)testName);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="comment">// we need to perform the stat64() using the fully resolved name.</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">// if there is an allocation error here, we have limited ability to raise</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="comment">// an error here so we will just fail silently and return incorrect information.</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="comment">// There is very low probability anybody will ever see this error.</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="keywordtype">size_t</span> bufferLength = strlen(<a class="code" href="class_sys_file_iterator.html#a5a03eea9b54e3122ac2cef47ba040ba3">directory</a>) + strlen(<a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name) + 8;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> fullName = (<span class="keywordtype">char</span> *)malloc(bufferLength);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span> (fullName == (<span class="keywordtype">char</span> *)NULL)</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    snprintf(fullName, bufferLength, <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code" href="class_sys_file_iterator.html#a5a03eea9b54e3122ac2cef47ba040ba3">directory</a>, <a class="code" href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">entry</a>-&gt;d_name);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    <span class="comment">// save the attribute information for this file</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    stat64(fullName, &amp;<a class="code" href="class_sys_file_iterator.html#a9b0da1b1e1ff5969213ad19580a0f066">findFileData</a>);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;}</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160; </div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="ttc" id="a_activity_manager_8hpp_html"><div class="ttname"><a href="_activity_manager_8hpp.html">ActivityManager.hpp</a></div></div>
<div class="ttc" id="a_file_name_buffer_8hpp_html"><div class="ttname"><a href="_file_name_buffer_8hpp.html">FileNameBuffer.hpp</a></div></div>
<div class="ttc" id="a_rexx_core_8h_html"><div class="ttname"><a href="_rexx_core_8h.html">RexxCore.h</a></div></div>
<div class="ttc" id="a_rexx_core_8h_html_a181a36438ba4535dd7d22ab63239d1e1"><div class="ttname"><a href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a></div><div class="ttdeci">#define OREF_NULL</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_core_8h_source.html#l00055">RexxCore.h:55</a></div></div>
<div class="ttc" id="a_string_class_8hpp_html_a4a9c05b5920cf789e1f3629037c9921a"><div class="ttname"><a href="_string_class_8hpp.html#a4a9c05b5920cf789e1f3629037c9921a">new_string</a></div><div class="ttdeci">RexxString * new_string(const char *s, size_t l)</div><div class="ttdef"><b>Definition:</b> <a href="_string_class_8hpp_source.html#l00823">StringClass.hpp:823</a></div></div>
<div class="ttc" id="a_utilities_8hpp_html"><div class="ttname"><a href="_utilities_8hpp.html">Utilities.hpp</a></div></div>
<div class="ttc" id="aclass_auto_close_html"><div class="ttname"><a href="class_auto_close.html">AutoClose</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00199">unix/SysFileSystem.hpp:200</a></div></div>
<div class="ttc" id="aclass_auto_close_html_a6e9ff91638d07c09e71a4abaa0d96434"><div class="ttname"><a href="class_auto_close.html#a6e9ff91638d07c09e71a4abaa0d96434">AutoClose::close</a></div><div class="ttdeci">int close(bool returnError=true)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00224">unix/SysFileSystem.hpp:224</a></div></div>
<div class="ttc" id="aclass_auto_file_name_buffer_html"><div class="ttname"><a href="class_auto_file_name_buffer.html">AutoFileNameBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00322">FileNameBuffer.hpp:323</a></div></div>
<div class="ttc" id="aclass_auto_free_html"><div class="ttname"><a href="class_auto_free.html">AutoFree</a></div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8hpp_source.html#l00068">Utilities.hpp:69</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html"><div class="ttname"><a href="class_file_name_buffer.html">FileNameBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00052">FileNameBuffer.hpp:53</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a55e0508ed640ffb2959816c441d1fb15"><div class="ttname"><a href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">FileNameBuffer::at</a></div><div class="ttdeci">char &amp; at(size_t pos)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00207">FileNameBuffer.hpp:207</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a6491632e5158b477d0a09997dd208aae"><div class="ttname"><a href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">FileNameBuffer::endsWith</a></div><div class="ttdeci">bool endsWith(char c)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00230">FileNameBuffer.hpp:230</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a6716a194791392dd168bbc37566e652a"><div class="ttname"><a href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">FileNameBuffer::length</a></div><div class="ttdeci">size_t length()</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00071">FileNameBuffer.hpp:71</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a8532e5858a45084da333d8a4b56e5f16"><div class="ttname"><a href="class_file_name_buffer.html#a8532e5858a45084da333d8a4b56e5f16">FileNameBuffer::isEmpty</a></div><div class="ttdeci">bool isEmpty()</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00247">FileNameBuffer.hpp:247</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a914cfc5e0ca08b748eeb7a72ed774860"><div class="ttname"><a href="class_file_name_buffer.html#a914cfc5e0ca08b748eeb7a72ed774860">FileNameBuffer::set</a></div><div class="ttdeci">FileNameBuffer &amp; set(const char *s, size_t l)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00177">FileNameBuffer.hpp:177</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_ab7a24ab0187fddedcd070b5cc7cac085"><div class="ttname"><a href="class_file_name_buffer.html#ab7a24ab0187fddedcd070b5cc7cac085">FileNameBuffer::expandCapacity</a></div><div class="ttdeci">void expandCapacity(size_t c)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00088">FileNameBuffer.hpp:88</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_abe2e58760c5c2553845be516a5f94e89"><div class="ttname"><a href="class_file_name_buffer.html#abe2e58760c5c2553845be516a5f94e89">FileNameBuffer::startsWith</a></div><div class="ttdeci">bool startsWith(char c)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00213">FileNameBuffer.hpp:213</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_ac41d5214f15aa74aa580e03ab4c3f9b9"><div class="ttname"><a href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">FileNameBuffer::capacity</a></div><div class="ttdeci">size_t capacity()</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00070">FileNameBuffer.hpp:70</a></div></div>
<div class="ttc" id="aclass_rexx_string_html"><div class="ttname"><a href="class_rexx_string.html">RexxString</a></div><div class="ttdef"><b>Definition:</b> <a href="_string_class_8hpp_source.html#l00068">StringClass.hpp:69</a></div></div>
<div class="ttc" id="aclass_rexx_string_html_a3a3cc92645c7d4318f623068884c812b"><div class="ttname"><a href="class_rexx_string.html#a3a3cc92645c7d4318f623068884c812b">RexxString::getLength</a></div><div class="ttdeci">size_t getLength() const</div><div class="ttdef"><b>Definition:</b> <a href="_string_class_8hpp_source.html#l00538">StringClass.hpp:538</a></div></div>
<div class="ttc" id="aclass_rexx_string_html_aaf47ec1ef2009a65092c14cea082a7f9"><div class="ttname"><a href="class_rexx_string.html#aaf47ec1ef2009a65092c14cea082a7f9">RexxString::getStringData</a></div><div class="ttdeci">const char * getStringData() const</div><div class="ttdef"><b>Definition:</b> <a href="_string_class_8hpp_source.html#l00542">StringClass.hpp:542</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_1_1_file_attributes_html"><div class="ttname"><a href="class_sys_file_iterator_1_1_file_attributes.html">SysFileIterator::FileAttributes</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00163">unix/SysFileSystem.hpp:164</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_1_1_file_attributes_html_a7ed1219470ef7b82df4e45d534919928"><div class="ttname"><a href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">SysFileIterator::FileAttributes::findFileData</a></div><div class="ttdeci">struct stat64 findFileData</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00166">unix/SysFileSystem.hpp:169</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a04a556bb14db4ecc07452c1c54d3163f"><div class="ttname"><a href="class_sys_file_iterator.html#a04a556bb14db4ecc07452c1c54d3163f">SysFileIterator::patternSpec</a></div><div class="ttdeci">const char * patternSpec</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00192">unix/SysFileSystem.hpp:192</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a1eceec79d2c57a598bbbdd10dfc81da4"><div class="ttname"><a href="class_sys_file_iterator.html#a1eceec79d2c57a598bbbdd10dfc81da4">SysFileIterator::close</a></div><div class="ttdeci">void close()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01908">unix/SysFileSystem.cpp:1908</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a3dd162e408c35a56ab6407608c7ab154"><div class="ttname"><a href="class_sys_file_iterator.html#a3dd162e408c35a56ab6407608c7ab154">SysFileIterator::hasNext</a></div><div class="ttdeci">bool hasNext()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01932">unix/SysFileSystem.cpp:1932</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a53d8a82540a20260020d1dd0a16576e9"><div class="ttname"><a href="class_sys_file_iterator.html#a53d8a82540a20260020d1dd0a16576e9">SysFileIterator::caseLess</a></div><div class="ttdeci">bool caseLess</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00191">unix/SysFileSystem.hpp:191</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a5a03eea9b54e3122ac2cef47ba040ba3"><div class="ttname"><a href="class_sys_file_iterator.html#a5a03eea9b54e3122ac2cef47ba040ba3">SysFileIterator::directory</a></div><div class="ttdeci">const char * directory</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00187">unix/SysFileSystem.hpp:187</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a84204b51458b5bac258456d00044fde9"><div class="ttname"><a href="class_sys_file_iterator.html#a84204b51458b5bac258456d00044fde9">SysFileIterator::~SysFileIterator</a></div><div class="ttdeci">~SysFileIterator()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01899">unix/SysFileSystem.cpp:1899</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_a9b0da1b1e1ff5969213ad19580a0f066"><div class="ttname"><a href="class_sys_file_iterator.html#a9b0da1b1e1ff5969213ad19580a0f066">SysFileIterator::findFileData</a></div><div class="ttdeci">struct stat64 findFileData</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00188">unix/SysFileSystem.hpp:189</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_aa354de2da440ef4f2029de0a2b3a36a8"><div class="ttname"><a href="class_sys_file_iterator.html#aa354de2da440ef4f2029de0a2b3a36a8">SysFileIterator::completed</a></div><div class="ttdeci">bool completed</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00186">unix/SysFileSystem.hpp:186</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_ab20fd83c4ab838761f491c332d387382"><div class="ttname"><a href="class_sys_file_iterator.html#ab20fd83c4ab838761f491c332d387382">SysFileIterator::next</a></div><div class="ttdeci">void next(FileNameBuffer &amp;buffer, FileAttributes &amp;attributes)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01944">unix/SysFileSystem.cpp:1944</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_abde56b4a018a5808f465b0b635aa9424"><div class="ttname"><a href="class_sys_file_iterator.html#abde56b4a018a5808f465b0b635aa9424">SysFileIterator::handle</a></div><div class="ttdeci">DIR * handle</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00190">unix/SysFileSystem.hpp:190</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_ac8b41647794aee8438dc58256230171e"><div class="ttname"><a href="class_sys_file_iterator.html#ac8b41647794aee8438dc58256230171e">SysFileIterator::entry</a></div><div class="ttdeci">struct dirent * entry</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00188">unix/SysFileSystem.hpp:188</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_aca803aff60c94290e26104a7bf721f1e"><div class="ttname"><a href="class_sys_file_iterator.html#aca803aff60c94290e26104a7bf721f1e">SysFileIterator::findNextEntry</a></div><div class="ttdeci">void findNextEntry()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01965">unix/SysFileSystem.cpp:1965</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_html_afb172874f89c4caf81b00d927c9a05a2"><div class="ttname"><a href="class_sys_file_iterator.html#afb172874f89c4caf81b00d927c9a05a2">SysFileIterator::SysFileIterator</a></div><div class="ttdeci">SysFileIterator(const char *path, const char *pattern, FileNameBuffer &amp;buffer, bool c=false)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01855">unix/SysFileSystem.cpp:1855</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a00065686fda60d5d8ae9a80149d2e583"><div class="ttname"><a href="class_sys_file_system.html#a00065686fda60d5d8ae9a80149d2e583">SysFileSystem::fileExists</a></div><div class="ttdeci">static bool fileExists(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00198">unix/SysFileSystem.cpp:198</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a027006c7cde375f689293a47d19dc987"><div class="ttname"><a href="class_sys_file_system.html#a027006c7cde375f689293a47d19dc987">SysFileSystem::setCurrentDirectory</a></div><div class="ttdeci">static bool setCurrentDirectory(const char *directory)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01406">unix/SysFileSystem.cpp:1406</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a05c46424e20d9c4a2310e9d489edd4a2"><div class="ttname"><a href="class_sys_file_system.html#a05c46424e20d9c4a2310e9d489edd4a2">SysFileSystem::canRead</a></div><div class="ttdeci">static bool canRead(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00831">unix/SysFileSystem.cpp:831</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a0e218432286a21e48a9fbeed655e5cee"><div class="ttname"><a href="class_sys_file_system.html#a0e218432286a21e48a9fbeed655e5cee">SysFileSystem::moveFile</a></div><div class="ttdeci">static int moveFile(const char *fromFile, const char *toFile)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01744">unix/SysFileSystem.cpp:1744</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a16834b7d64f698dc1d1ffdde6d920167"><div class="ttname"><a href="class_sys_file_system.html#a16834b7d64f698dc1d1ffdde6d920167">SysFileSystem::resolveTilde</a></div><div class="ttdeci">static bool resolveTilde(FileNameBuffer &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00541">unix/SysFileSystem.cpp:541</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a1f8400d507c08b216502ec54dd75373c"><div class="ttname"><a href="class_sys_file_system.html#a1f8400d507c08b216502ec54dd75373c">SysFileSystem::checkCurrentFile</a></div><div class="ttdeci">static bool checkCurrentFile(const char *name, FileNameBuffer &amp;resolvedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00438">unix/SysFileSystem.cpp:438</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a22c61953e6cbf741849e73a3d8babebd"><div class="ttname"><a href="class_sys_file_system.html#a22c61953e6cbf741849e73a3d8babebd">SysFileSystem::getPathStart</a></div><div class="ttdeci">static const char * getPathStart(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01825">unix/SysFileSystem.cpp:1825</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a26781292701bfbb2f89009ab74f6a9ae"><div class="ttname"><a href="class_sys_file_system.html#a26781292701bfbb2f89009ab74f6a9ae">SysFileSystem::setLastModifiedDate</a></div><div class="ttdeci">static bool setLastModifiedDate(const char *name, int64_t time)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01130">unix/SysFileSystem.cpp:1130</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a308b8de6e3ccbcc635688fafb7fb461b"><div class="ttname"><a href="class_sys_file_system.html#a308b8de6e3ccbcc635688fafb7fb461b">SysFileSystem::normalizePathName</a></div><div class="ttdeci">static bool normalizePathName(const char *name, FileNameBuffer &amp;resolvedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00672">unix/SysFileSystem.cpp:672</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a3670a938a91b57d519fe4ddce5029298"><div class="ttname"><a href="class_sys_file_system.html#a3670a938a91b57d519fe4ddce5029298">SysFileSystem::getSeparator</a></div><div class="ttdeci">static const char * getSeparator()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01343">unix/SysFileSystem.cpp:1343</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a4178c0be60d7087cb7293988dd6458f9"><div class="ttname"><a href="class_sys_file_system.html#a4178c0be60d7087cb7293988dd6458f9">SysFileSystem::canonicalizeName</a></div><div class="ttdeci">static bool canonicalizeName(FileNameBuffer &amp;resolvedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00613">unix/SysFileSystem.cpp:613</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a50169d0cf7ac0174b254252dff71817f"><div class="ttname"><a href="class_sys_file_system.html#a50169d0cf7ac0174b254252dff71817f">SysFileSystem::getTemporaryPath</a></div><div class="ttdeci">static bool getTemporaryPath(FileNameBuffer &amp;temporary)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01837">unix/SysFileSystem.cpp:1837</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a5285362313e300248657f32b782bc316"><div class="ttname"><a href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">SysFileSystem::getCurrentDirectory</a></div><div class="ttdeci">static bool getCurrentDirectory(FileNameBuffer &amp;directory)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01378">unix/SysFileSystem.cpp:1378</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a541fd681c22e2aaaf91d31f78192f239"><div class="ttname"><a href="class_sys_file_system.html#a541fd681c22e2aaaf91d31f78192f239">SysFileSystem::extractFile</a></div><div class="ttdeci">static RexxString * extractFile(RexxString *file)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00292">unix/SysFileSystem.cpp:292</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a5dfb59471524e6d18d10725f41e30807"><div class="ttname"><a href="class_sys_file_system.html#a5dfb59471524e6d18d10725f41e30807">SysFileSystem::setFileReadOnly</a></div><div class="ttdeci">static bool setFileReadOnly(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01208">unix/SysFileSystem.cpp:1208</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a5fa517d8ac2128851186e3c0028b99cf"><div class="ttname"><a href="class_sys_file_system.html#a5fa517d8ac2128851186e3c0028b99cf">SysFileSystem::EOL_Marker</a></div><div class="ttdeci">static const char * EOL_Marker</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00098">unix/SysFileSystem.hpp:98</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a617d52cfc7be506cebb68737ea80a5f0"><div class="ttname"><a href="class_sys_file_system.html#a617d52cfc7be506cebb68737ea80a5f0">SysFileSystem::hasDirectory</a></div><div class="ttdeci">static bool hasDirectory(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00355">unix/SysFileSystem.cpp:355</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a6768602e0467b409e66a51a609eada65"><div class="ttname"><a href="class_sys_file_system.html#a6768602e0467b409e66a51a609eada65">SysFileSystem::getPathEnd</a></div><div class="ttdeci">static const char * getPathEnd(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01811">unix/SysFileSystem.cpp:1811</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a6a0ab23b9aef8d958aa6eaaf82819191"><div class="ttname"><a href="class_sys_file_system.html#a6a0ab23b9aef8d958aa6eaaf82819191">SysFileSystem::getLastModifiedDate</a></div><div class="ttdeci">static int64_t getLastModifiedDate(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01010">unix/SysFileSystem.cpp:1010</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a6a41c4b0c2ff04ba1478233d423d701b"><div class="ttname"><a href="class_sys_file_system.html#a6a41c4b0c2ff04ba1478233d423d701b">SysFileSystem::getPathSeparator</a></div><div class="ttdeci">static const char * getPathSeparator()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01354">unix/SysFileSystem.cpp:1354</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a7e4f398fc2ed0fcdd0fe21d94e445458"><div class="ttname"><a href="class_sys_file_system.html#a7e4f398fc2ed0fcdd0fe21d94e445458">SysFileSystem::searchName</a></div><div class="ttdeci">static bool searchName(const char *name, const char *path, const char *extension, FileNameBuffer &amp;resolvedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00377">unix/SysFileSystem.cpp:377</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a84a4c8e4df1af3566b64b1eab8b7af2c"><div class="ttname"><a href="class_sys_file_system.html#a84a4c8e4df1af3566b64b1eab8b7af2c">SysFileSystem::makeDirectory</a></div><div class="ttdeci">static bool makeDirectory(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01087">unix/SysFileSystem.cpp:1087</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a8808de93d4cff628e28033e353a1e43c"><div class="ttname"><a href="class_sys_file_system.html#a8808de93d4cff628e28033e353a1e43c">SysFileSystem::extractDirectory</a></div><div class="ttdeci">static RexxString * extractDirectory(RexxString *file)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00224">unix/SysFileSystem.cpp:224</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a8f0ef0bb39826ebf6209cb8739590bb8"><div class="ttname"><a href="class_sys_file_system.html#a8f0ef0bb39826ebf6209cb8739590bb8">SysFileSystem::extractExtension</a></div><div class="ttdeci">static RexxString * extractExtension(RexxString *file)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00256">unix/SysFileSystem.cpp:256</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a92d9171935ae2fc255eb751b9ee08be1"><div class="ttname"><a href="class_sys_file_system.html#a92d9171935ae2fc255eb751b9ee08be1">SysFileSystem::getLineEnd</a></div><div class="ttdeci">static const char * getLineEnd()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01365">unix/SysFileSystem.cpp:1365</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a956e05fb8ed5d9d54a3b800f77655d00"><div class="ttname"><a href="class_sys_file_system.html#a956e05fb8ed5d9d54a3b800f77655d00">SysFileSystem::searchPath</a></div><div class="ttdeci">static bool searchPath(const char *name, const char *path, FileNameBuffer &amp;resolvedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00473">unix/SysFileSystem.cpp:473</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a97af14f883e32e40c218beae8ea5db8d"><div class="ttname"><a href="class_sys_file_system.html#a97af14f883e32e40c218beae8ea5db8d">SysFileSystem::searchFileName</a></div><div class="ttdeci">static bool searchFileName(const char *name, FileNameBuffer &amp;fileName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00091">unix/SysFileSystem.cpp:91</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a9d4c0462f4c948afce736454207e7146"><div class="ttname"><a href="class_sys_file_system.html#a9d4c0462f4c948afce736454207e7146">SysFileSystem::PathDelimiter</a></div><div class="ttdeci">static const char PathDelimiter</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00099">unix/SysFileSystem.hpp:99</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ab76e8ae39191f3e68e66ed0edf7c8b89"><div class="ttname"><a href="class_sys_file_system.html#ab76e8ae39191f3e68e66ed0edf7c8b89">SysFileSystem::setLastAccessDate</a></div><div class="ttdeci">static bool setLastAccessDate(const char *name, int64_t time)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01169">unix/SysFileSystem.cpp:1169</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ab79963d7b5c5239834cbc4813f8f6fd1"><div class="ttname"><a href="class_sys_file_system.html#ab79963d7b5c5239834cbc4813f8f6fd1">SysFileSystem::deleteFile</a></div><div class="ttdeci">static int deleteFile(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00771">unix/SysFileSystem.cpp:771</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ab90abfbdd7dcdf622776e21f32371ba3"><div class="ttname"><a href="class_sys_file_system.html#ab90abfbdd7dcdf622776e21f32371ba3">SysFileSystem::isDirectory</a></div><div class="ttdeci">static bool isDirectory(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00802">unix/SysFileSystem.cpp:802</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ab9b20df6500c330ac0cfb26a136d62a0"><div class="ttname"><a href="class_sys_file_system.html#ab9b20df6500c330ac0cfb26a136d62a0">SysFileSystem::getLastAccessDate</a></div><div class="ttdeci">static int64_t getLastAccessDate(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01040">unix/SysFileSystem.cpp:1040</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ac0c4fff0e30fe22b13c6027c99e90ff7"><div class="ttname"><a href="class_sys_file_system.html#ac0c4fff0e30fe22b13c6027c99e90ff7">SysFileSystem::canWrite</a></div><div class="ttdeci">static bool canWrite(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00861">unix/SysFileSystem.cpp:861</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ac12164113c9d3155d14c2d08958f2ef5"><div class="ttname"><a href="class_sys_file_system.html#ac12164113c9d3155d14c2d08958f2ef5">SysFileSystem::isCaseSensitive</a></div><div class="ttdeci">static bool isCaseSensitive()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01251">unix/SysFileSystem.cpp:1251</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ac3170f58e5561e49783ce4fc6c610c5e"><div class="ttname"><a href="class_sys_file_system.html#ac3170f58e5561e49783ce4fc6c610c5e">SysFileSystem::getFileLength</a></div><div class="ttdeci">static uint64_t getFileLength(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01069">unix/SysFileSystem.cpp:1069</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ac8c48476470d2e19c600bbadc61b5685"><div class="ttname"><a href="class_sys_file_system.html#ac8c48476470d2e19c600bbadc61b5685">SysFileSystem::isWriteOnly</a></div><div class="ttdeci">static bool isWriteOnly(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00846">unix/SysFileSystem.cpp:846</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ad14ef8949d51c2862e2094287776e3e5"><div class="ttname"><a href="class_sys_file_system.html#ad14ef8949d51c2862e2094287776e3e5">SysFileSystem::hasExtension</a></div><div class="ttdeci">static bool hasExtension(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00322">unix/SysFileSystem.cpp:322</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_ad8361dd58cb90aaa686c34f6268f3c15"><div class="ttname"><a href="class_sys_file_system.html#ad8361dd58cb90aaa686c34f6268f3c15">SysFileSystem::EOF_Marker</a></div><div class="ttdeci">static const char EOF_Marker</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00097">unix/SysFileSystem.hpp:97</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_adb998d580812a27c13a6ee316f00cd03"><div class="ttname"><a href="class_sys_file_system.html#adb998d580812a27c13a6ee316f00cd03">SysFileSystem::qualifyStreamName</a></div><div class="ttdeci">static void qualifyStreamName(const char *unqualifiedName, FileNameBuffer &amp;qualifiedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00172">unix/SysFileSystem.cpp:172</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_addecd83d7590310e772d60acf02febe6"><div class="ttname"><a href="class_sys_file_system.html#addecd83d7590310e772d60acf02febe6">SysFileSystem::CarriageReturn</a></div><div class="ttdeci">static const char CarriageReturn</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00101">unix/SysFileSystem.hpp:101</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_adff4f5ceb67103485f03017d3b3b6bde"><div class="ttname"><a href="class_sys_file_system.html#adff4f5ceb67103485f03017d3b3b6bde">SysFileSystem::deleteDirectory</a></div><div class="ttdeci">static int deleteDirectory(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00788">unix/SysFileSystem.cpp:788</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_aed6b850df4e894eaec591627504fb029"><div class="ttname"><a href="class_sys_file_system.html#aed6b850df4e894eaec591627504fb029">SysFileSystem::setFileWritable</a></div><div class="ttdeci">static bool setFileWritable(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01230">unix/SysFileSystem.cpp:1230</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_af2ee5d602a15223c1a49ae774698cc99"><div class="ttname"><a href="class_sys_file_system.html#af2ee5d602a15223c1a49ae774698cc99">SysFileSystem::isHidden</a></div><div class="ttdeci">static bool isHidden(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01100">unix/SysFileSystem.cpp:1100</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_af3f69f5d567b4f828c27283e948cf07d"><div class="ttname"><a href="class_sys_file_system.html#af3f69f5d567b4f828c27283e948cf07d">SysFileSystem::primitiveSearchName</a></div><div class="ttdeci">static bool primitiveSearchName(const char *name, const char *path, const char *extension, FileNameBuffer &amp;resolvedName)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00396">unix/SysFileSystem.cpp:396</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_af43b1d0db44c0a18d0e77135d2eb5b07"><div class="ttname"><a href="class_sys_file_system.html#af43b1d0db44c0a18d0e77135d2eb5b07">SysFileSystem::getRoots</a></div><div class="ttdeci">static int getRoots(FileNameBuffer &amp;roots)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01330">unix/SysFileSystem.cpp:1330</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_af53b0c972ca242b539bf359fc8376ecc"><div class="ttname"><a href="class_sys_file_system.html#af53b0c972ca242b539bf359fc8376ecc">SysFileSystem::isLink</a></div><div class="ttdeci">static bool isLink(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00910">unix/SysFileSystem.cpp:910</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_af7fbd8ec5f7992b7d23c0d11c6dc56b8"><div class="ttname"><a href="class_sys_file_system.html#af7fbd8ec5f7992b7d23c0d11c6dc56b8">SysFileSystem::isReadOnly</a></div><div class="ttdeci">static bool isReadOnly(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00818">unix/SysFileSystem.cpp:818</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_afba1c629bb68f4cfa3206f39343f773d"><div class="ttname"><a href="class_sys_file_system.html#afba1c629bb68f4cfa3206f39343f773d">SysFileSystem::NewLine</a></div><div class="ttdeci">static const char NewLine</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00100">unix/SysFileSystem.hpp:100</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_afd5106b26c6a68d9a01e3ef101665221"><div class="ttname"><a href="class_sys_file_system.html#afd5106b26c6a68d9a01e3ef101665221">SysFileSystem::exists</a></div><div class="ttdeci">static bool exists(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00893">unix/SysFileSystem.cpp:893</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_afdbfc64abd8f4454f11a7eb58dcd8f41"><div class="ttname"><a href="class_sys_file_system.html#afdbfc64abd8f4454f11a7eb58dcd8f41">SysFileSystem::copyFile</a></div><div class="ttdeci">static int copyFile(const char *fromFile, const char *toFile)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01728">unix/SysFileSystem.cpp:1728</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_aff112763947c164692ad49653d124474"><div class="ttname"><a href="class_sys_file_system.html#aff112763947c164692ad49653d124474">SysFileSystem::isFile</a></div><div class="ttdeci">static bool isFile(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00877">unix/SysFileSystem.cpp:877</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_a76c0a3bc6ecf53d054da7a8533a29f96"><div class="ttname"><a href="class_system_interpreter.html#a76c0a3bc6ecf53d054da7a8533a29f96">SystemInterpreter::getEnvironmentVariable</a></div><div class="ttdeci">static bool getEnvironmentVariable(const char *variable, FileNameBuffer &amp;buffer)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_interpreter_8cpp_source.html#l00178">unix/SystemInterpreter.cpp:178</a></div></div>
<div class="ttc" id="aclass_unsafe_block_html"><div class="ttname"><a href="class_unsafe_block.html">UnsafeBlock</a></div><div class="ttdef"><b>Definition:</b> <a href="_activity_manager_8hpp_source.html#l00336">ActivityManager.hpp:337</a></div></div>
<div class="ttc" id="aclass_utilities_html_a48f8b5eee5a201ee55dcd874206189b4"><div class="ttname"><a href="class_utilities.html#a48f8b5eee5a201ee55dcd874206189b4">Utilities::strupper</a></div><div class="ttdeci">static void strupper(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8cpp_source.html#l00141">Utilities.cpp:141</a></div></div>
<div class="ttc" id="aclass_utilities_html_a84b19457dd57d0b2cf3eba8d129765b2"><div class="ttname"><a href="class_utilities.html#a84b19457dd57d0b2cf3eba8d129765b2">Utilities::strlower</a></div><div class="ttdeci">static void strlower(char *str)</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8cpp_source.html#l00160">Utilities.cpp:160</a></div></div>
<div class="ttc" id="acmdparse_8cpp_html_ab3454b1e7e7c4c0b732dfeb74a0c040f"><div class="ttname"><a href="cmdparse_8cpp.html#ab3454b1e7e7c4c0b732dfeb74a0c040f">if</a></div><div class="ttdeci">if(!yymsg) yymsg</div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a1e463e85bad88125b37c28f2cd4231f6"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a1e463e85bad88125b37c28f2cd4231f6">temporaryFilename</a></div><div class="ttdeci">char * temporaryFilename(const char *filename, int &amp;errInfo)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01551">unix/SysFileSystem.cpp:1551</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a229ea589f5b056245f273bc598699b9b"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a229ea589f5b056245f273bc598699b9b">copyFileDontDereferenceSymbolicLinks</a></div><div class="ttdeci">int copyFileDontDereferenceSymbolicLinks(const char *fromFile, const char *toFile, bool force, bool preserveTimestamps, bool preserveMode)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01610">unix/SysFileSystem.cpp:1610</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a4232af97e0837a34645e36f2b432981f"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a4232af97e0837a34645e36f2b432981f">NoTimeStamp</a></div><div class="ttdeci">const int64_t NoTimeStamp</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00080">unix/SysFileSystem.cpp:80</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a42655e857442f171ce6430530625f454"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a42655e857442f171ce6430530625f454">copyFileDereferenceSymbolicLinks</a></div><div class="ttdeci">int copyFileDereferenceSymbolicLinks(const char *fromFile, const char *toFile, bool preserveTimestamps, bool preserveMode)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01467">unix/SysFileSystem.cpp:1467</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a61de47724d2c415732bcbcd69fa71b24"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a61de47724d2c415732bcbcd69fa71b24">localToUtc</a></div><div class="ttdeci">bool localToUtc(int64_t loc, time_t *utc)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00976">unix/SysFileSystem.cpp:976</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a6bcc082569c38f850dbdcf973febd53f"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a6bcc082569c38f850dbdcf973febd53f">StatEpoch</a></div><div class="ttdeci">const int64_t StatEpoch</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00079">unix/SysFileSystem.cpp:79</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_a8f77159ae2de71384402686c8f99264d"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#a8f77159ae2de71384402686c8f99264d">samePaths</a></div><div class="ttdeci">bool samePaths(const char *path1, const char *path2)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01421">unix/SysFileSystem.cpp:1421</a></div></div>
<div class="ttc" id="aunix_2_sys_file_system_8cpp_html_abdc7f00eb3d6ff658cae4b6cfbf6825b"><div class="ttname"><a href="unix_2_sys_file_system_8cpp.html#abdc7f00eb3d6ff658cae4b6cfbf6825b">utcToLocal</a></div><div class="ttdeci">bool utcToLocal(time_t utc, int64_t *loc)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l00927">unix/SysFileSystem.cpp:927</a></div></div>
<div class="ttc" id="awindows_2_sys_file_system_8hpp_html"><div class="ttname"><a href="windows_2_sys_file_system_8hpp.html">SysFileSystem.hpp</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a414156feea104f8f75b4ed9e3121b2f6"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a414156feea104f8f75b4ed9e3121b2f6">int64_t</a></div><div class="ttdeci">signed __int64 int64_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00077">windows/rexxapitypes.h:77</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00078">windows/rexxapitypes.h:78</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_2dfb7423ce64cb60f62cee208bb73ae3.html">official</a></li><li class="navelem"><a class="el" href="dir_63144926d93644d0b571decfac4c5baa.html">main</a></li><li class="navelem"><a class="el" href="dir_5131a42d519b9b019d5264fc1f0fe4ab.html">trunk</a></li><li class="navelem"><a class="el" href="dir_07b471ff108ade29d714c67783960c47.html">interpreter</a></li><li class="navelem"><a class="el" href="dir_4350e6caeaece7d6e66e745c6bce97c5.html">platform</a></li><li class="navelem"><a class="el" href="dir_ee1f4bdc11d4ec0f85183b4256a39b67.html">unix</a></li><li class="navelem"><a class="el" href="unix_2_sys_file_system_8cpp.html">SysFileSystem.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">ooRexx</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
