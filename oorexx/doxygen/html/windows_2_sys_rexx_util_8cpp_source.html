<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ooRexx: SysRexxUtil.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('windows_2_sys_rexx_util_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">windows/SysRexxUtil.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="windows_2_sys_rexx_util_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2024 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* https://www.oorexx.org/license.html                                        */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/* Windows-specific RexxUtil functions                                        */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/**********************************************************************</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*   This program extends the REXX language by providing many          *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*   REXX external functions.                                          *</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*   These functions are:                                              *</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*       SysCls              -- Clear the screen in an OS/2 fullscreen *</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*                              or windowed command prompt session.    *</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*       SysCurPos           -- Set and/or Query the cursor position   *</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*       SysCurState         -- Make the cursor visible or invisible   *</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*       SysDriveInfo        -- Returns information about a specific   *</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*                              drive.                                 *</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*       SysDriveMap         -- Returns a list of the drives on the    *</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*                              machine                                *</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*       SysGetKey           -- Returns one by of data indicating the  *</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*                              key which was pressed,                 *</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*                              in a command prompt session            *</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*       SysIni              -- Reads and/or updates entries in .INI   *</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*                              files.                                 *</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*       SysMkDir            -- Creates a directory                    *</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*       SysWinVer           -- Returns the Win OS and Version number  *</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*       SysVersion          -- Returns the OS and Version number      *</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*       SysTextScreenRead   -- Reads characters from the screen,      *</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*                              in a command prompt session            *</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*       SysTextScreenSize   -- Returns the size of the window in      *</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*                              rows and columns, in a                 *</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*       SysWaitNamedPipe    -- Wait on a named pipe.                  *</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*       SysBootDrive        -- Return the windows boot drive          *</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*       SysSystemDirectory  -- Return the Windows system directory    *</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*       SysFileSystemType   -- Return drive file system type          *</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*       SysVolumeLabel      -- Return the drive label                 *</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*       SysCreateMutexSem   -- Create a Mutex semaphore               *</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*       SysOpenMutexSem     -- Open a Mutex semaphore                 *</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*       SysCloseMutexSem    -- Close a Mutex semaphore                *</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*       SysRequestMutexSem  -- Request a Mutex semaphore              *</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*       SysReleaseMutexSem  -- Release a Mutex semaphore              *</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*       SysCreateEventSem   -- Create an Event semaphore              *</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*       SysOpenEventSem     -- Open an Event semaphore                *</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*       SysCloseEventSem    -- Close an Event semaphore               *</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*       SysPostEventSem     -- Post an Event semaphore                *</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*       SysPulseEventSem    -- Post and reset an Event semaphore      *</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*       SysResetEventSem    -- Reset an Event semaphore               *</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*       SysWaitEventSem     -- Wait on an Event semaphore             *</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*       SysProcessType      -- Return type of process                 *</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*       SysSetPriority      -- Set current thread priority            *</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*       SysShutDownSystem   -- Shutdown the system                    *</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*       SysSwitchSession    -- Switch to a named session              *</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*       SysQueryProcess     -- Get information on current proc/thread *</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*       SysSetFileDateTime  -- Set the last modified date of a file   *</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*       SysGetFileDateTime  -- Get the last modified date of a file   *</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*       SysUtilVersion      -- query version of REXXUTIL.DLL          *</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*       SysWinFileEncrypt   -- Encrypt file on a W2K-NTFS             *</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*       SysWinFileDecrypt   -- Decrypt file on a W2K-NTFS             *</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*       SysGetErrorText     -- Retrieve textual desc. of error number *</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">*       SysWinGetDefaultPrinter -- retrieve default printer           *</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">*       SysWinGetPrinters   -- Obtain list of local printers          *</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">*       SysWinSetDefaultPrinter -- set the local default printer      *</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*       SysIsFileCompressed   -- Check for a file to be compressed    *</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">*       SysIsFileEncrypted    -- Check for a file to be encrypted     *</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">*       SysIsFileNotContentIndexed -- Check if a file should be indexed *</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">*       SysIsFileOffline    -- Check if a file is offline             *</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">*       SysIsFileSparse     -- Check if a file is sparse              *</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*       SysIsFileTemporary  -- Check if a file is temporary           *</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">**********************************************************************/</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oorexxapi_8h.html">oorexxapi.h</a>&quot;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#include &lt;memory.h&gt;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#include &lt;conio.h&gt;</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// min()</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#include &lt;shlwapi.h&gt;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#include &lt;versionhelpers.h&gt;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="windows_2_sys_file_system_8hpp.html">SysFileSystem.hpp</a>&quot;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_util_common_8hpp.html">RexxUtilCommon.hpp</a>&quot;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_file_name_buffer_8hpp.html">FileNameBuffer.hpp</a>&quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_utilities_8hpp.html">Utilities.hpp</a>&quot;</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/* Saved character status                                            */</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">  137</a></span>&#160;<span class="keyword">static</span>   <span class="keywordtype">int</span>   <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = 0;       <span class="comment">/* extended character saved   */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a9ea4a6e038359484e4f837e13931235b">  138</a></span>&#160;<span class="keyword">static</span>   <span class="keywordtype">char</span>  <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a>;           <span class="comment">/* saved extended character   */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/**********************************************************************</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">* Function:  SysCls                                                   *</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">* Syntax:    call SysCls                                              *</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">* Return:    0 on success, else Windows error code                    *</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">**********************************************************************/</span></div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">  148</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">RexxRoutine0</a>(<span class="keywordtype">int</span>, SysCls)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;{</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    DWORD dummy;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    COORD home = { 0, 0 };           <span class="comment">// console home coordinates</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbi; <span class="comment">// console information</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    HANDLE h = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// fill console buffer with spaces, reset attributes, and set cursor home</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      GetConsoleScreenBufferInfo(h, &amp;csbi) &amp;&amp;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      FillConsoleOutputCharacter(h, <span class="charliteral">&#39; &#39;</span>, csbi.dwSize.X * csbi.dwSize.Y, home, &amp;dummy) &amp;&amp;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      FillConsoleOutputAttribute(h, csbi.wAttributes, csbi.dwSize.X * csbi.dwSize.Y, home, &amp;dummy) &amp;&amp;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      SetConsoleCursorPosition(h, home)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">* Function:  SysCurPos - positions cursor in DOS window                  *</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">* Syntax:    call SysCurPos [row, col]                                   *</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">* Params:    row   - row to place cursor on                              *</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">*            col   - column to place cursor on                           *</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">* Return:    row, col                                                    *</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">  177</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysCurPos, OPTIONAL_stringsize_t, inrow, OPTIONAL_stringsize_t, incol)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbiInfo; <span class="comment">/* Console information        */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(1) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2)) || (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(1)))</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">/* get handle to stdout       */</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">/* get current position, and  */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">/* continue only if in        */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">/* character mode             */</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo))</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%d %d&quot;</span>, csbiInfo.dwCursorPosition.Y, csbiInfo.dwCursorPosition.X);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2))</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            COORD newHome;                       <span class="comment">/* Position to move cursor    */</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            newHome.Y = (short)inrow;      <span class="comment">/* convert to short form      */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            newHome.X = (short)incol;      <span class="comment">/* convert to short form      */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="comment">/* Set the cursor position    */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            SetConsoleCursorPosition(hStdout, newHome);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(buffer);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">* Function:  SysCurState                                                 *</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">* Syntax:    call SysCurState state                                      *</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">* Params:    state - Either &#39;ON&#39; or &#39;OFF&#39;.                               *</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR - Successful.                                 *</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">  224</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysCurState, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, option)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    CONSOLE_CURSOR_INFO CursorInfo;      <span class="comment">/* info about cursor          */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">/* get handle to stdout       */</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">/* Get the cursor info        */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    GetConsoleCursorInfo(hStdout, &amp;CursorInfo);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">/* Get state and validate     */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;ON&quot;</span>) == 0)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        CursorInfo.bVisible = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;OFF&quot;</span>) == 0)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        CursorInfo.bVisible = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="stringliteral">&quot;SysCurState&quot;</span>, <span class="stringliteral">&quot;option&quot;</span>, <span class="stringliteral">&quot;&#39;ON&#39; or &#39;OFF&#39;&quot;</span>, option);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">/* Set the cursor info        */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    SetConsoleCursorInfo(hStdout, &amp;CursorInfo);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> 0;                            <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">* Function:  SysDriveInfo - returns total number of free bytes,          *</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">*                           total number of bytes, and                   *</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">*                           volume label                                 *</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">* Syntax:    result = SysDriveInfo([drive])                              *</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">* Params:    drive - d, d:, d:\, \\share\path                            *</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">*                    if omitted, defaults to current drive               *</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">* Return:    result - drive free total label                             *</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">*                     null string for any error                          *</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a61b67c0a8b93cc88f872c5393579152c">  265</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysDriveInfo, OPTIONAL_CSTRING, drive)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> d;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (drive == NULL)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// Although the Windows APIs interpret NULL as the current drive,</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// we still need to figure out the actual current drive as we are</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// expected to return it as the first word.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        GetCurrentDirectory((DWORD)d.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>(), (LPTSTR)d);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">if</span> (d.length() &gt;= 3 &amp;&amp; d.at(1) == <span class="charliteral">&#39;:&#39;</span> &amp;&amp; d.at(2) == <span class="charliteral">&#39;\\&#39;</span>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">// current directory is a standard d:\path, just keep the d:\ part</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            d.truncate(3);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d.startsWith(<span class="stringliteral">&quot;\\\\&quot;</span>))</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="comment">// current directory is a UNC path, just keep the \\share\path\ part</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            d.truncate(d.locatePathDelimiter(d.locatePathDelimiter(2) + 1));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        d = drive;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">// We just let the Windows APIs handle all the different ways to</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">// specify a volume, like d:\, \\?\d:, \\localhost\path, etc.  But</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">// on top of that we support a single-character drive d.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() == 1 &amp;&amp; <a class="code" href="class_utilities.html#a470770b40ea8bf748ee9a28ec4361852">Utilities::isAlpha</a>(d.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(0)))</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">// make this a valid drive specification</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            d += <span class="stringliteral">&quot;:\\&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// GetVolumeInformation() is picky, it requires a final backslash</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() &gt; 0)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        d.<a class="code" href="class_file_name_buffer.html#ad5f40320218a98a58bd54e54f78dc609">addFinalPathDelimiter</a>();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// get the volume label, then the total bytes and total free bytes</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordtype">char</span> volume[MAX_PATH];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> total, free;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (GetVolumeInformation((<span class="keywordtype">char</span> * )d, volume, (DWORD)<span class="keyword">sizeof</span>(volume), NULL, NULL, NULL, NULL, 0) &amp;&amp;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        GetDiskFreeSpaceEx(d, NULL, (PULARGE_INTEGER)&amp;total, (PULARGE_INTEGER)&amp;free))</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">// we remove any trailing backslash for our return string</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() &gt; 1 &amp;&amp; d.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="stringliteral">&quot;\\&quot;</span>))</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            d.<a class="code" href="class_file_name_buffer.html#a0a3478046331fad9da2545fef68ee0f2">truncate</a>(d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() - 1);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// return drive free total label</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordtype">char</span> retstr[256];</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        snprintf(retstr, <span class="keyword">sizeof</span>(retstr), <span class="stringliteral">&quot;%s %I64u %I64u %s&quot;</span>, (<span class="keywordtype">char</span> *)d, free, total, volume);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">return</span> context-&gt;String(retstr);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">/*  Defines used by SysDriveMap                                      */</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">  330</a></span>&#160;<span class="preprocessor">#define  USED           0</span></div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">  331</a></span>&#160;<span class="preprocessor">#define  FREE           1</span></div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">  332</a></span>&#160;<span class="preprocessor">#define  SPECIFIC       3</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">* Function:  SysDriveMap                                                 *</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">* Syntax:    call SysDriveMap [drive] [,mode]                            *</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">* Params:    drive - &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, etc.  The drive to start the search  *</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">*                     with.                                              *</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">*            mode  - Any of the following:  &#39;FREE&#39;, &#39;USED&#39;, &#39;DETACHED&#39;,  *</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">*                                           &#39;LOCAL&#39;, &#39;REMOTE&#39;            *</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">* Return:    &#39;A: B: C: D: ...&#39;                                           *</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a43d0d0acf3c6a9b5001aa9b93e15c997">  348</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysDriveMap, OPTIONAL_CSTRING, drive, OPTIONAL_CSTRING, mode)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    ULONG selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a>;             <span class="comment">// Query mode USED, FREE,</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    ULONG driveType = DRIVE_UNKNOWN;     <span class="comment">// checking for a particular type of drive</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    ULONG ordinal = 0;                   <span class="comment">// Ordinal of entry in name list required</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">char</span>     temp[MAX_PATH];             <span class="comment">// Entire drive map built here</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    temp[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">/* check starting drive letter*/</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    ULONG start = 3;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">if</span> (drive != NULL)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordtype">size_t</span> driveLength = strlen(drive);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">if</span> (driveLength == 0 || driveLength &gt; 2 || (driveLength == 2 &amp;&amp; drive[1] != <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            context-&gt;ThrowException1(<a class="code" href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a>, context-&gt;String(<span class="stringliteral">&quot;Invalid drive specification&quot;</span>));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="comment">// make sure this is in range</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        start = <a class="code" href="class_utilities.html#a0b91888c4169ea518a78ba9de5393c7e">Utilities::toUpper</a>(drive[0]) - <span class="charliteral">&#39;A&#39;</span> + 1;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (start &lt; 1 || start &gt; 26)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            context-&gt;ThrowException1(<a class="code" href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a>, context-&gt;String(<span class="stringliteral">&quot;Invalid drive specification&quot;</span>));</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">/* check the mode             */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">if</span> (mode != NULL)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;FREE&quot;</span>))</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">FREE</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;USED&quot;</span>))</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;RAMDISK&quot;</span>))</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">SPECIFIC</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            driveType = DRIVE_RAMDISK;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;REMOTE&quot;</span>))</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">SPECIFIC</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            driveType = DRIVE_REMOTE;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// local drives are really fixed ones</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;LOCAL&quot;</span>))</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">SPECIFIC</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            driveType = DRIVE_FIXED;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;REMOVABLE&quot;</span>))</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">SPECIFIC</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            driveType = DRIVE_REMOVABLE;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(mode, <span class="stringliteral">&quot;CDROM&quot;</span>))</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            selectMode = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">SPECIFIC</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            driveType = DRIVE_CDROM;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            context-&gt;ThrowException1(<a class="code" href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a>, context-&gt;String(<span class="stringliteral">&quot;Invalid drive type&quot;</span>));</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/* perform the query          */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    DWORD driveMap = GetLogicalDrives();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    driveMap &gt;&gt;= start - 1;              <span class="comment">// Shift to the first drive</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> driveMapBuffer;       <span class="comment">// the map is built here</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">char</span> driveStr[8];                    <span class="comment">// just enough space to format a drive specifier</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">for</span> (ULONG dnum = start; dnum &lt;= 26; dnum++)</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="comment">// Hey, we have a free drive</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keywordflow">if</span> (!(driveMap &amp; (DWORD)1))</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="comment">// is this what we&#39;re looking for?</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">if</span> (selectMode == <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">FREE</a>)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                snprintf(driveStr, <span class="keyword">sizeof</span>(driveStr), <span class="stringliteral">&quot;%c: &quot;</span>, dnum + <span class="charliteral">&#39;A&#39;</span> - 1);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                driveMapBuffer += driveStr;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">/* Hey, we have a used drive  */</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((driveMap &amp; (DWORD)1))</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="comment">// format in advance in case we need to add this</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            snprintf(driveStr, <span class="keyword">sizeof</span>(driveStr), <span class="stringliteral">&quot;%c: &quot;</span>, dnum + <span class="charliteral">&#39;A&#39;</span> - 1);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="comment">// if we only want to know the used ones, we have all the</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            <span class="comment">// information we need</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">if</span> (selectMode == <a class="code" href="windows_2_sys_rexx_util_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a>)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                driveMapBuffer += driveStr;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="comment">// need to check specific drive information</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordtype">char</span> deviceName[8];</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                snprintf(deviceName, <span class="keyword">sizeof</span>(deviceName), <span class="stringliteral">&quot;%c:\\&quot;</span>, dnum + <span class="charliteral">&#39;A&#39;</span> - 1);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="comment">// if this matches what we&#39;re looking for, add it to the list</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="keywordflow">if</span> (driveType == GetDriveType(deviceName))</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    driveMapBuffer += driveStr;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="comment">// shift to the next drive</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        driveMap &gt;&gt;= 1;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">size_t</span> driveLength = driveMapBuffer.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// if we are returning anything, then remove the last blank</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (driveLength &gt; 0)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        driveLength--;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewString(driveMapBuffer, driveLength);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">// below are Windows-specific implementations of TreeFinder methods.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment"> * if this ends in a directory separator, add a * wildcard to the end</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_tree_finder.html#a6b9cb316539b42b36237028eb8204951">TreeFinder::adjustDirectory</a>()</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;{</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// if this ends in a directory separator, add a * wildcard to the end</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="charliteral">&#39;\\&#39;</span>) || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="charliteral">&#39;/&#39;</span>))</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a> += <span class="stringliteral">&quot;*&quot;</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// just a . or .. is wildcarded also</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a> == <span class="stringliteral">&quot;.&quot;</span> || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a> == <span class="stringliteral">&quot;..&quot;</span>)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a> += <span class="stringliteral">&quot;\\*&quot;</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// if the end section is either \. or \.., we also add the wildcard</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="stringliteral">&quot;\\.&quot;</span>) || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="stringliteral">&quot;\\..&quot;</span>)  || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="stringliteral">&quot;/.&quot;</span>) || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">endsWith</a>(<span class="stringliteral">&quot;/..&quot;</span>))</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a> += <span class="stringliteral">&quot;\\*&quot;</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"> * Perform any platform-specific adjustments to the platform specification.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_tree_finder.html#a3739e861f7c64301134ca49ba5869d2b">TreeFinder::adjustFileSpec</a>()</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;{</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// Skip leading blanks.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i) == <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        i++;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// did we have leading spaces? There&#39;s some adjustment required.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">// we only remove the spaces if this starts with a drive or directory</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">// specification, otherwise the blanks are considered part of the name.</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordtype">size_t</span> len = <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>();</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">// now check the special cases. First, we start with</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">// a directory marker</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i) == <span class="charliteral">&#39;\\&#39;</span> || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i) == <span class="charliteral">&#39;/&#39;</span>)                         <span class="comment">// The &quot;\&quot; case</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="comment">// perform a left shift on the buffer</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a98c120488abe0a197452c74798336b92">shiftLeft</a>(i);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">// starts with &quot;.&quot; (or potentially &quot;..&quot;)</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i) == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="comment">// if this is not at the end, look for &quot;.\&quot; or &quot;..\&quot;</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">if</span> (i + 1 &lt; len)</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i + 1) == <span class="charliteral">&#39;\\&#39;</span> || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i + 1) == <span class="charliteral">&#39;/&#39;</span>)         <span class="comment">// The &quot;.\&quot; case</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <span class="comment">// perform a left shift on the buffer</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a98c120488abe0a197452c74798336b92">shiftLeft</a>(i);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i + 2 &lt; len)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i + 1) == <span class="charliteral">&#39;.&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                        (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i + 2) == <span class="charliteral">&#39;\\&#39;</span> || <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i + 2) == <span class="charliteral">&#39;/&#39;</span>))   <span class="comment">// The &quot;..\&quot; case</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                        <span class="comment">// perform a left shift on the buffer</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a98c120488abe0a197452c74798336b92">shiftLeft</a>(i);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i + 1 &lt; len &amp;&amp; <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(i + 1) == <span class="charliteral">&#39;:&#39;</span>)                     <span class="comment">// The &quot;z:&#39; case</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="comment">// perform a left shift on the buffer</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a98c120488abe0a197452c74798336b92">shiftLeft</a>(i);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"> * Tests for illegal file name characters in fileSpec</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment"> * @note  Double quotes in the file spec is not valid, spaces in file names do</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"> *        not need to be within quotes in the string passed to the Windows API.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"> *        A &#39;:&#39; is only valid if it is the second character. Technically a &#39;*&#39;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment"> *        and a &#39;?&#39; are not valid characters for a file name, but they are okay</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment"> *        for fSpec. Same thing for &#39;\&#39; and &#39;/&#39;, they are not valid in a file</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment"> *        name, but they are valid in fSpec. A &#39;/&#39; is iffy. The Windows API</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment"> *        accepts &#39;/&#39; as a directory separator, but most Rexx programmers</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"> *        probably don&#39;t know that.  Not sure if we should flag that as illegal</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> *        or not.</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_tree_finder.html#a6770f8b247bb95dbc230bb4fd8d18751">TreeFinder::validateFileSpecName</a>()</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;{</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> illegal[] = <span class="stringliteral">&quot;&lt;&gt;|\&quot;&quot;</span>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; strlen(illegal); i++)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">if</span> (strchr((<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>, illegal[i]) != NULL)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_tree_finder.html#a424a025278e4f4b08972a7455f9f5203a0010a17acfe2928791fc8d7b4d2f82d5">InvalidFileName</a>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *pos = strchr((<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">if</span> (pos != NULL)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">// c:\temp, \\?\c:\temp, \\.\c:\temp are all valid</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> p = (<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>)(pos - <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a> + 1);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">if</span> (p != 2 &amp;&amp; p != 6)</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_tree_finder.html#a424a025278e4f4b08972a7455f9f5203a0010a17acfe2928791fc8d7b4d2f82d5">InvalidFileName</a>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (strchr(pos + 1, <span class="charliteral">&#39;:&#39;</span>) != NULL)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="class_tree_finder.html#a424a025278e4f4b08972a7455f9f5203a0010a17acfe2928791fc8d7b4d2f82d5">InvalidFileName</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment"> * Returns a new file attribute value given a mask of attributes to be changed</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment"> * and the current attribute value.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"> * @return New attribute value.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a228743a67cab870158881f92e3005581">  610</a></span>&#160;<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a228743a67cab870158881f92e3005581">mergeAttrs</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html">TreeFinder::AttributeMask</a> &amp;mask, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> attr)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;{</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// if no settings to process, return the old set</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#a6d86fb819cef6e72f48ed93802261105">noNewSettings</a>())</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">return</span> attr;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#a5fb87e1522bab173290d30788ec40ac2">isOff</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a645b95e0883f9124168906e481084a5a">TreeFinder::AttributeMask::Archive</a>))</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_ARCHIVE;   <span class="comment">// Clear</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#ae4ef2869106158f1586f8c608a8f8307">isOn</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a645b95e0883f9124168906e481084a5a">TreeFinder::AttributeMask::Archive</a>))</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        attr |= FILE_ATTRIBUTE_ARCHIVE;    <span class="comment">// Set</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// we can&#39;t really turn the directory bit on or off, so leave</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="comment">// this unchanged.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#a5fb87e1522bab173290d30788ec40ac2">isOff</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a3b01f776ecb416760a0ea5fdd8dee1c5">TreeFinder::AttributeMask::Hidden</a>))</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_HIDDEN; <span class="comment">// Clear</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#ae4ef2869106158f1586f8c608a8f8307">isOn</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a3b01f776ecb416760a0ea5fdd8dee1c5">TreeFinder::AttributeMask::Hidden</a>))</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        attr |= FILE_ATTRIBUTE_HIDDEN;  <span class="comment">// Set</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#a5fb87e1522bab173290d30788ec40ac2">isOff</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400aa794ef89c775f3c46af6528083f534db">TreeFinder::AttributeMask::ReadOnly</a>))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_READONLY; <span class="comment">// Clear</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#ae4ef2869106158f1586f8c608a8f8307">isOn</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400aa794ef89c775f3c46af6528083f534db">TreeFinder::AttributeMask::ReadOnly</a>))</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        attr |= FILE_ATTRIBUTE_READONLY;  <span class="comment">// Set</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#a5fb87e1522bab173290d30788ec40ac2">isOff</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a203c715a94b079b916fa4103dddddcd3">TreeFinder::AttributeMask::System</a>))</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_SYSTEM; <span class="comment">// Clear</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mask.<a class="code" href="class_tree_finder_1_1_attribute_mask.html#ae4ef2869106158f1586f8c608a8f8307">isOn</a>(<a class="code" href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a203c715a94b079b916fa4103dddddcd3">TreeFinder::AttributeMask::System</a>))</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        attr |= FILE_ATTRIBUTE_SYSTEM;  <span class="comment">// Set</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">return</span>  attr;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"> * Set the file attributes using the new mask and then return the</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"> * new current attribute set for the file.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"> * @param fileName The target file name</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> * @return A new attribute mask for the file.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a14d3f42723fede816efe6de7e9d67ab9">  666</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a14d3f42723fede816efe6de7e9d67ab9">setFileAttributes</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fileName, <a class="code" href="class_tree_finder_1_1_attribute_mask.html">TreeFinder::AttributeMask</a> &amp;newAttributes)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;{</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// The file attributes need to be changed before we format the found file</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="comment">// line.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> oldAttrs = GetFileAttributes(fileName);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="comment">// create a merged set of attributes</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> changedAttrs = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a228743a67cab870158881f92e3005581">mergeAttrs</a>(newAttributes, oldAttrs);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// if they are not the same, then we need to try to set them</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (changedAttrs != oldAttrs)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="comment">// try to set the attributes, but if it fails, just use the exsiting.</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// the directory flag is not settable, so make sure this flag is off</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        SetFileAttributes(fileName, changedAttrs &amp; ~FILE_ATTRIBUTE_DIRECTORY);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment"> * Format the system-specific file time, attribute mask, and size for</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment"> * the given file.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment"> * @param foundFile The buffer the result is formatted into</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment"> * @param finfo     The system information about the file.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a35ddb30498f1f07b699af69a5b42ce9d">  693</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a35ddb30498f1f07b699af69a5b42ce9d">formatFileAttributes</a>(<a class="code" href="class_tree_finder.html">TreeFinder</a> *finder, <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> &amp;foundFile, <a class="code" href="class_sys_file_iterator_1_1_file_attributes.html">SysFileIterator::FileAttributes</a> &amp;attributes)</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;{</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">char</span> fileAttr[256];                 <span class="comment">// File attribute string of found file</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    FILETIME lastWriteTime;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    FileTimeToLocalFileTime(&amp;attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.ftLastWriteTime, &amp;lastWriteTime);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">// Convert UTC to local file time, and then to system format.</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    SYSTEMTIME systime;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    FileTimeToSystemTime(&amp;lastWriteTime, &amp;systime);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// The fileTime buffer is 64 bytes.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// Since we can count the characters put into the buffer here, there is</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">// no need to check for buffer overflow.</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// wYear range is 1601 through 30827</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">if</span> (finder-&gt;<a class="code" href="class_tree_finder.html#afbce0a441b278520d2c2843f64ae289e">longTime</a>())</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        snprintf(fileAttr, <span class="keyword">sizeof</span>(fileAttr), <span class="stringliteral">&quot;%4d-%02d-%02d %02d:%02d:%02d  &quot;</span>,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                 systime.wYear, systime.wMonth, systime.wDay, systime.wHour, systime.wMinute,</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                 systime.wSecond);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (finder-&gt;<a class="code" href="class_tree_finder.html#a4d9cf8dc1c33049c938cdaefdd98db67">editableTime</a>())</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        snprintf(fileAttr, <span class="keyword">sizeof</span>(fileAttr), <span class="stringliteral">&quot;%02d/%02d/%02d/%02d/%02d  &quot;</span>,</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                 systime.wYear % 100, systime.wMonth, systime.wDay,</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                 systime.wHour, systime.wMinute);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        snprintf(fileAttr, <span class="keyword">sizeof</span>(fileAttr), <span class="stringliteral">&quot;%2d/%02d/%02d  %2d:%02d%c  &quot;</span>,</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                 systime.wMonth, systime.wDay, systime.wYear % 100,</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                 (systime.wHour &lt; 13 &amp;&amp; systime.wHour != 0 ?</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                  systime.wHour : (abs(systime.wHour - (SHORT)12))),</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                 systime.wMinute, (systime.wHour &lt; 12 || systime.wHour == 24) ? <span class="charliteral">&#39;a&#39;</span> : <span class="charliteral">&#39;p&#39;</span>);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// this is the first part of the return value. Copy to the result buffer so we can</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// reuse the buffer</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    foundFile = fileAttr;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a> longFileSize = attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.nFileSizeHigh;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    longFileSize &lt;&lt;= 32;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    longFileSize |= attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.nFileSizeLow;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">// now the size information</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="keywordflow">if</span> (finder-&gt;<a class="code" href="class_tree_finder.html#a2ce515910cf14af9f08937e0468fbfdb">longSize</a>())</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        snprintf(fileAttr, <span class="keyword">sizeof</span>(fileAttr), <span class="stringliteral">&quot;%20llu  &quot;</span>, longFileSize);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <span class="keywordflow">if</span> (longFileSize &gt; 9999999999)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            longFileSize = 9999999999;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        snprintf(fileAttr, <span class="keyword">sizeof</span>(fileAttr), <span class="stringliteral">&quot;%10llu  &quot;</span>, longFileSize);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">// the order is time, size, attributes</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    foundFile += fileAttr;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    snprintf(fileAttr, <span class="keyword">sizeof</span>(fileAttr), <span class="stringliteral">&quot;%c%c%c%c%c  &quot;</span>,</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;             (attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.dwFileAttributes &amp; FILE_ATTRIBUTE_ARCHIVE) ? <span class="charliteral">&#39;A&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;             (attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY) ? <span class="charliteral">&#39;D&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;             (attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.dwFileAttributes &amp; FILE_ATTRIBUTE_HIDDEN) ? <span class="charliteral">&#39;H&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;             (attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.dwFileAttributes &amp; FILE_ATTRIBUTE_READONLY) ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;             (attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.dwFileAttributes &amp; FILE_ATTRIBUTE_SYSTEM) ? <span class="charliteral">&#39;S&#39;</span> : <span class="charliteral">&#39;-&#39;</span>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// add on this section</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    foundFile += fileAttr;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"> * SysFileTree helper routine to see if this is a file we need to include</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"> * in the result set.</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"> * @param attr   The file attributes</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"> * @return true if the file should be included, false otherwise.</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a51e5ad9fc6f1e2d4c667198539e0186c">  776</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a51e5ad9fc6f1e2d4c667198539e0186c">checkInclusion</a>(<a class="code" href="class_tree_finder.html">TreeFinder</a> *finder, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> attr)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;{</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// if this is a directory and we&#39;re not looking for dirs, this is a pass</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> ((attr &amp; FILE_ATTRIBUTE_DIRECTORY) &amp;&amp; !finder-&gt;<a class="code" href="class_tree_finder.html#ac6aa592c6bba3d74614e5e112e8339a1">includeDirs</a>())</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">// file is not a DIR and we&#39;re only looking for directories</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">if</span> (!(attr &amp; FILE_ATTRIBUTE_DIRECTORY) &amp;&amp; !finder-&gt;<a class="code" href="class_tree_finder.html#a725d60133dcfbecc9becd0d5dbd73386">includeFiles</a>())</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// we&#39;ve passed the file type checks, now see if we have attribute checks to make</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="comment">// if no mask is set, then everything is good</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (finder-&gt;<a class="code" href="class_tree_finder.html#a8b707e007537293ae45be54a8559f766">acceptAll</a>())</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (!finder-&gt;<a class="code" href="class_tree_finder.html#a628d2c9340b4a0942353c2dbb4669560">archiveSelected</a>((attr &amp; FILE_ATTRIBUTE_ARCHIVE) != 0))</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">// a little silly since this overlaps with the options</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> (!finder-&gt;<a class="code" href="class_tree_finder.html#a2abdc2f7811853ccad04b5f356eb343a">directorySelected</a>((attr &amp; FILE_ATTRIBUTE_DIRECTORY) != 0))</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (!finder-&gt;<a class="code" href="class_tree_finder.html#a0fd27652d12f3873955be7d2b48bf50a">hiddenSelected</a>((attr &amp; FILE_ATTRIBUTE_HIDDEN) != 0))</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> (!finder-&gt;<a class="code" href="class_tree_finder.html#a57cfdf98dbb05410b3b63a71dce0d973">readOnlySelected</a>((attr &amp; FILE_ATTRIBUTE_READONLY) != 0))</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">if</span> (!finder-&gt;<a class="code" href="class_tree_finder.html#af7785d090b13f09a44a98f0310ce576e">systemSelected</a>((attr &amp; FILE_ATTRIBUTE_SYSTEM) != 0))</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">return</span>  <span class="keyword">true</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;}</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> * Checks if this file should be part of the included result and adds it to the result set</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> * if it should be returned.</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_tree_finder.html#ad89d28086b2df157d93f798864eb47c5">TreeFinder::checkFile</a>(<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html">SysFileIterator::FileAttributes</a> &amp;attributes)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;{</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="comment">// check to see if this one should be included. If not, we just return without doing anythign</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a51e5ad9fc6f1e2d4c667198539e0186c">checkInclusion</a>(<span class="keyword">this</span>, attributes.<a class="code" href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">findFileData</a>.dwFileAttributes))</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="comment">// handle setting of the new file attributes, if supported</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a14d3f42723fede816efe6de7e9d67ab9">setFileAttributes</a>(<a class="code" href="class_tree_finder.html#a22df053b3af4a130eaddc8244dc5ceba">foundFile</a>, <a class="code" href="class_tree_finder.html#a74b967bebf1eed8c78641c5b06ab1117">newAttributes</a>);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// if only the name is requested, create a string object and set the</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="comment">// stem varaiable</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#a43d0063ee437cb87acaa3fea2cdc31a6">nameOnly</a>())</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <a class="code" href="class_tree_finder.html#a63157a8d75348d96b33c9082cded22f6">addResult</a>(<a class="code" href="class_tree_finder.html#a22df053b3af4a130eaddc8244dc5ceba">foundFile</a>);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// format all of the attributes and add them to the foundFile result</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a35ddb30498f1f07b699af69a5b42ce9d">formatFileAttributes</a>(<span class="keyword">this</span>, <a class="code" href="class_tree_finder.html#ad888865ea347ad955c445e1159b7a4da">foundFileLine</a>, attributes);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// and finally add on the file name</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="class_tree_finder.html#ad888865ea347ad955c445e1159b7a4da">foundFileLine</a> += <a class="code" href="class_tree_finder.html#a22df053b3af4a130eaddc8244dc5ceba">foundFile</a>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// add this to the stem</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="class_tree_finder.html#a63157a8d75348d96b33c9082cded22f6">addResult</a>(<a class="code" href="class_tree_finder.html#ad888865ea347ad955c445e1159b7a4da">foundFileLine</a>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;}</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment"> * Platform-specific TreeFinder method for locating the end of the</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment"> * fileSpec directory</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment"> * @return The position of the end of the directory. -1 indicates the file spec</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment"> *         does not contain a directory.</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_tree_finder.html#a249125a457591ca48c4e74854545799d">TreeFinder::findDirectoryEnd</a>()</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;{</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// Get the maximum position of the last &#39;\&#39;</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">int</span> lastSlashPos = (int)<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Step back through fileSpec until at its beginning or at a &#39;\&#39; or &#39;/&#39; character</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(lastSlashPos) != <span class="charliteral">&#39;\\&#39;</span> &amp;&amp; <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(lastSlashPos) != <span class="charliteral">&#39;/&#39;</span> &amp;&amp; lastSlashPos &gt;= 0)</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        --lastSlashPos;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> lastSlashPos;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment"> * Perform platform-specific drive checks on the file spec. This only</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment"> * applies to Windows.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment"> * @return true if this was processed, false if additional work is required.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_tree_finder.html#ad22d76aa47d89fb73cb4e72306fc1dc0">TreeFinder::checkNonPathDrive</a>()</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;{</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">// fileSpec could be a drive designator.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(1) == <span class="charliteral">&#39;:&#39;</span>)</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="class_routine_file_name_buffer.html">RoutineFileNameBuffer</a> currentDirectory(<a class="code" href="class_tree_finder.html#aa0b1a5653c7e67d10dcb5ff3c07c6317">context</a>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <a class="code" href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">SysFileSystem::getCurrentDirectory</a>(currentDirectory);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordtype">char</span> drive[4] = { 0 };</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="comment">// Just copy the drive letter and the colon, omit the rest.  This is</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="comment">// necessary e.g. for something like &quot;I:*&quot;</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        memcpy(drive, <a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>, 2);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="comment">// Change to the specified drive, get the current directory, then go</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="comment">// back to where we came from.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <a class="code" href="class_sys_file_system.html#a027006c7cde375f689293a47d19dc987">SysFileSystem::setCurrentDirectory</a>(drive);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <a class="code" href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">SysFileSystem::getCurrentDirectory</a>(<a class="code" href="class_tree_finder.html#a167c891316fbc292d7e6f26105aa13b5">filePath</a>);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <a class="code" href="class_sys_file_system.html#a027006c7cde375f689293a47d19dc987">SysFileSystem::setCurrentDirectory</a>(currentDirectory);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="comment">// everything after the drive delimiter is the search name.</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <a class="code" href="class_tree_finder.html#a2175a12961ace1d95854fe53f8949491">nameSpec</a> = ((<span class="keyword">const</span> <span class="keywordtype">char</span> *)<a class="code" href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">fileSpec</a>) + 2;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">// not a drive, this will need to be prepended by the current directory</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;}</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment"> * Perform any platform-specific fixup that might be required with</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment"> * the supplied path.</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_tree_finder.html#ae868be5e940be0bf3f17477d46a02fff">TreeFinder::fixupFilePath</a>()</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;{</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">// resolve any relative postions using _fullpath(), which really saves us</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">// a lot of work;</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *p = _fullpath(NULL, <a class="code" href="class_tree_finder.html#a167c891316fbc292d7e6f26105aa13b5">filePath</a>, 0);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">// this replaces what we currently have</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// but if we get a zero back, this is somehow invalid, keep the</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// existing path and try to use that</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordflow">if</span> (strlen(p) &gt; 0)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <a class="code" href="class_tree_finder.html#a167c891316fbc292d7e6f26105aa13b5">filePath</a> = p;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    free((<span class="keywordtype">void</span> *)p);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// make sure this is terminated with a path delimiter</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    <a class="code" href="class_tree_finder.html#a167c891316fbc292d7e6f26105aa13b5">filePath</a>.<a class="code" href="class_file_name_buffer.html#ad5f40320218a98a58bd54e54f78dc609">addFinalPathDelimiter</a>();</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;}</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">* Function:  SysGetKey                                                   *</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">* Syntax:    call SysGetKey [echo]                                       *</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">* Params:    echo - Either of the following:                             *</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">*                    &#39;ECHO&#39;   - Echo the inputted key (default).         *</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">*                    &#39;NOECHO&#39; - Do not echo the inputted key.            *</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">* Return:    The key striked.                                            *</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a97908390ada42fbd1dbd5400b46b66a0">  952</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysGetKey, OPTIONAL_CSTRING, echoOpt)</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;{</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordtype">bool</span> echo = <span class="keyword">true</span>;      <span class="comment">// indicates if we&#39;re expected to echo the character.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="comment">// if we have an option specified, validate it</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span> (echoOpt != NULL)</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <span class="keywordflow">if</span> (!_stricmp(echoOpt, <span class="stringliteral">&quot;NOECHO&quot;</span>))</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            echo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(echoOpt, <span class="stringliteral">&quot;ECHO&quot;</span>))</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="stringliteral">&quot;SysGetKey&quot;</span>, <span class="stringliteral">&quot;echo&quot;</span>, <span class="stringliteral">&quot;&#39;ECHO&#39; or &#39;NOECHO&#39;&quot;</span>, echoOpt);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordtype">int</span>       tmp;                       <span class="comment">/* Temp var used to hold      */</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// if we have the second part of an extended value, return that without</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// doing a real read.</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a>)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        tmp = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a>;                <span class="comment">/* get the second char        */</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        tmp = _getch();                    <span class="comment">/* read a character           */</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="comment">// either of these characters indicate this is an extended character.</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">if</span> ((tmp == 0x00) || (tmp == 0xe0))</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="comment">// this character is saved for the next call. We return the marker</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="comment">// character first.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a> = _getch();         <span class="comment">/* Read another character     */</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        }</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span> (echo)                            <span class="comment">/* echoing?                   */</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        _putch(tmp);                       <span class="comment">/* write the character back   */</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordtype">char</span> character = (char)tmp;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewString(&amp;character, 1);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;}</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">* Function:  SysIni                                                      *</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">* Syntax:    call SysIni [inifile], app [,key/stem] [,val/stem]          *</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">* Params:    inifile - INI file from which to query or write info.  The  *</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">*                       default is the current user INI file.            *</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">*            app     - Application title to work with.  May be either    *</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">*                       of the following:                                *</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">*                        &#39;ALL:&#39; - All app titles will be returned in the *</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">*                                  stem variable specified by the next   *</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">*                                  parameter.                            *</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">*                        other  - Specific app to work with.             *</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">*            key     - Key to work with.  May be any of the following:   *</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">*                        &#39;ALL:&#39;    - All key titles will be returned in  *</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">*                                     the stem variable specified by the *</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">*                                     next parameter.                    *</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">*                        &#39;DELETE:&#39; - All keys associated with the app    *</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">*                                     will be deleted.                   *</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">*                        other     - Specific key to work with.          *</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">*            val     - Key to work with. May be either of the following: *</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">*                        &#39;DELETE:&#39; - Delete app/key pair.                *</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">*                        other     - Set app/key pair info to data spec- *</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">*                                     ified.                             *</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">*            stem    - Name of stem variable in which to store results.  *</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">*                      Stem.0 = Number found (n).                        *</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">*                      Stem.1 - Stem.n = Entries found.                  *</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">* Return:    other          - Info queried from specific app/key pair.   *</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">*            &#39;&#39;             - Info queried and placed in stem or data    *</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">*                              deleted successfully.                     *</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">*            ERROR_NOMEM    - Out of memory.                             *</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">*            ERROR_RETSTR   - Error opening INI or querying/writing info.*</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ae9bccb40686b9038448e96593c7529c5"> 1038</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#ae9bccb40686b9038448e96593c7529c5">RexxRoutine4</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysIni, OPTIONAL_CSTRING, iniFile, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, app, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, key, OPTIONAL_RexxObjectPtr, val)</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;{</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="comment">// the ini file is optional and defaults to WIN.INI</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">if</span> (iniFile == NULL)</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        iniFile = <span class="stringliteral">&quot;WIN.INI&quot;</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// Process first off of the app key. This could be a keyword command, which changes</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// the meaning of the following arguments.</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">// all is a special app name, this wants everything</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">if</span> (_stricmp(app, <span class="stringliteral">&quot;ALL:&quot;</span>) == 0)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <a class="code" href="class_stem_handler.html">StemHandler</a> stemVariable(context);            <span class="comment">// used to manipulate the stem variable for return values.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="comment">// the third arg is required and is the stem variable name.</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="comment">// the 4th argument cannot be specified</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(4))</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <a class="code" href="_rexx_util_common_8hpp.html#a4f46dfcdd706725ac90a4618ce62e4ba">maxArgException</a>(context, <span class="stringliteral">&quot;SysIni ALL:&quot;</span>, 3);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="comment">// Retrieve the stem variable using the key name</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        stemVariable.<a class="code" href="class_stem_handler.html#a2a4a666625998c8d47af8b11b20e4250">setStem</a>(key, 3);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordtype">size_t</span> lSize = 0x0000ffffL;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">// Allocate a large buffer for retrieving the information</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <a class="code" href="class_auto_free.html">AutoFree</a> returnVal = (<span class="keywordtype">char</span> *)malloc(lSize);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">if</span> (returnVal == NULL)</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="unix_2_sys_rexx_util_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a>);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="comment">// now retrieve the application names.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        lSize = GetPrivateProfileString(NULL, NULL, <span class="stringliteral">&quot;&quot;</span>, returnVal, (DWORD)lSize, iniFile);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="comment">// zero indicates there was an error</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> (lSize == 0)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="comment">// parse this up into a list added to the stem variable</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        stemVariable.<a class="code" href="class_stem_handler.html#abfc8a8321d88b758f77b80d7dea62b08">addList</a>(returnVal);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="comment">// ok, this is targetted at a particular app. Now decode what sort of operation this is.</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="comment">// the key needs</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *keyName = context-&gt;ObjectToStringValue(key);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">// this could be a request for all keys of a given app</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">// the val argument must be a stem variable name.</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">if</span> (!_stricmp(keyName, <span class="stringliteral">&quot;ALL:&quot;</span>))</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="class_stem_handler.html">StemHandler</a> stemVariable(context);            <span class="comment">// used to manipulate the stem variable for return values.</span></div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="comment">// val is the stem variable for this case</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(4))</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            <span class="comment">// Missing argument; argument 4 is required</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            context-&gt;ThrowException1(<a class="code" href="oorexxerrors_8h.html#ad12039ea660308581bbab2c0a11db822">Rexx_Error_Invalid_argument_noarg</a>, context-&gt;WholeNumberToObject(4));</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        stemVariable.<a class="code" href="class_stem_handler.html#a2a4a666625998c8d47af8b11b20e4250">setStem</a>(val, 4);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordtype">size_t</span> lSize = 0x0000ffffL;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="comment">// Allocate a large buffer for retrieving the information</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <a class="code" href="class_auto_free.html">AutoFree</a> returnVal = (<span class="keywordtype">char</span> *)malloc(lSize);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">if</span> (returnVal == NULL)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="unix_2_sys_rexx_util_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="comment">// Retrieve all keys for a specific application</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        lSize = GetPrivateProfileString(app, NULL, <span class="stringliteral">&quot;&quot;</span>, returnVal, (DWORD)lSize, iniFile);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="comment">// zero indicates there was an error</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">if</span> (lSize == 0)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="comment">// parse this up into a list added to the stem variable</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        stemVariable.<a class="code" href="class_stem_handler.html#abfc8a8321d88b758f77b80d7dea62b08">addList</a>(returnVal);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160; </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">// this could be a DELETE: operation for a particular application</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">if</span> (stricmp(keyName, <span class="stringliteral">&quot;DELETE:&quot;</span>) == 0)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">// the 4th argument cannot be specified</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(4))</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <a class="code" href="_rexx_util_common_8hpp.html#a4f46dfcdd706725ac90a4618ce62e4ba">maxArgException</a>(context, <span class="stringliteral">&quot;SysIni DELETE:&quot;</span>, 3);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="comment">// A request to delete all keys for a given application</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">if</span> (!WritePrivateProfileString(app, NULL, NULL, iniFile))</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        }</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="comment">// OK, if we got this far, then we&#39;re working with a specific key for a specific app.</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="comment">// This is either a retrieval operation, a delete request, or a set request.</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="comment">// a NULL value argument is a retrieval request. This is the return value.</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">if</span> (val == NULL)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="keywordtype">size_t</span> lSize = 0x0000ffffL;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="comment">// Allocate a large buffer for retrieving the information</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <a class="code" href="class_auto_free.html">AutoFree</a> returnVal = (<span class="keywordtype">char</span> *)malloc(lSize);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">if</span> (returnVal == NULL)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="unix_2_sys_rexx_util_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="comment">// Retrieve just the given key value</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        lSize = GetPrivateProfileString(app, keyName, <span class="stringliteral">&quot;&quot;</span>, returnVal, (DWORD)lSize, iniFile);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <span class="comment">// zero indicates there was an error</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">if</span> (lSize == 0)</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewString(returnVal, lSize);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// this argument must be a string from this point</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *valueString = context-&gt;ObjectToStringValue(val);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">// this could be a key deletion request</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (stricmp(valueString, <span class="stringliteral">&quot;DELETE:&quot;</span>) == 0)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="comment">// A request to delete a key for a given application</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">if</span> (!WritePrivateProfileString(app, keyName, NULL, iniFile))</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        }</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">// we have a value specified and it is not the special key marker, this is a set operation</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">if</span> (!WritePrivateProfileString(app, keyName, valueString, iniFile))</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(<a class="code" href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;}</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">* Function:  SysMkDir                                                    *</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">* Syntax:    call SysMkDir dir                                           *</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">* Params:    dir - Directory to be created.                              *</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">*            Return code from CreateDirectory()                          *</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ab3fda15456e35e5870ffd8d8572c4e4e"> 1210</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysMkDir, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, dir)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;{</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="class_routine_qualified_name.html">RoutineQualifiedName</a> directory(context, dir);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="comment">// this could easily made a common function but the Linux version</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">// takes an extra argument.</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">return</span> CreateDirectory(directory, NULL) != 0 ? 0 : GetLastError();</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;}</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="comment">* Function:  SysGetErrorText                                             *</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="comment">* Syntax:    call SysGetErrortext errnumber                              *</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">* Params:    errnumber - error number to be described                    *</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">* Return:    Description or empty string                                 *</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a421d70bee1e0c8ae8d577e7518a3b046"> 1230</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysGetErrorText, <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>, errnum)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;{</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordtype">char</span> *errmsg;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">if</span> (FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM, NULL, errnum, 0, (LPSTR)&amp;errmsg, 64, NULL) == 0)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    {                               <span class="comment">/* succeeded                  */</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordtype">size_t</span> length = strlen(errmsg);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160; </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="comment">// FormatMessage returns strings with trailing CrLf, which we want removed</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="keywordflow">if</span> (length &gt;= 1 &amp;&amp; errmsg[length - 1] == 0x0a)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            length--;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">if</span> (length &gt;= 1 &amp;&amp; errmsg[length - 1] == 0x0d)</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            length--;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> ret = context-&gt;NewString(errmsg, length);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        LocalFree(errmsg);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;}</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">* Function:  SysWinEncryptFile (W2K only)                                *</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">* Syntax:    call SysWinEncryptFile filename                             *</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">* Params:    filename - file to be encrypted                             *</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">*            Return code from EncryptFile()                              *</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#afbf8253b05b356b088c7d4c1ac4e24a1"> 1271</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysWinEncryptFile, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, fileName)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;{</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <a class="code" href="class_routine_qualified_name.html">RoutineQualifiedName</a> qualifiedName(context, fileName);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    ULONG rc = EncryptFile(qualifiedName);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">return</span> rc != 0 ? rc : GetLastError();</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">* Function:  SysWinDecryptFile (W2K only)                                *</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">* Syntax:    call SysWinDecryptFile filename                             *</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">* Params:    filename - file to be decrypted                             *</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">*            Return code from DecryptFile()                              *</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160; </div>
<div class="line"><a name="l01291"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a4fbd6451cbb5b035061521feb4ca6195"> 1291</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysWinDecryptFile, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, fileName)</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;{</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <a class="code" href="class_routine_qualified_name.html">RoutineQualifiedName</a> qualifiedName(context, fileName);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    ULONG rc = DecryptFile(qualifiedName, 0);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">return</span> rc != 0 ? rc : GetLastError();</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;}</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">* Function:  SysWinVer                                                   *</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">* Syntax:    call SysWinVer                                              *</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">* Return:    Windows Version                                             *</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a0335ebdde6d0fb46e6a6c5136babf352"> 1309</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">RexxRoutine0</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysWinVer)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;{</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">// MS has deprecated GetVersionEx().  Also, since 10.0.18363, querying</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="comment">// the version information from one of the system DLLs won&#39;t give the</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">// correct version number any longer.  The only remaining option seems</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="comment">// to be this:</span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">// https://stackoverflow.com/questions/36543301/detecting-windows-10-version</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="preprocessor">    #define STATUS_SUCCESS (0x00000000)</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keyword">typedef</span> LONG NTSTATUS;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keyword">typedef</span> NTSTATUS (WINAPI* RtlGetVersionPtr)(PRTL_OSVERSIONINFOW);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160; </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    HMODULE hMod = ::GetModuleHandleW(L<span class="stringliteral">&quot;ntdll.dll&quot;</span>);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span> (hMod != NULL)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        RtlGetVersionPtr fxPtr = (RtlGetVersionPtr)::GetProcAddress(hMod, <span class="stringliteral">&quot;RtlGetVersion&quot;</span>);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">if</span> (fxPtr != NULL)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            RTL_OSVERSIONINFOW rovi;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            rovi.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(rovi);</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;            <span class="keywordflow">if</span> (fxPtr(&amp;rovi) == <a class="code" href="windows_2_sys_rexx_util_8cpp.html#ae56fdb340b23940f7a64ed2e37c1774a">STATUS_SUCCESS</a>)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            {</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                <span class="keywordtype">char</span> retstr[256];</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                snprintf(retstr, <span class="keyword">sizeof</span>(retstr), <span class="stringliteral">&quot;Windows %d.%d.%d&quot;</span>,</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                 rovi.dwMajorVersion, rovi.dwMinorVersion, rovi.dwBuildNumber);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(retstr);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="comment">// just return the nullstring if we fail</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;}</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">* Function:  SysTextScreenRead                                           *</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">* Syntax:    call SysTextScreenRead row, col [,len]                      *</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="comment">* Params:    row - Horizontal row on the screen to start reading from.   *</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="comment">*                   The row at the top of the screen is 0.               *</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="comment">*            col - Vertical column on the screen to start reading from.  *</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">*                   The column at the left of the screen is 0.           *</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="comment">*            len - The number of characters to read.  The default is the *</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">*                   rest of the screen.                                  *</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">* Return:    Characters read from text screen.                           *</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">* Note: The ReadConsoleOutputCharacter API is no longer recommended      *</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#acd43b5fbdb14e98d9f58471edb251f2d"> 1360</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#acd43b5fbdb14e98d9f58471edb251f2d">RexxRoutine3</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysTextScreenRead,</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;             <span class="keywordtype">int</span>, row, <span class="keywordtype">int</span>, col, OPTIONAL_uint32_t, len)</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;{</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    HANDLE h;                            <span class="comment">// stdout handle</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbiInfo; <span class="comment">// screen buffer size</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> buffer;                     <span class="comment">// return buffer</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    COORD start;                         <span class="comment">// start coordinates</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    DWORD chars;                         <span class="comment">// actual chars read</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">// get a handle to our console and the screen buffer size</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    h = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> (h == INVALID_HANDLE_VALUE ||</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        GetConsoleScreenBufferInfo(h, &amp;csbiInfo) == 0)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">// check row and column ranges</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordflow">if</span> (row &lt; 0 || row &gt;= csbiInfo.dwSize.Y)</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        <span class="comment">// 88.907 The &amp;1 argument must be in the range &amp;2 to &amp;3; found &quot;&amp;4&quot;</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        context-&gt;RaiseException(<a class="code" href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a>,</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          context-&gt;ArrayOfFour(context-&gt;String(<span class="stringliteral">&quot;row&quot;</span>),</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;          context-&gt;WholeNumber(0), context-&gt;WholeNumber(csbiInfo.dwSize.Y - 1),</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;          context-&gt;WholeNumber(row)));</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">if</span> (col &lt; 0 || col &gt;= csbiInfo.dwSize.X)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="comment">// 88.907 The &amp;1 argument must be in the range &amp;2 to &amp;3; found &quot;&amp;4&quot;</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        context-&gt;RaiseException(<a class="code" href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a>,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;          context-&gt;ArrayOfFour(context-&gt;String(<span class="stringliteral">&quot;col&quot;</span>),</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;          context-&gt;WholeNumber(0), context-&gt;WholeNumber(csbiInfo.dwSize.X - 1),</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;          context-&gt;WholeNumber(col)));</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160; </div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">// if not specified, set len to the maximum length</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3))</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        len = csbiInfo.dwSize.Y * csbiInfo.dwSize.X;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    }</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len &lt; 1)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// fix len for the given row/col start to be in range 1 .. max</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    len = std::min(len, (<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)csbiInfo.dwSize.Y * csbiInfo.dwSize.X - (row * csbiInfo.dwSize.X + col));</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="comment">// allocate our screen read character buffer</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    buffer = (<span class="keywordtype">char</span> *)malloc(len);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (buffer == NULL)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    start.X = (short)col;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    start.Y = (short)row;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">if</span> (ReadConsoleOutputCharacter(h, buffer, (DWORD)len, start, &amp;chars) == 0)</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        context-&gt;InvalidRoutine(); <span class="comment">// console read failed</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="comment">// seems undocumented, but if &quot;ANSI&quot; ReadConsoleOutputCharacterA()</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="comment">// encounters a Unicode character while reading the screen, it</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="comment">// returns success, but with chars set to 0.</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">if</span> (chars &gt; 0)</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="comment">// OK if chars &gt; 0 or len = 0 requested or we&#39;re reading outside the buffer</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewString(buffer, chars);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="comment">// Ok, let&#39;s retry with the &quot;Wide&quot; ReadConsoleOutputCharacterW(),</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <span class="comment">// then convert the -W result back to ANSI (which could be UTF-8).</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// first, we need a bigger Wide string buffer</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">if</span> (!buffer.<a class="code" href="class_auto_free.html#af59ae599c5fc6e07e0739b7a28fec85a">realloc</a>(len * 2))</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// next, try to read the screen again, this time with the -W suffix</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (ReadConsoleOutputCharacterW(h, (LPWSTR)(<span class="keywordtype">void</span> *)buffer, len, start, &amp;chars) == 0)</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="comment">// did we still get zero chars?  W-to-A conversion won&#39;t work, so</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">// just return a NULLSTRING</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">if</span> (chars == 0)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    <span class="comment">// the W-to-A conversion is a bit of a pain: first determine the</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="comment">// required conversion output buffer size</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordtype">int</span> required;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> output;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    required = WideCharToMultiByte(CP_ACP, 0, (LPCWCH)(<span class="keywordtype">void</span> *)buffer, chars, NULL, 0, NULL, NULL);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">if</span> (required == 0)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    output = (<span class="keywordtype">char</span> *)malloc(required);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">if</span> (output == NULL)</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    }</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="comment">// now finally we do the actual W-to-A conversion</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (WideCharToMultiByte(CP_ACP, 0, (LPCWCH)(<span class="keywordtype">void</span> *)buffer, chars, output, required, NULL, NULL) == 0)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewString(output, required);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;}</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">* Function:  SysTextScreenSize                                           *</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">* Syntax:    call SysTextScreenSize [option], [rows, colummns]          *</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">*            call SysTextScreenSize [option], [top, left, bottom, right] *</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">* Params:    option - &quot;BUFFERSIZE&quot;, &quot;WINDOWRECT&quot;, &quot;MAXWINDOWSIZE&quot;        *</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">*               &quot;BUFFERSIZE&quot; (default) return or set console buffer size *</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">*               &quot;WINDOWRECT&quot; return or set windows position              *</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">*               &quot;MAXWINDOWSIZE&quot; return maximum window size               *</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">*            lines, columns - set buffer size to lines by columns        *</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">*            top, left, bottom, right - set window size and position     *</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">* Return:    &quot;BUFFERSIZE&quot; or &quot;MAXWINDOWSIZE&quot;: rows columns               *</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">*            &quot;WINDOWRECT&quot;: top left bottom right                         *</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a082cae7620e7f850ea04d6fe6b15b583"> 1495</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a082cae7620e7f850ea04d6fe6b15b583">RexxRoutine5</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysTextScreenSize,</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;             OPTIONAL_CSTRING, optionString,</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;             OPTIONAL_stringsize_t, rows, OPTIONAL_stringsize_t, columns,</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;             OPTIONAL_stringsize_t, rows2, OPTIONAL_stringsize_t, columns2)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;{</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">// check for valid option</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">enum</span> {BUFFERSIZE, WINDOWRECT, MAXWINDOWSIZE } console_option;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    console_option option;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">if</span> (optionString == NULL || stricmp(optionString, <span class="stringliteral">&quot;BUFFERSIZE&quot;</span>) == 0)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        option = BUFFERSIZE;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(optionString, <span class="stringliteral">&quot;WINDOWRECT&quot;</span>) == 0)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        option = WINDOWRECT;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(optionString, <span class="stringliteral">&quot;MAXWINDOWSIZE&quot;</span>) == 0)</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        option = MAXWINDOWSIZE;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="stringliteral">&quot;SysTextScreenSize&quot;</span>, <span class="stringliteral">&quot;option&quot;</span>, <span class="stringliteral">&quot;BUFFERSIZE, WINDOWRECT, or MAXWINDOWSIZE&quot;</span>, optionString);</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    <span class="comment">// check for valid SET arguments: either none, or two more, or four more</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordtype">size_t</span> setArgs;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordtype">bool</span> omitted45 = <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(4) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(5);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordtype">bool</span> exists23 = <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(3);</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3) &amp;&amp; omitted45)</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        setArgs = 0;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    }</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exists23 &amp;&amp; omitted45)</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        setArgs = 2;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    }</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exists23 &amp;&amp; <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(4) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(5))</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        setArgs = 4;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="comment">// check that all SET arguments fit a SHORT</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordflow">if</span> (!(setArgs == 0 ||</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;          (setArgs == 2 &amp;&amp; rows &lt;= SHRT_MAX &amp;&amp; columns &lt;= SHRT_MAX) ||</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;          (setArgs == 4 &amp;&amp; rows &lt;= SHRT_MAX &amp;&amp; columns &lt;= SHRT_MAX &amp;&amp; rows2 &lt;= SHRT_MAX &amp;&amp; columns2 &lt;= SHRT_MAX)))</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">// real work starts here</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbi; <span class="comment">// console screen buffer information</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordtype">char</span> buffer[100];</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">if</span> (setArgs == 0)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="comment">// this is a GET requset, retrieve console information</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="keywordflow">if</span> (GetConsoleScreenBufferInfo(hStdout, &amp;csbi) == NULL)</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;            <span class="comment">// console not in character mode, return two or four zeroes</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(option == WINDOWRECT ? <span class="stringliteral">&quot;0 0 0 0&quot;</span> : <span class="stringliteral">&quot;0 0&quot;</span>);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        }</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">if</span> (option == BUFFERSIZE &amp;&amp; setArgs == 0)</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// this is a BUFFERSIZE GET, returns two values</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%d %d&quot;</span>, csbi.dwSize.Y, csbi.dwSize.X);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    }</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == WINDOWRECT &amp;&amp; setArgs == 0)</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    {</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="comment">// this is a WINDOWRECT GET, returns four values</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%d %d %d %d&quot;</span>, csbi.srWindow.Top, csbi.srWindow.Left, csbi.srWindow.Bottom, csbi.srWindow.Right);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == MAXWINDOWSIZE &amp;&amp; setArgs == 0)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <span class="comment">// this is a MAXWINDOWSIZE GET, returns two values</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%d %d&quot;</span>, csbi.dwMaximumWindowSize.Y, csbi.dwMaximumWindowSize.X);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == BUFFERSIZE &amp;&amp; setArgs == 2)</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="comment">// this is a BUFFERSIZE SET, requires two more arguments</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        COORD consoleBuffer;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        consoleBuffer.Y = (SHORT)rows;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        consoleBuffer.X = (SHORT)columns;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        BOOL code = SetConsoleScreenBufferSize(hStdout, consoleBuffer);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%d&quot;</span>, code == 0 ? GetLastError() : 0);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == WINDOWRECT  &amp;&amp; setArgs == 4)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="comment">// this is a WINDOWRECT  SET, requires four more arguments</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        SMALL_RECT consoleWindow;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        consoleWindow.Top =    (SHORT)rows;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        consoleWindow.Left =   (SHORT)columns;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        consoleWindow.Bottom = (SHORT)rows2;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        consoleWindow.Right =  (SHORT)columns2;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        BOOL code = SetConsoleWindowInfo(hStdout, 1, &amp;consoleWindow);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%d&quot;</span>, code == 0 ? GetLastError() : 0);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    }</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160; </div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="comment">// return the buffer as result</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(buffer);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;}</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a857514d3bc153b3c607aa02430965307"> 1612</a></span>&#160;<span class="preprocessor">#define MAX_CREATEPROCESS_CMDLINE (32 * 1024)</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">* Function:  RxWinExec                                                   *</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment">* Syntax:    call RxWinExec command,CmdShow                              *</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">* Parms:     command    - program to execute                             *</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">*            CmdShow    - Any of the SW_ type values in winuser.h        *</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">*                         SW_SHOW                 5                      *</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment">*                         SW_HIDE                 0                      *</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment">*                         SW_MINIMIZE etc...      6                      *</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">*                         numeric values...                              *</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">* Return:    Process ID or Error code                                    *</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a86a496c3a2e2b8676994b7b44e4683ba"> 1630</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, RxWinExec, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, command, OPTIONAL_CSTRING, show)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;{</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="comment">// Show window types.</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    PSZ    show_styles[] =</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="stringliteral">&quot;SHOWNORMAL&quot;</span>,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="stringliteral">&quot;SHOWNOACTIVATE&quot;</span>,</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="stringliteral">&quot;SHOWMINNOACTIVE&quot;</span>,</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        <span class="stringliteral">&quot;SHOWMINIMIZED&quot;</span>,</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        <span class="stringliteral">&quot;SHOWMAXIMIZED&quot;</span>,</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <span class="stringliteral">&quot;HIDE&quot;</span>,</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="stringliteral">&quot;MINIMIZE&quot;</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    };</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="comment">// Show window styles.</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    ULONG  show_flags[] =</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        SW_SHOWNORMAL,</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;        SW_SHOWNOACTIVATE,</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;        SW_SHOWMINNOACTIVE,</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        SW_SHOWMINIMIZED,</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        SW_SHOWMAXIMIZED,</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        SW_HIDE,</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        SW_MINIMIZE</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    };</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <span class="keywordflow">if</span> (strlen(command) &gt; <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a857514d3bc153b3c607aa02430965307">MAX_CREATEPROCESS_CMDLINE</a>)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordtype">int</span> cmdShow = SW_SHOWNORMAL;    <span class="comment">// The style is optional</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160; </div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">// Show type can be one and only one of the SW_XXX constants.</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">if</span> (show != NULL)</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="comment">// Get length of option and search the style table.</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="keywordtype">int</span>         index;                   <span class="comment">/* table index                */</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="keywordflow">for</span> (index = 0; index &lt; <span class="keyword">sizeof</span>(show_styles) / <span class="keyword">sizeof</span>(PSZ); index++)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            <span class="keywordflow">if</span> (_stricmp(show, show_styles[index]) == 0)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                cmdShow = show_flags[index];</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        }</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <span class="keywordflow">if</span> (index == <span class="keyword">sizeof</span>(show_styles) / <span class="keyword">sizeof</span>(PSZ))</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        }</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    }</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    ULONG       pid;                     <span class="comment">/* PID or error return code   */</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    STARTUPINFO si;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    PROCESS_INFORMATION procInfo;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    ZeroMemory(&amp;procInfo, <span class="keyword">sizeof</span>(procInfo));</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    ZeroMemory(&amp;si, <span class="keyword">sizeof</span>(si));</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    si.cb = <span class="keyword">sizeof</span>(si);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    si.dwFlags = STARTF_USESHOWWINDOW;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    si.wShowWindow = (WORD)cmdShow;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">if</span> (CreateProcess(NULL, (LPSTR)command, NULL, NULL, FALSE, 0, NULL,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                      NULL, &amp;si, &amp;procInfo))</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        pid = procInfo.dwProcessId;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        pid = GetLastError();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordflow">if</span> (pid &gt; 31)</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            <span class="comment">// Maintain compatibility to versions &lt; ooRexx 3.1.2</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            pid = (ULONG)-((<span class="keywordtype">int</span>)pid);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="comment">// Close process / thread handles as they are not used / needed.</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    CloseHandle(procInfo.hProcess);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    CloseHandle(procInfo.hThread);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="keywordflow">return</span> pid;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;}</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160; </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment">* Function:  SysBootDrive                                                *</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">* Syntax:    drive = SysBootDrive()                                      *</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">* Return:    &#39;A: B: C: D: ...&#39;                                           *</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ad594c4545a91cd1548bd389c734bf434"> 1728</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">RexxRoutine0</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysBootDrive)</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;{</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordtype">char</span> retstr[MAX_PATH];</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160; </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="keywordflow">if</span> (GetSystemDirectory(retstr, <span class="keyword">sizeof</span>(retstr)) &gt; 0)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="comment">// the drive is the first two characters of the system directory</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewString(retstr, 2);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    }</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;}</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">* Function:  SysSystemDirectory                                          *</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">* Syntax:    drive = SysSystemDirectory()                                *</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">* Return:    &#39;C:\WINDOWS ...&#39;                                            *</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aed2c7281074c8f1d29f9f62508e7abaf"> 1754</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">RexxRoutine0</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysSystemDirectory)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;{</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keywordtype">char</span> retstr[MAX_PATH];</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">if</span> (GetSystemDirectory(retstr, <span class="keyword">sizeof</span>(retstr)) &gt; 0)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(retstr);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;}</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">* Function:  SysFileSystemType                                           *</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">* Syntax:    result = SysFileSystemType([drive])                         *</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">* Params:    drive - d, d:, d:\, \\share\path                            *</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">*                    if omitted, defaults to current drive               *</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment">* Return:    result - the drive&#39;s file system (e. g. NTFS, FAT)          *</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment">*                     null string for any error                          *</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ae95bed9303810608f0012c5039533c10"> 1781</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysFileSystemType, OPTIONAL_CSTRING, drive)</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;{</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> d;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <span class="keywordflow">if</span> (drive != NULL)</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        d = drive;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="comment">// We just let the Windows APIs handle all the different ways to</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="comment">// specify a volume, like d:\, \\?\d:, \\localhost\path, etc.  But</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <span class="comment">// on top of that we support a single-character drive d.</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() == 1 &amp;&amp; <a class="code" href="class_utilities.html#a470770b40ea8bf748ee9a28ec4361852">Utilities::isAlpha</a>(d.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(0)))</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <span class="comment">// make this a valid drive specification</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            d += <span class="stringliteral">&quot;:\\&quot;</span>;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;        <span class="comment">// GetVolumeInformation() is picky, it requires a final backslash</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() &gt; 0)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        {</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            d.<a class="code" href="class_file_name_buffer.html#ad5f40320218a98a58bd54e54f78dc609">addFinalPathDelimiter</a>();</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    }</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="comment">// get the file system type</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;    <span class="keywordtype">char</span> fileSystem[MAX_PATH];</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <span class="keywordflow">if</span> (GetVolumeInformation((drive == NULL) ? NULL : (<span class="keywordtype">char</span> * )d, NULL, 0, NULL, NULL, NULL, fileSystem, <span class="keyword">sizeof</span>(fileSystem)))</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(fileSystem);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;}</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment">* Function:  SysVolumeLabel                                              *</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment">* Syntax:    result = SysVolumeLabel([drive])                            *</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment">* Params:    drive - d, d:, d:\, \\share\path                            *</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment">*                    if omitted, defaults to current drive               *</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">* Return:    result - the volume label                                   *</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">*                     null string for any error                          *</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aff80af803d8df7737c01a66f5731ac91"> 1826</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysVolumeLabel, OPTIONAL_CSTRING, drive)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;{</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <a class="code" href="class_file_name_buffer.html">FileNameBuffer</a> d;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">if</span> (drive != NULL)</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    {</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        d = drive;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="comment">// We just let the Windows APIs handle all the different ways to</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="comment">// specify a volume, like d:\, \\?\d:, \\localhost\path, etc.  But</span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <span class="comment">// on top of that we support a single-character drive d.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() == 1 &amp;&amp; <a class="code" href="class_utilities.html#a470770b40ea8bf748ee9a28ec4361852">Utilities::isAlpha</a>(d.<a class="code" href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">at</a>(0)))</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <span class="comment">// make this a valid drive specification</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            d += <span class="stringliteral">&quot;:\\&quot;</span>;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="comment">// GetVolumeInformation() is picky, it requires a final backslash</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">if</span> (d.<a class="code" href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">length</a>() &gt; 0)</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            d.<a class="code" href="class_file_name_buffer.html#ad5f40320218a98a58bd54e54f78dc609">addFinalPathDelimiter</a>();</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; </div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">// get the volume label</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordtype">char</span> volumeName[MAX_PATH];</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">if</span> (GetVolumeInformation((drive == NULL) ? NULL : (<span class="keywordtype">char</span> * )d, volumeName, <span class="keyword">sizeof</span>(volumeName), NULL, NULL, NULL, NULL, 0))</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(volumeName);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;}</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160; </div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">* Function:  SysCreateMutexSem                                           *</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">* Syntax:    handle = SysCreateMutexSem(&lt;name&gt;)                          *</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment">* Params:    name  - optional name for a mutex semaphore                 *</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment">* Return:    handle - token used as a mutex handle for                   *</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment">*                     SysRequestMutexSem, SysReleaseMutexSem,            *</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment">*                     SysCloseMutexSem, and SysOpenEventSem              *</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment">*            &#39;&#39; - Empty string in case of any error                      *</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aaf6b012099afc98fd0e8bd1e8621eb46"> 1872</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, SysCreateMutexSem, OPTIONAL_CSTRING, name)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;{</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    HANDLE    handle;                    <span class="comment">/* mutex handle               */</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    SECURITY_ATTRIBUTES sa = { <span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span> };</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    handle = 0;                          <span class="comment">/* zero the handle            */</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keywordflow">if</span> (name != NULL)                  <span class="comment">/* request for named sem      */</span></div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    {</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <span class="comment">/* create it by name          */</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        handle = CreateMutex(&amp;sa, <span class="keyword">false</span>, name);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">if</span> (!handle)                            <span class="comment">/* may already be created     */</span></div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;            handle = OpenMutex(MUTEX_ALL_ACCESS, <span class="keyword">true</span>, name);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    }</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">else</span>                                 <span class="comment">/* unnamed semaphore          */</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        handle = CreateMutex(&amp;sa, <span class="keyword">false</span>, NULL);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    }</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">return</span> context-&gt;Uintptr((<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)handle);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;}</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="comment">* Function:  SysOpenMutexSem                                             *</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="comment">* Syntax:    result = SysOpenMutexSem(name)                              *</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="comment">* Params:    name - name of the mutex semaphore                          *</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="comment">* Return:    result - handle to the mutex                                *</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a243b4bce9007d00e4fca3a1639f116ab"> 1912</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, SysOpenMutexSem, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;{</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    SECURITY_ATTRIBUTES sa = { <span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span> };</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="comment">/* get a binary handle        */</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)OpenMutex(MUTEX_ALL_ACCESS, <span class="keyword">true</span>, name); <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;}</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">* Function:  SysReleaseMutexSem                                          *</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment">* Syntax:    result = SysReleaseMutexSem(handle)                         *</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateMutexSem              *</span></div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">* Return:    result - return code from ReleaseMutex                      *</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a00ceb7227752b462740f20ab7165559d"> 1930</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysReleaseMutexSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;{</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keywordflow">return</span> !ReleaseMutex((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;}</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment">* Function:  SysCloseMutexSem                                            *</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment">* Syntax:    result = SysCloseMutexSem(handle)                           *</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateMutexSem              *</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">* Return:    result - return code from CloseHandle                       *</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160; </div>
<div class="line"><a name="l01945"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a8dfe031adeded0fc3ce3640745fcfac2"> 1945</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysCloseMutexSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;{</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keywordflow">return</span> !ReleaseMutex((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;}</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="comment">* Function:  SysRequestMutexSem                                          *</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="comment">* Syntax:    result = SysRequestMutexSem(handle, &lt;timeout&gt;)              *</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateMutexSem              *</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">* Return:    result - return code from WaitForSingleObject               *</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a3a30335f84a181404728b83bd98c1d2d"> 1960</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysRequestMutexSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h, OPTIONAL_int, timeout)</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;{</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2))</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    {</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        timeout = INFINITE;       <span class="comment">/* default is no timeout      */</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordtype">int</span> rc = WaitForSingleObject((HANDLE)h, timeout);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">if</span> (rc == WAIT_FAILED)</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keywordflow">return</span> rc;                         <span class="comment">/* format the return code     */</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;}</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment">* Function:  SysCreateEventSem                                           *</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">* Syntax:    handle = SysCreateEventSem(&lt;name&gt;,&lt;manual&gt;)                 *</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">* Params:    name  - optional name for a event semaphore                 *</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">*            any second argument means manual reset event                *</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">* Return:    handle - token used as a event sem handle for               *</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">*                     SysPostEventSem, SysClearEventSem,                 *</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">*                     SysCloseEventSem, and SysOpenEventSem              *</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment">*            &#39;&#39; - Empty string in case of any error                      *</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a822df6c176f05b4585df40629af2d8c4"> 1990</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, SysCreateEventSem, OPTIONAL_CSTRING, name, OPTIONAL_CSTRING, reset)</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;{</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    HANDLE    handle;                    <span class="comment">/* mutex handle               */</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    SECURITY_ATTRIBUTES sa = { <span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span> };</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordtype">bool</span>      manual;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160; </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    handle = 0;                          <span class="comment">/* zero the handle            */</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keywordflow">if</span> (reset != NULL)</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        manual = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    }</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        manual = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    }</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <span class="keywordflow">if</span> (name != NULL)</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    {                                    <span class="comment">/* request for named sem      */</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="comment">/* create it by name          */</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        handle = CreateEvent(&amp;sa, manual, <span class="keyword">false</span>, name);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        <span class="keywordflow">if</span> (!handle)                       <span class="comment">/* may already be created     */</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;            <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;            handle = OpenEvent(EVENT_ALL_ACCESS, <span class="keyword">true</span>, name);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    }</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keywordflow">else</span>                                 <span class="comment">/* unnamed semaphore          */</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        handle = CreateEvent(&amp;sa, manual, <span class="keyword">false</span>, NULL);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    }</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    }</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">return</span> context-&gt;Uintptr((<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)handle);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;}</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">* Function:  SysOpenEventSem                                             *</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">* Syntax:    result = SysOpenEventSem(name)                              *</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">* Params:    name - name of the event semaphore                          *</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">* Return:    result - return code from OpenEvent                         *</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aa99b04951a3dd00e93a76a3e69bc83f2"> 2039</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, SysOpenEventSem, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;{</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    SECURITY_ATTRIBUTES sa = { <span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span> };</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="comment">/* get a binary handle        */</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)OpenEvent(EVENT_ALL_ACCESS, <span class="keyword">true</span>, name); <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;}</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment">* Function:  SysPostEventSem                                             *</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">* Syntax:    result = SysPostEventSem(handle)                            *</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">* Return:    result - return code from SetEvent                          *</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ae7b40c43fa6bd58cec7a486b8f49fe6d"> 2057</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysPostEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;{</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">return</span> !SetEvent((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;}</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">* Function:  SysResetEventSem                                            *</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">* Syntax:    result = SysResetEventSem(handle)                           *</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">* Return:    result - return code from ResetEvent                        *</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a36473d49d30f1adc39ba57da6d79be53"> 2072</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysResetEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;{</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordflow">return</span> !ResetEvent((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;}</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="comment">* Function:  SysPulseEventSem                                            *</span></div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">* Syntax:    result = SysPulseEventSem(handle)                           *</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;<span class="comment">* Return:    result - return code from PulseEvent                        *</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a76c373c19cf62b77a3e4a7c7d9302993"> 2088</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysPulseEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;{</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="keywordflow">return</span> !PulseEvent((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;}</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="comment">* Function:  SysCloseEventSem                                            *</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="comment">* Syntax:    result = SysCloseEventSem(handle)                           *</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">* Return:    result - return code from CloseHandle                       *</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a40833703f5b327deb66d0fa8ce4baf72"> 2104</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysCloseEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;{</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">return</span> !CloseHandle((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;}</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">* Function:  SysWaitEventSem                                             *</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment">* Syntax:    result = SysWaitEventSem(handle, &lt;timeout&gt;)                 *</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="comment">* Params:    handle - token returned from SysWaitEventSem                *</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">* Return:    result - return code from WaitForSingleObject               *</span></div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ae5d73f441f7ceaf6a8ab72e13bb4c3c7"> 2119</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysWaitEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h, OPTIONAL_int, timeout)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;{</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2))</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        timeout = INFINITE;       <span class="comment">/* default is no timeout      */</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="comment">/* request the semaphore      */</span></div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <span class="keywordtype">int</span> rc = WaitForSingleObject((HANDLE)h, timeout);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keywordflow">if</span> (rc == WAIT_FAILED)</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    {</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <span class="keywordflow">return</span> rc;                         <span class="comment">/* format the return code     */</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;}</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="comment">* Function:  SysSetPriority                                              *</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="comment">* Syntax:    result = SysSetPriority(Class, Level)                       *</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="comment">* Params: Class - The priority class (0-3 or HIGH,REALTIME,NORMAL,IDLE)  *</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="comment">*         Level  - Amount to change (-15 to +15 or IDLE, LOWEST,...)     *</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; </div>
<div class="line"><a name="l02148"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#af96a077df14d285590d2972491c58e81"> 2148</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysSetPriority, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, classArg, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, levelArg)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;{</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;    HANDLE process = GetCurrentProcess();</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    HANDLE thread = GetCurrentThread();</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160; </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    DWORD     iclass = -1;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    <a class="code" href="rexx_8h.html#aa0199524ada35d939fa20d4625d27d55">wholenumber_t</a> classLevel;               <span class="comment">/* priority class             */</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="keywordflow">if</span> (context-&gt;WholeNumber(classArg, &amp;classLevel))</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <span class="keywordflow">switch</span> (classLevel)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                iclass = IDLE_PRIORITY_CLASS;</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                iclass = NORMAL_PRIORITY_CLASS;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                iclass = HIGH_PRIORITY_CLASS;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                iclass = REALTIME_PRIORITY_CLASS;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;        }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    }</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *classStr = context-&gt;ObjectToStringValue(classArg);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;REALTIME&quot;</span>) == 0)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            iclass = REALTIME_PRIORITY_CLASS;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;HIGH&quot;</span>) == 0)</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            iclass = HIGH_PRIORITY_CLASS;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            iclass = NORMAL_PRIORITY_CLASS;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;IDLE&quot;</span>) == 0)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            iclass = IDLE_PRIORITY_CLASS;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <a class="code" href="rexx_8h.html#aa0199524ada35d939fa20d4625d27d55">wholenumber_t</a> level;                    <span class="comment">/* priority level             */</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordflow">if</span> (context-&gt;WholeNumber(levelArg, &amp;level))</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    {</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="keywordflow">if</span> (level &lt; -15 || level &gt; 15)</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *levelStr = context-&gt;ObjectToStringValue(levelArg);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;ABOVE_NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            level = THREAD_PRIORITY_ABOVE_NORMAL;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;BELOW_NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;            level = THREAD_PRIORITY_BELOW_NORMAL;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        }</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;HIGHEST&quot;</span>) == 0)</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;            level = THREAD_PRIORITY_HIGHEST;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;LOWEST&quot;</span>) == 0)</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        {</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            level = THREAD_PRIORITY_LOWEST;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;        {</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;            level = THREAD_PRIORITY_NORMAL;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;IDLE&quot;</span>) == 0)</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;        {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            level = THREAD_PRIORITY_IDLE;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;TIME_CRITICAL&quot;</span>) == 0)</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;            level = THREAD_PRIORITY_TIME_CRITICAL;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        }</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordtype">int</span> rc = SetPriorityClass(process, iclass);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        rc = SetThreadPriority(thread, (<span class="keywordtype">int</span>)level);</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160; </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordflow">return</span> rc != 0 ? 0 : GetLastError();</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;}</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160; </div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160; </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment">* Function:  SysQueryProcess                                             *</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">* Params:    &quot;PID&quot; - (default) returns current process ID                *</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment">*            &quot;TID&quot; - (default) returns current thread ID                 *</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">*            &quot;PPRIO&quot; - (default) returns current process priority        *</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">*            &quot;TPRIO&quot; - (default) returns current thread priority         *</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment">*            &quot;PTIME&quot; - (default) returns current process times           *</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">*            &quot;TTIME&quot; - (default) returns current thread times            *</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160; </div>
<div class="line"><a name="l02273"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aae0b90d9935f613faa77c01425eafca3"> 2273</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, SysQueryProcess, OPTIONAL_CSTRING, option)</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;{</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    <span class="keywordflow">if</span> (option == NULL || stricmp(option, <span class="stringliteral">&quot;PID&quot;</span>) == 0)</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    {</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <span class="keywordflow">return</span> context-&gt;WholeNumber(GetCurrentProcessId());</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    }</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;TID&quot;</span>) == 0)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keywordflow">return</span> context-&gt;WholeNumber(GetCurrentThreadId());</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;PPRIO&quot;</span>) == 0)</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    {</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        LONG p;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        p = GetPriorityClass(GetCurrentProcess());</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        <span class="keywordflow">switch</span> (p)</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            <span class="keywordflow">case</span> HIGH_PRIORITY_CLASS:</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;HIGH&quot;</span>);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;            <span class="keywordflow">case</span> IDLE_PRIORITY_CLASS:</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;IDLE&quot;</span>);</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;            <span class="keywordflow">case</span> NORMAL_PRIORITY_CLASS:</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;NORMAL&quot;</span>);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <span class="keywordflow">case</span> REALTIME_PRIORITY_CLASS:</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;REALTIME&quot;</span>);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;UNKNOWN&quot;</span>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        }</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    }</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;TPRIO&quot;</span>) == 0)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        LONG p;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        p = GetThreadPriority(GetCurrentThread());</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160; </div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="keywordflow">switch</span> (p)</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        {</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_ABOVE_NORMAL:</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;ABOVE_NORMAL&quot;</span>);</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_BELOW_NORMAL:</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;BELOW_NORMAL&quot;</span>);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_HIGHEST:</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;HIGHEST&quot;</span>);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_IDLE:</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;IDLE&quot;</span>);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_LOWEST:</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;LOWEST&quot;</span>);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_NORMAL:</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;NORMAL&quot;</span>);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_TIME_CRITICAL:</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;TIME_CRITICAL&quot;</span>);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;UNKNOWN&quot;</span>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;        }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;PTIME&quot;</span>) == 0 || stricmp(option, <span class="stringliteral">&quot;TTIME&quot;</span>) == 0)</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    {</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        FILETIME createT, kernelT, userT, dummy;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        SYSTEMTIME createST, kernelST, userST;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        BOOL ok;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        <span class="keywordflow">if</span> (*option == <span class="charliteral">&#39;T&#39;</span> || *option == <span class="charliteral">&#39;t&#39;</span>)</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            ok = GetThreadTimes(GetCurrentThread(), &amp;createT, &amp;dummy, &amp;kernelT, &amp;userT);</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            ok = GetProcessTimes(GetCurrentProcess(), &amp;createT, &amp;dummy, &amp;kernelT, &amp;userT);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        }</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        <span class="keywordflow">if</span> (ok)</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            FileTimeToLocalFileTime(&amp;createT, &amp;createT);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            FileTimeToSystemTime(&amp;createT, &amp;createST);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            FileTimeToSystemTime(&amp;kernelT, &amp;kernelST);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;            FileTimeToSystemTime(&amp;userT, &amp;userST);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;Create: %4.4d/%2.2d/%2.2d %d:%2.2d:%2.2d:%3.3d  &quot;</span>\</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                         <span class="stringliteral">&quot;Kernel: %d:%2.2d:%2.2d:%3.3d  User: %d:%2.2d:%2.2d:%3.3d&quot;</span>,</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                     createST.wYear, createST.wMonth, createST.wDay, createST.wHour, createST.wMinute,</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                     createST.wSecond, createST.wMilliseconds,</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                     kernelST.wHour, kernelST.wMinute, kernelST.wSecond, kernelST.wMilliseconds,</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                     userST.wHour, userST.wMinute, userST.wSecond, userST.wMilliseconds);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160; </div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;}</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">/** SysShutDownSystem()</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment"> *  Interface to the InitiateSystemShutdown() API on Windows.</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment"> *  @param  computer         The name of the computer to shut down.  If omitted</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment"> *                           or the empty string, the local machine is shut</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment"> *                           down.  Otherwise this is the name of a remote</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment"> *                           machine to shut down.</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment"> *  @param  message          If timout is not 0, a shut down dialog is displayed</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment"> *                           on the machine being shut down, naming the user who</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="comment"> *                           initiated the shut down, a timer counting down the</span></div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="comment"> *                           seconds until the machine is shut down, and</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="comment"> *                           prompting the local user to log off. This parametr</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="comment"> *                           can be an additional message to add to the dialog</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment"> *                           box.  It can be ommitted if no additional message</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="comment"> *                           is desired.</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="comment"> *  @param  timeout          Number of seconds to display the shut down dialog.</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment"> *                           If this is 0 no dialog is displayed.  The default</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment"> *                           is 30 seconds, see the remarks below.  The user can</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment"> *                           force a 0 timeout by explicitly specifying 0.</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment"> *  @param  forceAppsClosed  If true applications with unsaved data are forcibly</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment"> *                           closed.  If false, the user is presented with a</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment"> *                           dialog telling the user to close the applcation(s).</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment"> *  @param  reboot           If true, the system is rebooted, if false the</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment"> *                           system is shut down.</span></div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="comment"> *  @remarks Note that prior to 4.0.0, the defaults for all arguments were</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment"> *           exactly what the value of each parameter is if omitted.</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="comment"> *           machine         == NULL</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="comment"> *           message         == NULL</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment"> *           timeout         == 0</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="comment"> *           forceAppsClosed == false</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="comment"> *           reboot          == false</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment"> *           Because of this, there would be no need to check if any argument is</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment"> *           ommitted or not.  However, the consequences of having a 0 timeout</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment"> *           value are severe if the system has an application open with unsaved</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="comment"> *           data.  Therefore for 4.0.0 and on the default time out value is</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment"> *           changed to 30 (seconds.)</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a39b4e0cd06e6572f1e3feee32364cf0d"> 2409</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a082cae7620e7f850ea04d6fe6b15b583">RexxRoutine5</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysShutDownSystem, OPTIONAL_CSTRING, computer, OPTIONAL_CSTRING, message, OPTIONAL_uint32_t, timeout,</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;             OPTIONAL_logical_t, forceAppsClosed, OPTIONAL_logical_t, reboot)</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;{</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> result = 0;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    HANDLE hToken = NULL;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;    TOKEN_PRIVILEGES tkp;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    <span class="comment">// First we get the token for the current process so we can add the proper</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    <span class="comment">// shutdown privilege.</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <span class="keywordflow">if</span> (OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken) == 0)</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    {</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        result = GetLastError();</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <span class="comment">// Get the locally unique identifier for the shutdown privilege we need,</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="comment">// local or remote, depending on what the user specified.</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    LPCTSTR privilegeName = (computer == NULL || *computer == <span class="charliteral">&#39;\0&#39;</span>) ? SE_SHUTDOWN_NAME : SE_REMOTE_SHUTDOWN_NAME;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keywordflow">if</span> (LookupPrivilegeValue(NULL, privilegeName, &amp;tkp.Privileges[0].Luid) == 0)</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        result = GetLastError();</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    }</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="comment">// We are only going to adjust 1 privilege and we are going to enable it.</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    tkp.PrivilegeCount = 1;</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160; </div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="comment">// The return from this function can not accurately be used to determine if</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="comment">// it failed or not.  Instead we need to use GetLastError to determine</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="comment">// success.</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, NULL, 0);</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    result = GetLastError();</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keywordflow">if</span> (result != ERROR_SUCCESS)</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    {</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    }</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="comment">// Do not shut down in 0 seconds by default.</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3))</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    {</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        timeout = 30;</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    <span class="comment">// Now just call the API with the parameters specified by the user.</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    <span class="keywordflow">if</span> (InitiateSystemShutdown((LPSTR)computer, (LPSTR)message, timeout, (BOOL)forceAppsClosed, (BOOL)reboot) == 0)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        result = GetLastError();</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    }</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    <span class="comment">// Finally, restore the shutdown privilege for this process to disabled.</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    tkp.Privileges[0].Attributes = 0;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, NULL, 0);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;done_out:</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;    <span class="keywordflow">if</span> (hToken != NULL)</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        CloseHandle(hToken);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;}</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="comment">* Function:  SysSwitchSession                                            *</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="comment">* Syntax:    result = SysSwitchSession(name)                             *</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="comment">* Params:    name   - name of target session                             *</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="comment">* Return:    OS/2 error return code                                      *</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160; </div>
<div class="line"><a name="l02482"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a43e4c7f2d29926c9770be4294462cd5b"> 2482</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysSwitchSession, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;{</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    HWND hwnd = FindWindow(NULL, name);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160; </div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keywordflow">if</span> (hwnd)</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    {</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="keywordflow">if</span> (!SetForegroundWindow(hwnd))</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        {</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        }</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;}</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">* Function:  SysWaitNamedPipe                                            *</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="comment">* Syntax:    result = SysWaitNamedPipe(name, timeout)                    *</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">* Params:    name - name of the pipe                                     *</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">*            timeout - amount of time to wait.                           *</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="comment">* Return:    Return code from WaitNamedPipe                              *</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; </div>
<div class="line"><a name="l02514"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aeef8636a9372955f145a52d302b43cc6"> 2514</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysWaitNamedPipe, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, OPTIONAL_int, timeout)</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;{</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2))</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    {</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        timeout = NMPWAIT_USE_DEFAULT_WAIT;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    {</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <span class="keywordflow">if</span> (timeout &lt; -1)</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="keywordflow">if</span> (timeout == 0)</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;            timeout = NMPWAIT_USE_DEFAULT_WAIT;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (timeout == -1)</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            timeout = NMPWAIT_WAIT_FOREVER;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    }</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <span class="keywordflow">if</span> (WaitNamedPipe(name, timeout))</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    {</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;}</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160; </div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="comment">* Function:  SysSetFileDateTime                                          *</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="comment">* Syntax:    result = SysSetFileDateTime(filename [,newdate] [,newtime]) *</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="comment">* Params:    filename - name of the file to update                       *</span></div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="comment">*            newdate  - new date to set in format YYYY-MM-DD (YYYY&gt;1800) *</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">*            newtime  - new time to set in format HH:MM:SS               *</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="comment">* Return:    0 - file date/time was updated correctly                    *</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="comment">*            -1 - failure attribute update                               *</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160; </div>
<div class="line"><a name="l02561"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a631f62f37f0f33e152d5a01b3f99b245"> 2561</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#acd43b5fbdb14e98d9f58471edb251f2d">RexxRoutine3</a>(<span class="keywordtype">int</span>, SysSetFileDateTime, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, OPTIONAL_CSTRING, newdate, OPTIONAL_CSTRING, newtime)</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;{</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    BOOL      fOk = FALSE;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    FILETIME  sFileTime;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    FILETIME  sLocalFileTime;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    SYSTEMTIME sLocalSysTime;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160; </div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    <span class="comment">/* open output file for read/write for update */</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    HANDLE setFile = CreateFile(name, GENERIC_WRITE | GENERIC_READ,</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                                FILE_SHARE_READ | FILE_SHARE_WRITE,</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                                NULL, OPEN_EXISTING, FILE_FLAG_WRITE_THROUGH |</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                                FILE_FLAG_BACKUP_SEMANTICS, NULL);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="keywordflow">if</span> (setFile &amp;&amp; (setFile != INVALID_HANDLE_VALUE))</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        fOk = GetFileTime(setFile, NULL, NULL, &amp;sFileTime);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        fOk &amp;= FileTimeToLocalFileTime(&amp;sFileTime, &amp;sLocalFileTime);</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        fOk &amp;= FileTimeToSystemTime(&amp;sLocalFileTime, &amp;sLocalSysTime);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <span class="keywordflow">if</span> (fOk)</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        {</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            <span class="comment">/* file date/time could be read, now parse the new date/time */</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            <span class="keywordflow">if</span> (newdate != NULL)</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                <span class="comment">/* parse new date */</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                <span class="keywordflow">if</span> (sscanf(newdate, <span class="stringliteral">&quot;%4hu-%2hu-%2hu&quot;</span>, &amp;sLocalSysTime.wYear,</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                           &amp;sLocalSysTime.wMonth, &amp;sLocalSysTime.wDay) != 3)</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                {</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                    fOk = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                }</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                <span class="keywordflow">if</span> (sLocalSysTime.wYear &lt; 1800)</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                    fOk = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            }</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;            <span class="keywordflow">if</span> (newtime != NULL)</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;            {</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                <span class="comment">/* parse new time */</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;                <span class="keywordflow">if</span> (sscanf(newtime, <span class="stringliteral">&quot;%2hu:%2hu:%2hu&quot;</span>, &amp;sLocalSysTime.wHour,</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                           &amp;sLocalSysTime.wMinute, &amp;sLocalSysTime.wSecond) != 3)</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;                {</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                    fOk = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                }</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                <span class="comment">// We never receive fractions of seconds.  Set them to zero.</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                sLocalSysTime.wMilliseconds = 0;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            }</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160; </div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            <span class="keywordflow">if</span> (newdate == NULL &amp;&amp; newtime == NULL)</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                <span class="comment">/* we set the timestamp to the current time and date */</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                GetLocalTime(&amp;sLocalSysTime);</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;            }</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;            <span class="keywordflow">if</span> (fOk)</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;            {</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                fOk &amp;= SystemTimeToFileTime(&amp;sLocalSysTime, &amp;sLocalFileTime);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                fOk &amp;= LocalFileTimeToFileTime(&amp;sLocalFileTime, &amp;sFileTime);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                fOk &amp;= SetFileTime(setFile, NULL, NULL, &amp;sFileTime);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            }</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        }</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160; </div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        CloseHandle(setFile);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordflow">return</span> fOk ? 0 : -1;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;}</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160; </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment">* Function:  SysGetFileDateTime                                          *</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment">* Syntax:    result = SysGetFileDateTime(filename [,timesel])            *</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment">* Params:    filename - name of the file to query                        *</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment">*            timesel  - What filetime to query: Created/Access/Write     *</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment">* Return:    -1 - file date/time query failed                            *</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment">*            other - date and time as YYYY-MM-DD HH:MM:SS                *</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160; </div>
<div class="line"><a name="l02639"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ab3cdd81b174125698dc63358463457b6"> 2639</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, SysGetFileDateTime, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, OPTIONAL_CSTRING, selector)</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;{</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <a class="code" href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abcc">SysFileSystem::FiletimeType</a> <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    FILETIME  sFileTime;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    FILETIME  sLocalFileTime;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    SYSTEMTIME sLocalSysTime;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keywordflow">if</span> (selector != NULL)</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    {</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        <span class="keywordflow">switch</span> (selector[0])</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        {</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> = <a class="code" href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abccaa678779f3bc69f5541572003933bbff8">SysFileSystem::FiletimeCreation</a>;</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> = <a class="code" href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abccad79c06211cf80827b55b4c2c8fabc6cb">SysFileSystem::FiletimeAccess</a>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>:</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> = <a class="code" href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abcca273c2df58acf87282d0b252fbc070ea2">SysFileSystem::FiletimeWrite</a>;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;                <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="stringliteral">&quot;SysGetFileDateTime&quot;</span>, <span class="stringliteral">&quot;time selector&quot;</span>, <span class="stringliteral">&quot;&#39;A&#39;, &#39;C&#39;, or &#39;W&#39;&quot;</span>, selector);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    {</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> = <a class="code" href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abcca273c2df58acf87282d0b252fbc070ea2">SysFileSystem::FiletimeWrite</a>;</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    }</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_sys_file_system.html#a3490e7e900234af5810530b9f7fc57af">SysFileSystem::getFiletime</a>(name, <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>, &amp;sFileTime) &amp;&amp;</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        FileTimeToLocalFileTime(&amp;sFileTime, &amp;sLocalFileTime) &amp;&amp;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        FileTimeToSystemTime(&amp;sLocalFileTime, &amp;sLocalSysTime))</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%4d-%02d-%02d %02d:%02d:%02d&quot;</span>,</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                sLocalSysTime.wYear,</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;                sLocalSysTime.wMonth,</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;                sLocalSysTime.wDay,</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                sLocalSysTime.wHour,</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;                sLocalSysTime.wMinute,</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;                sLocalSysTime.wSecond);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;    }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <span class="keywordflow">return</span> context-&gt;WholeNumber(-1);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;}</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; </div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="comment"> * Evaluate a code page argument.  The argument may be a whole number or</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="comment"> * any of the CP_* symbolic code pages that Windows provides or our own</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="comment"> * symbolic code page CONSOLE (the currently set console code page).</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="comment"> * This is used by the SysTo/FromUnicode() functions.</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="comment"> * @param context   The current call context.</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="comment"> * @param cpName    A String that is either a symbolic code page name or a number.</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="comment"> * @param inOrOut   &#39;I&#39; indicating input, or &#39;O&#39; indicating output code page.</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="comment"> * @param function  The calling function (e. g. &quot;SysFromUnicode&quot;) used as</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="comment"> *                  error message insert.</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;<span class="comment"> * @return  Returns the code page number, or raises exception.</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aadeebc656a4c23e2612b7e943211524e"> 2704</a></span>&#160;<span class="keyword">static</span> UINT <a class="code" href="windows_2_sys_rexx_util_8cpp.html#aadeebc656a4c23e2612b7e943211524e">evaluateCodePage</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *context, <span class="keywordtype">char</span> *cpName, <span class="keywordtype">char</span> inOrOut, <span class="keywordtype">char</span> *<span class="keyword">function</span>)</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;{</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="keyword">const</span> UINT CONSOLE = 999000000; <span class="comment">// unique, but different from any code page number</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <span class="keywordtype">char</span>* cpNames[] = { <span class="stringliteral">&quot;OEMCP&quot;</span>,  <span class="stringliteral">&quot;ACP&quot;</span>,  <span class="stringliteral">&quot;UTF8&quot;</span>, <span class="stringliteral">&quot;CONSOLE&quot;</span>,  <span class="stringliteral">&quot;THREAD_ACP&quot;</span>,  <span class="stringliteral">&quot;MACCP&quot;</span>,  <span class="stringliteral">&quot;SYMBOL&quot;</span>,  <span class="stringliteral">&quot;UTF7&quot;</span>, NULL };</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    UINT cpCodes[] = {CP_OEMCP, CP_ACP, CP_UTF8,   CONSOLE, CP_THREAD_ACP, CP_MACCP, CP_SYMBOL, CP_UTF7,  NULL };</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    UINT cpCode = CP_OEMCP;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160; </div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">if</span> (cpName != NULL)</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    {</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <span class="keywordflow">for</span> (i = 0; cpNames[i] != NULL; i++)</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;            <span class="keywordflow">if</span> (_stricmp(cpName, cpNames[i]) == 0)</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;            {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                cpCode = cpCodes[i];</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;            }</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        }</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">if</span> (cpNames[i] == NULL)</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <span class="comment">// No match for any of the symbolic names ... this may be a</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="comment">// numeric code page.  Try to convert to UINT.</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            <span class="keywordtype">long</span> l;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            <span class="keywordtype">char</span> *stop;</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            l = strtol(cpName, &amp;stop, 10);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            <span class="comment">// no left-over characters, not negative, no null string</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            <span class="keywordflow">if</span> (stop[0] == <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; l &gt;= 0 &amp;&amp; l &lt;= 999999999 &amp;&amp; cpName[0] != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            {</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                cpCode = l;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;            }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;            {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="keyword">function</span>, <span class="stringliteral">&quot;codepage&quot;</span>,</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                  <span class="stringliteral">&quot;ACP, CONSOLE, MACCP, OEMCP, SYMBOL, THREAD_ACP, UTF7, UTF8, or a non-negative whole number&quot;</span>,</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                  cpName);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;            }</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cpCode == CONSOLE)</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        {</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            <span class="comment">// For a given Windows installation GetOEMCP() returns a fixed code</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            <span class="comment">// page number which is the initial default for the console, but</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;            <span class="comment">// the CHCP and the MODE command can change this to any arbitrary</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            <span class="comment">// actual console code page.  It seems there is no way to request</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            <span class="comment">// this *current* console code page.  This is why we here define</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            <span class="comment">// our own symbolic code page name CONSOLE which returns</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;            <span class="comment">// GetConsoleCP() or GetConsoleOutputCP().</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            cpCode = inOrOut == <span class="charliteral">&#39;I&#39;</span> ? GetConsoleCP() : GetConsoleOutputCP();</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        }</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    }</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    <span class="keywordflow">return</span> cpCode;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;}</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment"> * Parse and combine a flag argument.</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="comment"> * This is used by the SysTo/FromUnicode() functions.</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="comment"> * @param _string   A string whose words are flag names.</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment"> * @param names     An array of flag name strings.</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment"> * @param values    An array of bit values to combine.</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment"> * @param combined  The returned combined value.</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment"> * @return  Returns NULL upon success, else a pointer to the invalid option.</span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a87d44eb90d0af7ed48cbbb8837109576"> 2767</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a87d44eb90d0af7ed48cbbb8837109576">combineFlags</a>(<a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> _string, <span class="keywordtype">char</span>* names[], DWORD values[], DWORD &amp;combined)</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;{</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <span class="comment">// we need a copy of our string because strtok_s() modifies it</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <span class="keywordtype">char</span> *<span class="keywordtype">string</span> = _string == NULL ? NULL : strdup(_string);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;    <span class="keywordtype">char</span> delimiters[] = <span class="stringliteral">&quot; \t&quot;</span>; <span class="comment">// Rexx allows word delimiters blank or tab</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="keywordtype">char</span> *token, *next;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    combined = 0;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    token = strtok_s(<span class="keywordtype">string</span>, delimiters, &amp;next);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <span class="keywordflow">while</span> (token != NULL)</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        <span class="keywordflow">for</span> (i = 0; names[i] != NULL; i++)</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        {</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            <span class="keywordflow">if</span> (_stricmp(token, names[i]) == 0)</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            {</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                combined |= values[i];</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                token = strtok_s(NULL, delimiters, &amp;next);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            }</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        }</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        <span class="keywordflow">if</span> (names[i] == NULL)</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        {</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;            <span class="keywordflow">return</span> token;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">return</span> token; <span class="comment">// should be always NULL</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;}</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment">/** SysFromUnicode()</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment"> *  Converts a UTF-16 string to a character string in the specified code page.</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment"> *  Interface to the WideCharToMultiByte() API on Windows.</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment"> *  https://learn.microsoft.com/en-us/windows/win32/api/stringapiset/nf-stringapiset-widechartomultibyte</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment"> *  @param  sourceString  The UTF-16 string to be converted.</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment"> *  @param  codePage      An optional code page to be converted to, which can</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment"> *                        be either a number or a symbolic code page name like</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment"> *                        OEMCP.  If omitted, defaults to OEMCP.</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment"> *  @param  mappingFlags  Optional string of mapping flag names.</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment"> *  @param  defaultChar   Optional default character for unmappable characters.</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment"> *                        If omitted, codepage-dependent default is typically &quot;?&quot;.</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment"> *  @param  stem          A stem variable.  Upon successful return these tails</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment"> *                        are set:</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment"> *                        !USEDDEFAULTCHAR  A boolean indicating that the conversion</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"> *                                          found one or more characters in sourceString</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment"> *                                          that cannot be represented in the specified</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment"> *                                          code page.</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment"> *                        !TEXT             The string converted to the code page.</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment"> *  @return  Returns 0 upon success, or a Windows error code from WideCharToMultiByte()</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment"> *  @remarks As older code used mapping flag names ERR_INVALID instead of ERR_INVALID_CHARS</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment"> *           and NO_BEST_FIT instead of NO_BEST_FIT_CHARS, we keep these for now as</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment"> *           undocumented aliases.</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a3677bbc5cb172abb61541687b531f859"> 2824</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a082cae7620e7f850ea04d6fe6b15b583">RexxRoutine5</a>(<span class="keywordtype">int</span>, SysFromUnicode, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, sourceString,</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;             OPTIONAL_CSTRING, codePage, OPTIONAL_CSTRING, mappingFlags,</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;             OPTIONAL_RexxStringObject, defaultChar, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, stem)</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;{</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="comment">// Argument one: sourceString, a UTF-16 string</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    <span class="keywordtype">size_t</span> sourceBytes =  context-&gt;StringLength(sourceString);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="comment">// sourceString length must fit a Windows int and have even length (UTF-16)</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">if</span> (sourceBytes &gt; INT_MAX || sourceBytes % 2 == 1)</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    {</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        <span class="keywordflow">return</span> 87; <span class="comment">// The parameter is incorrect</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    LPCWCH source = (LPCWCH)context-&gt;StringData(sourceString);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keywordtype">int</span> sourceLength = (int)sourceBytes / 2; <span class="comment">// length in UTF-16 units</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="comment">// Argument two: codePage</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    UINT cp = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#aadeebc656a4c23e2612b7e943211524e">evaluateCodePage</a>(context, (<span class="keywordtype">char</span> *)codePage, <span class="charliteral">&#39;O&#39;</span>, <span class="stringliteral">&quot;SysFromUnicode&quot;</span>);</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="comment">// Argument three: mappingFlags</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    DWORD flags = 0;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keywordflow">if</span> (mappingFlags != NULL &amp;&amp; mappingFlags[0] != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    {</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        <span class="keywordtype">char</span>* names[] =  {  <span class="stringliteral">&quot;ERR_INVALID_CHARS&quot;</span>,  <span class="stringliteral">&quot;NO_BEST_FIT_CHARS&quot;</span>,  <span class="stringliteral">&quot;COMPOSITECHECK&quot;</span>,  <span class="stringliteral">&quot;DEFAULTCHAR&quot;</span>,  <span class="stringliteral">&quot;DISCARDNS&quot;</span>,  <span class="stringliteral">&quot;SEPCHARS&quot;</span>,   <span class="stringliteral">&quot;ERR_INVALID&quot;</span>,        <span class="stringliteral">&quot;NO_BEST_FIT&quot;</span>,      NULL};</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        DWORD values[] = {WC_ERR_INVALID_CHARS, WC_NO_BEST_FIT_CHARS, WC_COMPOSITECHECK, WC_DEFAULTCHAR, WC_DISCARDNS, WC_SEPCHARS,  WC_ERR_INVALID_CHARS, WC_NO_BEST_FIT_CHARS, NULL};</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160; </div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;        <span class="keywordtype">char</span> *invalid = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a87d44eb90d0af7ed48cbbb8837109576">combineFlags</a>(mappingFlags, names, values, flags);</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keywordflow">if</span> (invalid != NULL)</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;            <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="stringliteral">&quot;SysFromUnicode&quot;</span>, <span class="stringliteral">&quot;mappingflags&quot;</span>,</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;              <span class="stringliteral">&quot;COMPOSITECHECK, DEFAULTCHAR, DISCARDNS, SEPCHARS, ERR_INVALID_CHARS, or NO_BEST_FIT_CHARS&quot;</span>,</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;              invalid);</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        }</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; </div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="comment">// Argument four: defaultChar, an optional null string or single character</span></div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <span class="comment">// Can be set independently of any COMPOSITECHECK DEFAULTCHAR flags.</span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    LPCCH defaultCh;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="keywordtype">size_t</span> defaultLength = defaultChar == NULL ? 0 : context-&gt;StringLength(defaultChar);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;    <span class="keywordflow">if</span> (defaultLength == 0)</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    {</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        <span class="comment">// When omitted or null string, code page default character is typically &#39;?&#39;</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;        defaultCh = NULL;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    {</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        <span class="comment">// must be a single character</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        <span class="keywordflow">if</span> (defaultLength == 1)</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        {</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;            defaultCh = context-&gt;StringData(defaultChar);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        }</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        {</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;            context-&gt;ThrowException(<a class="code" href="oorexxerrors_8h.html#a2f4267fe115c8b5cbdce8803483e6cd7">Rexx_Error_Incorrect_call_pad</a>,</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;              context-&gt;ArrayOfThree(</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;              context-&gt;String(<span class="stringliteral">&quot;SysFromUnicode&quot;</span>),</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;              context-&gt;String(<span class="stringliteral">&quot;defaultchar&quot;</span>),</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;              defaultChar));</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;        }</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    }</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160; </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="comment">// WideCharToMultiByte can&#39;t handle a null string, but we allow this</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="keywordflow">if</span> (sourceLength == 0)</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    {</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;        context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!TEXT&quot;</span>, context-&gt;NullString());</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!USEDDEFAULTCHAR&quot;</span>, context-&gt;False());</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    }</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160; </div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="comment">// Get the number of bytes required for the destination string</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="keywordtype">int</span> bytes = WideCharToMultiByte(cp, flags, source, sourceLength,</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                  NULL, 0, defaultCh, NULL);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <span class="keywordflow">if</span> (bytes == 0) <span class="comment">// WideCharToMultiByte failed</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    {</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    }</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160; </div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> destination = (<span class="keywordtype">char</span> *)malloc(bytes);</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">if</span> (destination == NULL)</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160; </div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <span class="comment">// Convert source to destination</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    BOOL defaultChUsed = FALSE;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    bytes = WideCharToMultiByte(cp, flags, source, sourceLength,</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;              destination, bytes, defaultCh, &amp;defaultChUsed);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">if</span> (bytes == 0) <span class="comment">// WideCharToMultiByte failed</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    }</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <span class="comment">// set the indicator and the converted string</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!USEDDEFAULTCHAR&quot;</span>, defaultChUsed ? context-&gt;True() : context-&gt;False());</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!TEXT&quot;</span>, context-&gt;String(destination, bytes));</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;}</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="comment">/** SysToUnicode()</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="comment"> *  Converts a character string in the specified code page to a Windows UTF-16 string.</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="comment"> *  Interface to the MultiByteToWideChar() API on Windows.</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;<span class="comment"> *  https://learn.microsoft.com/en-us/windows/win32/api/stringapiset/nf-stringapiset-multibytetowidechar</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment"> *  @param  sourceString  The character string to be converted.</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="comment"> *  @param  codePage      An optional code page to be converted to, which can</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="comment"> *                        be either a number or a symbolic code page name like</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment"> *                        OEMCP.  If omitted, defaults to OEMCP.</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;<span class="comment"> *  @param  mappingFlags  Optional string of mapping flag names.</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment"> *  @param  stem          A stem variable.  Upon successful return this tail is set:</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment"> *                        !TEXT             The converted wide UTF-16 string.</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment"> *  @return  Returns 0 upon success, or a Windows error code from MultiByteToWideChar().</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;<span class="comment"> *  @remarks As older code used mapping flag name ERR_INVALID instead of ERR_INVALID_CHARS</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;<span class="comment"> *           we keep this for now as an undocumented alias.</span></div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02941"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#aadd589d2f5d5c3f7ef602d84482e9972"> 2941</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#ae9bccb40686b9038448e96593c7529c5">RexxRoutine4</a>(<span class="keywordtype">int</span>, SysToUnicode, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, sourceString, OPTIONAL_CSTRING, codePage,</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;             OPTIONAL_CSTRING, mappingFlags, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, stem)</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;{</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    <span class="comment">// Argument one: sourceString</span></div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    <span class="keywordtype">size_t</span> sourceBytes =  context-&gt;StringLength(sourceString);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    <span class="comment">// sourceString length must fit a Windows int</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    <span class="keywordflow">if</span> (sourceBytes &gt; INT_MAX)</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;    {</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <span class="keywordflow">return</span> 87; <span class="comment">// The parameter is incorrect</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    }</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *source = context-&gt;StringData(sourceString);</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordtype">int</span> sourceLength = (int)sourceBytes;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160; </div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;    <span class="comment">// Argument two: codePage</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    UINT cp = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#aadeebc656a4c23e2612b7e943211524e">evaluateCodePage</a>(context, (<span class="keywordtype">char</span> *)codePage, <span class="charliteral">&#39;I&#39;</span>, <span class="stringliteral">&quot;SysToUnicode&quot;</span>);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160; </div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    <span class="comment">// Argument three: mappingFlags</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    DWORD flags = 0;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    <span class="keywordflow">if</span> (mappingFlags != NULL &amp;&amp; mappingFlags[0] != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    {</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="keywordtype">char</span>* names[] =  {  <span class="stringliteral">&quot;COMPOSITE&quot;</span>,  <span class="stringliteral">&quot;ERR_INVALID_CHARS&quot;</span>,  <span class="stringliteral">&quot;ERR_INVALID&quot;</span>,        <span class="stringliteral">&quot;PRECOMPOSED&quot;</span>,  <span class="stringliteral">&quot;USEGLYPHCHARS&quot;</span>, NULL};</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        DWORD values[] = {MB_COMPOSITE, MB_ERR_INVALID_CHARS, MB_ERR_INVALID_CHARS, MB_PRECOMPOSED, MB_USEGLYPHCHARS,  NULL};</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; </div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        <span class="keywordtype">char</span> *invalid = <a class="code" href="windows_2_sys_rexx_util_8cpp.html#a87d44eb90d0af7ed48cbbb8837109576">combineFlags</a>(mappingFlags, names, values, flags);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="keywordflow">if</span> (invalid != NULL)</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;        {</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            <a class="code" href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a>(context, <span class="stringliteral">&quot;SysToUnicode&quot;</span>, <span class="stringliteral">&quot;mappingflags&quot;</span>,</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;              <span class="stringliteral">&quot;COMPOSITE, ERR_INVALID_CHARS, PRECOMPOSED, or USEGLYPHCHARS&quot;</span>,</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;              invalid);</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;        }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;    }</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160; </div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="comment">// MultiByteToWideChar can&#39;t handle a null string, but we allow this</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="keywordflow">if</span> (sourceLength == 0)</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    {</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!TEXT&quot;</span>, context-&gt;NullString());</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    }</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    <span class="comment">// Get the number of wide chars required for the destination string</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="keywordtype">int</span> chars = MultiByteToWideChar(cp, flags, source, sourceLength, NULL, 0);</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="keywordflow">if</span> (chars == 0) <span class="comment">// MultiByteToWideChar failed</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    }</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160; </div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> destination = (<span class="keywordtype">char</span> *)malloc(chars * 2); <span class="comment">// UTF-16 chars</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;    <span class="keywordflow">if</span> (destination == NULL)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;    {</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        <a class="code" href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    }</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160; </div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="comment">// Convert source to destination</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;    chars = MultiByteToWideChar(cp, flags, source, sourceLength, (LPWSTR)(<span class="keywordtype">char</span> *)destination, chars);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <span class="keywordflow">if</span> (chars == 0)</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    {</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <span class="keywordflow">return</span> GetLastError(); <span class="comment">// MultiByteToWideChar failed</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    }</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="comment">// set the converted string</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!TEXT&quot;</span>, context-&gt;String(destination, chars * 2));</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;}</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160; </div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="comment">* Function:  SysWinGetPrinters                                           *</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment">* Syntax:    call SysWinGetPrinters stem.                                *</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="comment">* Params:    stem. - stem to store infos in                              *</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment">* Return:    error number                                                *</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; </div>
<div class="line"><a name="l03017"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a6f9a02e30db93cdaa558e1ee80978c1b"> 3017</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysWinGetPrinters, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, stem)</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;{</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    DWORD realSize = 0;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;    DWORD entries = 0;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    DWORD currentSize = 10 * <span class="keyword">sizeof</span>(PRINTER_INFO_2) * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    <a class="code" href="class_auto_free.html">AutoFree</a> pArray = (<span class="keywordtype">char</span> *)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * currentSize);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160; </div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        <span class="keywordflow">if</span> (pArray == NULL)</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            <a class="code" href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;        }</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160; </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        <span class="keywordflow">if</span> (EnumPrinters(PRINTER_ENUM_LOCAL | PRINTER_ENUM_CONNECTIONS, NULL, 2, (LPBYTE)(<span class="keywordtype">char</span> *)pArray,</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                         currentSize, &amp;realSize, &amp;entries) == 0)</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        {</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            <span class="comment">// this is not a failure if we get ERROR_INSUFFICIENT_BUFFER</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            DWORD rc = GetLastError();</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            <span class="keywordflow">if</span> (rc != ERROR_INSUFFICIENT_BUFFER)</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            {</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;            }</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;        <span class="keywordflow">if</span> (currentSize &gt;= realSize)</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;        {</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        }</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        currentSize = realSize;</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        realSize = 0;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        <span class="comment">// adjust to the new size</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        pArray.realloc(currentSize);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160; </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <a class="code" href="class_stem_handler.html">StemHandler</a> stemVariable(context, stem, 1);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    PRINTER_INFO_2 *pResult = (PRINTER_INFO_2 *)(<span class="keywordtype">char</span> *)pArray;</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160; </div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keywordflow">while</span> (entries--)</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="keywordtype">char</span>  buffer[256];</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        snprintf(buffer, <span class="keyword">sizeof</span>(buffer), <span class="stringliteral">&quot;%s,%s,%s&quot;</span>, pResult[entries].pPrinterName, pResult[entries].pDriverName,</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;                pResult[entries].pPortName);</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        stemVariable.<a class="code" href="class_stem_handler.html#aec707e5f2b9b77459b58bfdca84a2d72">addValue</a>(buffer);</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    stemVariable.<a class="code" href="class_stem_handler.html#a39a740471ea6372a6ead99b990cfb5cc">complete</a>();   <span class="comment">// set the final value</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <span class="keywordflow">return</span> 0;          <span class="comment">// a little reversed...success is false, failure is true</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;}</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="comment">* Function:  SysWinGetDefaultPrinter                                     *</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">* Syntax:    call SysWinGetDefaultPrinter                                *</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">* Return:    string describing default printer                           *</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a8ef26c9474822266233645d082f9529a"> 3076</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">RexxRoutine0</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysWinGetDefaultPrinter)</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;{</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    buffer[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; </div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    GetProfileString(<span class="stringliteral">&quot;Windows&quot;</span>, <span class="stringliteral">&quot;DEVICE&quot;</span>, <span class="stringliteral">&quot;,,,&quot;</span>, buffer, <span class="keyword">sizeof</span>(buffer));</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;    <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;}</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; </div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<span class="comment">* Function:  SysWinSetDefaultPrinter                                     *</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;<span class="comment">* Syntax:    call SysWinSetDefaultPrinter printer                        *</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="comment">* Params:    string describing default printer                           *</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;<span class="comment">* Return:    0 on success, otherwise the OS system error number.         *</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a0d78dbd0e712c5219987d8e2adaeb219"> 3095</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysWinSetDefaultPrinter, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, printer)</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;{</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160; </div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;    <span class="comment">// Two forms of input are allowed.  The old form of</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    <span class="comment">// &quot;Printername,Drivername,Portname&quot; and for W2K or later just the printer</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;    <span class="comment">// name.  Count the commas to determine which form this might be.</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; printer[i] != <span class="charliteral">&#39;\0&#39;</span>; i++)</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    {</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <span class="keywordflow">if</span> (printer[i] == <span class="charliteral">&#39;,&#39;</span>)</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        {</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            count++;</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;        }</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;    }</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160; </div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;    <span class="keywordflow">if</span> (count != 0 &amp;&amp; count != 2)</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;    {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    }</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    SetLastError(0);</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160; </div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;    <span class="keywordflow">if</span> (count == 0)</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    {</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="comment">// This is W2K or later and the user specified just the printer name.</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        <span class="comment">// This code will work on W2K through Vista.</span></div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="keywordflow">if</span> (SetDefaultPrinter(printer) != 0)</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        {</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        }</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        {</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;            <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        }</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;    }</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    {</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        <span class="comment">// The user still specified the old format. Microssoft</span></div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        <span class="comment">// only provides WriteProfileString() for backward compatibility to</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="comment">// 16-bit Windows, and at some point this may no longer be supported.</span></div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;        <span class="comment">// But it still appears to work on XP.</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        <span class="keywordflow">if</span> (WriteProfileString(<span class="stringliteral">&quot;Windows&quot;</span>, <span class="stringliteral">&quot;DEVICE&quot;</span>, printer) == 0)</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        {</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        {</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;            <span class="keywordflow">if</span> (SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, 0L, 0L, SMTO_NORMAL, 1000, NULL) == 0)</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            {</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;                <span class="comment">// If a window just timed out, then GetLastError() will return 0</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;                <span class="comment">// and the user will get the succes code.  If GetLastError()</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;                <span class="comment">// does not return 0, then chances are something really is</span></div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;                <span class="comment">// wrong.</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;            }</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;            {</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;                <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;            }</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;        }</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    }</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;}</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160; </div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160; </div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">* Function:  SysIsFileCompressed                                         *</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="comment">* Syntax:    call SysIsFileCompressed file                               *</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment">* Params:    file - file to check if it is compressed.                   *</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; </div>
<div class="line"><a name="l03169"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a3579dc4be9f084679a66565889917881"> 3169</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileCompressed, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;{</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    DWORD dwAttrs = <a class="code" href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a>(file);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_COMPRESSED);</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;}</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160; </div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">* Function:  SysIsFileEncrypted                                          *</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">* Syntax:    call SysIsFileEncrypted file                                *</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">* Params:    file - file to check if it is Encrypted.                    *</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160; </div>
<div class="line"><a name="l03185"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a459f5f132364b6b6a17252eec76634a2"> 3185</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileEncrypted, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;{</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    DWORD dwAttrs = <a class="code" href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a>(file);</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_ENCRYPTED);</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;}</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160; </div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;<span class="comment">* Function:  SysIsFileNotContentIndexed                                  *</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;<span class="comment">* Syntax:    call SysIsFileNotContentIndexed file                        *</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="comment">* Params:    file - file to check if it is to be indexed by the indexing *</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="comment">*             service.                                                   *</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160; </div>
<div class="line"><a name="l03202"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a83dd54e01bec4d753bb2264ed713ca5a"> 3202</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileNotContentIndexed, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;{</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    DWORD dwAttrs = <a class="code" href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a>(file);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_NOT_CONTENT_INDEXED);</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;}</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160; </div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment">* Function:  SysIsFileOffline                                            *</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;<span class="comment">* Syntax:    call SysIsFileOffline file                                  *</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment">* Params:    file - file to check if it is offline                       *</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160; </div>
<div class="line"><a name="l03218"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ac20f39baa86c48aba1a5e5ec7fbf201e"> 3218</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileOffline, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;{</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    DWORD dwAttrs = <a class="code" href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a>(file);</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_OFFLINE);</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;}</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160; </div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="comment">* Function:  SysIsFileSparse                                             *</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="comment">* Syntax:    call SysIsFileSparse file                                   *</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;<span class="comment">* Params:    file - file to check if it is sparse                        *</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160; </div>
<div class="line"><a name="l03234"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#af4116770bc9802c4c1a0dd79c13355f0"> 3234</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileSparse, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;{</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    DWORD dwAttrs = <a class="code" href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a>(file);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_SPARSE_FILE);</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;}</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160; </div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160; </div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="comment">* Function:  SysIsFileTemporary                                          *</span></div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">* Syntax:    call SysIsFileTemporary file                                *</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="comment">* Params:    file - file to check if it is temporary                     *</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160; </div>
<div class="line"><a name="l03251"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#af77371fb642a542daacf2b53473d66db"> 3251</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileTemporary, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;{</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    DWORD dwAttrs = <a class="code" href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a>(file);</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_TEMPORARY);</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;}</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160; </div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160; </div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment">* Function:  SysGetLongPathName                                          *</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment">*            Converts the specified path to its long form                *</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment">* Syntax:    longPath = SysGetLongPathName(path)                         *</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment">* Params:    path - a path to an existing file                           *</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment">* Return:    longPath - path converted to its long form                  *</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="comment">*                       NULL string if path doesn&#39;t exist or call fails  *</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160; </div>
<div class="line"><a name="l03270"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#a743232cd18cba569a6395b123c6485e2"> 3270</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysGetLongPathName, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, path)</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;{</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    <a class="code" href="class_routine_file_name_buffer.html">RoutineFileNameBuffer</a> longPath(context);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;    DWORD requiredSize = GetLongPathName(path, longPath, (DWORD)longPath.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>());</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    <span class="keywordflow">if</span> (requiredSize == 0)    <span class="comment">// call failed</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;    {</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;    }</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    <span class="comment">// was the buffer too small?</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (requiredSize &gt; longPath.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>())</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    {</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        <span class="comment">// expand and retry (which should succeed this time)</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        longPath.<a class="code" href="class_file_name_buffer.html#a1849cd436b72a73a1424023d82543c54">ensureCapacity</a>(requiredSize);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordflow">if</span> (GetLongPathName(path, longPath, (DWORD)longPath.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>()))</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        {</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;        }</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;    }</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(longPath);</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;}</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160; </div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160; </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;<span class="comment">* Function:  SysGetShortPathName                                         *</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;<span class="comment">*            Converts the specified path to its short form               *</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">* Syntax:    shortPath = SysGetShortPathName(path)                       *</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">* Params:    path - a path to an existing file                           *</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;<span class="comment">* Return:    shortPath - path converted to its short form                *</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;<span class="comment">*                        NULL string if path doesn&#39;t exist or call fails *</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; </div>
<div class="line"><a name="l03305"></a><span class="lineno"><a class="line" href="windows_2_sys_rexx_util_8cpp.html#ae8ad74a783dbf25e635966de2ccbcf04"> 3305</a></span>&#160;<a class="code" href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysGetShortPathName, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, path)</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;{</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <a class="code" href="class_routine_file_name_buffer.html">RoutineFileNameBuffer</a> shortPath(context);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    DWORD requiredSize = GetShortPathName(path, shortPath, (DWORD)shortPath.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>());</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="keywordflow">if</span> (requiredSize == 0)    <span class="comment">// call failed</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    {</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    }</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    <span class="comment">// was the buffer too small?</span></div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (requiredSize &gt; shortPath.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>())</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    {</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        <span class="comment">// expand and retry (which should succeed this time)</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        shortPath.<a class="code" href="class_file_name_buffer.html#a1849cd436b72a73a1424023d82543c54">ensureCapacity</a>(requiredSize);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        <span class="keywordflow">if</span> (GetShortPathName(path, shortPath, (DWORD)shortPath.<a class="code" href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">capacity</a>()))</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;        {</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;            <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        }</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    }</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160; </div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(shortPath);</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;}</div>
<div class="ttc" id="a_file_name_buffer_8hpp_html"><div class="ttname"><a href="_file_name_buffer_8hpp.html">FileNameBuffer.hpp</a></div></div>
<div class="ttc" id="a_rexx_util_common_8hpp_html"><div class="ttname"><a href="_rexx_util_common_8hpp.html">RexxUtilCommon.hpp</a></div></div>
<div class="ttc" id="a_rexx_util_common_8hpp_html_a0d640f916a13ffdbfbc4f73da2dde1ed"><div class="ttname"><a href="_rexx_util_common_8hpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a></div><div class="ttdeci">#define ERROR_RETSTR</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00058">RexxUtilCommon.hpp:58</a></div></div>
<div class="ttc" id="a_rexx_util_common_8hpp_html_a1f0cf79aea937d49702908d656a54b9d"><div class="ttname"><a href="_rexx_util_common_8hpp.html#a1f0cf79aea937d49702908d656a54b9d">invalidOptionException</a></div><div class="ttdeci">void invalidOptionException(RexxCallContext *c, const char *fName, const char *aName, const char *options, const char *actual)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00104">RexxUtilCommon.hpp:104</a></div></div>
<div class="ttc" id="a_rexx_util_common_8hpp_html_a4f46dfcdd706725ac90a4618ce62e4ba"><div class="ttname"><a href="_rexx_util_common_8hpp.html#a4f46dfcdd706725ac90a4618ce62e4ba">maxArgException</a></div><div class="ttdeci">void maxArgException(RexxCallContext *c, const char *fname, size_t max)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00123">RexxUtilCommon.hpp:123</a></div></div>
<div class="ttc" id="a_rexx_util_common_8hpp_html_af1a6ea20fc14e2abb6138f493303e6aa"><div class="ttname"><a href="_rexx_util_common_8hpp.html#af1a6ea20fc14e2abb6138f493303e6aa">outOfMemoryException</a></div><div class="ttdeci">void outOfMemoryException(RexxCallContext *c)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00073">RexxUtilCommon.hpp:73</a></div></div>
<div class="ttc" id="a_utilities_8hpp_html"><div class="ttname"><a href="_utilities_8hpp.html">Utilities.hpp</a></div></div>
<div class="ttc" id="aclass_auto_free_html"><div class="ttname"><a href="class_auto_free.html">AutoFree</a></div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8hpp_source.html#l00068">Utilities.hpp:69</a></div></div>
<div class="ttc" id="aclass_auto_free_html_af59ae599c5fc6e07e0739b7a28fec85a"><div class="ttname"><a href="class_auto_free.html#af59ae599c5fc6e07e0739b7a28fec85a">AutoFree::realloc</a></div><div class="ttdeci">bool realloc(size_t newLen)</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8hpp_source.html#l00093">Utilities.hpp:93</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html"><div class="ttname"><a href="class_file_name_buffer.html">FileNameBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00052">FileNameBuffer.hpp:53</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a0a3478046331fad9da2545fef68ee0f2"><div class="ttname"><a href="class_file_name_buffer.html#a0a3478046331fad9da2545fef68ee0f2">FileNameBuffer::truncate</a></div><div class="ttdeci">void truncate(size_t l)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00104">FileNameBuffer.hpp:104</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a1849cd436b72a73a1424023d82543c54"><div class="ttname"><a href="class_file_name_buffer.html#a1849cd436b72a73a1424023d82543c54">FileNameBuffer::ensureCapacity</a></div><div class="ttdeci">void ensureCapacity(size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8cpp_source.html#l00096">FileNameBuffer.cpp:96</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a55e0508ed640ffb2959816c441d1fb15"><div class="ttname"><a href="class_file_name_buffer.html#a55e0508ed640ffb2959816c441d1fb15">FileNameBuffer::at</a></div><div class="ttdeci">char &amp; at(size_t pos)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00207">FileNameBuffer.hpp:207</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a6491632e5158b477d0a09997dd208aae"><div class="ttname"><a href="class_file_name_buffer.html#a6491632e5158b477d0a09997dd208aae">FileNameBuffer::endsWith</a></div><div class="ttdeci">bool endsWith(char c)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00230">FileNameBuffer.hpp:230</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a6716a194791392dd168bbc37566e652a"><div class="ttname"><a href="class_file_name_buffer.html#a6716a194791392dd168bbc37566e652a">FileNameBuffer::length</a></div><div class="ttdeci">size_t length()</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00071">FileNameBuffer.hpp:71</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_a98c120488abe0a197452c74798336b92"><div class="ttname"><a href="class_file_name_buffer.html#a98c120488abe0a197452c74798336b92">FileNameBuffer::shiftLeft</a></div><div class="ttdeci">void shiftLeft(size_t l)</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00089">FileNameBuffer.hpp:89</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_ac41d5214f15aa74aa580e03ab4c3f9b9"><div class="ttname"><a href="class_file_name_buffer.html#ac41d5214f15aa74aa580e03ab4c3f9b9">FileNameBuffer::capacity</a></div><div class="ttdeci">size_t capacity()</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00070">FileNameBuffer.hpp:70</a></div></div>
<div class="ttc" id="aclass_file_name_buffer_html_ad5f40320218a98a58bd54e54f78dc609"><div class="ttname"><a href="class_file_name_buffer.html#ad5f40320218a98a58bd54e54f78dc609">FileNameBuffer::addFinalPathDelimiter</a></div><div class="ttdeci">void addFinalPathDelimiter()</div><div class="ttdef"><b>Definition:</b> <a href="_file_name_buffer_8hpp_source.html#l00262">FileNameBuffer.hpp:262</a></div></div>
<div class="ttc" id="aclass_routine_file_name_buffer_html"><div class="ttname"><a href="class_routine_file_name_buffer.html">RoutineFileNameBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="_external_file_buffer_8hpp_source.html#l00049">ExternalFileBuffer.hpp:50</a></div></div>
<div class="ttc" id="aclass_routine_qualified_name_html"><div class="ttname"><a href="class_routine_qualified_name.html">RoutineQualifiedName</a></div><div class="ttdef"><b>Definition:</b> <a href="_external_file_buffer_8hpp_source.html#l00133">ExternalFileBuffer.hpp:134</a></div></div>
<div class="ttc" id="aclass_stem_handler_html"><div class="ttname"><a href="class_stem_handler.html">StemHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00168">RexxUtilCommon.hpp:169</a></div></div>
<div class="ttc" id="aclass_stem_handler_html_a2a4a666625998c8d47af8b11b20e4250"><div class="ttname"><a href="class_stem_handler.html#a2a4a666625998c8d47af8b11b20e4250">StemHandler::setStem</a></div><div class="ttdeci">void setStem(RexxObjectPtr stemArgument, int position)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00192">RexxUtilCommon.hpp:192</a></div></div>
<div class="ttc" id="aclass_stem_handler_html_a39a740471ea6372a6ead99b990cfb5cc"><div class="ttname"><a href="class_stem_handler.html#a39a740471ea6372a6ead99b990cfb5cc">StemHandler::complete</a></div><div class="ttdeci">void complete()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00183">RexxUtilCommon.hpp:183</a></div></div>
<div class="ttc" id="aclass_stem_handler_html_abfc8a8321d88b758f77b80d7dea62b08"><div class="ttname"><a href="class_stem_handler.html#abfc8a8321d88b758f77b80d7dea62b08">StemHandler::addList</a></div><div class="ttdeci">void addList(const char *values)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00216">RexxUtilCommon.hpp:216</a></div></div>
<div class="ttc" id="aclass_stem_handler_html_aec707e5f2b9b77459b58bfdca84a2d72"><div class="ttname"><a href="class_stem_handler.html#aec707e5f2b9b77459b58bfdca84a2d72">StemHandler::addValue</a></div><div class="ttdeci">void addValue(const char *value)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00227">RexxUtilCommon.hpp:227</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_1_1_file_attributes_html"><div class="ttname"><a href="class_sys_file_iterator_1_1_file_attributes.html">SysFileIterator::FileAttributes</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00163">unix/SysFileSystem.hpp:164</a></div></div>
<div class="ttc" id="aclass_sys_file_iterator_1_1_file_attributes_html_a7ed1219470ef7b82df4e45d534919928"><div class="ttname"><a href="class_sys_file_iterator_1_1_file_attributes.html#a7ed1219470ef7b82df4e45d534919928">SysFileIterator::FileAttributes::findFileData</a></div><div class="ttdeci">struct stat64 findFileData</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8hpp_source.html#l00166">unix/SysFileSystem.hpp:169</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a027006c7cde375f689293a47d19dc987"><div class="ttname"><a href="class_sys_file_system.html#a027006c7cde375f689293a47d19dc987">SysFileSystem::setCurrentDirectory</a></div><div class="ttdeci">static bool setCurrentDirectory(const char *directory)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01406">unix/SysFileSystem.cpp:1406</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a3490e7e900234af5810530b9f7fc57af"><div class="ttname"><a href="class_sys_file_system.html#a3490e7e900234af5810530b9f7fc57af">SysFileSystem::getFiletime</a></div><div class="ttdeci">static bool getFiletime(const char *name, FiletimeType type, FILETIME *time)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_file_system_8cpp_source.html#l00280">windows/SysFileSystem.cpp:280</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a5285362313e300248657f32b782bc316"><div class="ttname"><a href="class_sys_file_system.html#a5285362313e300248657f32b782bc316">SysFileSystem::getCurrentDirectory</a></div><div class="ttdeci">static bool getCurrentDirectory(FileNameBuffer &amp;directory)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_file_system_8cpp_source.html#l01378">unix/SysFileSystem.cpp:1378</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a66debdc7565b17de5a1b91380701abcc"><div class="ttname"><a href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abcc">SysFileSystem::FiletimeType</a></div><div class="ttdeci">FiletimeType</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_file_system_8hpp_source.html#l00065">windows/SysFileSystem.hpp:66</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a66debdc7565b17de5a1b91380701abcca273c2df58acf87282d0b252fbc070ea2"><div class="ttname"><a href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abcca273c2df58acf87282d0b252fbc070ea2">SysFileSystem::FiletimeWrite</a></div><div class="ttdeci">@ FiletimeWrite</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_file_system_8hpp_source.html#l00068">windows/SysFileSystem.hpp:68</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a66debdc7565b17de5a1b91380701abccaa678779f3bc69f5541572003933bbff8"><div class="ttname"><a href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abccaa678779f3bc69f5541572003933bbff8">SysFileSystem::FiletimeCreation</a></div><div class="ttdeci">@ FiletimeCreation</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_file_system_8hpp_source.html#l00069">windows/SysFileSystem.hpp:69</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a66debdc7565b17de5a1b91380701abccad79c06211cf80827b55b4c2c8fabc6cb"><div class="ttname"><a href="class_sys_file_system.html#a66debdc7565b17de5a1b91380701abccad79c06211cf80827b55b4c2c8fabc6cb">SysFileSystem::FiletimeAccess</a></div><div class="ttdeci">@ FiletimeAccess</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_file_system_8hpp_source.html#l00067">windows/SysFileSystem.hpp:67</a></div></div>
<div class="ttc" id="aclass_sys_file_system_html_a89e8082c949c84a18a95ee7c878122c4"><div class="ttname"><a href="class_sys_file_system.html#a89e8082c949c84a18a95ee7c878122c4">SysFileSystem::getFileAttributes</a></div><div class="ttdeci">static DWORD getFileAttributes(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_file_system_8cpp_source.html#l00247">windows/SysFileSystem.cpp:247</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html">TreeFinder::AttributeMask</a></div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00286">RexxUtilCommon.hpp:287</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_a5fb87e1522bab173290d30788ec40ac2"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#a5fb87e1522bab173290d30788ec40ac2">TreeFinder::AttributeMask::isOff</a></div><div class="ttdeci">bool isOff(AttributeType maskSetting)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00344">RexxUtilCommon.hpp:344</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_a6d86fb819cef6e72f48ed93802261105"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#a6d86fb819cef6e72f48ed93802261105">TreeFinder::AttributeMask::noNewSettings</a></div><div class="ttdeci">bool noNewSettings()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00342">RexxUtilCommon.hpp:342</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_aa29e5b994c007d9917ab07e5dface400a203c715a94b079b916fa4103dddddcd3"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a203c715a94b079b916fa4103dddddcd3">TreeFinder::AttributeMask::System</a></div><div class="ttdeci">@ System</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00296">RexxUtilCommon.hpp:296</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_aa29e5b994c007d9917ab07e5dface400a3b01f776ecb416760a0ea5fdd8dee1c5"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a3b01f776ecb416760a0ea5fdd8dee1c5">TreeFinder::AttributeMask::Hidden</a></div><div class="ttdeci">@ Hidden</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00294">RexxUtilCommon.hpp:294</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_aa29e5b994c007d9917ab07e5dface400a645b95e0883f9124168906e481084a5a"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400a645b95e0883f9124168906e481084a5a">TreeFinder::AttributeMask::Archive</a></div><div class="ttdeci">@ Archive</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00292">RexxUtilCommon.hpp:292</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_aa29e5b994c007d9917ab07e5dface400aa794ef89c775f3c46af6528083f534db"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#aa29e5b994c007d9917ab07e5dface400aa794ef89c775f3c46af6528083f534db">TreeFinder::AttributeMask::ReadOnly</a></div><div class="ttdeci">@ ReadOnly</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00295">RexxUtilCommon.hpp:295</a></div></div>
<div class="ttc" id="aclass_tree_finder_1_1_attribute_mask_html_ae4ef2869106158f1586f8c608a8f8307"><div class="ttname"><a href="class_tree_finder_1_1_attribute_mask.html#ae4ef2869106158f1586f8c608a8f8307">TreeFinder::AttributeMask::isOn</a></div><div class="ttdeci">bool isOn(AttributeType maskSetting)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00343">RexxUtilCommon.hpp:343</a></div></div>
<div class="ttc" id="aclass_tree_finder_html"><div class="ttname"><a href="class_tree_finder.html">TreeFinder</a></div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00260">RexxUtilCommon.hpp:261</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a0fd27652d12f3873955be7d2b48bf50a"><div class="ttname"><a href="class_tree_finder.html#a0fd27652d12f3873955be7d2b48bf50a">TreeFinder::hiddenSelected</a></div><div class="ttdeci">bool hiddenSelected(bool onOff)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00398">RexxUtilCommon.hpp:398</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a167c891316fbc292d7e6f26105aa13b5"><div class="ttname"><a href="class_tree_finder.html#a167c891316fbc292d7e6f26105aa13b5">TreeFinder::filePath</a></div><div class="ttdeci">RoutineFileNameBuffer filePath</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00406">RexxUtilCommon.hpp:406</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a2175a12961ace1d95854fe53f8949491"><div class="ttname"><a href="class_tree_finder.html#a2175a12961ace1d95854fe53f8949491">TreeFinder::nameSpec</a></div><div class="ttdeci">RoutineFileNameBuffer nameSpec</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00410">RexxUtilCommon.hpp:410</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a22df053b3af4a130eaddc8244dc5ceba"><div class="ttname"><a href="class_tree_finder.html#a22df053b3af4a130eaddc8244dc5ceba">TreeFinder::foundFile</a></div><div class="ttdeci">RoutineFileNameBuffer foundFile</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00408">RexxUtilCommon.hpp:408</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a249125a457591ca48c4e74854545799d"><div class="ttname"><a href="class_tree_finder.html#a249125a457591ca48c4e74854545799d">TreeFinder::findDirectoryEnd</a></div><div class="ttdeci">int findDirectoryEnd()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00524">unix/SysRexxUtil.cpp:524</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a2abdc2f7811853ccad04b5f356eb343a"><div class="ttname"><a href="class_tree_finder.html#a2abdc2f7811853ccad04b5f356eb343a">TreeFinder::directorySelected</a></div><div class="ttdeci">bool directorySelected(bool onOff)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00397">RexxUtilCommon.hpp:397</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a2ce515910cf14af9f08937e0468fbfdb"><div class="ttname"><a href="class_tree_finder.html#a2ce515910cf14af9f08937e0468fbfdb">TreeFinder::longSize</a></div><div class="ttdeci">bool longSize()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00394">RexxUtilCommon.hpp:394</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a3739e861f7c64301134ca49ba5869d2b"><div class="ttname"><a href="class_tree_finder.html#a3739e861f7c64301134ca49ba5869d2b">TreeFinder::adjustFileSpec</a></div><div class="ttdeci">void adjustFileSpec()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00346">unix/SysRexxUtil.cpp:346</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a424a025278e4f4b08972a7455f9f5203a0010a17acfe2928791fc8d7b4d2f82d5"><div class="ttname"><a href="class_tree_finder.html#a424a025278e4f4b08972a7455f9f5203a0010a17acfe2928791fc8d7b4d2f82d5">TreeFinder::InvalidFileName</a></div><div class="ttdeci">@ InvalidFileName</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00282">RexxUtilCommon.hpp:282</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a43d0063ee437cb87acaa3fea2cdc31a6"><div class="ttname"><a href="class_tree_finder.html#a43d0063ee437cb87acaa3fea2cdc31a6">TreeFinder::nameOnly</a></div><div class="ttdeci">bool nameOnly()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00391">RexxUtilCommon.hpp:391</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a4d9cf8dc1c33049c938cdaefdd98db67"><div class="ttname"><a href="class_tree_finder.html#a4d9cf8dc1c33049c938cdaefdd98db67">TreeFinder::editableTime</a></div><div class="ttdeci">bool editableTime()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00393">RexxUtilCommon.hpp:393</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a57cfdf98dbb05410b3b63a71dce0d973"><div class="ttname"><a href="class_tree_finder.html#a57cfdf98dbb05410b3b63a71dce0d973">TreeFinder::readOnlySelected</a></div><div class="ttdeci">bool readOnlySelected(bool onOff)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00399">RexxUtilCommon.hpp:399</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a628d2c9340b4a0942353c2dbb4669560"><div class="ttname"><a href="class_tree_finder.html#a628d2c9340b4a0942353c2dbb4669560">TreeFinder::archiveSelected</a></div><div class="ttdeci">bool archiveSelected(bool onOff)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00396">RexxUtilCommon.hpp:396</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a63157a8d75348d96b33c9082cded22f6"><div class="ttname"><a href="class_tree_finder.html#a63157a8d75348d96b33c9082cded22f6">TreeFinder::addResult</a></div><div class="ttdeci">void addResult(const char *v)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8cpp_source.html#l00743">RexxUtilCommon.cpp:743</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a6770f8b247bb95dbc230bb4fd8d18751"><div class="ttname"><a href="class_tree_finder.html#a6770f8b247bb95dbc230bb4fd8d18751">TreeFinder::validateFileSpecName</a></div><div class="ttdeci">void validateFileSpecName()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00358">unix/SysRexxUtil.cpp:358</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a6b9cb316539b42b36237028eb8204951"><div class="ttname"><a href="class_tree_finder.html#a6b9cb316539b42b36237028eb8204951">TreeFinder::adjustDirectory</a></div><div class="ttdeci">void adjustDirectory()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00319">unix/SysRexxUtil.cpp:319</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a725d60133dcfbecc9becd0d5dbd73386"><div class="ttname"><a href="class_tree_finder.html#a725d60133dcfbecc9becd0d5dbd73386">TreeFinder::includeFiles</a></div><div class="ttdeci">bool includeFiles()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00389">RexxUtilCommon.hpp:389</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a74b967bebf1eed8c78641c5b06ab1117"><div class="ttname"><a href="class_tree_finder.html#a74b967bebf1eed8c78641c5b06ab1117">TreeFinder::newAttributes</a></div><div class="ttdeci">AttributeMask newAttributes</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00413">RexxUtilCommon.hpp:413</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_a8b707e007537293ae45be54a8559f766"><div class="ttname"><a href="class_tree_finder.html#a8b707e007537293ae45be54a8559f766">TreeFinder::acceptAll</a></div><div class="ttdeci">bool acceptAll()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00390">RexxUtilCommon.hpp:390</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_aa0b1a5653c7e67d10dcb5ff3c07c6317"><div class="ttname"><a href="class_tree_finder.html#aa0b1a5653c7e67d10dcb5ff3c07c6317">TreeFinder::context</a></div><div class="ttdeci">RexxCallContext * context</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00404">RexxUtilCommon.hpp:404</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_ac6aa592c6bba3d74614e5e112e8339a1"><div class="ttname"><a href="class_tree_finder.html#ac6aa592c6bba3d74614e5e112e8339a1">TreeFinder::includeDirs</a></div><div class="ttdeci">bool includeDirs()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00388">RexxUtilCommon.hpp:388</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_acc73dc32282b020f26cf43f46c1dcdfa"><div class="ttname"><a href="class_tree_finder.html#acc73dc32282b020f26cf43f46c1dcdfa">TreeFinder::fileSpec</a></div><div class="ttdeci">RoutineFileNameBuffer fileSpec</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00407">RexxUtilCommon.hpp:407</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_ad22d76aa47d89fb73cb4e72306fc1dc0"><div class="ttname"><a href="class_tree_finder.html#ad22d76aa47d89fb73cb4e72306fc1dc0">TreeFinder::checkNonPathDrive</a></div><div class="ttdeci">bool checkNonPathDrive()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00370">unix/SysRexxUtil.cpp:370</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_ad888865ea347ad955c445e1159b7a4da"><div class="ttname"><a href="class_tree_finder.html#ad888865ea347ad955c445e1159b7a4da">TreeFinder::foundFileLine</a></div><div class="ttdeci">RoutineFileNameBuffer foundFileLine</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00409">RexxUtilCommon.hpp:409</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_ad89d28086b2df157d93f798864eb47c5"><div class="ttname"><a href="class_tree_finder.html#ad89d28086b2df157d93f798864eb47c5">TreeFinder::checkFile</a></div><div class="ttdeci">void checkFile(SysFileIterator::FileAttributes &amp;attributes)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00477">unix/SysRexxUtil.cpp:477</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_ae868be5e940be0bf3f17477d46a02fff"><div class="ttname"><a href="class_tree_finder.html#ae868be5e940be0bf3f17477d46a02fff">TreeFinder::fixupFilePath</a></div><div class="ttdeci">void fixupFilePath()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00543">unix/SysRexxUtil.cpp:543</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_af7785d090b13f09a44a98f0310ce576e"><div class="ttname"><a href="class_tree_finder.html#af7785d090b13f09a44a98f0310ce576e">TreeFinder::systemSelected</a></div><div class="ttdeci">bool systemSelected(bool onOff)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00400">RexxUtilCommon.hpp:400</a></div></div>
<div class="ttc" id="aclass_tree_finder_html_afbce0a441b278520d2c2843f64ae289e"><div class="ttname"><a href="class_tree_finder.html#afbce0a441b278520d2c2843f64ae289e">TreeFinder::longTime</a></div><div class="ttdeci">bool longTime()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_util_common_8hpp_source.html#l00392">RexxUtilCommon.hpp:392</a></div></div>
<div class="ttc" id="aclass_utilities_html_a0b91888c4169ea518a78ba9de5393c7e"><div class="ttname"><a href="class_utilities.html#a0b91888c4169ea518a78ba9de5393c7e">Utilities::toUpper</a></div><div class="ttdeci">static char toUpper(char c)</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8hpp_source.html#l00052">Utilities.hpp:52</a></div></div>
<div class="ttc" id="aclass_utilities_html_a470770b40ea8bf748ee9a28ec4361852"><div class="ttname"><a href="class_utilities.html#a470770b40ea8bf748ee9a28ec4361852">Utilities::isAlpha</a></div><div class="ttdeci">static bool isAlpha(char c)</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8hpp_source.html#l00049">Utilities.hpp:49</a></div></div>
<div class="ttc" id="acmdparse_8cpp_html_ac765329451135abec74c45e1897abf26"><div class="ttname"><a href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="cmdparse_8cpp_source.html#l01888">cmdparse.cpp:1888</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html"><div class="ttname"><a href="oorexxapi_8h.html">oorexxapi.h</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a15c340ee5245f15f32265d54a1e5a3f5"><div class="ttname"><a href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a></div><div class="ttdeci">#define argumentExists(i)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l04274">oorexxapi.h:4274</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a895bccfb4968ae24b153351beadd50f7"><div class="ttname"><a href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a></div><div class="ttdeci">#define argumentOmitted(i)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l04275">oorexxapi.h:4275</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a2e34ba6b32f03ebefc4a415684900dce"><div class="ttname"><a href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a></div><div class="ttdeci">#define Rexx_Error_Invalid_argument_range</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00464">oorexxerrors.h:464</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a2f4267fe115c8b5cbdce8803483e6cd7"><div class="ttname"><a href="oorexxerrors_8h.html#a2f4267fe115c8b5cbdce8803483e6cd7">Rexx_Error_Incorrect_call_pad</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_call_pad</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00379">oorexxerrors.h:379</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a4d878853d7bdfad5156aaecf60880798"><div class="ttname"><a href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_call_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00392">oorexxerrors.h:392</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_ad12039ea660308581bbab2c0a11db822"><div class="ttname"><a href="oorexxerrors_8h.html#ad12039ea660308581bbab2c0a11db822">Rexx_Error_Invalid_argument_noarg</a></div><div class="ttdeci">#define Rexx_Error_Invalid_argument_noarg</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00458">oorexxerrors.h:458</a></div></div>
<div class="ttc" id="arexx_8h_html_a581e376dc8d3b9132e29014c896b9e70"><div class="ttname"><a href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a></div><div class="ttdeci">const char * CSTRING</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00078">rexx.h:78</a></div></div>
<div class="ttc" id="arexx_8h_html_a6092009977837102d11ed4338f9e93b5"><div class="ttname"><a href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a></div><div class="ttdeci">size_t logical_t</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00238">rexx.h:238</a></div></div>
<div class="ttc" id="arexx_8h_html_a64dfe004825692637e2075467179fcd9"><div class="ttname"><a href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a></div><div class="ttdeci">struct _RexxStringObject * RexxStringObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00134">rexx.h:134</a></div></div>
<div class="ttc" id="arexx_8h_html_a96e0cc5eda42aed364b05f3c493e07e8"><div class="ttname"><a href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a></div><div class="ttdeci">struct _RexxObjectPtr * RexxObjectPtr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00133">rexx.h:133</a></div></div>
<div class="ttc" id="arexx_8h_html_a9a119fa1e31a4af78dee3c12225b240a"><div class="ttname"><a href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a></div><div class="ttdeci">#define NULLOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00155">rexx.h:155</a></div></div>
<div class="ttc" id="arexx_8h_html_aa0199524ada35d939fa20d4625d27d55"><div class="ttname"><a href="rexx_8h.html#aa0199524ada35d939fa20d4625d27d55">wholenumber_t</a></div><div class="ttdeci">ssize_t wholenumber_t</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00237">rexx.h:237</a></div></div>
<div class="ttc" id="arexx_8h_html_af481dd711e94a4b9b636f922b8cfef5c"><div class="ttname"><a href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a></div><div class="ttdeci">struct _RexxStemObject * RexxStemObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00146">rexx.h:146</a></div></div>
<div class="ttc" id="astruct_rexx_call_context___html"><div class="ttname"><a href="struct_rexx_call_context__.html">RexxCallContext_</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l02516">oorexxapi.h:2517</a></div></div>
<div class="ttc" id="aunix_2_sys_rexx_util_8cpp_html_a6a24fbb8516a67c00ceb454e189be4ac"><div class="ttname"><a href="unix_2_sys_rexx_util_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a></div><div class="ttdeci">#define ERROR_NOMEM</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_rexx_util_8cpp_source.html#l00182">unix/SysRexxUtil.cpp:182</a></div></div>
<div class="ttc" id="awindows_2_sys_file_system_8hpp_html"><div class="ttname"><a href="windows_2_sys_file_system_8hpp.html">SysFileSystem.hpp</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a0308273194dd52d866703aaeb65c7604"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a></div><div class="ttdeci">RexxRoutine2(RexxStringObject, SysCurPos, OPTIONAL_stringsize_t, inrow, OPTIONAL_stringsize_t, incol)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00177">windows/SysRexxUtil.cpp:177</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a05ec9ff971191219c0ad575fcba802d5"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a></div><div class="ttdeci">static int ExtendedFlag</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00137">windows/SysRexxUtil.cpp:137</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a082cae7620e7f850ea04d6fe6b15b583"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a082cae7620e7f850ea04d6fe6b15b583">RexxRoutine5</a></div><div class="ttdeci">RexxRoutine5(RexxStringObject, SysTextScreenSize, OPTIONAL_CSTRING, optionString, OPTIONAL_stringsize_t, rows, OPTIONAL_stringsize_t, columns, OPTIONAL_stringsize_t, rows2, OPTIONAL_stringsize_t, columns2)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l01495">windows/SysRexxUtil.cpp:1495</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a14d3f42723fede816efe6de7e9d67ab9"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a14d3f42723fede816efe6de7e9d67ab9">setFileAttributes</a></div><div class="ttdeci">void setFileAttributes(const char *fileName, TreeFinder::AttributeMask &amp;newAttributes)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00666">windows/SysRexxUtil.cpp:666</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a228743a67cab870158881f92e3005581"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a228743a67cab870158881f92e3005581">mergeAttrs</a></div><div class="ttdeci">uint32_t mergeAttrs(TreeFinder::AttributeMask &amp;mask, uint32_t attr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00610">windows/SysRexxUtil.cpp:610</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a35ddb30498f1f07b699af69a5b42ce9d"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a35ddb30498f1f07b699af69a5b42ce9d">formatFileAttributes</a></div><div class="ttdeci">void formatFileAttributes(TreeFinder *finder, FileNameBuffer &amp;foundFile, SysFileIterator::FileAttributes &amp;attributes)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00693">windows/SysRexxUtil.cpp:693</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a379643b4a1b8f467f7de46208cb47b46"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a379643b4a1b8f467f7de46208cb47b46">RexxRoutine0</a></div><div class="ttdeci">RexxRoutine0(int, SysCls)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00148">windows/SysRexxUtil.cpp:148</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a3a569ef5fe00db423924200dc918ad81"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a3a569ef5fe00db423924200dc918ad81">SPECIFIC</a></div><div class="ttdeci">#define SPECIFIC</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00332">windows/SysRexxUtil.cpp:332</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a47277a3785d67b3ec5e850d55cdc6f59"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a></div><div class="ttdeci">RexxRoutine1(int, SysCurState, CSTRING, option)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00224">windows/SysRexxUtil.cpp:224</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a51e5ad9fc6f1e2d4c667198539e0186c"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a51e5ad9fc6f1e2d4c667198539e0186c">checkInclusion</a></div><div class="ttdeci">bool checkInclusion(TreeFinder *finder, uint32_t attr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00776">windows/SysRexxUtil.cpp:776</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a857514d3bc153b3c607aa02430965307"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a857514d3bc153b3c607aa02430965307">MAX_CREATEPROCESS_CMDLINE</a></div><div class="ttdeci">#define MAX_CREATEPROCESS_CMDLINE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l01612">windows/SysRexxUtil.cpp:1612</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a87d44eb90d0af7ed48cbbb8837109576"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a87d44eb90d0af7ed48cbbb8837109576">combineFlags</a></div><div class="ttdeci">static char * combineFlags(CSTRING _string, char *names[], DWORD values[], DWORD &amp;combined)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l02767">windows/SysRexxUtil.cpp:2767</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a9a8e700d56e7d858108b755ad3edb52e"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">FREE</a></div><div class="ttdeci">#define FREE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00331">windows/SysRexxUtil.cpp:331</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_a9ea4a6e038359484e4f837e13931235b"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a></div><div class="ttdeci">static char ExtendedChar</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00138">windows/SysRexxUtil.cpp:138</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_aadeebc656a4c23e2612b7e943211524e"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#aadeebc656a4c23e2612b7e943211524e">evaluateCodePage</a></div><div class="ttdeci">static UINT evaluateCodePage(RexxCallContext *context, char *cpName, char inOrOut, char *function)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l02704">windows/SysRexxUtil.cpp:2704</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_abcd0a22ee4346cad5706adb6d2119429"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a></div><div class="ttdeci">#define USED</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l00330">windows/SysRexxUtil.cpp:330</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_acd43b5fbdb14e98d9f58471edb251f2d"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#acd43b5fbdb14e98d9f58471edb251f2d">RexxRoutine3</a></div><div class="ttdeci">RexxRoutine3(RexxStringObject, SysTextScreenRead, int, row, int, col, OPTIONAL_uint32_t, len)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l01360">windows/SysRexxUtil.cpp:1360</a></div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_ae56fdb340b23940f7a64ed2e37c1774a"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#ae56fdb340b23940f7a64ed2e37c1774a">STATUS_SUCCESS</a></div><div class="ttdeci">#define STATUS_SUCCESS</div></div>
<div class="ttc" id="awindows_2_sys_rexx_util_8cpp_html_ae9bccb40686b9038448e96593c7529c5"><div class="ttname"><a href="windows_2_sys_rexx_util_8cpp.html#ae9bccb40686b9038448e96593c7529c5">RexxRoutine4</a></div><div class="ttdeci">RexxRoutine4(RexxStringObject, SysIni, OPTIONAL_CSTRING, iniFile, CSTRING, app, RexxObjectPtr, key, OPTIONAL_RexxObjectPtr, val)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_sys_rexx_util_8cpp_source.html#l01038">windows/SysRexxUtil.cpp:1038</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a2f338919cf0aa5c3d87df8096b8fa972"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a></div><div class="ttdeci">UINT_PTR uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00050">windows/rexxapitypes.h:50</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a32f2e37ee053cf2ce8ca28d1f74630e5"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00073">windows/rexxapitypes.h:73</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00074">windows/rexxapitypes.h:74</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_aec6fcb673ff035718c238c8c9d544c47"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#aec6fcb673ff035718c238c8c9d544c47">uint64_t</a></div><div class="ttdeci">unsigned __int64 uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00078">windows/rexxapitypes.h:78</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_2dfb7423ce64cb60f62cee208bb73ae3.html">official</a></li><li class="navelem"><a class="el" href="dir_63144926d93644d0b571decfac4c5baa.html">main</a></li><li class="navelem"><a class="el" href="dir_5131a42d519b9b019d5264fc1f0fe4ab.html">trunk</a></li><li class="navelem"><a class="el" href="dir_07b471ff108ade29d714c67783960c47.html">interpreter</a></li><li class="navelem"><a class="el" href="dir_4350e6caeaece7d6e66e745c6bce97c5.html">platform</a></li><li class="navelem"><a class="el" href="dir_d96f3096ceadcf6c85febe967da14f14.html">windows</a></li><li class="navelem"><a class="el" href="windows_2_sys_rexx_util_8cpp.html">SysRexxUtil.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">ooRexx</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
