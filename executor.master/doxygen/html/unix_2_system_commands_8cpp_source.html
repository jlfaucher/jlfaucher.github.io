<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>executor.master: SystemCommands.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('unix_2_system_commands_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">unix/SystemCommands.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="unix_2_system_commands_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2009 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* http://www.oorexx.org/license.html                                         */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/* REXX UNIX  Support                                            aixcmd.c     */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/* AIX specific command processing routines                                   */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/*  aixcmd.c - C methods for handling calls to system exits and subcommand    */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/*             handlers.                                                      */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/*  C methods:                                                                */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/*    SysCommand     - Method to invoke a subcommand handler                  */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/*  Internal routines:                                                        */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/*    sys_command - Run a command through system command processor.           */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span>                         <span class="comment">/* Get strcpy, strcat, etc.       */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;sys/wait.h&gt;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_core_8h.html">RexxCore.h</a>&quot;</span>                         <span class="comment">/* global REXX declarations       */</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_string_class_8hpp.html">StringClass.hpp</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_activity_8hpp.html">RexxActivity.hpp</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_activity_manager_8hpp.html">ActivityManager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="windows_2_system_interpreter_8hpp.html">SystemInterpreter.hpp</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_interpreter_instance_8hpp.html">InterpreterInstance.hpp</a>&quot;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="windows_2_sys_interpreter_instance_8hpp.html">SysInterpreterInstance.hpp</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_internal_apis_8h.html">RexxInternalApis.h</a>&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#include &lt;pwd.h&gt;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a4e6abc272d26e8bdf2960ed9a4ac3048">   73</a></span>&#160;<span class="preprocessor">#define CMDBUFSIZE 1024                     </span><span class="comment">/* Max size of executable cmd     */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a0ad0666a1726541270e5b2a3594f242c">   74</a></span>&#160;<span class="preprocessor">#define MAX_COMMAND_ARGS 400</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#if defined(AIX)</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#define CMDDEFNAME &quot;/bin/ksh&quot;</span>               <span class="comment">/* Korn shell is default for AIX */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#elif defined(OPSYS_SUN)                        </span><span class="comment">/*  path for AIX        */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#define CMDDEFNAME &quot;/bin/sh&quot;</span>                <span class="comment">/* Bourne Again Shell is default */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#else                                       </span><span class="comment">/* shell for Linux               */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a1a79969713bde49c13f1df2aecffc4f4">   81</a></span>&#160;<span class="preprocessor">#define CMDDEFNAME &quot;/bin/bash&quot;</span>              <span class="comment">/* Bourne Again Shell is default */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#ac5f4cf1c989af592617184f7a7e5c372">   84</a></span>&#160;<span class="preprocessor">#define UNKNOWN_COMMAND 127                 </span><span class="comment">/* unknown command return code    */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a0a85173c80294c4f706b3f0c4007a654">   86</a></span>&#160;<span class="preprocessor">#define SYSENV &quot;command&quot;</span>                    <span class="comment">/* Default cmd environment        */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a0db8a9b5ad5a66e4adc36d0ba68735c8">   87</a></span>&#160;<span class="preprocessor">#define SHELL  &quot;SHELL&quot;</span>                      <span class="comment">/* UNIX cmd handler env. var. name*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#ab21f8ef3ba992efc1eda405bccdde69a">   88</a></span>&#160;<span class="preprocessor">#define EXPORT_FLAG 1</span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a7abab620880927f796581747ae3719c0">   89</a></span>&#160;<span class="preprocessor">#define SET_FLAG    2</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">   90</a></span>&#160;<span class="preprocessor">#define UNSET_FLAG  3</span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a4ce3e2af80a76d816ab7f8567ec4a65a">   91</a></span>&#160;<span class="preprocessor">#define MAX_VALUE   1280</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="unix_2_system_commands_8cpp.html#a06571931bd9663e2d27ef4f33e0c7229">putflag</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * Retrieve the globally default initial address.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * @return The string name of the default address.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_system_interpreter.html#a7740c59653d2ea0c7599477d458d554a">  101</a></span>&#160;<a class="code" href="class_rexx_string.html">RexxString</a> *<a class="code" href="class_system_interpreter.html#a7740c59653d2ea0c7599477d458d554a">SystemInterpreter::getDefaultAddressName</a>()</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> OREF_INITIALADDRESS;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">/* Handle &quot;export&quot; command in same process */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#afe75207bfad29f881c9baf126b9ac7a0">  107</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="unix_2_system_commands_8cpp.html#afe75207bfad29f881c9baf126b9ac7a0">sys_process_export</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> * cmd, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> &amp;rc, <span class="keywordtype">int</span> flag)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">char</span> *Env_Var_String = NULL;         <span class="comment">/* Environment variable string for   */</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">size_t</span> size, allocsize;              <span class="comment">/* size of the string                */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordtype">char</span>      **Environment;             <span class="comment">/* environment pointer               */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">char</span>  *np;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">size_t</span> i,j,k,l,iLength, copyval;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">char</span>   namebufcurr[1281];             <span class="comment">/* buf for extracted name            */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">char</span>   cmd_name[1281];                <span class="comment">/* name of the envvariable setting   */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">char</span>   *array, *runarray, *runptr, *endptr, *maxptr;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordtype">char</span>   temparray[1281];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *st;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">char</span>  *tmpptr;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">char</span>   name[1281];                    <span class="comment">/* is the name + value + =           */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">char</span>   value[1281];                   <span class="comment">/* is the part behind =              */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">char</span>  *del = NULL;                    <span class="comment">/* ptr to old unused memory          */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">char</span>  *hit = NULL;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">bool</span>   HitFlag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    l = 0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    j = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    allocsize = 1281 * 2;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    memset(temparray, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(temparray));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    Environment = <a class="code" href="unix_2_platform_definitions_8h.html#a393e32c1a85bf6da7aed6908633924bf">getEnvironment</a>();       <span class="comment">/* get the environment               */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (flag == <a class="code" href="unix_2_system_commands_8cpp.html#ab21f8ef3ba992efc1eda405bccdde69a">EXPORT_FLAG</a>)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        st = &amp;cmd[6];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flag == <a class="code" href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">UNSET_FLAG</a>)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        st = &amp;cmd[5];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        st = &amp;cmd[3];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">while</span> ((*st) &amp;&amp; (*st == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        st++;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    strcpy(name, st);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    iLength = strlen(st) + 1;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/* if string == EXPORT_FLAG or string == SET and only blanks are delivered */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> ( ((flag == <a class="code" href="unix_2_system_commands_8cpp.html#ab21f8ef3ba992efc1eda405bccdde69a">EXPORT_FLAG</a>) || (flag == <a class="code" href="unix_2_system_commands_8cpp.html#a7abab620880927f796581747ae3719c0">SET_FLAG</a>)) &amp;&amp;  (iLength == 1) )</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="unix_2_system_commands_8cpp.html#a06571931bd9663e2d27ef4f33e0c7229">putflag</a>)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {                        <span class="comment">/* first change in the environment ? */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">/* copy all entries to dynamic memory                                   */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">for</span> (;*Environment != NULL; Environment++)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {                                  <span class="comment">/*for all entries in the env         */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            size = strlen(*Environment)+1;   <span class="comment">/* get the size of the string        */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            Env_Var_String = (<span class="keywordtype">char</span> *)malloc(size); <span class="comment">/* and alloc space for it      */</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            memcpy(Env_Var_String,*Environment,size);<span class="comment">/* copy the string           */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            putenv(Env_Var_String);          <span class="comment">/* and chain it in                   */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="unix_2_system_commands_8cpp.html#a06571931bd9663e2d27ef4f33e0c7229">putflag</a> = 1;                         <span class="comment">/* prevent do it again               */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    Environment = <a class="code" href="unix_2_platform_definitions_8h.html#a393e32c1a85bf6da7aed6908633924bf">getEnvironment</a>();      <span class="comment">/* reset the environment pointer     */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/* do we have a assignment operator? If not return true           */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/* The operating system treads this like no command, and so do we */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> ( !(strchr(name, <span class="charliteral">&#39;=&#39;</span>)) &amp;&amp; (flag != <a class="code" href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">UNSET_FLAG</a>) ) <span class="comment">/*only set and export */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">/* we do not have a assignment operator, but maybe a &#39;|&#39; for a    */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">/* controlled output                                              */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> ( (strchr(name, <span class="charliteral">&#39;|&#39;</span>))  || (strchr(name, <span class="charliteral">&#39;&gt;&#39;</span>)) || (strstr(name, <span class="stringliteral">&quot;&gt;&gt;&quot;</span>)) )</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="comment">// this worked ok (well, sort of)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            rc = context-&gt;False();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">/* no &#39;=&#39; for unset, so force a shell error message               */</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> ( (strchr(name, <span class="charliteral">&#39;=&#39;</span>)) &amp;&amp; (flag == <a class="code" href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">UNSET_FLAG</a>) )</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">for</span> (i=0;(name[i]!=<span class="charliteral">&#39;=&#39;</span>)&amp;&amp;(i&lt;iLength);i++)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        cmd_name[i] = name[i];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">/* lets try handling variables in the assignment string */</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    cmd_name[i]  = <span class="charliteral">&#39;\0&#39;</span>;                <span class="comment">/* copy the terminator           */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    i++;                                <span class="comment">/* the place after&#39;=&#39; */</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">/* lets search the value for variable part(s)  */</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    strcpy(value, &amp;(name[i]));         <span class="comment">/* value contains the part behind &#39;=&#39; */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    array = (<span class="keywordtype">char</span> *) malloc(1281);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    strcpy(array, cmd_name);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    array[strlen(cmd_name)] = <span class="charliteral">&#39;=&#39;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    array[i] = <span class="charliteral">&#39;\0&#39;</span>;                   <span class="comment">/* copy the terminator           */</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    runarray = array + strlen(array);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    runptr = value;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    endptr = runptr + strlen(value);   <span class="comment">/*this is the end of the input*/</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    maxptr = array + <a class="code" href="unix_2_system_commands_8cpp.html#a4ce3e2af80a76d816ab7f8567ec4a65a">MAX_VALUE</a> -1;     <span class="comment">/* this is the end of our new string */</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">while</span> ((tmpptr = (strchr(runptr, <span class="charliteral">&#39;$&#39;</span>))) != 0)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        Environment = <a class="code" href="unix_2_platform_definitions_8h.html#a393e32c1a85bf6da7aed6908633924bf">getEnvironment</a>();  <span class="comment">/* get the beginning of the environment*/</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        HitFlag = <span class="keyword">true</span>;          <span class="comment">/* if not true inputvalue= outputvalue*/</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        copyval = tmpptr - runptr;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (copyval)   <span class="comment">/* runarray should keep the &#39;real&#39; environment  */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">while</span> ((runarray + copyval) &gt;  maxptr)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                array = (<span class="keywordtype">char</span> *) realloc(array, allocsize);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                runarray = array + strlen(array);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                maxptr = array + allocsize - 1;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                allocsize = allocsize * 2;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            memcpy(runarray,runptr, copyval);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            runarray= runarray + copyval; <span class="comment">/* a new place to copy */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            *runarray = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            runptr = tmpptr;              <span class="comment">/* now runptr is at the place of $ */</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        runptr++;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span> (j = 0;(*runptr != <span class="charliteral">&#39;/&#39;</span>) &amp;&amp; (*runptr != <span class="charliteral">&#39;:&#39;</span>) &amp;&amp; (*runptr != <span class="charliteral">&#39;$&#39;</span>) &amp;&amp;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            (*runptr); j++)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            memcpy(&amp;(temparray[j]), runptr,1); <span class="comment">/*temparray is the env var to search*/</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            runptr++;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        temparray[j] = <span class="charliteral">&#39;\0&#39;</span>;                <span class="comment">/* lets see what we can do    */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        np = NULL;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">for</span> (;(*Environment != NULL) &amp;&amp; (hit == NULL) ;Environment++)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            np = *Environment;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">for</span> (k=0;(*np!=<span class="charliteral">&#39;=&#39;</span>)&amp;&amp;(k&lt;255);np++,k++)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                memcpy(&amp;(namebufcurr[k]),np,1);  <span class="comment">/* copy the character                */</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            namebufcurr[k] = <span class="charliteral">&#39;\0&#39;</span>;                 <span class="comment">/* copy the terminator           */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span> (!strcmp(temparray,namebufcurr))     <span class="comment">/* have a match ?         */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                hit = *Environment;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">/* copy value to new string*/</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">if</span> (hit) <span class="comment">/* if we have found an entry of the env var in the env list */</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            np ++;                  <span class="comment">/* don&#39;t copy equal                     */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">while</span> ((runarray + strlen(np)) &gt;  maxptr)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                array = (<span class="keywordtype">char</span> *) realloc(array, allocsize);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                runarray = array + strlen(array);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                maxptr = array + allocsize - 1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                allocsize = allocsize * 2;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            strcpy(runarray, np);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            runarray = runarray + strlen(np);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            *runarray = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            hit = NULL;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (HitFlag == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (runptr &lt; endptr)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">while</span> ((runarray + strlen(runptr)) &gt;  maxptr)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                array = (<span class="keywordtype">char</span> *) realloc(array, allocsize);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                runarray = array + strlen(array);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                maxptr = array + allocsize - 1;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                allocsize = allocsize * 2;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            strcpy(runarray, runptr);      <span class="comment">/* if there is a part after a var */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            runarray = runarray + strlen(runptr);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            *runarray = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">else</span>   <span class="comment">/* no hit so lets copy the value as it is                     */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">while</span> ((runarray + strlen(value)) &gt;  maxptr)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            array = (<span class="keywordtype">char</span> *) realloc(array, allocsize);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            runarray = array + strlen(array);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            maxptr = array + allocsize - 1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            allocsize = allocsize * 2;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        strcpy(runarray,value);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        runarray = runarray + strlen(runptr);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        *runarray = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    Environment = <a class="code" href="unix_2_platform_definitions_8h.html#a393e32c1a85bf6da7aed6908633924bf">getEnvironment</a>();     <span class="comment">/* get the beginning of the environment*/</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">for</span> (;*Environment != NULL;Environment++)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        np = *Environment;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">for</span> (i=0;(*np!=<span class="charliteral">&#39;=&#39;</span>)&amp;&amp;(i&lt;255);np++,i++)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            memcpy(&amp;(namebufcurr[i]),np,1);  <span class="comment">/* copy the character                */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        namebufcurr[i] = <span class="charliteral">&#39;\0&#39;</span>;                 <span class="comment">/* copy the terminator          */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (!strcmp(cmd_name,namebufcurr))<span class="comment">/* have a match ?         */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            del = *Environment;              <span class="comment">/* remember it for deletion          */</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">/* find the entry in the environ     */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span> (flag != <a class="code" href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">UNSET_FLAG</a>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        size = strlen(array)+1;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        Env_Var_String = (<span class="keywordtype">char</span> *)malloc(size);<span class="comment">/* get the memory                    */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        memcpy(Env_Var_String, array, size);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordtype">int</span> errCode = putenv(Env_Var_String);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> (errCode != 0)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="comment">// non-zero is an error condition</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, context-&gt;String(cmd), NULL, context-&gt;WholeNumberToObject(errCode));</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            rc = context-&gt;False();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (del)                              <span class="comment">/* if there was a old one            */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        free(del);                         <span class="comment">/* free it                           */</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    rc = context-&gt;False();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">/* Returns a copy of s without quotes. Escaped characters are kept unchanged */</span></div>
<div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">  361</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="unix_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">unquote</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> ( s == NULL )</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">size_t</span> size = strlen(s) + 1;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordtype">char</span> *unquoted = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*size);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span> ( unquoted == NULL )</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">char</span> *u = unquoted;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordtype">char</span> c;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordtype">bool</span> escape = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        c = *s;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">if</span> ( escape )</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            *u++ = *s;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            escape = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c == <span class="charliteral">&#39;\\&#39;</span> )</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            escape = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c != <span class="charliteral">&#39;&quot;&#39;</span> )</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            *u++ = *s;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        s++;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">while</span> ( c != <span class="charliteral">&#39;\0&#39;</span> );</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span> unquoted;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">/* Handle &quot;cd XXX&quot; command in same process */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#ac644acf87026e9c7444b19cc91cf9656">  400</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="unix_2_system_commands_8cpp.html#ac644acf87026e9c7444b19cc91cf9656">sys_process_cd</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> * cmd, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> rc)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;{</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * st;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *home_dir = NULL;            <span class="comment">/* home directory path        */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordtype">char</span> *dir_buf = NULL;             <span class="comment">/* full directory path        */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *slash;                      <span class="comment">/* ptr to &#39;/&#39;                 */</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">struct </span>passwd *ppwd;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    st = &amp;cmd[2];</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">while</span> ((*st) &amp;&amp; (*st == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        st++;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> ((!*st) || (strlen(cmd) == 2))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        home_dir = getenv(<span class="stringliteral">&quot;HOME&quot;</span>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">if</span> (!home_dir)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        dir_buf = (<span class="keywordtype">char</span> *)malloc(strlen(home_dir)+1);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        strcpy(dir_buf, home_dir);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }                                  <span class="comment">/* if no user name            */</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(st) == <span class="charliteral">&#39;~&#39;</span> &amp;&amp; (*(st+1) == <span class="charliteral">&#39;\0&#39;</span> || *(st+1) == <span class="charliteral">&#39;/&#39;</span>|| *(st+1) == <span class="charliteral">&#39; &#39;</span> ))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">if</span> (*(st+1) == <span class="charliteral">&#39;/&#39;</span>)              <span class="comment">/* if there is a path         */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            st +=2;                        <span class="comment">/* jump over &#39;~/&#39;             */</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                           <span class="comment">/* get home directory path    */</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            home_dir = getenv(<span class="stringliteral">&quot;HOME&quot;</span>);     <span class="comment">/* from the environment       */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">if</span> (!home_dir)                  <span class="comment">/* if no home dir info        */</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <span class="comment">/* get space for the buf      */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordtype">size_t</span> size = strlen(home_dir)+strlen(st)+2;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            dir_buf = (<span class="keywordtype">char</span> *)malloc(size);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">if</span> (!dir_buf)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="comment">/* merge the strings          */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            snprintf(dir_buf, size, <span class="stringliteral">&quot;%s/%s&quot;</span>, home_dir, st);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="comment">/* get home directory path    */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            home_dir = getenv(<span class="stringliteral">&quot;HOME&quot;</span>);     <span class="comment">/* from the environment       */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                           <span class="comment">/* get space for the buf      */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordtype">size_t</span> size = strlen(home_dir)+2;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            dir_buf = (<span class="keywordtype">char</span> *)malloc(size);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">if</span> (!dir_buf)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            snprintf(dir_buf, size, <span class="stringliteral">&quot;%s/&quot;</span>, home_dir);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*(st) == <span class="charliteral">&#39;~&#39;</span>)             <span class="comment">/* cmd is &#39;~username...&#39;      */</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        st++;                            <span class="comment">/* jump over &#39;~&#39;              */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        slash = strchr(st,<span class="charliteral">&#39;/&#39;</span>);          <span class="comment">/* search for &#39;/&#39;             */</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> (!slash)                      <span class="comment">/* if no &#39;/&#39;                  */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="comment">/* rest of string is username */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            ppwd = getpwnam(st);           <span class="comment">/* get info about the user    */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">if</span> (ppwd == NULL || ppwd-&gt;pw_dir == NULL)</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                           <span class="comment">/* get space for the buf      */</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <span class="keywordtype">size_t</span> size = strlen(ppwd-&gt;pw_dir)+2;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            dir_buf = (<span class="keywordtype">char</span> *)malloc(size);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">if</span> (!dir_buf)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="comment">/* merge the strings          */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            snprintf(dir_buf, size, <span class="stringliteral">&quot;%s/&quot;</span>, ppwd-&gt;pw_dir);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">else</span>                            <span class="comment">/* there is a slash           */</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordtype">char</span> username[256];            <span class="comment">// need to copy the user name</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            memcpy(username, st, slash - st);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            username[slash - st] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            ppwd = getpwnam(username);     <span class="comment">/* get info about the user    */</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">if</span> (ppwd == NULL || ppwd-&gt;pw_dir == NULL)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            slash++;                       <span class="comment">/* step over the slash        */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                           <span class="comment">/* get space for the buf      */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <span class="keywordtype">size_t</span> size = strlen(ppwd-&gt;pw_dir)+strlen(slash)+2;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            dir_buf = (<span class="keywordtype">char</span> *)malloc(size);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <span class="keywordflow">if</span> (!dir_buf)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="comment">/* merge the strings          */</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            snprintf(dir_buf, size, <span class="stringliteral">&quot;%s/%s&quot;</span>, ppwd-&gt;pw_dir, slash);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        dir_buf = strdup(st);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">char</span> *unquoted = <a class="code" href="unix_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">unquote</a>(dir_buf);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (unquoted == NULL)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordtype">int</span> errCode = chdir(unquoted);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    free(unquoted);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    free(dir_buf);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">if</span> (errCode != 0)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// non-zero is an error condition</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, context-&gt;String(cmd), NULL, context-&gt;WholeNumberToObject(errCode));</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        rc = context-&gt;False();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">/* This function breaks a command up into whitespace-delimited pieces*/</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/* to create the pointer array for the execvp call.  It is only used */</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/* to support the &quot;COMMAND&quot; command environment, which does not use  */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">/* a shell to invoke its commands.                                   */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#a6e294c33bff4537c84c93249b96cece4">  537</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="unix_2_system_commands_8cpp.html#a6e294c33bff4537c84c93249b96cece4">scan_cmd</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *parm_cmd, <span class="keywordtype">char</span> **argPtr)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;{</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">char</span> *cmd = strdup(parm_cmd);        <span class="comment">/* Allocate for copy          */</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordtype">char</span> *end = cmd + strlen(cmd);       <span class="comment">/* Find the end of the command*/</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">/* This loop scans our copy of the command, setting pointers in    */</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">/* the args[] array to point to each of the arguments, and null-   */</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="comment">/* terminating each one of them.                                   */</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">/* LOOP INVARIANT:                                                 */</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">/* pos points to the next character of the command to be examined. */</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">/* i indicates the next element of the args[] array to be loaded.  */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordtype">size_t</span> i = 0;                               <span class="comment">/* Start with args[0]         */</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">char</span> *pos = cmd; pos &lt; end; pos++)</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">while</span> (*pos==<span class="charliteral">&#39; &#39;</span> || *pos==<span class="charliteral">&#39;\t&#39;</span>)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            pos++;                           <span class="comment">/* Skip to first non-white    */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">if</span> (*pos == <span class="charliteral">&#39;\0&#39;</span>)                  <span class="comment">/* If we&#39;re at the end,       */</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">break</span>;                           <span class="comment">/* get out.                   */</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">/* If at this point, we&#39;ve used up all but one of the available  */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <span class="comment">/* elements of our args[] array, let the user know, and we must  */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="comment">/* terminate.                                                    */</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">if</span> (i == <a class="code" href="unix_2_system_commands_8cpp.html#a0ad0666a1726541270e5b2a3594f242c">MAX_COMMAND_ARGS</a>)</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        argPtr[i++] = pos;                 <span class="comment">/* Point to current argument  */</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                           <span class="comment">/* and advance i to next      */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                           <span class="comment">/* element of args[]          */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">while</span> (*pos!=<span class="charliteral">&#39; &#39;</span> &amp;&amp; *pos!=<span class="charliteral">&#39;\t&#39;</span> &amp;&amp; *pos!=<span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            pos++;                           <span class="comment">/* Look for next whitespace   */</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        }                                  <span class="comment">/* or end of command          */</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        *pos = <span class="charliteral">&#39;\0&#39;</span>;                       <span class="comment">/* Null-terminate this arg    */</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">/* Finally, put a null pointer in args[] to indicate the end.      */</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    argPtr[i] = NULL;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">/* Name:       sys_command                                                    */</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">/* Arguments:  cmd - Command to be executed                                   */</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">/*             local_env_type - integer indicating which shell                */</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">/* Returned:   rc - Return Code                                               */</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">/* Notes:      Handles processing of a system command.                        */</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">/*             Uses the &#39;fork&#39; and &#39;exec&#39; system calls to create a new process*/</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">/*             and invoke the shell indicated by the local_env_type argument. */</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">/*             This is modeled after command handling done in Classic REXX.   */</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00600"></a><span class="lineno"><a class="line" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">  600</a></span>&#160;<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> address, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> command)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;{</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd = context-&gt;StringData(command);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *envName = context-&gt;StringData(address);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> rc = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">/* check for redirection symbols, ignore them when enclosed in double quotes.</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">       escaped quotes are ignored. */</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">bool</span> noDirectInvoc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">bool</span> inQuotes = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">bool</span> escape = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">for</span> (i = 0; i&lt;strlen(cmd); i++)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">if</span> (escape)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            escape = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd[i] == <span class="charliteral">&#39;\\&#39;</span>)</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            escape = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmd[i] == <span class="charliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            inQuotes = !inQuotes;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="comment">/* if we&#39;re in the unquoted part and the current character is one of */</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="comment">/* the redirection characters or the &amp; for multiple commands then we */</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="comment">/* will no longer try to invoke the command directly                 */</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">if</span> (!inQuotes &amp;&amp; (strchr(<span class="stringliteral">&quot;&lt;&gt;|&amp;&quot;</span>, cmd[i]) != NULL))</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                noDirectInvoc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> (!noDirectInvoc)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="comment">/* execute &#39;cd&#39; in the same process */</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordtype">size_t</span> commandLen = strlen(cmd);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="keywordflow">if</span> (strcmp(cmd, <span class="stringliteral">&quot;cd&quot;</span>) == 0)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="unix_2_system_commands_8cpp.html#ac644acf87026e9c7444b19cc91cf9656">sys_process_cd</a>(context, cmd, rc))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (commandLen &gt;= 3)</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordtype">char</span> tmp[16];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            strncpy(tmp, cmd, 3);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            tmp[3] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;cd &quot;</span>,tmp) == 0)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="unix_2_system_commands_8cpp.html#ac644acf87026e9c7444b19cc91cf9656">sys_process_cd</a>(context, cmd, rc))</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            strncpy(tmp, cmd, 4);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            tmp[4] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <span class="keywordflow">if</span> (strcmp(<span class="stringliteral">&quot;set &quot;</span>,tmp) == 0)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="unix_2_system_commands_8cpp.html#afe75207bfad29f881c9baf126b9ac7a0">sys_process_export</a>(context, cmd, rc, <a class="code" href="unix_2_system_commands_8cpp.html#a7abab620880927f796581747ae3719c0">SET_FLAG</a>)) <span class="comment">/*unset works fine for me*/</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            strncpy(tmp, cmd, 6);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            tmp[6] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;unset &quot;</span>, tmp) == 0)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="unix_2_system_commands_8cpp.html#afe75207bfad29f881c9baf126b9ac7a0">sys_process_export</a>(context, cmd, rc, <a class="code" href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">UNSET_FLAG</a>))</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            strncpy(tmp, cmd, 7);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            tmp[7] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;export &quot;</span>, tmp) == 0)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="unix_2_system_commands_8cpp.html#afe75207bfad29f881c9baf126b9ac7a0">sys_process_export</a>(context, cmd, rc, <a class="code" href="unix_2_system_commands_8cpp.html#ab21f8ef3ba992efc1eda405bccdde69a">EXPORT_FLAG</a>))</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">    /****************************************************************************/</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">/* Invoke the system command handler to execute the command                 */</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">    /****************************************************************************/</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// if this is the null string, then use the default address environment</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="comment">// for the platform</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (strlen(envName) == 0)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        envName = <a class="code" href="unix_2_platform_definitions_8h.html#af79ec3c590d0c25b220387f30cc70f87">SYSINITIALADDRESS</a>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">int</span> errCode = 0;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="preprocessor">#ifdef LINUX</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// JLF : I don&#39;t know why a special case is made to call system()</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="comment">// But something sure : it&#39;s wrong to call system() when the passed address is &quot;bash&quot;.</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// Since system() delegates always to /bin/sh, the only acceptable address is &quot;sh&quot;.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;sh&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        errCode = system( cmd );</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordflow">if</span> ( errCode &gt;= 256 )</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            errCode = errCode / 256;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordtype">int</span> pid = fork();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordtype">int</span> status;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="keywordflow">if</span> (pid != 0)                         <span class="comment">/* spawn a child process to run the  */</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            waitpid ( pid, &amp;status, 0);          <span class="comment">/* command and wait for it to finish */</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="keywordflow">if</span> (WIFEXITED(status))               <span class="comment">/* If cmd process ended normal       */</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                                 <span class="comment">/* Give &#39;em the exit code            */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                errCode = WEXITSTATUS(status);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">else</span>                              <span class="comment">/* Else process died ugly, so        */</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                errCode = -(WTERMSIG(status));</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="keywordflow">if</span> (errCode == 1)                    <span class="comment">/* If process was stopped            */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    errCode = -1;                   <span class="comment">/* Give &#39;em a -1.                    */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        {                                <span class="comment">/* run the command in the child      */</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;sh&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                execl(<span class="stringliteral">&quot;/bin/sh&quot;</span>, <span class="stringliteral">&quot;sh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, cmd, NULL);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;ksh&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                execl(<span class="stringliteral">&quot;/bin/ksh&quot;</span>, <span class="stringliteral">&quot;ksh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, cmd, NULL);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;bsh&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                execl(<span class="stringliteral">&quot;/bin/bsh&quot;</span>, <span class="stringliteral">&quot;bsh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, cmd, NULL);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;csh&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                execl(<span class="stringliteral">&quot;/bin/csh&quot;</span>, <span class="stringliteral">&quot;csh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, cmd, NULL);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;bash&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                execl(<span class="stringliteral">&quot;/bin/bash&quot;</span>, <span class="stringliteral">&quot;bash&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, cmd, NULL);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a>(<span class="stringliteral">&quot;cmd&quot;</span>, envName) == 0)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordtype">char</span> * args[<a class="code" href="unix_2_system_commands_8cpp.html#a0ad0666a1726541270e5b2a3594f242c">MAX_COMMAND_ARGS</a>+1];      <span class="comment">/* Array for argument parsing */</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="unix_2_system_commands_8cpp.html#a6e294c33bff4537c84c93249b96cece4">scan_cmd</a>(cmd, args))             <span class="comment">/* Parse cmd into arguments  */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    exit(1);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                execvp(args[0], args);           <span class="comment">/* Invoke command directly   */</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                perror(<span class="stringliteral">&quot; *E* Address COMMAND&quot;</span>);  <span class="comment">/* If we get to this point,  */</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                exit(1);                         <span class="comment">/* we couldn&#39;t run the       */</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                execl(<span class="stringliteral">&quot;/bin/sh&quot;</span>, <span class="stringliteral">&quot;sh&quot;</span>, <span class="stringliteral">&quot;-c&quot;</span>, cmd, NULL);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// unknown command code?</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (errCode == <a class="code" href="unix_2_system_commands_8cpp.html#ac5f4cf1c989af592617184f7a7e5c372">UNKNOWN_COMMAND</a>)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="comment">// failure condition</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;FAILURE&quot;</span>, context-&gt;String(cmd), NULL, context-&gt;WholeNumberToObject(errCode));</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errCode != 0)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">// non-zero is an error condition</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, context-&gt;String(cmd), NULL, context-&gt;WholeNumberToObject(errCode));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">return</span> context-&gt;False();      <span class="comment">// zero return code</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;}</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"> * Register the standard system command handlers.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> * @param instance The created instance.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="class_sys_interpreter_instance.html#a7b868224b41c0f61b943bf04987a7d12">  801</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_sys_interpreter_instance.html#a7b868224b41c0f61b943bf04987a7d12">SysInterpreterInstance::registerCommandHandlers</a>(<a class="code" href="class_interpreter_instance.html">InterpreterInstance</a> *_instance)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;{</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">// Unix has a whole collection of similar environments, services by a single handler</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;COMMAND&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;SH&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;KSH&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;CSH&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;BSH&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    _instance-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;BASH&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;}</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="ttc" id="a_activity_manager_8hpp_html"><div class="ttname"><a href="_activity_manager_8hpp.html">ActivityManager.hpp</a></div></div>
<div class="ttc" id="a_interpreter_instance_8hpp_html"><div class="ttname"><a href="_interpreter_instance_8hpp.html">InterpreterInstance.hpp</a></div></div>
<div class="ttc" id="a_rexx_activity_8hpp_html"><div class="ttname"><a href="_rexx_activity_8hpp.html">RexxActivity.hpp</a></div></div>
<div class="ttc" id="a_rexx_core_8h_html"><div class="ttname"><a href="_rexx_core_8h.html">RexxCore.h</a></div></div>
<div class="ttc" id="a_rexx_internal_apis_8h_html"><div class="ttname"><a href="_rexx_internal_apis_8h.html">RexxInternalApis.h</a></div></div>
<div class="ttc" id="a_string_class_8hpp_html"><div class="ttname"><a href="_string_class_8hpp.html">StringClass.hpp</a></div></div>
<div class="ttc" id="aclass_interpreter_instance_html"><div class="ttname"><a href="class_interpreter_instance.html">InterpreterInstance</a></div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_instance_8hpp_source.html#l00055">InterpreterInstance.hpp:56</a></div></div>
<div class="ttc" id="aclass_interpreter_instance_html_a8e5cdb7cf93d6cdcf8ceda46d4e13d50"><div class="ttname"><a href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">InterpreterInstance::addCommandHandler</a></div><div class="ttdeci">void addCommandHandler(const char *name, const char *registeredName)</div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_instance_8cpp_source.html#l00779">InterpreterInstance.cpp:779</a></div></div>
<div class="ttc" id="aclass_rexx_string_html"><div class="ttname"><a href="class_rexx_string.html">RexxString</a></div><div class="ttdef"><b>Definition:</b> <a href="_string_class_8hpp_source.html#l00122">StringClass.hpp:122</a></div></div>
<div class="ttc" id="aclass_sys_interpreter_instance_html_a7b868224b41c0f61b943bf04987a7d12"><div class="ttname"><a href="class_sys_interpreter_instance.html#a7b868224b41c0f61b943bf04987a7d12">SysInterpreterInstance::registerCommandHandlers</a></div><div class="ttdeci">void registerCommandHandlers(InterpreterInstance *i)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00801">unix/SystemCommands.cpp:801</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_a7740c59653d2ea0c7599477d458d554a"><div class="ttname"><a href="class_system_interpreter.html#a7740c59653d2ea0c7599477d458d554a">SystemInterpreter::getDefaultAddressName</a></div><div class="ttdeci">static RexxString * getDefaultAddressName()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00101">unix/SystemCommands.cpp:101</a></div></div>
<div class="ttc" id="aclass_utilities_html_a99155cc671bfd7846467c1a7fdc7fe80"><div class="ttname"><a href="class_utilities.html#a99155cc671bfd7846467c1a7fdc7fe80">Utilities::strCaselessCompare</a></div><div class="ttdeci">static int strCaselessCompare(const char *opt1, const char *opt2)</div><div class="ttdef"><b>Definition:</b> <a href="_utilities_8cpp_source.html#l00102">Utilities.cpp:102</a></div></div>
<div class="ttc" id="arexx_8h_html_a64dfe004825692637e2075467179fcd9"><div class="ttname"><a href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a></div><div class="ttdeci">struct _RexxStringObject * RexxStringObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00128">rexx.h:128</a></div></div>
<div class="ttc" id="arexx_8h_html_a96e0cc5eda42aed364b05f3c493e07e8"><div class="ttname"><a href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a></div><div class="ttdeci">struct _RexxObjectPtr * RexxObjectPtr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00127">rexx.h:127</a></div></div>
<div class="ttc" id="arexx_8h_html_a9a119fa1e31a4af78dee3c12225b240a"><div class="ttname"><a href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a></div><div class="ttdeci">#define NULLOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00147">rexx.h:147</a></div></div>
<div class="ttc" id="arexx_8h_html_aec9d4b9410c6f3c46bcceec8c16e253d"><div class="ttname"><a href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a></div><div class="ttdeci">#define RexxEntry</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00235">rexx.h:235</a></div></div>
<div class="ttc" id="astruct_rexx_exit_context___html"><div class="ttname"><a href="struct_rexx_exit_context__.html">RexxExitContext_</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l02970">oorexxapi.h:2971</a></div></div>
<div class="ttc" id="aunix_2_platform_definitions_8h_html_a393e32c1a85bf6da7aed6908633924bf"><div class="ttname"><a href="unix_2_platform_definitions_8h.html#a393e32c1a85bf6da7aed6908633924bf">getEnvironment</a></div><div class="ttdeci">char ** getEnvironment()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_platform_definitions_8h_source.html#l00136">unix/PlatformDefinitions.h:136</a></div></div>
<div class="ttc" id="aunix_2_platform_definitions_8h_html_af79ec3c590d0c25b220387f30cc70f87"><div class="ttname"><a href="unix_2_platform_definitions_8h.html#af79ec3c590d0c25b220387f30cc70f87">SYSINITIALADDRESS</a></div><div class="ttdeci">#define SYSINITIALADDRESS</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_platform_definitions_8h_source.html#l00125">unix/PlatformDefinitions.h:125</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_a06571931bd9663e2d27ef4f33e0c7229"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#a06571931bd9663e2d27ef4f33e0c7229">putflag</a></div><div class="ttdeci">int putflag</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_external_functions_8cpp_source.html#l00116">unix/ExternalFunctions.cpp:116</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_a0ad0666a1726541270e5b2a3594f242c"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#a0ad0666a1726541270e5b2a3594f242c">MAX_COMMAND_ARGS</a></div><div class="ttdeci">#define MAX_COMMAND_ARGS</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00074">unix/SystemCommands.cpp:74</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_a4ce3e2af80a76d816ab7f8567ec4a65a"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#a4ce3e2af80a76d816ab7f8567ec4a65a">MAX_VALUE</a></div><div class="ttdeci">#define MAX_VALUE</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00091">unix/SystemCommands.cpp:91</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_a6e294c33bff4537c84c93249b96cece4"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#a6e294c33bff4537c84c93249b96cece4">scan_cmd</a></div><div class="ttdeci">bool scan_cmd(const char *parm_cmd, char **argPtr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00537">unix/SystemCommands.cpp:537</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_a775cad78401f7d77c12a07e9a042eb7e"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">unquote</a></div><div class="ttdeci">char * unquote(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00361">unix/SystemCommands.cpp:361</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_a7abab620880927f796581747ae3719c0"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#a7abab620880927f796581747ae3719c0">SET_FLAG</a></div><div class="ttdeci">#define SET_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00089">unix/SystemCommands.cpp:89</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_ab21f8ef3ba992efc1eda405bccdde69a"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#ab21f8ef3ba992efc1eda405bccdde69a">EXPORT_FLAG</a></div><div class="ttdeci">#define EXPORT_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00088">unix/SystemCommands.cpp:88</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_ac5f4cf1c989af592617184f7a7e5c372"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#ac5f4cf1c989af592617184f7a7e5c372">UNKNOWN_COMMAND</a></div><div class="ttdeci">#define UNKNOWN_COMMAND</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00084">unix/SystemCommands.cpp:84</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_ac644acf87026e9c7444b19cc91cf9656"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#ac644acf87026e9c7444b19cc91cf9656">sys_process_cd</a></div><div class="ttdeci">bool sys_process_cd(RexxExitContext *context, const char *cmd, RexxObjectPtr rc)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00400">unix/SystemCommands.cpp:400</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_afb2d8ac3e06eeeb0b38d31e9623cc375"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a></div><div class="ttdeci">RexxObjectPtr RexxEntry systemCommandHandler(RexxExitContext *context, RexxStringObject address, RexxStringObject command)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00600">unix/SystemCommands.cpp:600</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_afe75207bfad29f881c9baf126b9ac7a0"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#afe75207bfad29f881c9baf126b9ac7a0">sys_process_export</a></div><div class="ttdeci">bool sys_process_export(RexxExitContext *context, const char *cmd, RexxObjectPtr &amp;rc, int flag)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00107">unix/SystemCommands.cpp:107</a></div></div>
<div class="ttc" id="aunix_2_system_commands_8cpp_html_afee2154093e69c309aa3029e78030812"><div class="ttname"><a href="unix_2_system_commands_8cpp.html#afee2154093e69c309aa3029e78030812">UNSET_FLAG</a></div><div class="ttdeci">#define UNSET_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00090">unix/SystemCommands.cpp:90</a></div></div>
<div class="ttc" id="aunix_2rexxapitypes_8h_html_a5212c3741a3e463415430503c49e2147"><div class="ttname"><a href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a></div><div class="ttdeci">void * REXXPFN</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxapitypes_8h_source.html#l00064">unix/rexxapitypes.h:64</a></div></div>
<div class="ttc" id="awindows_2_sys_interpreter_instance_8hpp_html"><div class="ttname"><a href="windows_2_sys_interpreter_instance_8hpp.html">SysInterpreterInstance.hpp</a></div></div>
<div class="ttc" id="awindows_2_system_interpreter_8hpp_html"><div class="ttname"><a href="windows_2_system_interpreter_8hpp.html">SystemInterpreter.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_8b29bd360d363874c010699c0e4edfe4.html">executor</a></li><li class="navelem"><a class="el" href="dir_b12c9cdd073ecc75d378afe044a8807c.html">sandbox</a></li><li class="navelem"><a class="el" href="dir_6f8e204b311fad1e21be914fb6af8fc9.html">jlf</a></li><li class="navelem"><a class="el" href="dir_4796bfee7d29ff8f3ba63e631cf48035.html">trunk</a></li><li class="navelem"><a class="el" href="dir_568b253ddbf98cea92a6c65945d41c59.html">interpreter</a></li><li class="navelem"><a class="el" href="dir_d4404b4bd34c68f45870030da437ebcb.html">platform</a></li><li class="navelem"><a class="el" href="dir_c5b765be06ecfa97e7fb91623525a542.html">unix</a></li><li class="navelem"><a class="el" href="unix_2_system_commands_8cpp.html">SystemCommands.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">executor.master</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
