<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>executor.master: rexxutil.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('windows_2rexxutil_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">windows/rexxutil.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="windows_2rexxutil_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2017 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* http://www.oorexx.org/license.html                                         */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/* REXX Windows Support                                          rexxutil.c   */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/* Windows system utility functions                                           */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/**********************************************************************</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">*   This program extends the REXX language by providing many          *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">*   REXX external functions.                                          *</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">*   These functions are:                                              *</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">*       SysCls              -- Clear the screen in an OS/2 fullscreen *</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">*                              or windowed command prompt session.    *</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">*       SysCurPos           -- Set and/or Query the cursor position   *</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">*       SysCurState         -- Make the cursor visible or invisible   *</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">*       SysDriveInfo        -- Returns information about a specific   *</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">*                              drive.                                 *</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">*       SysDriveMap         -- Returns a list of the drives on the    *</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">*                              machine                                *</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">*       SysDropFuncs        -- Makes all functions in this package    *</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">*                              unknown to REXX.                       *</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">*       SysFileDelete       -- Deletes a file                         *</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">*       SysFileSearch       -- Searches for a file matching a given   *</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">*                              filespec.                              *</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">*       SysFileTree         -- Searches for files matching a given    *</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">*                              filespec, including files in           *</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">*                              subdirectories.                        *</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">*       SysGetKey           -- Returns one by of data indicating the  *</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">*                              key which was pressed,                 *</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">*       SysIni              -- Reads and/or updates entries in .INI   *</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">*                              files.                                 *</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">*       SysLoadFuncs        -- Makes all functions in this package    *</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">*                              known to REXX so REXX programs may     *</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">*                              call them.                             *</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">*       SysMkDir            -- Creates a directory                    *</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">*       SysWinVer           -- Returns the Win OS and Version number  *</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">*       SysVersion          -- Returns the OS and Version number      *</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">*       SysRmDir            -- Removes a directory                    *</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">*       SysSearchPath       -- Searches throught a specified path     *</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">*                              for a file.                            *</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*       SysSleep            -- Suspends execution for a number of     *</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">*                              seconds and milliseconds.              *</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*       SysTempFilename     -- Creates a unique filename              *</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">*       SysTextScreenRead   -- Reads characters from the screen,      *</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">*       SysTextScreenSize   -- Returns the size of the window in      *</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">*                              rows and columns,                      *</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">*                              in an OS/2 fullscreen or windowed      *</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">*                              command prompt session.                *</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">*       SysWaitNamedPipe    -- Wait on a named pipe.                  *</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">*       SysRegisterObjectClass -- Register a new object class         *</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">*       SysDeregisterObjectClass -- Remove class registration         *</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">*       SysQueryClassList   -- Get list of registered classes         *</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">*       SysCreateObject     -- Create an object instance              *</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">*       SysDestroyObject    -- Delete an object instance              *</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">*       SysSetObjectData    -- Change object settings data            *</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">*       SysBootDrive        -- Return the windows boot drive          *</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">*       SysSystemDirectory  -- Return the Windows system directory    *</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">*       SysQueryEAList      -- Return list of file EA names           *</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">*       SysWildCard         -- Perform file wild card editting        *</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">*       SysFileSystemType   -- Return drive file system type          *</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*       SysVolumeLabel      -- Return the drive label                 *</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">*       SysAddFileHandle    -- Add file handles to a process          *</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">*       SysSetFileHandle    -- Set file handles for a process         *</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">*       SysCreateMutexSem   -- Create a Mutex semaphore               *</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">*       SysOpenMutexSem     -- Open a Mutex semaphore                 *</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">*       SysCloseMutexSem    -- Close a Mutex semaphore                *</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">*       SysRequestMutexSem  -- Request a Mutex semaphore              *</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">*       SysReleaseMutexSem  -- Release a Mutex semaphore              *</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">*       SysCreateEventSem   -- Create an Event semaphore              *</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">*       SysOpenEventSem     -- Open an Event semaphore                *</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">*       SysCloseEventSem    -- Close an Event semaphore               *</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">*       SysPostEventSem     -- Post an Event semaphore                *</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">*       SysPulseEventSem    -- Post and reset an Event semaphore      *</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">*       SysResetEventSem    -- Reset an Event semaphore               *</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">*       SysWaitEventSem     -- Wait on an Event semaphore             *</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">*       SysProcessType      -- Return type of process                 *</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">*       SysSetPriority      -- Set current thread priority            *</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">*       SysGetCollate       -- Get country/codepage collating sequence*</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">*       SysNationalLanguageCompare -- NLS strict compare              *</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*       SysMapCase          -- NLS uppercasing                        *</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">*       SysSetProcessCodePage -- Set current code page                *</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">*       SysQueryProcessCodePage -- Get current code page              *</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">*       SysAddRexxMacro     -- Load program into macro space          *</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">*       SysDropRexxMacro    -- Drop program from macro space          *</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">*       SysReorderRexxMacro -- Reorder program in macro space         *</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">*       SysQueryRexxMacro   -- Query ordering of macro space program  *</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">*       SysClearRexxMacroSpace -- Remove all programs from macro space*</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*       SysLoadRexxMacroSpace  -- Load a Rexx macro space             *</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">*       SysSaveRexxMacroSpace  -- Save a Rexx macro space             *</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">*       SysShutDownSystem   -- Shutdown the system                    *</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">*       SysSwitchSession    -- Switch to a named session              *</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*       SysDropLibrary      -- Drop a function package                *</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">*       SysQueryProcess     -- Get information on current proc/thread *</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">*       SysDumpVariables    -- Dump current variables to a file       *</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">*       SysSetFileDateTime  -- Set the last modified date of a file   *</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*       SysGetFileDateTime  -- Get the last modified date of a file   *</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">*       SysStemSort         -- sort a stem array                      *</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">*       SysStemDelete       -- delete items in a stem array           *</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">*       SysStemInsert       -- insert items into a stem array         *</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">*       SysStemCopy         -- copy items from one stem array to other*</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">*       SysUtilVersion      -- query version of REXXUTIL.DLL          *</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">*       SysWinFileEncrypt   -- Encrypt file on a W2K-NTFS             *</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">*       SysWinFileDecrypt   -- Decrypt file on a W2K-NTFS             *</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">*       SysGetErrortext     -- Retrieve textual desc. of error number *</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">*       SysWinGetDefaultPrinter -- retrieve default printer           *</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">*       SysWinGetPrinters   -- Obtain list of local printers          *</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">*       SysWinSetDefaultPrinter -- set the local default printer      *</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">*       SysFileCopy         -- Copy files on the file system          *</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">*       SysFileMove         -- Move / Rename files or directories     *</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">*       SysIsFile           -- Check for the existance of a file      *</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">*       SysIsFileDirectory  -- Check for the existance of a directory *</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">*       SysIsFileLink       -- Check for the existance of a link      *</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">*       SysIsFileCompressed   -- Check for a file to be compressed    *</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">*       SysIsFileEncrypted    -- Check for a file to be encrypted     *</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">*       SysIsFileNotContentIndexed -- Check if a file should be indexed *</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">*       SysIsFileOffline    -- Check if a file is offline             *</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">*       SysIsFileSparse     -- Check if a file is sparse              *</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*       SysIsFileTemporary  -- Check if a file is temporary           *</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">**********************************************************************/</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">/* Include files */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oorexxapi_8h.html">oorexxapi.h</a>&quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#include &lt;memory.h&gt;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#include &lt;ctype.h&gt;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#include &lt;conio.h&gt;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">#include &lt;limits.h&gt;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#include &lt;shlwapi.h&gt;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span>                      <span class="comment">// isnan(), HUGE_VAL</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a47ea672db15c78539388264846c5fba7">  182</a></span>&#160;<span class="preprocessor">#define OM_WAKEUP (WM_USER+10)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;VOID CALLBACK <a class="code" href="windows_2rexxutil_8cpp.html#a563a9eb1cdb33946ea9a942899b0b09a">SleepTimerProc</a>( HWND, UINT, UINT, DWORD);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/*  Various definitions used by various functions.                   */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a2c7e82e1bec284185fd7e657a6d1e144">  189</a></span>&#160;<span class="preprocessor">#define MAX_LABEL      13              </span><span class="comment">/* max label length (sdrvinfo)*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a001791a21d538b8b9176287ae60d9b61">  190</a></span>&#160;<span class="preprocessor">#define MAX_DIGITS     9               </span><span class="comment">/* max digits in numeric arg  */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">  191</a></span>&#160;<span class="preprocessor">#define MAX            264             </span><span class="comment">/* temporary buffer length    */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a26f71277f565e460c73f60a89c8c57e6">  192</a></span>&#160;<span class="preprocessor">#define IBUF_LEN       4096            </span><span class="comment">/* Input buffer length        */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a02706310c2be4fc4b66273d8e08bcebd">  193</a></span>&#160;<span class="preprocessor">#define MAX_READ       0x10000         </span><span class="comment">/* full segment of buffer     */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a1801a4e55bb24535c0e7605f8da5f037">  194</a></span>&#160;<span class="preprocessor">#define CH_EOF         0x1A            </span><span class="comment">/* end of file marker         */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8bfc2021af2e7e6fbf2228a180d815a9">  195</a></span>&#160;<span class="preprocessor">#define CH_CR          &#39;\r&#39;            </span><span class="comment">/* carriage return character  */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0b05abb761c82a2935cf47ac557f164b">  196</a></span>&#160;<span class="preprocessor">#define CH_NL          &#39;\n&#39;            </span><span class="comment">/* new line character         */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a578a524920b6c339c439d1b515caccaf">  197</a></span>&#160;<span class="preprocessor">#define AllocFlag      PAG_COMMIT | PAG_WRITE  </span><span class="comment">/* for DosAllocMem    */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa0404bdc143b8c96d8f09f38be3de977">  198</a></span>&#160;<span class="preprocessor">#define RNDFACTOR      1664525L</span></div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ac8e587038055e4f6b6674d01d0b99058">  199</a></span>&#160;<span class="preprocessor">#define MAX_ENVVAR     1024</span></div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a09a3b394b8602092d58347b791158062">  200</a></span>&#160;<span class="preprocessor">#define MAX_LINE_LEN   4096            </span><span class="comment">/* max line length            */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a857514d3bc153b3c607aa02430965307">  201</a></span>&#160;<span class="preprocessor">#define MAX_CREATEPROCESS_CMDLINE (32 * 1024)</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/*  Defines used by SysDriveMap                                      */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">  207</a></span>&#160;<span class="preprocessor">#define  USED           0</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">  208</a></span>&#160;<span class="preprocessor">#define  FREE           1</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5e22cbe91a4d63890d01dd36e7a1c373">  209</a></span>&#160;<span class="preprocessor">#define  CDROM          2</span></div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a62ca51b78468397b2ef98ee55a5e6e2a">  210</a></span>&#160;<span class="preprocessor">#define  REMOTE         3</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3758dd5d300a594312c95bc393378df0">  211</a></span>&#160;<span class="preprocessor">#define  LOCAL          4</span></div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a6ba3cd3a913e871f79c104129cb9ceb3">  212</a></span>&#160;<span class="preprocessor">#define  RAMDISK        5</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aac1f74a2a44349000b99fe6511e7a04f">  213</a></span>&#160;<span class="preprocessor">#define  REMOVABLE      6</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">/* Defines uses by SysTree                                           */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ac0c299988aa45f396d7e7296bfa59851">  219</a></span>&#160;<span class="preprocessor">#define  RECURSE        0x0002</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">  220</a></span>&#160;<span class="preprocessor">#define  DO_DIRS        0x0004</span></div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">  221</a></span>&#160;<span class="preprocessor">#define  DO_FILES       0x0008</span></div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae64f2f78f77dc2698028906d97e18751">  222</a></span>&#160;<span class="preprocessor">#define  NAME_ONLY      0x0010</span></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa482ee7aac998fef8df1ba15360b2548">  223</a></span>&#160;<span class="preprocessor">#define  EDITABLE_TIME  0x0020</span></div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a2a931c7ac0ee9eb68945edc736d43a64">  224</a></span>&#160;<span class="preprocessor">#define  LONG_TIME      0x0040   </span><span class="comment">/* long time format for SysFileTree */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae9e02c5b570e751a8235011a25188e8f">  225</a></span>&#160;<span class="preprocessor">#define  CASELESS       0x0080</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae7800c48813cfde08f4ad9334789064b">  226</a></span>&#160;<span class="preprocessor">#define  RXIGNORE       2              </span><span class="comment">/* Ignore attributes entirely */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0a92734e2d899e0102a6661bc6a4990a">  227</a></span>&#160;<span class="preprocessor">#define  AllAtts        FILE_NORMAL | FILE_READONLY | FILE_HIDDEN | \</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">FILE_SYSTEM | FILE_DIRECTORY | FILE_ARCHIVED</span></div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3f2974475f433125fced2c253537fe55">  229</a></span>&#160;<span class="preprocessor">#define  AllFiles       FILE_NORMAL | FILE_READONLY | FILE_HIDDEN | \</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">FILE_SYSTEM | FILE_ARCHIVED</span></div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a18cc80238409554fbcaf1720dad7a409">  231</a></span>&#160;<span class="preprocessor">#define  AllDirs        FILE_READONLY | FILE_HIDDEN | \</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">FILE_SYSTEM | FILE_ARCHIVED | MUST_HAVE_DIRECTORY | FILE_DIRECTORY</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">/* Defines used by SysStemSort -- must match values in okstem.hpp    */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa34ca575266a3f4b79b915c067dc275e">  237</a></span>&#160;<span class="preprocessor">#define SORT_CASESENSITIVE 0</span></div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8d2fa71ddc3683adb805fa0a0680731d">  238</a></span>&#160;<span class="preprocessor">#define SORT_CASEIGNORE    1</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a81da4fa77ffcb61150943958eea47cd1">  240</a></span>&#160;<span class="preprocessor">#define SORT_ASCENDING 0</span></div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#acda2338325b3044d2e9cae8c83de6a8b">  241</a></span>&#160;<span class="preprocessor">#define SORT_DECENDING 1</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">/* Define used for Unicode translation. Not present in early Windows */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">/* SDKs.                                                             */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">#ifndef WC_ERR_INVALID_CHARS</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8f2d1bc0ebfe7e951cbdfaae730143c2">  248</a></span>&#160;<span class="preprocessor">#define WC_ERR_INVALID_CHARS      0x00000080</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">// Defines for various SysFileTree buffer.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">  252</a></span>&#160;<span class="preprocessor">#define FNAMESPEC_BUF_EXTRA    8</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">  253</a></span>&#160;<span class="preprocessor">#define FNAMESPEC_BUF_LEN      MAX_PATH + FNAMESPEC_BUF_EXTRA</span></div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a80754ae58acc97441c981a0dcfa41784">  254</a></span>&#160;<span class="preprocessor">#define FOUNDFILE_BUF_LEN      MAX_PATH</span></div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#abd39eb7c47cb01d7b35816a79c6a5c4a">  255</a></span>&#160;<span class="preprocessor">#define FILETIME_BUF_LEN       64</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#afe308f9c1d5692562360266352823789">  256</a></span>&#160;<span class="preprocessor">#define FILEATTR_BUF_LEN       16</span></div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa1bef0fc54efabb9b00ed4300eb55d08">  257</a></span>&#160;<span class="preprocessor">#define FOUNDFILELINE_BUF_LEN  FOUNDFILE_BUF_LEN + FILETIME_BUF_LEN + FILEATTR_BUF_LEN</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">/* Structures used throughout REXXUTIL.C                             */</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">/* RxTree Structure used by GetLine, OpenFile and CloseFile          */</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct___get_file_data.html">_GetFileData</a> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">char</span> *       <a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>;                 <span class="comment">/* file read buffer           */</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">size_t</span>       <a class="code" href="struct___get_file_data.html#a339cdb27bb7facf9b0dce05aec668123">size</a>;                   <span class="comment">/* file size                  */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordtype">size_t</span>       <a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>;                   <span class="comment">/* data left in buffer        */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keywordtype">size_t</span>       <a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a>;               <span class="comment">/* size left to read          */</span></div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="struct___get_file_data.html#aa37b5982a2d6abfc1a4033a64384796c">  272</a></span>&#160;  <span class="keywordtype">char</span> *       <a class="code" href="struct___get_file_data.html#aa37b5982a2d6abfc1a4033a64384796c">scan</a>;                   <span class="comment">/* current scan position      */</span></div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="struct___get_file_data.html#a2a8cfa812b5e122b9f2d2934c76b90c2">  273</a></span>&#160;  HANDLE       <a class="code" href="struct___get_file_data.html#a2a8cfa812b5e122b9f2d2934c76b90c2">handle</a>;                 <span class="comment">/* file handle                */</span></div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3b41bbd068254a0c8052a422657b269f">  274</a></span>&#160;} <a class="code" href="windows_2rexxutil_8cpp.html#a3b41bbd068254a0c8052a422657b269f">GetFileData</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> *  Data structure for SysFileTree.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> *  Note that in Windows the MAX_PATH define includes the terminating null.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_rx_tree_data.html">RxTreeData</a> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">size_t</span>         <a class="code" href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">count</a>;                         <span class="comment">// Number of found file lines</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a> <a class="code" href="struct_rx_tree_data.html#a9bef0c4b76ac4283092efe843ad39f35">files</a>;                         <span class="comment">// Stem that holds results.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">char</span>           <a class="code" href="struct_rx_tree_data.html#a31e260d4e63a9fbece99ed6602a6deb6">fNameSpec</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a>];  <span class="comment">// File name portion of the search for file spec, may contain glob characters.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">char</span>           <a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a80754ae58acc97441c981a0dcfa41784">FOUNDFILE_BUF_LEN</a>];  <span class="comment">// Full path name of found file</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">char</span>           <a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>[<a class="code" href="windows_2rexxutil_8cpp.html#abd39eb7c47cb01d7b35816a79c6a5c4a">FILETIME_BUF_LEN</a>];    <span class="comment">// Time and size of found file</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordtype">char</span>           <a class="code" href="struct_rx_tree_data.html#ae9860099d7c029962a0f1268cfa4b129">fileAttr</a>[<a class="code" href="windows_2rexxutil_8cpp.html#afe308f9c1d5692562360266352823789">FILEATTR_BUF_LEN</a>];    <span class="comment">// File attribute string of found file</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">char</span>           <a class="code" href="struct_rx_tree_data.html#ae68ea12a13b6f27d8cc0ca9d30d66a6e">foundFileLine</a>[<a class="code" href="windows_2rexxutil_8cpp.html#aa1bef0fc54efabb9b00ed4300eb55d08">FOUNDFILELINE_BUF_LEN</a>]; <span class="comment">// Buffer for found file line, includes foundFile, fileTime, and fileAttr</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordtype">char</span>          *<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>;                    <span class="comment">// Starts out pointing at fNameSpec</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordtype">size_t</span>         <a class="code" href="struct_rx_tree_data.html#ae9dba9daef69438aa76a3cd65372da61">nFNameSpec</a>;                    <span class="comment">// CouNt of bytes in dFNameSpec buffer</span></div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a61b5662eb07457abc8f49702f3e1ec6d">  292</a></span>&#160;} <a class="code" href="windows_2rexxutil_8cpp.html#a61b5662eb07457abc8f49702f3e1ec6d">RXTREEDATA</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/* RxStemData                                                        */</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">/*   Structure which describes as generic                            */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">/*   stem variable.                                                  */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct_rx_stem_data.html">RxStemData</a> {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="struct___s_h_v_b_l_o_c_k.html">SHVBLOCK</a> <a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>;                     <span class="comment">/* Request block for RxVar    */</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a26f71277f565e460c73f60a89c8c57e6">IBUF_LEN</a>];               <span class="comment">/* Input buffer               */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>];                 <span class="comment">/* Buffer for the variable    */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                       <span class="comment">/* name                       */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordtype">char</span> <a class="code" href="struct_rx_stem_data.html#a61aa9d45719c5ceb01eea9911541c549">stemname</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>];                <span class="comment">/* Buffer for the variable    */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                       <span class="comment">/* name                       */</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>;                    <span class="comment">/* Length of stem.            */</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>;                       <span class="comment">/* Length of variable value   */</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="struct_rx_stem_data.html#a48f4bdc104cd85c77d9255a1ebbfcb4b">j</a>;                          <span class="comment">/* Temp counter               */</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="struct_rx_stem_data.html#a68c96508f447b68f098be0ae064db61e">tlong</a>;                      <span class="comment">/* Temp counter               */</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>;                      <span class="comment">/* Number of elements         */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                       <span class="comment">/* processed                  */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a9bcc5b47f981040a9256b2cb11459b67">  313</a></span>&#160;} <a class="code" href="windows_2rexxutil_8cpp.html#a9bcc5b47f981040a9256b2cb11459b67">RXSTEMDATA</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/* Saved character status                                            */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">  319</a></span>&#160;<span class="keyword">static</span>   <span class="keywordtype">int</span>   <a class="code" href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = 0;       <span class="comment">/* extended character saved   */</span></div>
<div class="line"><a name="l00320"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a9ea4a6e038359484e4f837e13931235b">  320</a></span>&#160;<span class="keyword">static</span>   <span class="keywordtype">char</span>  <a class="code" href="windows_2rexxutil_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a>;           <span class="comment">/* saved extended character   */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">/* function pointer for GetDiskFreespaceEx for SysDriveInfo          */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#abcc1848edcb5c704edb90e565fabfbfb">  325</a></span>&#160;<span class="keyword">typedef</span>  BOOL (WINAPI *<a class="code" href="windows_2rexxutil_8cpp.html#abcc1848edcb5c704edb90e565fabfbfb">P_GDFSE</a>)(LPCTSTR, PULARGE_INTEGER, PULARGE_INTEGER,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                               PULARGE_INTEGER);</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">  327</a></span>&#160;<span class="keyword">static</span>   <a class="code" href="windows_2rexxutil_8cpp.html#abcc1848edcb5c704edb90e565fabfbfb">P_GDFSE</a> <a class="code" href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">pGetDiskFreeSpaceEx</a> = NULL;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">/* Numeric Error Return Strings                                      */</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a86965da6e034d2ecefa88ff3c2d213cc">  333</a></span>&#160;<span class="preprocessor">#define  NO_UTIL_ERROR    &quot;0&quot;</span>          <span class="comment">/* No error whatsoever        */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">  334</a></span>&#160;<span class="preprocessor">#define  ERROR_NOMEM      &quot;2&quot;</span>          <span class="comment">/* Insufficient memory        */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#afca154868d5055477f8ec8a5cc3eb1c1">  335</a></span>&#160;<span class="preprocessor">#define  ERROR_FILEOPEN   &quot;3&quot;</span>          <span class="comment">/* Error opening text file    */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">/* Alpha Numeric Return Strings                                      */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">  341</a></span>&#160;<span class="preprocessor">#define  ERROR_RETSTR   &quot;ERROR:&quot;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">/* Numeric Return calls                                              */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">  347</a></span>&#160;<span class="preprocessor">#define  INVALID_ROUTINE 40            </span><span class="comment">/* Raise Rexx error           */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">  348</a></span>&#160;<span class="preprocessor">#define  VALID_ROUTINE    0            </span><span class="comment">/* Successful completion      */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/* Some useful macros                                                */</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">  354</a></span>&#160;<span class="preprocessor">#define BUILDRXSTRING(t, s) { \</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">  strcpy((t)-&gt;strptr,(s));\</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">  (t)-&gt;strlength = strlen((s)); \</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#acf0a46c8a6b68267ae16d6fe597f9f98">  359</a></span>&#160;<span class="preprocessor">#define RETVAL(retc) { \</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">  retstr-&gt;strlength = strlen(itoa(retc, retstr-&gt;strptr,10)); \</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">  return VALID_ROUTINE; \</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">/****************  REXXUTIL Supporting Functions  ********************/</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/****************  REXXUTIL Supporting Functions  ********************/</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">/****************  REXXUTIL Supporting Functions  ********************/</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">  370</a></span>&#160;<span class="keywordtype">void</span> <span class="keyword">inline</span> <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(<a class="code" href="struct_rexx_thread_context__.html">RexxThreadContext</a> *c)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    c-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#ac62b63c2b452912b30225fc815ff22a8">Rexx_Error_System_service_user_defined</a>, c-&gt;String(<span class="stringliteral">&quot;failed to allocate memory&quot;</span>));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> * &lt;routineName&gt; argument &lt;argPos&gt; must not be a null string</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"> * SysFileTree argument 2 must not be a null string</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"> * @param c      Threade context we are operating in.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> * @param fName  Routine name.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"> * @param pos    Argument position.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa7768c7412471a88c3cb717fb1d32c0a">  384</a></span>&#160;<span class="keywordtype">void</span> <span class="keyword">inline</span> <a class="code" href="windows_2rexxutil_8cpp.html#aa7768c7412471a88c3cb717fb1d32c0a">nullStringException</a>(<a class="code" href="struct_rexx_thread_context__.html">RexxThreadContext</a> *c, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> fName, <span class="keywordtype">size_t</span> pos)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    c-&gt;RaiseException3(<a class="code" href="oorexxerrors_8h.html#af462261a026f211fbb7799b7b2ae5aff">Rexx_Error_Incorrect_call_null</a>, c-&gt;String(fName), c-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), c-&gt;StringSize(pos));</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;}</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">  389</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">safeLocalFree</a>(<span class="keywordtype">void</span> *p)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span> (p != NULL)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        LocalFree(p);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"> * Raises an exception for an unrecoverable system API failure.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"> * @param c    Call context we are operating in.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"> * @param api  System API name.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"> * @param rc   Return code from calling the API.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">  404</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a>(<a class="code" href="struct_rexx_thread_context__.html">RexxThreadContext</a> *c, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> api, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> rc)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordtype">char</span> buf[256] = {0};</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    _snprintf(buf, <span class="keyword">sizeof</span>(buf),</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;             <span class="stringliteral">&quot;system API %s() failed; rc: %d last error code: %d&quot;</span>, api, rc, GetLastError());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    c-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#ac62b63c2b452912b30225fc815ff22a8">Rexx_Error_System_service_user_defined</a>, c-&gt;String(buf));</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> * Tests if the the current operating system version meets the specified</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> * requirements. Really a front end to VerifyVersionInfo().  See MSDN docs for</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> * type and condition flags.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> * @param major       OS major number.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * @param minor       OS minor number.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> * @param sp          Service pack level.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> * @param type        Further refines the test.  See MSDN for all the flags, but</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> *                    for example there is VER_NT_WORKSTATION to differentiate</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> *                    between NT desktop and NT server.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> * @param condition   The test condition.  Typical flags would be VER_EQUAL or</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> *                    VER_GREATER_EQUAL.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"> * @return True if the condition is met by the current operating system, or</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> *         false if not.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a6e9ceaba82ebbe3b12d1b23aa029e0b1">  430</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a6e9ceaba82ebbe3b12d1b23aa029e0b1">isWindowsVersion</a>(DWORD major, DWORD minor, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sp, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> condition)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;{</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    OSVERSIONINFOEX ver;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    DWORDLONG       mask = 0;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    DWORD           testForMask = VER_MAJORVERSION | VER_MINORVERSION;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    ZeroMemory(&amp;ver, <span class="keyword">sizeof</span>(OSVERSIONINFOEX));</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    ver.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(OSVERSIONINFOEX);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    ver.dwMajorVersion = major;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    ver.dwMinorVersion = minor;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    VER_SET_CONDITION(mask, VER_MAJORVERSION, condition);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    VER_SET_CONDITION(mask, VER_MINORVERSION, condition);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> ( condition != VER_EQUAL )</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        ver.wServicePackMajor = sp;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        testForMask |= VER_SERVICEPACKMAJOR;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        VER_SET_CONDITION(mask, VER_SERVICEPACKMAJOR, condition);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> != 0 )</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        ver.wProductType = <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        testForMask |= VER_PRODUCT_TYPE;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        VER_SET_CONDITION(mask, VER_PRODUCT_TYPE, condition);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">if</span> ( VerifyVersionInfo(&amp;ver, testForMask, mask) )</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">* Function:  string2size_t(string, number)                          *</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">* Purpose:   Validates and converts an ASCII-Z string from string   *</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">*            form to an unsigned long.  Returns false if the number *</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">*            is not valid, true if the number was successfully      *</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">*            converted.                                             *</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">* RC:        true - Good number converted                           *</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">*            false - Invalid number supplied.                       *</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00480"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">  480</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">string2size_t</a>(</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>,                  <span class="comment">/* string to convert          */</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordtype">size_t</span> *number)                      <span class="comment">/* converted number           */</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">size_t</span>   accumulator;                <span class="comment">/* converted number           */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordtype">size_t</span>   length;                     <span class="comment">/* length of number           */</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    length = strlen(<span class="keywordtype">string</span>);             <span class="comment">/* get length of string       */</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">if</span> (length == 0 ||                   <span class="comment">/* if null string             */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        length &gt; <a class="code" href="windows_2rexxutil_8cpp.html#a001791a21d538b8b9176287ae60d9b61">MAX_DIGITS</a> + 1)         <span class="comment">/* or too long                */</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;                    <span class="comment">/* not valid                  */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    accumulator = 0;                     <span class="comment">/* start with zero            */</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">while</span> (length)                       <span class="comment">/* while more digits          */</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> (!isdigit(*<span class="keywordtype">string</span>))             <span class="comment">/* not a digit?               */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;                    <span class="comment">/* tell caller                */</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                             <span class="comment">/* add to accumulator         */</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        accumulator = accumulator * 10 + (*<span class="keywordtype">string</span> - <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        length--;                          <span class="comment">/* reduce length              */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordtype">string</span>++;                          <span class="comment">/* step pointer               */</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    *number = accumulator;               <span class="comment">/* return the value           */</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;                         <span class="comment">/* good number                */</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a270882ebf6e7854c46fef5e869667da4">  511</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a270882ebf6e7854c46fef5e869667da4">isAtLeastVista</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;{</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a6e9ceaba82ebbe3b12d1b23aa029e0b1">isWindowsVersion</a>(6, 0, 0, 0, VER_GREATER_EQUAL);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">/*   Subroutine Name:   memupper                                     */</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/*   Descriptive Name:  uppercase a memory location                  */</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">/*   Entry Point:       memupper                                     */</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">/*   Input:             memory to upper case                         */</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">/*                      length of memory location                    */</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aec33b06d90ac834899b86039851abced">  529</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="windows_2rexxutil_8cpp.html#aec33b06d90ac834899b86039851abced">memupper</a>(</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordtype">char</span>    *location,                   <span class="comment">/* location to uppercase      */</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="keywordtype">size_t</span>   length)                     <span class="comment">/* length to uppercase        */</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;{</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">for</span> (; length--; location++)         <span class="comment">/* loop for entire string     */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                       <span class="comment">/* uppercase in place         */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    *location = toupper(*location);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;}</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a>( <a class="code" href="struct___get_file_data.html">GetFileData</a> *filedata );</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">* Function:  OpenFile(file, filedata)                               *</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">* Purpose:   Prepares a file for reading.                           *</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">* RC:        0     - file was opened successfully                   *</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">*            1     - file open error occurred                       *</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8983afb4113449c47f41a55a283a10a2">  549</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a8983afb4113449c47f41a55a283a10a2">MyOpenFile</a>(</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">char</span>  *file,                  <span class="comment">/* file name                  */</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <a class="code" href="struct___get_file_data.html">GetFileData</a> *filedata )             <span class="comment">/* global file information    */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;{</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   DWORD       dwSize;                 <span class="comment">/* file status information    */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                       <span class="comment">/* try to open the file       */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">if</span> ((filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a> = CreateFile(file, GENERIC_READ,</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                            FILE_SHARE_READ | FILE_SHARE_WRITE, 0, OPEN_EXISTING,</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                            FILE_FLAG_WRITE_THROUGH, 0))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            == INVALID_HANDLE_VALUE)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;                          <span class="comment">/* return failure             */</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                       <span class="comment">/* retrieve the file size     */</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  dwSize = GetFileSize(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>, NULL);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                       <span class="comment">/* if GetFileSize failed or   */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                       <span class="comment">/* size=0                     */</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (dwSize == 0xffffffff || !dwSize) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    CloseHandle(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>);     <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;                       <span class="comment">/* and quit                   */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">if</span> (dwSize &lt;= <a class="code" href="windows_2rexxutil_8cpp.html#a02706310c2be4fc4b66273d8e08bcebd">MAX_READ</a>) {            <span class="comment">/* less than a single buffer  */</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    DWORD bytesRead;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                       <span class="comment">/* allocate buffer for file   */</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">if</span> (!(filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a> = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_ZEROINIT |</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                         GMEM_FIXED, dwSize))) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      CloseHandle(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>);   <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#a339cdb27bb7facf9b0dce05aec668123">size</a> = dwSize;           <span class="comment">/* save file size             */</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a> = 0;            <span class="comment">/* no left over information   */</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                       <span class="comment">/* read the file in           */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (!ReadFile(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>, filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>, dwSize, &amp;bytesRead, NULL)) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      GlobalFree(filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>);    <span class="comment">/* free the buffer            */</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      CloseHandle(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>);   <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// Set scan to beginning of buffer, and data to number of bytes we have.</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a> = filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a> = bytesRead;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordflow">else</span> {                               <span class="comment">/* need to read partial       */</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                       <span class="comment">/* allocate buffer for read   */</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (!(filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a> = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_ZEROINIT |</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                         GMEM_FIXED, <a class="code" href="windows_2rexxutil_8cpp.html#a02706310c2be4fc4b66273d8e08bcebd">MAX_READ</a>))) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      CloseHandle(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>);   <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#a339cdb27bb7facf9b0dce05aec668123">size</a> = dwSize;           <span class="comment">/* save file size             */</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                       <span class="comment">/* and set remainder          */</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a> = filedata-&gt;<a class="code" href="struct___get_file_data.html#a339cdb27bb7facf9b0dce05aec668123">size</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                       <span class="comment">/* read the file in           */</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a>(filedata)) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      GlobalFree(filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>);    <span class="comment">/* free the buffer            */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      CloseHandle(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>);   <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;                        <span class="comment">/* file is opened             */</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">* Function:  CloseFile(filedata)                                    *</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">* Purpose:   Close a file                                           *</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8468fc5c1c06493766b86dbf139a06ea">  617</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="windows_2rexxutil_8cpp.html#a8468fc5c1c06493766b86dbf139a06ea">CloseFile</a>(</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <a class="code" href="struct___get_file_data.html">GetFileData</a> *filedata )             <span class="comment">/* global file information    */</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  CloseHandle(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>);       <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  GlobalFree(filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>);        <span class="comment">/* free the buffer            */</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"> * Reads the next buffer of data.</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"> * @param filedata  Global file information.</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"> * @return  0, buffer was read.  1, an error occurred reading buffer.</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">  631</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a>(<a class="code" href="struct___get_file_data.html">GetFileData</a> *filedata)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordtype">size_t</span> size;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    DWORD  bytesRead;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="comment">/* get size of this read      */</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    size = <a class="code" href="_array_class_8cpp.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(<span class="keywordtype">size_t</span>(<a class="code" href="windows_2rexxutil_8cpp.html#a02706310c2be4fc4b66273d8e08bcebd">MAX_READ</a>), filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">/* read the file in           */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="keywordflow">if</span> ( !ReadFile(filedata-&gt;<a class="code" href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">handle</a>, filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>, (DWORD)size, &amp;bytesRead, NULL) )</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a> = bytesRead;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span> ( filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a> != size )</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="comment">// Read less than requested, no residual.</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a> = 0;            <span class="comment">/* no residual                */</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">// Residual is remainder.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a> = filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a> - size;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">/* don&#39;t check for EOF but read to real end of file     */</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">//                                     /* look for a EOF mark        */</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">//endptr = memchr(filedata-&gt;buffer, CH_EOF, filedata-&gt;data);</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="comment">//if (endptr) {                        /* found an EOF mark          */</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">//                                     /* set new length             */</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="comment">//  filedata-&gt;data = (ULONG)(endptr - filedata-&gt;buffer);</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="comment">//  filedata-&gt;residual = 0;            /* no residual                */</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">// Set position to beginning.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a> = filedata-&gt;<a class="code" href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">buffer</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">* Function:  GetLine(line, size, filedata)                          *</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">* Purpose:   Reads a line of data using buffered reads.  At end of  *</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">*            file, zero is returned to indicate nothing left.       *</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">* RC:        true -  line was read successfully                     *</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">*            false - end of file was reached                        *</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3cb9da7fb9d0e9c4f3ec58492df0aced">  682</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a3cb9da7fb9d0e9c4f3ec58492df0aced">GetLine</a>(</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordtype">char</span>        *<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>,                  <span class="comment">/* returned line              */</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   <span class="keywordtype">size_t</span>       size,                  <span class="comment">/* size of line buffer        */</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <a class="code" href="struct___get_file_data.html">GetFileData</a> *filedata )             <span class="comment">/* file handle                */</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;{</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordtype">char</span>        *scan;                  <span class="comment">/* current scan pointer       */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordtype">size_t</span>       length;                <span class="comment">/* line length                */</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   <span class="keywordtype">size_t</span>       copylength;            <span class="comment">/* copied length              */</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (!(filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>)) {             <span class="comment">/* if out of current buffer   */</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span> (filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a>) {          <span class="comment">/* may be another buffer      */</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <a class="code" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a>(filedata);        <span class="comment">/* try to read one            */</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">if</span> (!filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>)             <span class="comment">/* nothing more?              */</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;                   <span class="comment">/* all done                   */</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;                     <span class="comment">/* return EOF condition       */</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                       <span class="comment">/* look for a carriage return */</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  scan = (<span class="keywordtype">char</span> *)memchr(filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a>, <a class="code" href="windows_2rexxutil_8cpp.html#a0b05abb761c82a2935cf47ac557f164b">CH_NL</a>, filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">if</span> (scan) {                          <span class="comment">/* found one                  */</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                       <span class="comment">/* calculate the length       */</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    length = scan - filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    copylength = <a class="code" href="_array_class_8cpp.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(length, size);    <span class="comment">/* get length to copy         */</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                       <span class="comment">/* copy over the data         */</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    memcpy(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a>, copylength);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[copylength] = <span class="charliteral">&#39;\0&#39;</span>;           <span class="comment">/* make into ASCIIZ string    */</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">/* we don&#39;t want the CR character in the result string*/</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[copylength - 1] == <a class="code" href="windows_2rexxutil_8cpp.html#a8bfc2021af2e7e6fbf2228a180d815a9">CH_CR</a> ) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[copylength - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    } <span class="comment">/* endif */</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a> -= length + 1;      <span class="comment">/* reduce the length          */</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a> = scan + 1;         <span class="comment">/* set new scan point         */</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (!filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>) {             <span class="comment">/* all used up                */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">if</span> (filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a>)          <span class="comment">/* more to read               */</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a>(filedata);      <span class="comment">/* read the next buffer       */</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;                        <span class="comment">/* this worked ok           */</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  }</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">else</span>                                   <span class="comment">/* ran off the end          */</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  {</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">/* now we have scanned the whole buffer, but didn&#39;t find LF.         */</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="comment">/* we have two situation that can appear:                            */</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="comment">/* 1.) size &gt; filedata-&gt;data ==&gt; there is still room in the working  */</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="comment">/*     buffer, we can see whether we have scanned the whole file     */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">/*     --&gt; ReadNextBuffer, or this was it, and we return             */</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">/* 2.) size &lt; filedata-&gt;buffer ==&gt; we have scanned to the end of the */</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="comment">/*     buffer, more than what would fit into it, but still we        */</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="comment">/*     haven&#39;t had a hit. So copy all elements into the buffer       */</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">/*     read the next buffer, GetLine to get the next LF              */</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">/*     and return what was put into buffer. Be ALWAYS AWARE that     */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="comment">/*     that buffer limits to 2047 bytes, and that we only return up  */</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">/*     to 2047 bytes of a line. The rest of the line is not returned */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="comment">/*     and not checked for search argument. Nevertheless, this       */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <span class="comment">/*     garantees, that the line counter (argument &#39;N&#39;) corresponds   */</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="comment">/*     with the input file                                           */</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                       <span class="comment">/* get length to copy         */</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="keywordflow">if</span> (size &gt; filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;       copylength = filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>;    <span class="comment">/* copy the rest into linebuffer */</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                       <span class="comment">/* copy over the data         */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;       memcpy(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a>, copylength);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;       <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[copylength] = <span class="charliteral">&#39;\0&#39;</span>;          <span class="comment">/* make into ASCIIZ string  */</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;     <span class="comment">/* all data should be read, filedata-&gt;data must be zero         */</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;       filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a> -= copylength;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;     <span class="comment">/* scan should be at the end                                    */</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;       filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a> += copylength;     <span class="comment">/* set new scan point       */</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="comment">/* if no more data to read in the file, return OK     */</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;       <span class="keywordflow">if</span> (!filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a>)</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a3cb9da7fb9d0e9c4f3ec58492df0aced">GetLine</a>(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a> + copylength, size - copylength, filedata);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">else</span>        <span class="comment">/* the line is full, scan until LF found but no copy */</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;       copylength = <a class="code" href="_array_class_8cpp.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(size, filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                         <span class="comment">/* copy over the data       */</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;       memcpy(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a>, copylength);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;       <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[copylength] = <span class="charliteral">&#39;\0&#39;</span>;          <span class="comment">/* make into ASCIIZ string  */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;       filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>  = 0;            <span class="comment">/* no data in buffer          */</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;       filedata-&gt;<a class="code" href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">scan</a> += filedata-&gt;<a class="code" href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">data</a>; <span class="comment">/* set scan point to end    */</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;       <span class="keywordflow">if</span> (filedata-&gt;<a class="code" href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">residual</a>)         <span class="comment">/* more to read               */</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;       {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;           <a class="code" href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a>(filedata);   <span class="comment">/* read the next buffer       */</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;           <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a3cb9da7fb9d0e9c4f3ec58492df0aced">GetLine</a>(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a> + copylength, 0, filedata);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;       }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;       <span class="keywordflow">else</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">* Function:  SetFileMode(file, attributes)                          *</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">* Purpose:   Change file attribute bits                             *</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">*            without PM.                                            *</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">* RC:        0    -  File attributes successfully changed           *</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">*            1    -  Unable to change attributes                    *</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a100635e0d5340c4fb128814f0c116088">  792</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a100635e0d5340c4fb128814f0c116088">SetFileMode</a>(</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *file,                    <span class="comment">/* file name                  */</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordtype">size_t</span>   attr )                      <span class="comment">/* new file attributes        */</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  DWORD         dwfileattrib;          <span class="comment">/* file attributes            */</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                       <span class="comment">/* get the file status        */</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">if</span> ((dwfileattrib = GetFileAttributes(file)) != 0xffffffff) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                       <span class="comment">/* if worked                  */</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                       <span class="comment">/* set the attributes         */</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">if</span> ((dwfileattrib = SetFileAttributes(file, (DWORD)attr)) != 0)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;   <span class="comment">/* give back success flag     */</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;}</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">* Function:  mystrstr(haystack, needle, hlen, nlen, sensitive)      *</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">* Purpose:   Determines if the string &#39;needle&#39; is in the            *</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">*            string &#39;haystack&#39; by returning it&#39;s position or        *</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">*            a NULL if not found.  The length of haystack and       *</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">*            needle are given by &#39;hlen&#39; and &#39;nlen&#39; respectively.    *</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">*            If &#39;sensitive&#39; is true, then the search is case        *</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">*            sensitive, else it is case insensitive.                *</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">* RC:        num  - The pos where needle was found.                 *</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">*            NULL - needle not found.                               *</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">* Used By:   SysFileSearch()                                        *</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">  828</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *haystack,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *needle,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="keywordtype">size_t</span>  hlen,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="keywordtype">size_t</span>  nlen,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordtype">bool</span>    sensitive)</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;{</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">// TODO:  This can be made a LOT more efficient</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordtype">char</span> <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a09a3b394b8602092d58347b791158062">MAX_LINE_LEN</a>];</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordtype">char</span> target[<a class="code" href="windows_2rexxutil_8cpp.html#a09a3b394b8602092d58347b791158062">MAX_LINE_LEN</a>];</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="keywordtype">size_t</span> p;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; <span class="comment">/* Copy line  - Change nulls to spaces and uppercase if needed      */</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">for</span> (p = 0; p &lt; hlen; p++)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">if</span> (haystack[p] == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[p] = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sensitive)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[p] = haystack[p];</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">else</span> <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[p] = (char)toupper(haystack[p]);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[p] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; <span class="comment">/* Copy target  - Change nulls to spaces and uppercase if needed    */</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">for</span> (p = 0; p &lt; nlen; p++) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">if</span> (needle[p] == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      target[p] = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sensitive)</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      target[p] = needle[p];</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">else</span> target[p] = (char)toupper(needle[p]);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  target[p] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">return</span> strstr(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, target);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a6c11894032532fe96b8a76f81305df5d">  867</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *haystack, <span class="keyword">const</span> <span class="keywordtype">char</span> *needle)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;{</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordtype">size_t</span> hlen = strlen(haystack);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordtype">size_t</span> nlen = strlen(haystack);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordtype">char</span> *haystackCopy = strdup(haystack);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; hlen; i++)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        haystackCopy[i] = toupper(haystackCopy[i]);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *result = strstr(haystackCopy, needle);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    free(haystackCopy);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">/****************************************************************</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">* Function: GetUniqueFileName(Template, Filler, file)           *</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">*                                                               *</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">* Purpose:  This function returns a unique temporary file name  *</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">*           given a template and a filler character.            *</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">*                                                               *</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="comment">* Params:   CHAR* Template - The template.  Must contain at     *</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">*                            least one or more filler chars.    *</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">*                                                               *</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">*                            Example:  &quot;C:\TEMP\FILE????.DAT    *</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">*                                                               *</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">*           CHAR Filler    - The character in the Template to   *</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">*                            be replaced with numbers.  For     *</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">*                            the above example, the filler char *</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">*                            would be &#39;?&#39;.                      *</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment">*           CHAR* file     - file name produced (output)        *</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">*                                                               *</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">* Used By:  RxTempFileName()                                    *</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">****************************************************************/</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5273ad4c59f3a26dea4d732d29670e07">  903</a></span>&#160;VOID <a class="code" href="windows_2rexxutil_8cpp.html#a5273ad4c59f3a26dea4d732d29670e07">GetUniqueFileName</a>(</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  CHAR  *Template,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  CHAR   Filler,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;  CHAR  *file)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;{</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  CHAR numstr[6];</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordtype">bool</span> Unique = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  ULONG x,                             <span class="comment">/* loop index                 */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        i,                             <span class="comment">/*                            */</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        j = 0,                         <span class="comment">/* number of filler chars     */</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                       <span class="comment">/* found                      */</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        num,                           <span class="comment">/* temporary random number    */</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        start,                         <span class="comment">/* first random number        */</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        max = 1;                       <span class="comment">/* maximum random number      */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  INT  seed;                           <span class="comment">/* to get current time        */</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  WIN32_FIND_DATA wfdFinfo;            <span class="comment">/* Windows Find data struct   */</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                       <span class="comment">/* Structure                  */</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  SYSTEMTIME DT;                       <span class="comment">/* The date and time structure*/</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  UINT            fuErrorMode;         <span class="comment">/* holds current file err mode*/</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  HANDLE hSearch;                      <span class="comment">/* handle of file if found    */</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"> /** Determine number of filler characters *                         */</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">for</span> (x = 0; Template[x] != 0; x++)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (Template[x] == Filler) {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      max = max *10;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      j++;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment"> /** Return NULL string if less than 1 or greater than 4 *           */</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">if</span> (j == 0 || j &gt; 5) {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    Unique = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    strcpy(file, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="comment"> /** Get a random number in the appropriate range                    */</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                       <span class="comment">/* Get the time               */</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  GetSystemTime(&amp;DT);                  <span class="comment">/* via Windows                */</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  seed = DT.wHour*60 + DT.wMinute;     <span class="comment">/* convert to hundreths       */</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  seed = seed*60 + DT.wSecond;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  seed = seed*100 + ( DT.wMilliseconds / (UINT)10 );</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  seed = seed * <a class="code" href="windows_2rexxutil_8cpp.html#aa0404bdc143b8c96d8f09f38be3de977">RNDFACTOR</a> + 1;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  num = (ULONG)seed % max;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  start = num;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment"> /** Do until a unique name is found                                 */</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">while</span> (!Unique) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">    /** Generate string which represents the number                  */</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">switch</span> (j) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">case</span> 1 :</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        wsprintf(numstr, <span class="stringliteral">&quot;%01u&quot;</span>, num);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordflow">case</span> 2 :</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        wsprintf(numstr, <span class="stringliteral">&quot;%02u&quot;</span>, num);</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">case</span> 3 :</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        wsprintf(numstr, <span class="stringliteral">&quot;%03u&quot;</span>, num);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <span class="keywordflow">case</span> 4 :</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        wsprintf(numstr, <span class="stringliteral">&quot;%04u&quot;</span>, num);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <span class="keywordflow">case</span> 5 :</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        wsprintf(numstr, <span class="stringliteral">&quot;%05u&quot;</span>, num);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">    /** Subsitute filler characters with numeric string              */</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    i = 0;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">for</span> (x = 0; Template[x] != 0; x++)</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      <span class="keywordflow">if</span> (Template[x] == Filler)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        file[x] = numstr[i++];</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        file[x] = Template[x];</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    file[x] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">    /** See if the file exists                                       */</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                       <span class="comment">/* Disable Hard-Error popups  */</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    fuErrorMode = SetErrorMode(SEM_NOOPENFILEERRORBOX);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    hSearch = FindFirstFile(file, &amp;wfdFinfo);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">if</span> (hSearch == INVALID_HANDLE_VALUE)<span class="comment">/* file not found?           */</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      Unique = <span class="keyword">true</span>;                   <span class="comment">/* got one                    */</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    FindClose(hSearch);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    SetErrorMode(fuErrorMode);         <span class="comment">/* Enable previous setting    */</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">    /** Make sure we are not wasting our time                        */</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    num = (num+1)%max;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">if</span> (num == start &amp;&amp; !Unique) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      Unique = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      strcpy(file, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">/**********************************************************************</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">***             &lt;&lt;&lt;&lt;&lt;&lt; REXXUTIL Functions Follow &gt;&gt;&gt;&gt;&gt;&gt;&gt;            ***</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">***             &lt;&lt;&lt;&lt;&lt;&lt; REXXUTIL Functions Follow &gt;&gt;&gt;&gt;&gt;&gt;&gt;            ***</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">***             &lt;&lt;&lt;&lt;&lt;&lt; REXXUTIL Functions Follow &gt;&gt;&gt;&gt;&gt;&gt;&gt;            ***</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">***             &lt;&lt;&lt;&lt;&lt;&lt; REXXUTIL Functions Follow &gt;&gt;&gt;&gt;&gt;&gt;&gt;            ***</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">**********************************************************************/</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">/**********************************************************************</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">* Function:  SysCls                                                   *</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">* Syntax:    call SysCls                                              *</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">*                                                                     *</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR - Successful.                              *</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">**********************************************************************/</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a7b9510a9bed0a8609bba2297edd0ed64"> 1029</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a7b9510a9bed0a8609bba2297edd0ed64">SysCls</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;{</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  HANDLE hStdout;                      <span class="comment">/* Handle to Standard Out     */</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  DWORD dummy;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  COORD Home = {0, 0};                 <span class="comment">/* Home coordinates on console*/</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  CONSOLE_SCREEN_BUFFER_INFO csbiInfo; <span class="comment">/* Console information        */</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">if</span> (numargs)                         <span class="comment">/* arguments specified?       */</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;          <span class="comment">/* raise the error            */</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                       <span class="comment">/* if in character mode       */</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> (GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo)) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    FillConsoleOutputCharacter( hStdout, <span class="charliteral">&#39; &#39;</span>,</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                csbiInfo.dwSize.X * csbiInfo.dwSize.Y,</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                Home, &amp;dummy );</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    SetConsoleCursorPosition(hStdout, Home);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a86965da6e034d2ecefa88ff3c2d213cc">NO_UTIL_ERROR</a>);<span class="comment">/* pass back result           */</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">* Function:  SysCurPos - positions cursor in DOS window                  *</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">* Syntax:    call SysCurPos [row, col]                                   *</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">* Params:    row   - row to place cursor on                              *</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">*            col   - column to place cursor on                           *</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">* Return:    row, col                                                    *</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604"> 1063</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysCurPos, OPTIONAL_stringsize_t, inrow, OPTIONAL_stringsize_t, incol)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;{</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbiInfo; <span class="comment">/* Console information        */</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(1) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2)) || (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(1)))</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="comment">/* get handle to stdout       */</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="comment">/* get current position, and  */</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">/* continue only if in        */</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">/* character mode             */</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo))</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;%d %d&quot;</span>, csbiInfo.dwCursorPosition.Y, csbiInfo.dwCursorPosition.X);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2))</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            COORD newHome;                       <span class="comment">/* Position to move cursor    */</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            newHome.Y = (short)inrow;      <span class="comment">/* convert to short form      */</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            newHome.X = (short)incol;      <span class="comment">/* convert to short form      */</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                           <span class="comment">/* Set the cursor position    */</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            SetConsoleCursorPosition(hStdout, newHome);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(buffer);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;}</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">* Function:  SysCurState                                                 *</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">* Syntax:    call SysCurState state                                      *</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">* Params:    state - Either &#39;ON&#39; or &#39;OFF&#39;.                               *</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR - Successful.                                 *</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59"> 1110</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysCurState, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, option)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;{</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    CONSOLE_CURSOR_INFO CursorInfo;      <span class="comment">/* info about cursor          */</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                         <span class="comment">/* get handle to stdout       */</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="comment">/* Get the cursor info        */</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    GetConsoleCursorInfo(hStdout,&amp;CursorInfo);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">/* Get state and validate     */</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;ON&quot;</span>) == 0)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        CursorInfo.bVisible = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;OFF&quot;</span>) == 0)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        CursorInfo.bVisible = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">// this is an error, raise the condition and return</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">/* Set the cursor info        */</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    SetConsoleCursorInfo(hStdout,&amp;CursorInfo);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">return</span> 0;                            <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;}</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="comment">* Function:  SysDriveInfo                                                *</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="comment">* Syntax:    call SysDriveInfo drive                                     *</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment">* Params:    drive - &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, etc.                                 *</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">* Return:    disk free total label                                       *</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a07bc4be1a9a8a49a9472dcb8aad4791a"> 1149</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a07bc4be1a9a8a49a9472dcb8aad4791a">SysDriveInfo</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;{</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  CHAR   chFileSysType[MAX_PATH],      <span class="comment">/*  File system name          */</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         chVolumeName[MAX_PATH],       <span class="comment">/*  volume label              */</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;         chDriveLetter[4];             <span class="comment">/*  drive_letter + : + \ + \0 */</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  BOOL   bGVIrc;                       <span class="comment">/* rc from GVI                */</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                       <span class="comment">/* GetDiskFreeSpace calculations */</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  DWORD  dwSectorsPerCluster, dwBytesPerSector;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  DWORD  dwFreeClusters, dwClusters;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  BOOL   bGDFSrc;                      <span class="comment">/* GDFS rc                    */</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  UINT   errorMode;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  DWORD dwgle;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keywordtype">unsigned</span> __int64 i64FreeBytesToCaller,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                   i64TotalBytes,</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                   i64FreeBytes;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                       <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="keywordflow">if</span> (numargs != 1 ||</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      args[0].strlength &gt; 2 ||         <span class="comment">/* no more than 2 chars       */</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      args[0].strlength == 0)          <span class="comment">/* at least 1                 */</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *arg = args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;    <span class="comment">/* get argument pointer       */</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                       <span class="comment">/* drive letter?              */</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (strlen(arg) == 2 &amp;&amp;              <span class="comment">/* if second letter isn&#39;t : bye */</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      arg[1] != <span class="charliteral">&#39;:&#39;</span>)</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordflow">if</span> (arg[0] &lt; <span class="charliteral">&#39;A&#39;</span> ||                  <span class="comment">/* is it in range?            */</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      arg[0] &gt; <span class="charliteral">&#39;z&#39;</span>)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160; </div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;   <span class="keywordflow">if</span> (strlen(arg) == 1){              <span class="comment">/* need to add a : if only the*/</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;     chDriveLetter[0]=arg[0];          <span class="comment">/* letter was passed in       */</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;     chDriveLetter[1]=<span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;     chDriveLetter[2]=<span class="charliteral">&#39;\\&#39;</span>;            <span class="comment">/* need to add \ because of   */</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;     chDriveLetter[3]=<span class="charliteral">&#39;\0&#39;</span>;            <span class="comment">/* bug in getvolumeinfo       */</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;   }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;   <span class="keywordflow">else</span>                           <span class="comment">/* have &lt;letter&gt;: , just copy over */</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;   {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;     strcpy(chDriveLetter, args[0].strptr);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;     chDriveLetter[2]=<span class="charliteral">&#39;\\&#39;</span>;            <span class="comment">/* need to add \ because of   */</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;     chDriveLetter[3]=<span class="charliteral">&#39;\0&#39;</span>;            <span class="comment">/* bug in getvolumeinfo       */</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;   }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="comment">/* try to load GetDiskFreeSpaceEx function pointer */</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">if</span> ( !<a class="code" href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">pGetDiskFreeSpaceEx</a> )</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">pGetDiskFreeSpaceEx</a> = (<a class="code" href="windows_2rexxutil_8cpp.html#abcc1848edcb5c704edb90e565fabfbfb">P_GDFSE</a>) GetProcAddress(GetModuleHandle(<span class="stringliteral">&quot;kernel32.dll&quot;</span>),</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                                   <span class="stringliteral">&quot;GetDiskFreeSpaceExA&quot;</span>);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  } <span class="comment">/* endif */</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  errorMode = SetErrorMode(SEM_FAILCRITICALERRORS);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                         <span class="comment">/* get the volume name and file system type */</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  bGVIrc=GetVolumeInformation(chDriveLetter,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                           chVolumeName,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                           (DWORD)MAX_PATH,</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                           NULL,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                           NULL,</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                           NULL,</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                           chFileSysType,</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                           (DWORD)MAX_PATH);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  dwgle=GetLastError();</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="comment">/* use appropriate function */</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">pGetDiskFreeSpaceEx</a> )</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    bGDFSrc = <a class="code" href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">pGetDiskFreeSpaceEx</a>(chDriveLetter,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                  (PULARGE_INTEGER) &amp;i64FreeBytesToCaller,</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                  (PULARGE_INTEGER) &amp;i64TotalBytes,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                  (PULARGE_INTEGER) &amp;i64FreeBytes);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                              <span class="comment">/* get the disk free space information */</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    bGDFSrc=GetDiskFreeSpace( chDriveLetter,</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                              &amp;dwSectorsPerCluster,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                              &amp;dwBytesPerSector,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                              &amp;dwFreeClusters,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                              &amp;dwClusters);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160; </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="comment">/* force 64 bit maths */</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    i64TotalBytes = (__int64)dwClusters * dwSectorsPerCluster * dwBytesPerSector;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    i64FreeBytes = (__int64)dwFreeClusters * dwSectorsPerCluster * dwBytesPerSector;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  } <span class="comment">/* endif */</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  dwgle=GetLastError();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  SetErrorMode(errorMode);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="keywordflow">if</span> (bGVIrc &amp;&amp; bGDFSrc) {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="comment">/* use simplified display routine with 64 bit types */</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,            <span class="comment">// drive free total label</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            <span class="stringliteral">&quot;%c%c  %-12I64u %-12I64u %-13s&quot;</span>,</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            chDriveLetter[0], chDriveLetter[1],</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            i64FreeBytes, i64TotalBytes, chVolumeName);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                       <span class="comment">/* create return string       */</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;             <span class="comment">/* return null string         */</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;}</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">* Function:  SysDriveMap                                                 *</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">* Syntax:    call SysDriveMap [drive] [,mode]                            *</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">* Params:    drive - &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, etc.  The drive to start the search  *</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">*                     with.                                              *</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">*            mode  - Any of the following:  &#39;FREE&#39;, &#39;USED&#39;, &#39;DETACHED&#39;,  *</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">*                                           &#39;LOCAL&#39;, &#39;REMOTE&#39;            *</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">* Return:    &#39;A: B: C: D: ...&#39;                                           *</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0b1a486d8de452c909c69e57bb7cbbc4"> 1270</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a0b1a486d8de452c909c69e57bb7cbbc4">SysDriveMap</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;{</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  CHAR     temp[<a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>];                  <span class="comment">/* Entire drive map built here*/</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  CHAR     tmpstr[<a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>];                <span class="comment">/* Single drive entries built */</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                       <span class="comment">/* here                       */</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  CHAR     DeviceName[4];              <span class="comment">/* Device name or drive letter*/</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                       <span class="comment">/* string                     */</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  DWORD    DriveMap;                   <span class="comment">/* Drive map                  */</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  ULONG    Ordinal;                    <span class="comment">/* Ordinal of entry in name   */</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                       <span class="comment">/* list                       */</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                       <span class="comment">/* required                   */</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  ULONG    dnum;                       <span class="comment">/* Disk num variable          */</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  ULONG    start = 3;                  <span class="comment">/* Initial disk num           */</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  ULONG    Mode = <a class="code" href="windows_2rexxutil_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a>;                <span class="comment">/* Query mode USED, FREE,     */</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                       <span class="comment">/* LOCAL, etc                 */</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  LONG     rc;                         <span class="comment">/* OS/2 return codes          */</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  UINT     errorMode;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  Ordinal = (ULONG )0;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  temp[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">if</span> (numargs &gt; 2)                     <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                       <span class="comment">/* check starting drive letter*/</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordflow">if</span> (numargs &gt;= 1 &amp;&amp; args[0].strptr) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">if</span> ((strlen(args[0].strptr) == 2 &amp;&amp;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        args[0].strptr[1] != <span class="charliteral">&#39;:&#39;</span>) ||</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        strlen(args[0].strptr) &gt; 2 ||</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        strlen(args[0].strptr) == 0)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    start = toupper(args[0].strptr[0])-<span class="charliteral">&#39;A&#39;</span>+1;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">if</span> (start &lt; 1 ||                     <span class="comment">/* is it in range?            */</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      start &gt; 26)</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                       <span class="comment">/* check the mode             */</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">if</span> (numargs == 2 &amp;&amp; args[1].strlength != 0) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;FREE&quot;</span>))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">FREE</a>;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;USED&quot;</span>))</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a>;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;RAMDISK&quot;</span>))</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#a6ba3cd3a913e871f79c104129cb9ceb3">RAMDISK</a>;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;REMOTE&quot;</span>))</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#a62ca51b78468397b2ef98ee55a5e6e2a">REMOTE</a>;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;LOCAL&quot;</span>))</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;REMOVABLE&quot;</span>))</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#aac1f74a2a44349000b99fe6511e7a04f">REMOVABLE</a>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(args[1].strptr, <span class="stringliteral">&quot;CDROM&quot;</span>))</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      Mode = <a class="code" href="windows_2rexxutil_8cpp.html#a5e22cbe91a4d63890d01dd36e7a1c373">CDROM</a>;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                       <span class="comment">/* perform the query          */</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  DriveMap = GetLogicalDrives();</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  DriveMap&gt;&gt;=start-1;                  <span class="comment">/* Shift to the first drive   */</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  temp[0] = <span class="charliteral">&#39;\0&#39;</span>;                      <span class="comment">/* Clear temporary buffer     */</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <span class="keywordflow">for</span> (dnum = start; dnum &lt;= 26; dnum++) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                       <span class="comment">/* Hey, we have a free drive  */</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">if</span> (!(DriveMap&amp;(DWORD)1) &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">FREE</a>) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      strcat(temp, tmpstr);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                       <span class="comment">/* Hey, we have a used drive  */</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((DriveMap&amp;(DWORD)1) &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a>) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      strcat(temp, tmpstr);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (DriveMap&amp;(DWORD)1) {      <span class="comment">/* Check specific drive info  */</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      sprintf(DeviceName, <span class="stringliteral">&quot;%c:\\&quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      errorMode = SetErrorMode(SEM_FAILCRITICALERRORS);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      rc = (LONG)GetDriveType(DeviceName);</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      SetErrorMode(errorMode);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="preprocessor">      #ifdef UNDELETE</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      DataBufferLen = <span class="keyword">sizeof</span> DataBuffer;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      DosQueryFSAttach(DeviceName, Ordinal, FSAInfoLevel,</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          &amp;DataBuffer, &amp;DataBufferLen);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      rc = DosQueryFSInfo(dnum, 2, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="preprocessor">      #endif</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      <span class="keywordflow">if</span> (rc == DRIVE_REMOVABLE &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#aac1f74a2a44349000b99fe6511e7a04f">REMOVABLE</a>) {</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                       <span class="comment">/* Hey, we have a removable   */</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                       <span class="comment">/* drive                      */</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        strcat(temp, tmpstr);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == DRIVE_CDROM &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#a5e22cbe91a4d63890d01dd36e7a1c373">CDROM</a>) {</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        strcat(temp, tmpstr);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == DRIVE_FIXED &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        strcat(temp, tmpstr);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == DRIVE_REMOTE &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#a62ca51b78468397b2ef98ee55a5e6e2a">REMOTE</a>) {</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        strcat(temp, tmpstr);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160; </div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rc == DRIVE_RAMDISK &amp;&amp; Mode == <a class="code" href="windows_2rexxutil_8cpp.html#a6ba3cd3a913e871f79c104129cb9ceb3">RAMDISK</a>) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        sprintf(tmpstr, <span class="stringliteral">&quot;%c: &quot;</span>, dnum+<span class="charliteral">&#39;A&#39;</span>-1);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        strcat(temp, tmpstr);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    DriveMap&gt;&gt;=1;                      <span class="comment">/* Shift to the next drive    */</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, temp);         <span class="comment">/* pass back result           */</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="keywordflow">if</span> (retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>)               <span class="comment">/* if not a null string       */</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>--;               <span class="comment">/* Get rid of last space      */</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160; </div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment">* Function:  SysDropFuncs                                                *</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment">* Syntax:    call SysDropFuncs                                           *</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR - Successful.                                 *</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa103e70ed4303627d9eb1a9b3cb2a084"> 1405</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#aa103e70ed4303627d9eb1a9b3cb2a084">SysDropFuncs</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;{</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// this is a NOP now</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;               <span class="comment">/* set return value           */</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;}</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">* Function:  SysFileDelete                                               *</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">* Syntax:    call SysFileDelete file                                     *</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">* Params:    file - file to be deleted.                                  *</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment">* Return:    Return code from DosDelete() function.                      *</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae88ee877c8c12acb2e896e7eb262c209"> 1422</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, <a class="code" href="unix_2rexxutil_8cpp.html#af00eb685356358bb4b5d60e591203c7f">SysFileDelete</a>, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;{</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">return</span> !DeleteFile(name) ? GetLastError() : 0;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;}</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">* Function:  SysFileSearch                                               *</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">* Syntax:    call SysFileSearch target, file, stem [, options]           *</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">* Params:    target  - String to search for.                             *</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">*            file    - Filespec to search.                               *</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">*            stem    - Stem variable name to place results in.           *</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">*            options - Any combo of the following:                       *</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">*                       &#39;C&#39; - Case sensitive search (non-default).       *</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="comment">*                       &#39;N&#39; - Preceed each found string in result stem   *</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">*                              with it line number in file (non-default).*</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR   - Successful.                               *</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">*            ERROR_NOMEM     - Out of memory.                            *</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#abad96b5cafd0998ce7fd5b944ecdb305"> 1445</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#abad96b5cafd0998ce7fd5b944ecdb305">SysFileSearch</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;{</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  CHAR        <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>[<a class="code" href="windows_2rexxutil_8cpp.html#a09a3b394b8602092d58347b791158062">MAX_LINE_LEN</a>];      <span class="comment">/* Line read from file        */</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordtype">char</span>       *ptr;                     <span class="comment">/* Pointer to char str found  */</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  ULONG       num = 0;                 <span class="comment">/* Line number                */</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <span class="keywordtype">size_t</span>      len;                     <span class="comment">/* Length of string           */</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordtype">size_t</span>      len2;                    <span class="comment">/* Length of string           */</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  ULONG       rc = 0;                  <span class="comment">/* Return code of this func   */</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordtype">bool</span>        linenums = <span class="keyword">false</span>;        <span class="comment">/* Set true for linenums in   */</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                                       <span class="comment">/* output                     */</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  <span class="keywordtype">bool</span>        sensitive = <span class="keyword">false</span>;       <span class="comment">/* Set true for case-sens     */</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                                       <span class="comment">/* search                     */</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="struct_rx_stem_data.html">RXSTEMDATA</a>  ldp;                     <span class="comment">/* stem data                  */</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="keywordtype">char</span>       *buffer_pointer;          <span class="comment">/* current buffer pointer     */</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <a class="code" href="struct___get_file_data.html">GetFileData</a> filedata;                <span class="comment">/* file read information      */</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a86965da6e034d2ecefa88ff3c2d213cc">NO_UTIL_ERROR</a>);<span class="comment">/* pass back result           */</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                       <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">if</span> (numargs &lt; 3 || numargs &gt; 4 ||</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0]) ||</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[1]) ||</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[2]))</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;            <span class="comment">/* raise an error             */</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  buffer_pointer = NULL;               <span class="comment">/* nothing in buffer          */</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *target = args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;             <span class="comment">/* get target pointer         */</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *file = args[1].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;               <span class="comment">/* get file name              */</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keywordflow">if</span> (numargs == 4) {                  <span class="comment">/* process options            */</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *opts = args[3].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;     <span class="comment">/* point to the options       */</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span> (strstr(opts, <span class="stringliteral">&quot;N&quot;</span>) || strstr(opts, <span class="stringliteral">&quot;n&quot;</span>))</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      linenums = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> (strstr(opts, <span class="stringliteral">&quot;C&quot;</span>) || strstr(opts, <span class="stringliteral">&quot;c&quot;</span>))</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      sensitive = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                       <span class="comment">/* Initialize data area       */</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a> = 0;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  strcpy(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>, args[2].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a> = args[2].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">strlength</a>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                                       <span class="comment">/* uppercase the name         */</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <a class="code" href="windows_2rexxutil_8cpp.html#aec33b06d90ac834899b86039851abced">memupper</a>(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>, strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>));</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="keywordflow">if</span> (ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>-1] != <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>++] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#a8983afb4113449c47f41a55a283a10a2">MyOpenFile</a>(file, &amp;filedata)) {   <span class="comment">/* open the file              */</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#afca154868d5055477f8ec8a5cc3eb1c1">ERROR_FILEOPEN</a>);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;              <span class="comment">/* finished                   */</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                       <span class="comment">/* do the search...found lines*/</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                       <span class="comment">/* are saved in stem vars     */</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="windows_2rexxutil_8cpp.html#a3cb9da7fb9d0e9c4f3ec58492df0aced">GetLine</a>(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, <a class="code" href="windows_2rexxutil_8cpp.html#a09a3b394b8602092d58347b791158062">MAX_LINE_LEN</a> - 1, &amp;filedata)) {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    len = strlen(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    num++;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    ptr = <a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(<a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, target, len, args[0].strlength, sensitive);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (ptr != NULL) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <span class="keywordflow">if</span> (linenums) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;        wsprintf(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>, <span class="stringliteral">&quot;%d &quot;</span>, num);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        len2 = strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        memcpy(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>+len2, <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, <a class="code" href="_array_class_8cpp.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(len, <a class="code" href="windows_2rexxutil_8cpp.html#a26f71277f565e460c73f60a89c8c57e6">IBUF_LEN</a>-len2));</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a> = <a class="code" href="_array_class_8cpp.html#ac6afabdc09a49a433ee19d8a9486056d">std::min</a>(<span class="keywordtype">size_t</span>(<a class="code" href="windows_2rexxutil_8cpp.html#a26f71277f565e460c73f60a89c8c57e6">IBUF_LEN</a>), len+len2);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        memcpy(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>, <a class="code" href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a>, len);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a> = len;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>++;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      ltoa((<span class="keywordtype">long</span>)ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>, ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>+ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>, 10);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="keywordflow">if</span> (ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>[ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>-1] == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>--;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">shvnext</a> = NULL;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr = ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength = strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">shvnamelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">shvvaluelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">shvcode</a> = <a class="code" href="rexxapidefs_8h.html#a8ffa6714f4ffb75f4c65cff2ba8e84b9">RXSHV_SET</a>;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> = 0;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a>(&amp;ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>) == <a class="code" href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a>) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#a8468fc5c1c06493766b86dbf139a06ea">CloseFile</a>(&amp;filedata);          <span class="comment">/* close the file             */</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;        <span class="comment">/* error on non-zero          */</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <a class="code" href="windows_2rexxutil_8cpp.html#a8468fc5c1c06493766b86dbf139a06ea">CloseFile</a>(&amp;filedata);                <span class="comment">/* Close that file            */</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;                                       <span class="comment">/* set stem.0 to lines read   */</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  ltoa((<span class="keywordtype">long</span>)ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>, ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>, 10);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>+1] = 0;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">shvnext</a> = NULL;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr = ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength = ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>+1;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">shvnamelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>+1;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">shvvaluelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">shvcode</a> = <a class="code" href="rexxapidefs_8h.html#a8ffa6714f4ffb75f4c65cff2ba8e84b9">RXSHV_SET</a>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> = 0;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a>(&amp;ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>) == <a class="code" href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a>)</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;            <span class="comment">/* error on non-zero          */</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;}</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">/*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *\</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment"> *                                                                            *</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment"> *   SysFileTree() implmentation and helper functions.                        *</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment"> *                                                                            *</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment">\* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -*/</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment"> * This is a SysFileTree specific function.</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment"> * @param c</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"> * @param pos</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment"> * @param actual</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a65011e5ea12430a310b308c79481064e"> 1572</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="windows_2rexxutil_8cpp.html#a65011e5ea12430a310b308c79481064e">badSFTOptsException</a>(<a class="code" href="struct_rexx_thread_context__.html">RexxThreadContext</a> *c, <span class="keywordtype">size_t</span> pos, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> actual)</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;{</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    <span class="keywordtype">char</span> buf[256] = {0};</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    _snprintf(buf, <span class="keyword">sizeof</span>(buf),</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;             <span class="stringliteral">&quot;SysFileTree argument %zd must be a combination of F, D, B, S, T, L, I, or O; found \&quot;%s\&quot;&quot;</span>,</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;             pos, actual);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    c-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a>, c-&gt;String(buf));</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;}</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="comment"> * This is a SysFile specific function.</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="comment"> * @param c</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="comment"> * @param pos</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="comment"> * @param actual</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a46f76935abcd584285feb9ee9dbf145f"> 1589</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="windows_2rexxutil_8cpp.html#a46f76935abcd584285feb9ee9dbf145f">badMaskException</a>(<a class="code" href="struct_rexx_thread_context__.html">RexxThreadContext</a> *c, <span class="keywordtype">size_t</span> pos, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> actual)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;{</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordtype">char</span> buf[256] = {0};</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    _snprintf(buf, <span class="keyword">sizeof</span>(buf),</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;             <span class="stringliteral">&quot;SysFileTree argument %zd must be 5 characters or less in length containing only &#39;+&#39;, &#39;-&#39;, or &#39;*&#39;; found \&quot;%s\&quot;&quot;</span>,</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;             pos, actual);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    c-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a>, c-&gt;String(buf));</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;}</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment"> * Returns a value that is greater than &#39;need&#39; by doubling &#39;have&#39; until that</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment"> * value is reached.</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a779a231240dce6d3984b74c927665585"> 1603</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">size_t</span> <a class="code" href="windows_2rexxutil_8cpp.html#a779a231240dce6d3984b74c927665585">neededSize</a>(<span class="keywordtype">size_t</span> need, <span class="keywordtype">size_t</span> have)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;{</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="keywordflow">while</span> ( have &lt; need )</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        have *= 2;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">return</span> have;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;}</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment"> * Allocates a buffer that is at least twice as big as the buffer passed in.</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment"> * @param c             Call context we are operating in.</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment"> * @param dBuf          Pointer to the buffer to reallocate</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment"> * @param nBuf          Size of current dBuf buffer. Will be updated on return</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment"> *                      to size of newly allocated buffer.</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment"> * @param needed        Minimum size needed.</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment"> * @param nStaticBuffer Size of original static buffer.</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment"> * @return True on success, false on memory allocation failure.</span></div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="comment"> * @remarks  NOTE: that the pointer to the buffer to reallocate, may, or may</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment"> *           not, be a pointer to a static buffer.  We must NOT try to free a</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment"> *           static buffer and we MUST free a non-static buffer.</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f"> 1628</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> **dBuf, <span class="keywordtype">size_t</span> *nBuf, <span class="keywordtype">size_t</span> needed, <span class="keywordtype">size_t</span> nStaticBuffer)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;{</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">if</span> ( *nBuf != nStaticBuffer )</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        LocalFree(*dBuf);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160; </div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    *nBuf = <a class="code" href="windows_2rexxutil_8cpp.html#a779a231240dce6d3984b74c927665585">neededSize</a>(needed, *nBuf);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    *dBuf = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, *nBuf * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">if</span> ( *dBuf == NULL )</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160; </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;}</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment"> * Checks that attr is the same as that specified by the mask.</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment"> * @param mask</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment"> * @param attr</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment"> * @param options</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment"> * @return True for a match, otherwise false.</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#adb30d8462f397fcbb11dd7b1d5b5c0a9"> 1656</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#adb30d8462f397fcbb11dd7b1d5b5c0a9">sameAttr</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *mask, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> attr, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> options)</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;{</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">if</span> ( (options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a>) &amp;&amp; ! (options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a>) &amp;&amp; ! (attr &amp; FILE_ATTRIBUTE_DIRECTORY) )</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordflow">if</span> ( ! (options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a>) &amp;&amp; (options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a>) &amp;&amp; (attr &amp; FILE_ATTRIBUTE_DIRECTORY) )</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">if</span> ( mask[0] == <a class="code" href="windows_2rexxutil_8cpp.html#ae7800c48813cfde08f4ad9334789064b">RXIGNORE</a> )</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    {</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">true</span>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">if</span> ( mask[0] &lt; 0 &amp;&amp; attr &amp; FILE_ATTRIBUTE_ARCHIVE )</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">if</span> ( mask[0] &gt; 0 &amp;&amp; ! (attr &amp; FILE_ATTRIBUTE_ARCHIVE) )</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">if</span> ( mask[1] &lt; 0 &amp;&amp; attr &amp; FILE_ATTRIBUTE_DIRECTORY )</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> ( mask[1] &gt; 0 &amp;&amp; ! (attr &amp; FILE_ATTRIBUTE_DIRECTORY) )</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">if</span> ( mask[2] &lt; 0 &amp;&amp; attr &amp; FILE_ATTRIBUTE_HIDDEN )</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span> (mask[2] &gt; 0 &amp;&amp; ! (attr &amp; FILE_ATTRIBUTE_HIDDEN) )</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">if</span> (mask[3] &lt; 0 &amp;&amp; attr &amp; FILE_ATTRIBUTE_READONLY )</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">if</span> (mask[3] &gt; 0 &amp;&amp; ! (attr &amp; FILE_ATTRIBUTE_READONLY) )</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">if</span> (mask[4] &lt; 0 &amp;&amp; attr &amp; FILE_ATTRIBUTE_SYSTEM )</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">if</span> (mask[4] &gt; 0 &amp;&amp; ! (attr &amp; FILE_ATTRIBUTE_SYSTEM) )</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="keywordflow">return</span>  <span class="keyword">false</span>;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="keywordflow">return</span>  <span class="keyword">true</span>;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;}</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment"> * Returns a new file attribute value given a mask of attributes to be changed</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment"> * and the current attribute value.</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="comment"> * @param mask</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="comment"> * @param attr</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment"> * @return New attribute value.</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa577bd9dd9463fe358b0eada0fcd44fd"> 1724</a></span>&#160;<span class="keyword">static</span> <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="code" href="windows_2rexxutil_8cpp.html#aa577bd9dd9463fe358b0eada0fcd44fd">newAttr</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *mask, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> attr)</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;{</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> ( mask[0] == <a class="code" href="windows_2rexxutil_8cpp.html#ae7800c48813cfde08f4ad9334789064b">RXIGNORE</a> )</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="keywordflow">return</span>  attr;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordflow">if</span> ( mask[0] &lt; 0 )</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    {</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_ARCHIVE;   <span class="comment">// Clear</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">if</span> ( mask[0] &gt; 0 )</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        attr |= FILE_ATTRIBUTE_ARCHIVE;    <span class="comment">// Set</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> ( mask[1] &lt; 0 )</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_DIRECTORY; <span class="comment">// Clear</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">if</span> ( mask[1] &gt; 0 )</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        attr |= FILE_ATTRIBUTE_DIRECTORY;  <span class="comment">// Set</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">if</span> ( mask[2] &lt; 0 )</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    {</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_HIDDEN;    <span class="comment">// Clear</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordflow">if</span> ( mask[2] &gt; 0 )</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        attr |= FILE_ATTRIBUTE_HIDDEN;     <span class="comment">// Set</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">if</span> ( mask[3] &lt; 0 )</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_READONLY;  <span class="comment">// Clear</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">if</span> ( mask[3] &gt; 0 )</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        attr |= FILE_ATTRIBUTE_READONLY;   <span class="comment">// Set</span></div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">if</span> ( mask[4] &lt; 0 )</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        attr &amp;= ~FILE_ATTRIBUTE_SYSTEM;    <span class="comment">// Clear</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="keywordflow">if</span> ( mask[4] &gt; 0 )</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        attr |= FILE_ATTRIBUTE_SYSTEM;     <span class="comment">// Set</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="keywordflow">return</span>  attr;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;}</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment"> * Changes the file attributes of the specified file to those specified by attr.</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;<span class="comment"> * @param file  File to change the attributes of.</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="comment"> * @param attr  New file attributes.</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="comment"> * @return True on success, false on error.</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment"> * @remarks  Note that this function was named SetFileMode() in the old IBM</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;<span class="comment"> * code.</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a52551faaaa7d98c3b68e9a95d1e8812c"> 1787</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a52551faaaa7d98c3b68e9a95d1e8812c">setAttr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *file, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> attr)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;{</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="keywordflow">if</span> ( SetFileAttributes(file, attr) == 0 )</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    {</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;}</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment"> * This function is used by SysFileTree only.</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment"> * Formats the line for a found file and adds it to the stem containing all the</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment"> * found files.</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment"> * @param c</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment"> * @parm  path</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"> * @param treeData</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment"> * @param newMask</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment"> * @param options</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment"> * @param wfd</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment"> * @return True on success, false on error.</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment"> * @remarks  We try to use the static buffers in treeData, but if they are not</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment"> *  big enough, we allocate memory.  If we do allocate memory, we have to free</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment"> *  it of course.  We can determine if the memory needs to be freed by checking</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="comment"> *  that either nFoundFile, or nFoundFileLine, are the same size as they are</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="comment"> *  originally set to, or not.</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="comment"> *  If the file search is a very deep recursion in the host file system, a very</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;<span class="comment"> *  large number of String objects may be created in the single Call context of</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment"> *  SysFileTree.  A reference to each created object is saved in a hash table to</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment"> *  protect it from garbage collection, which can lead to a very large hash</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment"> *  table.  To prevent the creation of a very large hash table, we create a temp</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment"> *  object, pass that object to the interpreter, and then tell the interpreter</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="comment"> *  the object no longer needs to be protected in this call context.</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a2c95be1e6d1ce22e37c9bfbd440459b6"> 1826</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a2c95be1e6d1ce22e37c9bfbd440459b6">formatFile</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *path, <a class="code" href="struct_rx_tree_data.html">RXTREEDATA</a> *treeData, <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *newMask,</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;                       <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> options, WIN32_FIND_DATA *wfd)</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;{</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    SYSTEMTIME systime;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    FILETIME   ftLocal;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="keywordtype">char</span>   *dFoundFile = treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordtype">size_t</span>  nFoundFile = <span class="keyword">sizeof</span>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordtype">int</span> len = _snprintf(dFoundFile, nFoundFile, <span class="stringliteral">&quot;%s%s&quot;</span>, path, wfd-&gt;cFileName);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">if</span> ( len &lt; 0 || len == nFoundFile )</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        nFoundFile = strlen(path) + strlen(wfd-&gt;cFileName) + 1;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        dFoundFile = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, nFoundFile);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <span class="keywordflow">if</span> ( dFoundFile == NULL )</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="comment">// Buffer is sure to be big enough now, we we don&#39;t check the return.</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        _snprintf(dFoundFile, nFoundFile, <span class="stringliteral">&quot;%s%s&quot;</span>, path, wfd-&gt;cFileName);</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    }</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">if</span> ( options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#ae64f2f78f77dc2698028906d97e18751">NAME_ONLY</a> )</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    {</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> t = c-&gt;String(dFoundFile);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160; </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="comment">// Add the file name to the stem and be done with it.</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">count</a>++;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        c-&gt;SetStemArrayElement(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a9bef0c4b76ac4283092efe843ad39f35">files</a>, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">count</a>, t);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        c-&gt;ReleaseLocalReference(t);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <span class="keywordflow">if</span> ( nFoundFile != <span class="keyword">sizeof</span>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>) )</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            LocalFree(dFoundFile);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">// The file attributes need to be changed before we format the found file</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">// line.</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> changedAttr = <a class="code" href="windows_2rexxutil_8cpp.html#aa577bd9dd9463fe358b0eada0fcd44fd">newAttr</a>(newMask, wfd-&gt;dwFileAttributes);</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">if</span> ( changedAttr != wfd-&gt;dwFileAttributes )</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        <span class="comment">// try to set the attributes, but if it fails, just use the exsiting.</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a52551faaaa7d98c3b68e9a95d1e8812c">setAttr</a>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>, changedAttr &amp; ~FILE_ATTRIBUTE_DIRECTORY) )</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            changedAttr = wfd-&gt;dwFileAttributes;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    }</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// Convert UTC to local file time, and then to system format.</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    FileTimeToLocalFileTime(&amp;wfd-&gt;ftLastWriteTime, &amp;ftLocal);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    FileTimeToSystemTime(&amp;ftLocal, &amp;systime);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="comment">// The fileTime buffer is 64 bytes, and the fileAtt buffer is 16 bytes.</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">// Since we can count the characters put into the buffer here, there is</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <span class="comment">// no need to check for buffer overflow.</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="keywordflow">if</span> ( options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#a2a931c7ac0ee9eb68945edc736d43a64">LONG_TIME</a> )</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        sprintf(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>, <span class="stringliteral">&quot;%4d-%02d-%02d %02d:%02d:%02d  %10lu  &quot;</span>,</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;                systime.wYear,</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                systime.wMonth,</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                systime.wDay,</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                systime.wHour,</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                systime.wMinute,</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                systime.wSecond,</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                wfd-&gt;nFileSizeLow);</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordflow">if</span> ( options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#aa482ee7aac998fef8df1ba15360b2548">EDITABLE_TIME</a> )</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            sprintf(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>, <span class="stringliteral">&quot;%02d/%02d/%02d/%02d/%02d  %10lu  &quot;</span>,</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                    (systime.wYear + 100) % 100,</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                    systime.wMonth,</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                    systime.wDay,</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                    systime.wHour,</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                    systime.wMinute,</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                    wfd-&gt;nFileSizeLow);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        }</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            sprintf(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>, <span class="stringliteral">&quot;%2d/%02d/%02d  %2d:%02d%c  %10lu  &quot;</span>,</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                    systime.wMonth,</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                    systime.wDay,</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;                    (systime.wYear + 100) % 100,</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                    (systime.wHour &lt; 13 &amp;&amp; systime.wHour != 0 ?</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                     systime.wHour : (abs(systime.wHour - (SHORT)12))),</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                    systime.wMinute,</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;                    (systime.wHour &lt; 12 || systime.wHour == 24) ? <span class="charliteral">&#39;a&#39;</span> : <span class="charliteral">&#39;p&#39;</span>,</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;                    wfd-&gt;nFileSizeLow);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        }</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160; </div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    sprintf(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae9860099d7c029962a0f1268cfa4b129">fileAttr</a>, <span class="stringliteral">&quot;%c%c%c%c%c  &quot;</span>,</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;           (changedAttr &amp; FILE_ATTRIBUTE_ARCHIVE)   ? <span class="charliteral">&#39;A&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;           (changedAttr &amp; FILE_ATTRIBUTE_DIRECTORY) ? <span class="charliteral">&#39;D&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;           (changedAttr &amp; FILE_ATTRIBUTE_HIDDEN)    ? <span class="charliteral">&#39;H&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;           (changedAttr &amp; FILE_ATTRIBUTE_READONLY)  ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;-&#39;</span>,</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;           (changedAttr &amp; FILE_ATTRIBUTE_SYSTEM)    ? <span class="charliteral">&#39;S&#39;</span> : <span class="charliteral">&#39;-&#39;</span>);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="comment">// Now format the complete line, allocating memory if we have to.</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordtype">char</span>   *dFoundFileLine = treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae68ea12a13b6f27d8cc0ca9d30d66a6e">foundFileLine</a>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keywordtype">size_t</span>  nFoundFileLine = <span class="keyword">sizeof</span>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae68ea12a13b6f27d8cc0ca9d30d66a6e">foundFileLine</a>);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    len = _snprintf(dFoundFileLine, nFoundFileLine, <span class="stringliteral">&quot;%s%s%s&quot;</span>,</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                    treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae9860099d7c029962a0f1268cfa4b129">fileAttr</a>, dFoundFile);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keywordflow">if</span> ( len &lt; 0 || len == nFoundFileLine )</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        nFoundFileLine = strlen(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>) + strlen(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae9860099d7c029962a0f1268cfa4b129">fileAttr</a>) + nFoundFile + 1;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        dFoundFileLine = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, nFoundFileLine);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160; </div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <span class="keywordflow">if</span> ( dFoundFileLine == NULL )</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            <span class="keywordflow">if</span> ( nFoundFile != <span class="keyword">sizeof</span>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>) )</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                LocalFree(dFoundFile);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="comment">// Buffer is sure to be big enough now so we don&#39;t check return.</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        _snprintf(dFoundFileLine, nFoundFileLine, <span class="stringliteral">&quot;%s%s%s&quot;</span>, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">fileTime</a>, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae9860099d7c029962a0f1268cfa4b129">fileAttr</a>, dFoundFile);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    }</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="comment">// Place found file line in the stem.</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> t = c-&gt;String(dFoundFileLine);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">count</a>++;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    c-&gt;SetStemArrayElement(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a9bef0c4b76ac4283092efe843ad39f35">files</a>, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">count</a>, t);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    c-&gt;ReleaseLocalReference(t);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">if</span> ( nFoundFile != <span class="keyword">sizeof</span>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">foundFile</a>) )</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        LocalFree(dFoundFile);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">if</span> ( nFoundFileLine != <span class="keyword">sizeof</span>(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#ae68ea12a13b6f27d8cc0ca9d30d66a6e">foundFileLine</a>) )</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        LocalFree(dFoundFileLine);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;}</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment"> * Finds all files matching a file specification, formats a file name line and</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment"> * adds the formatted line to a stem.  Much of the data to complete this</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;<span class="comment"> * operation is contained in the treeData struct.</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment"> * This is a recursive function that may search through subdirectories if the</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment"> * recurse option is used.</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment"> * @param c           Call context we are operating in.</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment"> * @param path        Current directory we are searching.</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment"> * @param treeData    Struct containing data pertaining to the search, such as</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment"> *                    the file specification we are searching for, the stem to</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment"> *                    put the results in, etc..</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment"> * @param targetMask  An array of integers which describe the source attribute</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment"> *                    mask.  Only files with attributes matching this mask will</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment"> *                    be found.</span></div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment"> * @param newMask     An array of integers which describe the target attribute</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment"> *                    mask.  Attributes of all found files will be changed / set</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment"> *                    to the values specified by this mask.</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment"> * @param options</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment"> * @return uint32_t</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment"> * @remarks  For both targetMask and newMask, each index of the mask corresponds</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment"> *           to a different file attribute.  Each index and its associated</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment"> *           attribute are as follows:</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment"> *                        mask[0] = FILE_ARCHIVED</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment"> *                        mask[1] = FILE_DIRECTORY</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment"> *                        mask[2] = FILE_HIDDEN</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment"> *                        mask[3] = FILE_READONLY</span></div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="comment"> *                        mask[4] = FILE_SYSTEM</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment"> *           A negative value at a given index indicates that the attribute bit</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment"> *           of the file is not set.  A positive number indicates that the</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment"> *           attribute should be set. A value of 0 indicates a &quot;Don&#39;t Care&quot;</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment"> *           setting.</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment"> *           A close reading of MSDN seems to indicate that as long as we are</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment"> *           compiled for ANSI, which we are, that MAX_PATH is sufficiently</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment"> *           large.  But, we will code for the possibility that it is not large</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment"> *           enough, by mallocing dynamic memory if _snprintf indicates a</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment"> *           failure.</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment"> *           We point dTmpFileName at the static buffer and nTmpFileName is set</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment"> *           to the size of the buffer.  If we have to allocate memory,</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment"> *           nTmpFileName will be set to the size we allocate and if</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment"> *           nTmpFileName does not equal what it is originally set to, we know</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment"> *           we have to free the allocated memory.</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02029"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a6a75e2ce6e9d93b82e81e440c25e64af"> 2029</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a6a75e2ce6e9d93b82e81e440c25e64af">recursiveFindFile</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *path, <a class="code" href="struct_rx_tree_data.html">RXTREEDATA</a> *treeData,</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                              <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *targetMask, <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *newMask, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> options)</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;{</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  WIN32_FIND_DATA  wfd;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  HANDLE           fHandle;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  <span class="keywordtype">char</span>             tmpFileName[<a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a>];</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  <span class="keywordtype">char</span>            *dTmpFileName = tmpFileName;       <span class="comment">// Dynamic memory for tmpFileName, static memory to begin with.</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="keywordtype">size_t</span>           nTmpFileName = <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a>; <span class="comment">// CouNt of bytes in dTmpFileName.</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>          len;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="keywordtype">bool</span>             result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  len = _snprintf(dTmpFileName, nTmpFileName, <span class="stringliteral">&quot;%s%s&quot;</span>, path, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="keywordflow">if</span> ( len &lt; 0 || len == nTmpFileName )</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      nTmpFileName = strlen(path) + strlen(treeData-&gt;<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>) + 1;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      dTmpFileName = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, nTmpFileName);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;      <span class="keywordflow">if</span> ( dTmpFileName == NULL )</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;          <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;          result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;          <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;      <span class="comment">// buffer is sure to be big enough now, so we don&#39;t check the return.</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;      _snprintf(dTmpFileName, nTmpFileName, <span class="stringliteral">&quot;%s%s&quot;</span>, path, treeData-&gt;<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  fHandle = FindFirstFile(dTmpFileName, &amp;wfd);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordflow">if</span> ( fHandle != INVALID_HANDLE_VALUE )</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;          <span class="comment">// Skip dot directories</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;          <span class="keywordflow">if</span> ( strcmp(wfd.cFileName, <span class="stringliteral">&quot;.&quot;</span>) == 0 || strcmp(wfd.cFileName, <span class="stringliteral">&quot;..&quot;</span>) == 0 )</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;          {</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;          }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="windows_2rexxutil_8cpp.html#adb30d8462f397fcbb11dd7b1d5b5c0a9">sameAttr</a>(targetMask, wfd.dwFileAttributes, options) )</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;          {</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;              <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a2c95be1e6d1ce22e37c9bfbd440459b6">formatFile</a>(c, path, treeData, newMask, options, &amp;wfd) )</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;              {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                  FindClose(fHandle);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                  result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                  <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;              }</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;          }</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      } <span class="keywordflow">while</span> ( FindNextFile(fHandle, &amp;wfd) );</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      FindClose(fHandle);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="keywordflow">if</span> ( options &amp; <a class="code" href="windows_2rexxutil_8cpp.html#ac0c299988aa45f396d7e7296bfa59851">RECURSE</a> )</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;      <span class="comment">// Build new target spec.  Above, path + fileSpec fit into tmpFileName,</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="comment">// fileSpec is always longer than 1 character, so we are okay here.</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      sprintf(dTmpFileName, <span class="stringliteral">&quot;%s*&quot;</span>, path);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      fHandle = FindFirstFile(dTmpFileName, &amp;wfd);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;      <span class="keywordflow">if</span> ( fHandle != INVALID_HANDLE_VALUE )</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;          <span class="keywordflow">do</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;          {</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;              <span class="comment">// Skip non-directories and dot directories.</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;              <span class="keywordflow">if</span> ( ! (wfd.dwFileAttributes &amp; FILE_ATTRIBUTE_DIRECTORY) ||</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                   strcmp(wfd.cFileName, <span class="stringliteral">&quot;.&quot;</span>) == 0 || strcmp(wfd.cFileName, <span class="stringliteral">&quot;..&quot;</span>) == 0 )</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;              {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;              }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;              <span class="comment">// Build the new directory file name.</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;              len = _snprintf(dTmpFileName, nTmpFileName, <span class="stringliteral">&quot;%s%s\\&quot;</span>, path, wfd.cFileName);</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;              <span class="keywordflow">if</span> ( len &lt; 0 || len == nTmpFileName )</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;              {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                  <span class="comment">// We may need to free dTmpFileName if it is now allocated</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                  <span class="comment">// memory.</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                  <span class="keywordflow">if</span> ( nTmpFileName != <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a> )</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                  {</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                      LocalFree(dTmpFileName);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                  }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                  nTmpFileName = strlen(path) + strlen(wfd.cFileName) + 2;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                  dTmpFileName = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, nTmpFileName);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                  <span class="keywordflow">if</span> ( dTmpFileName == NULL )</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                  {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                      <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                      FindClose(fHandle);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                      result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                      <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                  }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                  <span class="comment">// buffer is sure to be big enough now, so we don&#39;t check the</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                  <span class="comment">// return.</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                  _snprintf(dTmpFileName, nTmpFileName, <span class="stringliteral">&quot;%s%s\\&quot;</span>, path, wfd.cFileName);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;              }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;              <span class="comment">// Search the next level.</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;              <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a6a75e2ce6e9d93b82e81e440c25e64af">recursiveFindFile</a>(c, tmpFileName, treeData, targetMask, newMask, options) )</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;              {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                  FindClose(fHandle);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                  result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                  <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;              }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;          }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;          <span class="keywordflow">while</span> (FindNextFile(fHandle, &amp;wfd));</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;          FindClose(fHandle);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  }</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;done_out:</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordflow">if</span> ( nTmpFileName != <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a> )</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">safeLocalFree</a>(dTmpFileName);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;}</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment"> * This is a SysFileTree() specific function.  It is only called, indirectly</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment"> * through getPath(), from SysFileTree().</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="comment"> * This function mimics the old IBM code.</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="comment"> * Leading spaces are stripped, in some cases. A file specification of &quot;.&quot; is</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment"> * changed to &quot;*.*&quot; and a file specification of &quot;..&quot; is changed to &quot;..\*.*&quot;</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="comment"> * Leading spaces in fSpec are stripped IFF the first character(s) after the</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment"> * leading spaces:</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment"> *       is &#39;\&#39; or &#39;/&#39;</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment"> *     or</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="comment"> *       is &#39;.\&#39; or &#39;./&#39;</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="comment"> *     or</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment"> *       is &#39;..\&#39; or &#39;../&#39;</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment"> *     or</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment"> *        is z:  (i.e., a drive letter)</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment"> * @param fSpec  The SysFileTree search specification</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="comment"> * @return A pointer to fSpec, possibly adjust to point to the first non-space</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="comment"> *         character in the string.</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="comment"> * @side effects:  fSpec may be changed from &quot;.&quot; to &quot;*.*&quot; or may be changed from</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment"> *                 &quot;..&quot; to &quot;..\*.*&quot;</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment"> * @assumes:  The buffer for fSpec is large enough for the possible changes.</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5c58f57f9c642ad0a72ebbd45697aa6e"> 2176</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="windows_2rexxutil_8cpp.html#a5c58f57f9c642ad0a72ebbd45697aa6e">adjustFSpec</a>(<span class="keywordtype">char</span> *fSpec)</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;{</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordtype">size_t</span> i = 0;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160; </div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="comment">// Skip leading blanks.</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    <span class="keywordflow">while</span> ( fSpec[i] == <span class="charliteral">&#39; &#39;</span> )</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    {</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        i++;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    }</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160; </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">if</span> ( i &gt; 0 )</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    {</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="keywordtype">size_t</span> len = strlen(fSpec);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        <span class="comment">// This series of if statements could be combined in to on huge if, but</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        <span class="comment">// this is easier to comprehend:</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">if</span> ( fSpec[i] == <span class="charliteral">&#39;\\&#39;</span> || fSpec[i] == <span class="charliteral">&#39;/&#39;</span> )                         <span class="comment">// The &quot;\&quot; case</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            fSpec = &amp;fSpec[i];</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fSpec[i] == <span class="charliteral">&#39;.&#39;</span> )</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            <span class="keywordflow">if</span> ( i + 1 &lt; len )</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                <span class="keywordflow">if</span> ( fSpec[i + 1] == <span class="charliteral">&#39;\\&#39;</span> || fSpec[i + 1] == <span class="charliteral">&#39;/&#39;</span> )         <span class="comment">// The &quot;.\&quot; case</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                    fSpec = &amp;fSpec[i];</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( i + 2 &lt; len )</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                    <span class="keywordflow">if</span> ( fSpec[i + 1] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                         (fSpec[i + 2] == <span class="charliteral">&#39;\\&#39;</span> || fSpec[i + 2] == <span class="charliteral">&#39;/&#39;</span>) )   <span class="comment">// The &quot;..\&quot; case</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                    {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                        fSpec = &amp;fSpec[i];</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;                    }</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( i + 1 &lt; len &amp;&amp; fSpec[i + 1] == <span class="charliteral">&#39;:&#39;</span> )                     <span class="comment">// The &quot;z:&#39; case</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        {</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            fSpec = &amp;fSpec[i];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        }</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="keywordflow">if</span> ( strcmp(fSpec, <span class="stringliteral">&quot;.&quot;</span>) == 0 )</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="comment">// If fSpec is exactly &quot;.&quot; then change it to &quot;*.*&quot;</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        strcpy(fSpec, <span class="stringliteral">&quot;*.*&quot;</span>);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    }</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(fSpec, <span class="stringliteral">&quot;..&quot;</span>) == 0 )</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="comment">// Else if fSpec is exactly &quot;..&quot; then change it to &quot;..\*.*&quot;</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        strcpy(fSpec, <span class="stringliteral">&quot;..\\*.*&quot;</span>);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <span class="keywordflow">return</span> fSpec;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;}</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a380dd07de146d431f3eef3e765ed27c5"> 2234</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a380dd07de146d431f3eef3e765ed27c5">safeGetCurrentDirectory</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> **pPath, <span class="keywordtype">size_t</span> *pPathLen)</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;{</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keywordtype">size_t</span>  pathLen = *pPathLen;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    <span class="keywordtype">char</span>   *path    = *pPath;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="comment">// Get the current directory.  First check that the path buffer is large</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">// enough.</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ret = GetCurrentDirectory(0, 0);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">if</span> ( ret == 0 )</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;GetCurrentDirectory&quot;</span>, GetLastError());</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160; </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="comment">// we might need to add a trailing backslash here, so make sure we leave enough room</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    ret += <a class="code" href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">FNAMESPEC_BUF_EXTRA</a>;</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160; </div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    path = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, ret);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">if</span> ( path == NULL )</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;    {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160; </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="comment">// Fix up our input path / pathLen variables now.  The input path buffer</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="comment">// is allocated memory, so we need to free it.</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    LocalFree(*pPath);</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    *pPath    = path;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    *pPathLen = ret;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160; </div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    ret = GetCurrentDirectory(ret, path);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    <span class="keywordflow">if</span> ( ret == 0 )</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    {</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;GetCurrentDirectory&quot;</span>, GetLastError());</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;}</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a87c3675528926b05b45c2c52e4d2f61a"> 2274</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a87c3675528926b05b45c2c52e4d2f61a">expandNonPath2fullPath</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *fSpec, <span class="keywordtype">char</span> **pPath, <span class="keywordtype">size_t</span> *pPathLen, <span class="keywordtype">int</span> *lastSlashPos)</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;{</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;    <span class="keywordtype">char</span>     *buf    = NULL;  <span class="comment">// used to save current dir</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="keywordtype">char</span>      drv[3] = {0};   <span class="comment">// used to change current drive</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>  ret    = 0;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordtype">bool</span>      result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160; </div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="comment">// fSpec could be a drive designator.</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="keywordflow">if</span> ( fSpec[1] == <span class="charliteral">&#39;:&#39;</span> )</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="comment">// Save the current drive and path, first get needed buffer size.</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        ret = GetCurrentDirectory(0, 0);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <span class="keywordflow">if</span> ( ret == 0 )</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;GetCurrentDirectory&quot;</span>, ret);</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        }</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        buf = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, ret);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        <span class="keywordflow">if</span> ( buf == NULL )</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        ret = GetCurrentDirectory(ret, buf);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="keywordflow">if</span> ( ret == 0 )</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;GetCurrentDirectory&quot;</span>, ret);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        }</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160; </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="comment">// Just copy the drive letter and the colon, omit the rest.  This is</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        <span class="comment">// necessary e.g. for something like &quot;I:*&quot;</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        memcpy(drv, fSpec, 2);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        <span class="comment">// Change to the specified drive, get the current directory, then go</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <span class="comment">// back to where we came from.</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        SetCurrentDirectory(drv);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordtype">bool</span> success = <a class="code" href="windows_2rexxutil_8cpp.html#a380dd07de146d431f3eef3e765ed27c5">safeGetCurrentDirectory</a>(c, pPath, pPathLen);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        SetCurrentDirectory(buf);</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        LocalFree(buf);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        buf = NULL;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="keywordflow">if</span> ( ! success )</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a>(c-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;GetCurrentDirectory&quot;</span>, ret);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160; </div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;        <span class="comment">// make drive the path</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        *lastSlashPos = 1;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        <span class="comment">// No drive designator, just get the current directory.</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a380dd07de146d431f3eef3e765ed27c5">safeGetCurrentDirectory</a>(c, pPath, pPathLen) )</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="comment">// If we need a trailing slash, add one.</span></div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordtype">char</span> *path = *pPath;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <span class="keywordflow">if</span> ( path[strlen(path) - 1] != <span class="charliteral">&#39;\\&#39;</span> )</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;        strcat(path, <span class="stringliteral">&quot;\\&quot;</span>);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    }</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;done_out:</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">safeLocalFree</a>(buf);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;}</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment"> * Splits the path portion off from fSpec and returns it in the path buffer.</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment"> * When this function is called, there is always at least one slash in fSpec.</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment"> * @param c</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment"> * @param fSpec</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="comment"> * @param lastSlashPos</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="comment"> * @param pPath</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="comment"> * @param pPathLen</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="comment"> * @return bool</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="comment"> * @remarks  The size of the path buffer is guarenteed to be at least the string</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment"> *           length of fSpec + FNAMESPEC_BUF_EXTRA (8) in size.  Or MAX (264)</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="comment"> *           bytes in size.  Whichever is larger.  So path is big enough to</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment"> *           contain all of fSpec + 7 characters.</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="comment"> *           We may have to enlarge the passed in path buffer.  If we do, we</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="comment"> *           need to be sure and update the path buffer pointer and the path</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="comment"> *           length. As long as we keep pPath and pPathLen correct, the caller</span></div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="comment"> *           will take care of freeing any memory.</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="comment"> *           But if we do change pPath, we need to free the buffer it was</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="comment"> *           pointing to.</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3f3162dc59bf43be0b2cf233c862b86e"> 2378</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a3f3162dc59bf43be0b2cf233c862b86e">expandPath2fullPath</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *fSpec, <span class="keywordtype">size_t</span> lastSlashPos, <span class="keywordtype">char</span> **pPath, <span class="keywordtype">size_t</span> *pPathLen)</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;{</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="keywordtype">size_t</span> l = 0;    <span class="comment">// Used to calculate lengths of strings.</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160; </div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="keywordtype">char</span>   *path    = *pPath;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <span class="keywordtype">size_t</span>  pathLen = *pPathLen;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="comment">// If fSpec starts with a drive designator, then we have a full path. Copy</span></div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="comment">// over the path portion, including the last slash, and null terminate it.</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <span class="keywordflow">if</span> (fSpec[1] == <span class="charliteral">&#39;:&#39;</span>)</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    {</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        l = lastSlashPos + 1;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        memcpy(path, fSpec, l);</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        path[l] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    }</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    {</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        <span class="keywordtype">char</span> fpath[MAX_PATH];</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="keywordtype">char</span> drive[_MAX_DRIVE];</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        <span class="keywordtype">char</span> dir[_MAX_DIR];</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        <span class="keywordtype">char</span> fname[_MAX_FNAME];</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        <span class="keywordtype">char</span> ext[_MAX_EXT];</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="keywordtype">char</span> lastChar;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="comment">// fpath is the only buffer we need to worry about being too small.</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        <span class="comment">// Although, when compiled for ANSI, which we are, I really think it is</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        <span class="comment">// impossible for MAX_PATH to be too small.</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="keywordtype">char</span>   *dFPath = fpath;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        <span class="keywordtype">size_t</span>  nFPath = MAX_PATH;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <span class="keywordflow">if</span> ( lastSlashPos == 0 )</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        {</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            <span class="comment">// Only 1 slash at the beginning, get the full path.</span></div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            _fullpath(dFPath, <span class="stringliteral">&quot;\\&quot;</span>, nFPath);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            l = strlen(dFPath) + strlen(&amp;fSpec[1]) + 1;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            <span class="keywordflow">if</span> ( l &gt; nFPath )</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            {</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;                <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a>(c, &amp;dFPath, &amp;nFPath, l, nFPath) )</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;                {</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                }</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;            }</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160; </div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            strcat(dFPath, &amp;fSpec[1]);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;            <span class="comment">// Chop off the path part by putting a null at the last slash, get</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="comment">// the full path, and then put the slash back.</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            fSpec[lastSlashPos] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            <span class="keywordflow">if</span> ( _fullpath(dFPath, fSpec, nFPath) == NULL )</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            {</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <span class="comment">// This will double the buffer until either _fullpath()</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                <span class="comment">// succeeds, or we run out of memory.  If we go through the loop</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                <span class="comment">// more than once, and fail, we need to free memory allocated</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                <span class="comment">// for dFPath.  We fix fSpec on failure, but that is not really</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                <span class="comment">// needed, the caller(s) will just quit on failure of this</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                <span class="comment">// function.</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                <span class="keywordflow">do</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                    <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a>(c, &amp;dFPath, &amp;nFPath, l, MAX_PATH) )</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                    {</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                        <span class="keywordflow">if</span> ( nFPath != MAX_PATH )</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                        {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                            LocalFree(dFPath);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                        }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160; </div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                        fSpec[lastSlashPos] = <span class="charliteral">&#39;\\&#39;</span>;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                    }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                } <span class="keywordflow">while</span> ( _fullpath(dFPath, fSpec, nFPath) == NULL );</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;            }</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160; </div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            fSpec[lastSlashPos] = <span class="charliteral">&#39;\\&#39;</span>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160; </div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;            lastChar = dFPath[strlen(dFPath) - 1];</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            <span class="keywordflow">if</span> (lastChar != <span class="charliteral">&#39;\\&#39;</span> &amp;&amp; lastChar != <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                l = strlen(dFPath) + strlen(&amp;fSpec[lastSlashPos]) + 1;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                <span class="keywordflow">if</span> ( l &gt; nFPath )</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                    <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a>(c, &amp;dFPath, &amp;nFPath, l, MAX_PATH) )</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                    {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                        <span class="comment">// If dFPath was allocated, free it.</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                        <span class="keywordflow">if</span> ( nFPath != MAX_PATH )</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                        {</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                            LocalFree(dFPath);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                        }</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;                    }</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160; </div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                strcat(dFPath, &amp;fSpec[lastSlashPos]);</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            }</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        _splitpath(dFPath, drive, dir, fname, ext);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;        l = strlen(drive) + strlen(dir) + 1;</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        <span class="keywordflow">if</span> ( l &gt; pathLen )</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        {</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a>(c, &amp;path, &amp;pathLen, l, pathLen) )</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            }</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160; </div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;            LocalFree(*pPath);</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;            *pPath    = path;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;            *pPathLen = pathLen;</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        strcpy(path, drive);</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        strcat(path, dir);</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160; </div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;        <span class="comment">// If path is invalid, (the empty string,) for some reason, copy the</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <span class="comment">// path from fSpec.  That is from the start of the string up through the</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <span class="comment">// last slash.  Then zero terminate it.  The path buffer is guaranteed</span></div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="comment">// big enough for this, see the remarks.</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        <span class="keywordflow">if</span> ( strlen(path) == 0 )</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            memcpy(path, fSpec, lastSlashPos + 1);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            path[lastSlashPos + 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;        }</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;        <span class="comment">// If we need a trailing slash, add it.  Again, the path buffer is</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <span class="comment">// guaranteed to be big enough.</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        <span class="keywordflow">if</span> (path[strlen(path) - 1] != <span class="charliteral">&#39;\\&#39;</span>)</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        {</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            strcat(path, <span class="stringliteral">&quot;\\&quot;</span>);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;}</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment"> * This is a SysFileTree() specific function..</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="comment"> * This function expands the file spec passed in to the funcition into its full</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="comment"> * path name.  The full path name is then split into the path portion and the</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="comment"> * file name portion.  The path portion is then returned in path and the file</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="comment"> * name portion is returned in fileName.</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment"> * The path portion will end with the &#39;\&#39; char if fSpec contains a path.</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="comment"> * @param fSpec</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="comment"> * @param path       Pointer to path buffer.  Path buffer is allocated memory,</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment"> *                   not a static buffer.</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="comment"> * @param filename</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment"> * @param pathLen    Pointer to size of the path buffer.</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="comment"> * @remarks  On entry, the buffer pointed to by fSpec is guaranteed to be at</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="comment"> *           least strlen(fSpec) + FNAMESPEC_BUF_EXTRA (8).  So, we can strcat</span></div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="comment"> *           to it at least 7 characters and still have it null terminated.</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment"> *           In addition, the path buffer is guarenteed to be at least that size</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment"> *           also.</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a7063b4325a083ec0efd84153ed2b695f"> 2537</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a7063b4325a083ec0efd84153ed2b695f">getPath</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *fSpec, <span class="keywordtype">char</span> **path, <span class="keywordtype">char</span> *filename, <span class="keywordtype">size_t</span> *pathLen)</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;{</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keywordtype">size_t</span> len;                     <span class="comment">// length of filespec</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="keywordtype">int</span>    lastSlashPos;            <span class="comment">// position of last slash</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    fSpec = <a class="code" href="windows_2rexxutil_8cpp.html#a5c58f57f9c642ad0a72ebbd45697aa6e">adjustFSpec</a>(fSpec);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160; </div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="comment">// Find the position of the last slash in fSpec</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    len = strlen(fSpec);</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160; </div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    <span class="comment">// Get the maximum position of the last &#39;\&#39;</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    lastSlashPos = (int)len;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="comment">// Step back through fSpec until at its beginning or at a &#39;\&#39; or &#39;/&#39; character</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <span class="keywordflow">while</span> ( fSpec[lastSlashPos] != <span class="charliteral">&#39;\\&#39;</span> &amp;&amp; fSpec[lastSlashPos] != <span class="charliteral">&#39;/&#39;</span> &amp;&amp; lastSlashPos &gt;= 0 )</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        --lastSlashPos;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    }</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160; </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    <span class="comment">// If lastSlashPos is less than 0, then there is no backslash present in</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="comment">// fSpec.</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keywordflow">if</span> ( lastSlashPos &lt; 0 )</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    {</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a87c3675528926b05b45c2c52e4d2f61a">expandNonPath2fullPath</a>(c, fSpec, path, pathLen, &amp;lastSlashPos) )</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        }</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    }</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a3f3162dc59bf43be0b2cf233c862b86e">expandPath2fullPath</a>(c, fSpec, lastSlashPos, path, pathLen) )</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        {</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        }</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160; </div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    <span class="comment">// Get the file name from fSpec, the portion just after the last &#39;\&#39;</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <span class="keywordflow">if</span> ( fSpec[lastSlashPos + 1] != <span class="charliteral">&#39;\0&#39;</span> )</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    {</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="comment">// The position after the last slash is not the null terminator so there</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        <span class="comment">// is something to copy over to the file name segment.</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        strcpy(filename, &amp;fSpec[lastSlashPos + 1]);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    }</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        <span class="comment">// The last slash is the last character in fSpec, just use wildcards for</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        <span class="comment">// the file name segment.</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        strcpy(filename, <span class="stringliteral">&quot;*.*&quot;</span>);</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    }</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;}</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="comment"> * This is a SysFileTree specific function.</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment"> * Determines the options by converting the character based argument to the</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment"> * correct set of flags.</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment"> * @param c</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment"> * @param opts</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment"> * @param pOpts</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="comment"> * @return bool</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ad90439a5509c675aa2831862c06eb6f2"> 2602</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#ad90439a5509c675aa2831862c06eb6f2">goodOpts</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *opts, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *pOpts)</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;{</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> options = *pOpts;</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="keywordflow">while</span> ( *opts )</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <span class="keywordflow">switch</span>( toupper(*opts) )</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        {</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:                      <span class="comment">// recurse into subdirectories</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#ac0c299988aa45f396d7e7296bfa59851">RECURSE</a>;</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160; </div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>:                      <span class="comment">// only return names</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#ae64f2f78f77dc2698028906d97e18751">NAME_ONLY</a>;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:                      <span class="comment">// use short time format, ignored if L is used</span></div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            options |= <a class="code" href="windows_2rexxutil_8cpp.html#aa482ee7aac998fef8df1ba15360b2548">EDITABLE_TIME</a>;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160; </div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:                      <span class="comment">// use long time format</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#a2a931c7ac0ee9eb68945edc736d43a64">LONG_TIME</a>;</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:                      <span class="comment">// include only files</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;              options &amp;= ~<a class="code" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a>;</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a>;</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160; </div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>:                      <span class="comment">// include only directories</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;              options &amp;= ~<a class="code" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a>;</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160; </div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:                      <span class="comment">// include both files and directories</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a>;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;              options |= <a class="code" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a>;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;          <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:                      <span class="comment">// case insensitive? no op on Windows</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;          <span class="keywordflow">default</span>:                       <span class="comment">// error, unknown option</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        }</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        opts++;</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    }</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160; </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    *pOpts = options;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;}</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="comment"> * This is a SysFileTree() specific helper function.</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment"> * Set a mask of unsigned ints to what is specified by a mask of chars.</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment"> * @param c</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment"> * @param msk</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment"> * @param mask</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment"> * @return True on success, false on error.</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment"> * @remarks  If a character in position N is a &#39;+&#39; then the unsigned int at</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment"> *           position N is set to 1.  This is turning it on.</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment"> *           If a character in position N is a &#39;-&#39; then the unsigned int at</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment"> *           position N is set to -1.  This is turning it off.</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment"> *           If a character in position N is a &#39;*&#39; then the unsigned int at</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment"> *           position N is set to 0.  This is saying ignore it, it doesn&#39;t</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment"> *           matter what the attribute is.</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aff8064d281bdc392e8186b81f986e6a2"> 2675</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#aff8064d281bdc392e8186b81f986e6a2">goodMask</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *c, <span class="keywordtype">char</span> *msk, <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *mask)</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;{</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> y = 0;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordflow">while</span> (*msk)</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        <span class="keywordflow">if</span> ( *msk == <span class="charliteral">&#39;+&#39;</span> )</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        {</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            mask[y] = 1;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        }</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( *msk == <span class="charliteral">&#39;-&#39;</span> )</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        {</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            mask[y] = -1;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        }</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*msk == <span class="charliteral">&#39;*&#39;</span>)</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;        {</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            mask[y] = 0;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        {</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        }</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        y++;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;        msk++;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    }</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;}</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="comment"> * This is a SysFileTree specific helper function.</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="comment"> * Checks the validity of an attribute mask argument and converts the character</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="comment"> * based mask into an integer based mask.</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="comment"> * @param context</span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="comment"> * @param msk</span></div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment"> * @param mask</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment"> * @param argPos</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment"> * @return bool</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02718"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a49e97b805c6dd6cfcae32a44ad4cc273"> 2718</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a49e97b805c6dd6cfcae32a44ad4cc273">getMaskFromArg</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *context, <span class="keywordtype">char</span> *msk, <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> *mask, <span class="keywordtype">size_t</span> argPos)</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;{</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(argPos) &amp;&amp; strlen(msk) &gt; 0 )</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">if</span> ( strlen(msk) &gt; 5 )</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        {</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#a46f76935abcd584285feb9ee9dbf145f">badMaskException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, argPos, msk);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        }</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160; </div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#aff8064d281bdc392e8186b81f986e6a2">goodMask</a>(context, msk, mask) )</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;        {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#a46f76935abcd584285feb9ee9dbf145f">badMaskException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, argPos, msk);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        }</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    {</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        mask[0] = <a class="code" href="windows_2rexxutil_8cpp.html#ae7800c48813cfde08f4ad9334789064b">RXIGNORE</a>;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    }</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160; </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;}</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment"> * This is a SysFileTree specific helper function.</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment"> * Checks the validity of the options argument to SysFileTree and converts the</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment"> * character based argument to the proper set of flags.</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment"> * @param context</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;<span class="comment"> * @param opts</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment"> * @param options</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment"> * @param argPos</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment"> * @return bool</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02755"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0abf85d7ec2b6300c8e332bee17b1ac9"> 2755</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#a0abf85d7ec2b6300c8e332bee17b1ac9">getOptionsFromArg</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *context, <span class="keywordtype">char</span> *opts, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *options, <span class="keywordtype">size_t</span> argPos)</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;{</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    *options = <a class="code" href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a> | <a class="code" href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a>;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(argPos) )</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    {</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        <span class="keywordflow">if</span> ( strlen(opts) == 0 )</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#aa7768c7412471a88c3cb717fb1d32c0a">nullStringException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;SysFileTree&quot;</span>, argPos);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#ad90439a5509c675aa2831862c06eb6f2">goodOpts</a>(context, opts, options) )</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#a65011e5ea12430a310b308c79481064e">badSFTOptsException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, argPos, opts);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        }</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    }</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;}</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="comment"> * This is a SysFileTree specific helper function.</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="comment"> * Allocates and returns a buffer containing the file specification to search</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="comment"> * for.</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="comment"> * The file specification consists of the search string as sent by the Rexx</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="comment"> * user, with possibly some glob characters added.  The returned buffer is</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="comment"> * bigger than the original string to accommodate these, possible, added</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="comment"> * characters.  The number of bytes added to the buffer is 8, which is what the</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="comment"> * original IBM code used.  8 is probably 1 byte more than needed, but there is</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="comment"> * no reason that this needs to be exact, better too long than too short.</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="comment"> * If the file speicfication ends in a slash (&#39;\&#39;) or a period (&#39;.&#39;) or two</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="comment"> * periods (&#39;..&#39;), then a wild card specification (&#39;*.*&#39;) is appended.</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="comment"> * However, note that there is also the case where a single &#39;.&#39; at the end of</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="comment"> * the file specification is not used as a directory specifier, but rather is</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="comment"> * tacked on to the end of a file name.</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment"> * Windows has a sometimes used convention that a &#39;.&#39; at the end of a file name</span></div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment"> * can be used to indicate the file has no extension. For example, given a file</span></div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="comment"> * named: MyFile a command of &quot;dir MyFile.&quot; will produce a listing of &quot;MyFile&quot;.</span></div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment"> * In this case we want to leave the file specification alone. that is, do not</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment"> * append a &quot;*.*&quot;. A command of &quot;dir *.&quot; will produce a directory listing of all</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment"> * files that do not have an extension.</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment"> * @param context</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment"> * @param fSpec</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment"> * @param fSpecLen     [returned]  The length of the original fSpec argument,</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment"> *                     not the length of the allocated buffer.</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment"> * @param fSpecBufLen  [returned]  The length of the length of the allocated</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment"> *                     fSpec buffer.</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment"> * @param argPos</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"> * @return A string specifying the file pattern to search for.  The buffer</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment"> *         holding the string is larger than the original input specify.</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment"> * @remarks  Caller is responsible for freeing memory.  Memory is allocated</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment"> *           using LocalAlloc(), not malloc().</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment"> *           If the returned buffer is null, a condition has been raised.</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment"> *           FNAMESPEC_BUF_EXTRA (8) is sized to contain the terminating NULL.</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment"> *           So the allocated buffer has room to concatenate 7 characters.</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a54dbb1c1fdba5d4447120978a87597f2"> 2824</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="windows_2rexxutil_8cpp.html#a54dbb1c1fdba5d4447120978a87597f2">getFileSpecFromArg</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *context, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> fSpec, <span class="keywordtype">size_t</span> *fSpecLen,</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                                <span class="keywordtype">size_t</span> *fSpecBufLen, <span class="keywordtype">size_t</span> argPos)</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;{</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="keywordtype">size_t</span> len = strlen(fSpec);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keywordflow">if</span> ( len == 0 )</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#aa7768c7412471a88c3cb717fb1d32c0a">nullStringException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>, <span class="stringliteral">&quot;SysFileTree&quot;</span>, argPos);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    }</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160; </div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    <span class="keywordtype">char</span> *fileSpec = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, len + <a class="code" href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">FNAMESPEC_BUF_EXTRA</a>);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="keywordflow">if</span> ( fileSpec == NULL )</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160; </div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="comment">// Allocated buffer is zero filled (LPTR flag) already, no need to zero</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="comment">// terminate.</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    memcpy(fileSpec, fSpec, len);</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160; </div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    <span class="keywordflow">if</span> ( fileSpec[len - 1] == <span class="charliteral">&#39;\\&#39;</span> )</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;    {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        strcat(fileSpec, <span class="stringliteral">&quot;*.*&quot;</span>);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    }</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( fileSpec[len - 1] == <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="keywordflow">if</span> ( len == 1 ||</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;             (len &gt; 1  &amp;&amp; (fileSpec[len - 2] == <span class="charliteral">&#39;\\&#39;</span> || fileSpec[len - 2] == <span class="charliteral">&#39;.&#39;</span>)) )</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;        {</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            strcat(fileSpec, <span class="stringliteral">&quot;\\*.*&quot;</span>);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    }</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160; </div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    *fSpecLen    = len;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    *fSpecBufLen = len + <a class="code" href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">FNAMESPEC_BUF_EXTRA</a>;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="keywordflow">return</span> fileSpec;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;}</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="comment"> * This is a SysFileTree specific helper function.</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment"> * Allocates and returns a buffer large enough to contain the path to search</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment"> * along.</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment"> *  We need a minimum size for the path buffer of at least MAX (264).  But the</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment"> *  old code seemed to think fileSpecLen + FNAMESPEC_BUF_EXTRA could be longer</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment"> *  than that.  I guess it could if the user put in a non-existent long file</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment"> *  path.</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment"> *  The old code of checking fSpecLen is still used, but I&#39;m unsure of its exact</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment"> *  purpose.</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;<span class="comment"> * @param context</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="comment"> * @param fSpecLen</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;<span class="comment"> * @param pathLen</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="comment"> * @return A buffer the larger of MAX or fSpecLen + FNAMESPEC_BUF_EXTRA bytes in</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment"> *         size.  Returns NULL on failure.</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="comment"> * @remarks  The caller is resposible for freeing the allocated memory.</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment"> *           LocalAlloc(), not malloc() is used for memory allocation.</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment"> *           Note that the path buffer is guarenteed to be FNAMESPEC_BUF_EXTRA</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment"> *           (8) bytes larger than the fNameSpec buffer in the caller.  This is</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment"> *           important in later checks for buffer overflow.</span></div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02892"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#accb279e5c95197bb20c3bdd3da404a65"> 2892</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">char</span> *<a class="code" href="windows_2rexxutil_8cpp.html#accb279e5c95197bb20c3bdd3da404a65">getPathBuffer</a>(<a class="code" href="struct_rexx_call_context__.html">RexxCallContext</a> *context, <span class="keywordtype">size_t</span> fSpecLen, <span class="keywordtype">size_t</span> *pathLen)</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;{</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    <span class="keywordtype">size_t</span> bufLen = <a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="keywordflow">if</span> ( fSpecLen + <a class="code" href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">FNAMESPEC_BUF_EXTRA</a> &gt; <a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a> )</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    {</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        bufLen = fSpecLen + <a class="code" href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">FNAMESPEC_BUF_EXTRA</a>;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    *pathLen = bufLen;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="keywordtype">char</span> *path = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, bufLen);</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">if</span> ( path == NULL )</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a>(context-&gt;<a class="code" href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">threadContext</a>);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    }</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160; </div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">return</span> path;</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;}</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="comment"> * Tests for illegal file name characters in fSpec.</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment"> * @param fSpec</span></div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment"> * @return bool</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;<span class="comment"> * @note  Double quotes in the file spec is not valid, spaces in file names do</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment"> *        not need to be within quotes in the string passed to the Windows API.</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="comment"> *        A &#39;:&#39; is only valid if it is the second character. Technically a &#39;*&#39;</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="comment"> *        and a &#39;?&#39; are not valid characters for a file name, but they are okay</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;<span class="comment"> *        for fSpec. Same thing for &#39;\&#39; and &#39;/&#39;, they are not valid in a file</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="comment"> *        name, but they are valid in fSpec. A &#39;/&#39; is iffy. The Windows API</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;<span class="comment"> *        accepts &#39;/&#39; as a directory separator, but most Rexx programmers</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;<span class="comment"> *        probably don&#39;t know that.  Not sure if we should flag that as illegal</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="comment"> *        or not.</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02930"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa7d955f6716c7a050f227f023a68378e"> 2930</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#aa7d955f6716c7a050f227f023a68378e">illegalFileNameChars</a>(<span class="keywordtype">char</span> * fSpec)</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;{</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">char</span> illegal[] = <span class="stringliteral">&quot;&lt;&gt;|\&quot;&quot;</span>;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160; </div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; i &lt; 4; i++ )</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    {</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <span class="keywordflow">if</span> ( strchr(fSpec, illegal[i]) != NULL )</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        {</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        }</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    }</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160; </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="keywordtype">char</span> *pos = strchr(fSpec, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    <span class="keywordflow">if</span> ( pos != NULL )</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    {</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;        <span class="keywordflow">if</span> ( ((<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>)(pos - fSpec + 1)) != 2 )</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        {</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        }</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        <span class="keywordflow">if</span> ( strchr(pos + 1, <span class="charliteral">&#39;:&#39;</span>) != NULL )</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        {</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;        }</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    }</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160; </div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;}<span class="comment"></span></div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment"> * SysFileTree() implementation.  Searches for files in a directory tree</span></div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment"> * matching the specified search pattern.</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="comment"> * @param  fSpec  [required] The search pattern, may contain glob characters</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="comment"> *                 and full or partial path informattion. E.g., *.bat, or</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="comment"> *                 ../../*.txt, or C:\temp.  May not contain illegal file name</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="comment"> *                 characters which are: &quot;, &lt;, &gt;, |, and :  The semicolon is</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;<span class="comment"> *                 only legal if it is exactly the second character.  Do not use</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="comment"> *                 a double quote in fSpec, it is not needed and is taken as a</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment"> *                 character in a file name, which is an illegal character.</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="comment"> * @param  files  [required] A stem to contain the returned results.  On return,</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment"> *                files.0 contains the count N of found files and files.1</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="comment"> *                through files.N will contain the found files.</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="comment"> * @param  opts   [optional] Any combination of the following letters that</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="comment"> *                specify how the search takes place, or how the returned found</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="comment"> *                file line is formatted.  Case is not significant:</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;<span class="comment"> *                  &#39;B&#39; - Search for files and directories.</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="comment"> *                  &#39;D&#39; - Search for directories only.</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment"> *                  &#39;F&#39; - Search for files only.</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment"> *                  &#39;O&#39; - Only output file names.</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment"> *                  &#39;S&#39; - Recursively scan subdirectories.</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment"> *                  &#39;T&#39; - Combine time &amp; date fields into one.</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="comment"> *                  &#39;L&#39; - Long time format</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;<span class="comment"> *                  &#39;I&#39; - Case Insensitive search.</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;<span class="comment"> *                The defualt is &#39;B&#39; using normal time (neither &#39;T&#39; nor &#39;L&#39;.)</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;<span class="comment"> *                The &#39;I&#39;option is meaningless on Windows.</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment"> * @param targetAttr  [optional] Target attribute mask.  Only files with these</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment"> *                    attributes will be searched for.  The default is to ignore</span></div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;<span class="comment"> *                    the attributes of the files found, so all files found are</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;<span class="comment"> *                    returned.</span></div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;<span class="comment"> * @param newAttr     [optional] New attribute mask.  Each found file will have</span></div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="comment"> *                    its attributes set (changed) to match this mask.  The</span></div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="comment"> *                    default is to not change any attributes.</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="comment"> * @return  0 on success, non-zero on error.  For all errors, a condition is</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;<span class="comment"> *          raised.</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;<span class="comment"> * @remarks  The original IBM code passed in fileSpec to recursiveFindFile(),</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="comment"> *           but then never used it in recursiveFineFile.  So, that has been</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment"> *           eliminated.</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03006"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aadd168e82abdb8bad10a39fc4915309c"> 3006</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aadd168e82abdb8bad10a39fc4915309c">RexxRoutine5</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysFileTree, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, fSpec, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, files, OPTIONAL_CSTRING, opts,</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;             OPTIONAL_CSTRING, targetAttr, OPTIONAL_CSTRING, <a class="code" href="windows_2rexxutil_8cpp.html#aa577bd9dd9463fe358b0eada0fcd44fd">newAttr</a>)</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;{</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;     <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>     result   = 1;        <span class="comment">// Return value, 1 is an error.</span></div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;     <span class="keywordtype">char</span>        *fileSpec = NULL;     <span class="comment">// File spec to search for.</span></div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;     <span class="keywordtype">size_t</span>       fSpecLen = 0;        <span class="comment">// Length of the original fSpec string.</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;     <span class="keywordtype">size_t</span>       fSpecBufLen = 0;     <span class="comment">// Length of the allocated fSpec buffer.</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;     <span class="keywordtype">char</span>        *path     = NULL;     <span class="comment">// Path to search along.</span></div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;     <span class="keywordtype">size_t</span>       pathLen  = 0;        <span class="comment">// Size of buffer holding path.</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;     <a class="code" href="struct_rx_tree_data.html">RXTREEDATA</a>   treeData = {0};      <span class="comment">// Struct for data.</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; </div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;     context-&gt;SetStemArrayElement(files, 0, context-&gt;WholeNumber(0));</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;     treeData.<a class="code" href="struct_rx_tree_data.html#a9bef0c4b76ac4283092efe843ad39f35">files</a>      = files;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;     treeData.<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a> = treeData.<a class="code" href="struct_rx_tree_data.html#a31e260d4e63a9fbece99ed6602a6deb6">fNameSpec</a>;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;     treeData.<a class="code" href="struct_rx_tree_data.html#ae9dba9daef69438aa76a3cd65372da61">nFNameSpec</a> = <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a>;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160; </div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;     fileSpec = <a class="code" href="windows_2rexxutil_8cpp.html#a54dbb1c1fdba5d4447120978a87597f2">getFileSpecFromArg</a>(context, fSpec, &amp;fSpecLen, &amp;fSpecBufLen, 1);</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;     <span class="keywordflow">if</span> ( fileSpec == NULL )</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;     {</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;     }</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;     <span class="keywordflow">if</span> ( <a class="code" href="windows_2rexxutil_8cpp.html#aa7d955f6716c7a050f227f023a68378e">illegalFileNameChars</a>((<span class="keywordtype">char</span> *)fSpec) )</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;     {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;         result = ERROR_INVALID_NAME;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;     }</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;     <span class="comment">// Some, or all, of fileSpec will eventually be copied into</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;     <span class="comment">// treeData.dFNameSpec. So, if we ensure that treeData.dFNameSpec is big</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;     <span class="comment">// enough to hold fileSpec we do not need to worry about it any more.</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;     <span class="keywordflow">if</span> ( fSpecBufLen &gt;= <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a> )</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;     {</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;         <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a>(context, &amp;treeData.<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>, &amp;treeData.<a class="code" href="struct_rx_tree_data.html#ae9dba9daef69438aa76a3cd65372da61">nFNameSpec</a>, fSpecBufLen + 1, <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a>) )</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;         {</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;             <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;         }</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;     }</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; </div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;     path = <a class="code" href="windows_2rexxutil_8cpp.html#accb279e5c95197bb20c3bdd3da404a65">getPathBuffer</a>(context, fSpecLen, &amp;pathLen);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;     <span class="keywordflow">if</span> ( path == NULL )</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;     {</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;     }</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;     <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> options = 0;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;     <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a0abf85d7ec2b6300c8e332bee17b1ac9">getOptionsFromArg</a>(context, (<span class="keywordtype">char</span> *)opts, &amp;options, 3) )</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;     {</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;     }</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;     <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> targetMask[5] = {0};    <span class="comment">// Attribute mask of files to search for.</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;     <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> newMask[5]    = {0};    <span class="comment">// Attribute mask to set found files to.</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;     <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a49e97b805c6dd6cfcae32a44ad4cc273">getMaskFromArg</a>(context, (<span class="keywordtype">char</span> *)targetAttr, targetMask, 4) )</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;     {</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;     }</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160; </div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;     <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a49e97b805c6dd6cfcae32a44ad4cc273">getMaskFromArg</a>(context, (<span class="keywordtype">char</span> *)<a class="code" href="windows_2rexxutil_8cpp.html#aa577bd9dd9463fe358b0eada0fcd44fd">newAttr</a>, newMask, 5) )</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;     {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;     }</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;     <span class="comment">// Get the full path segment and the file name segment by expanding the</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;     <span class="comment">// file specification string.  It seems highly unlikely, but possible, that</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;     <span class="comment">// this could fail.</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;     <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#a7063b4325a083ec0efd84153ed2b695f">getPath</a>(context, fileSpec, &amp;path, treeData.<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>, &amp;pathLen) )</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;     {</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;         <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;     }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;     <span class="keywordflow">if</span> ( <a class="code" href="windows_2rexxutil_8cpp.html#a6a75e2ce6e9d93b82e81e440c25e64af">recursiveFindFile</a>(context, path, &amp;treeData, targetMask, newMask, options) )</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;     {</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;         context-&gt;SetStemArrayElement(treeData.<a class="code" href="struct_rx_tree_data.html#a9bef0c4b76ac4283092efe843ad39f35">files</a>, 0, context-&gt;WholeNumber(treeData.<a class="code" href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">count</a>));</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;         result = 0;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;     }</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;done_out:</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">safeLocalFree</a>(fileSpec);</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">safeLocalFree</a>(path);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;    <span class="keywordflow">if</span> ( treeData.<a class="code" href="struct_rx_tree_data.html#ae9dba9daef69438aa76a3cd65372da61">nFNameSpec</a> != <a class="code" href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a> )</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;    {</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        LocalFree(treeData.<a class="code" href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">dFNameSpec</a>);</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    }</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;}</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160; </div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;<span class="comment">* Function:  SysGetKey                                                   *</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;<span class="comment">* Syntax:    call SysGetKey [echo]                                       *</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;<span class="comment">* Params:    echo - Either of the following:                             *</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;<span class="comment">*                    &#39;ECHO&#39;   - Echo the inputted key (default).         *</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="comment">*                    &#39;NOECHO&#39; - Do not echo the inputted key.            *</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;<span class="comment">* Return:    The key striked.                                            *</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160; </div>
<div class="line"><a name="l03108"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aade4ab4ab239c0bceb5bcee31210b26e"> 3108</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#aade4ab4ab239c0bceb5bcee31210b26e">SysGetKey</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;{</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;  INT       tmp;                       <span class="comment">/* Temp var used to hold      */</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                                       <span class="comment">/* keystroke value            */</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;  <span class="keywordtype">bool</span>      echo = <span class="keyword">true</span>;               <span class="comment">/* Set to false if we         */</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                                       <span class="comment">/* shouldn&#39;t echo             */</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160; </div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;  <span class="keywordflow">if</span> (numargs &gt; 1)                     <span class="comment">/* too many arguments         */</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;            <span class="comment">/* raise an error             */</span></div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160; </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <span class="keywordflow">if</span> (numargs == 1) {                  <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keywordflow">if</span> (!_stricmp(args[0].strptr, <span class="stringliteral">&quot;NOECHO&quot;</span>))</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      echo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(args[0].strptr, <span class="stringliteral">&quot;ECHO&quot;</span>))</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;          <span class="comment">/* Invalid option             */</span></div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  }</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a>) {                  <span class="comment">/* if have an extended        */</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    tmp = <a class="code" href="windows_2rexxutil_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a>;                <span class="comment">/* get the second char        */</span></div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = <span class="keyword">false</span>;              <span class="comment">/* do a real read next time   */</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;    tmp = _getch();                    <span class="comment">/* read a character           */</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160; </div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                                       <span class="comment">/* If a function key or arrow */</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;    <span class="keywordflow">if</span> ((tmp == 0x00) || (tmp == 0xe0)) {</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      <a class="code" href="windows_2rexxutil_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a> = _getch();         <span class="comment">/* Read another character     */</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      <a class="code" href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <a class="code" href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;  }</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;  <span class="keywordflow">if</span> (echo)                            <span class="comment">/* echoing?                   */</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;    _putch(tmp);                       <span class="comment">/* write the character back   */</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160; </div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;  wsprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;%c&quot;</span>, tmp);</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 1;</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160; </div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;}</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160; </div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;<span class="comment">* Function:  SysIni                                                      *</span></div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;<span class="comment">* Syntax:    call SysIni [inifile], app [,key/stem] [,val/stem]          *</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="comment">* Params:    inifile - INI file from which to query or write info.  The  *</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="comment">*                       default is the current user INI file.            *</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">*            app     - Application title to work with.  May be either    *</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;<span class="comment">*                       of the following:                                *</span></div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;<span class="comment">*                        &#39;ALL:&#39; - All app titles will be returned in the *</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;<span class="comment">*                                  stem variable specified by the next   *</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;<span class="comment">*                                  parameter.                            *</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="comment">*                        other  - Specific app to work with.             *</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;<span class="comment">*            key     - Key to work with.  May be any of the following:   *</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;<span class="comment">*                        &#39;ALL:&#39;    - All key titles will be returned in  *</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;<span class="comment">*                                     the stem variable specified by the *</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;<span class="comment">*                                     next parameter.                    *</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;<span class="comment">*                        &#39;DELETE:&#39; - All keys associated with the app    *</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;<span class="comment">*                                     will be deleted.                   *</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;<span class="comment">*                        other     - Specific key to work with.          *</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;<span class="comment">*            val     - Key to work with. May be either of the following: *</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;<span class="comment">*                        &#39;DELETE:&#39; - Delete app/key pair.                *</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;<span class="comment">*                        other     - Set app/key pair info to data spec- *</span></div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;<span class="comment">*                                     ified.                             *</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">*            stem    - Name of stem variable in which to store results.  *</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment">*                      Stem.0 = Number found (n).                        *</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment">*                      Stem.1 - Stem.n = Entries found.                  *</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment">* Return:    other          - Info queried from specific app/key pair.   *</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="comment">*            &#39;&#39;             - Info queried and placed in stem or data    *</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;<span class="comment">*                              deleted successfully.                     *</span></div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;<span class="comment">*            ERROR_NOMEM    - Out of memory.                             *</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="comment">*            ERROR_RETSTR   - Error opening INI or querying/writing info.*</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03183"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8f324c8049bd9815f0137c01d7e04eeb"> 3183</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a8f324c8049bd9815f0137c01d7e04eeb">SysIni</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;{</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;    <span class="keywordtype">size_t</span>      x;                       <span class="comment">/* Temp counter               */</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;    <span class="keywordtype">size_t</span>      len;                     <span class="comment">/* Len var used when creating */</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                                         <span class="comment">/* stem                       */</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;    <span class="keywordtype">size_t</span>      lSize;                   <span class="comment">/* Size of queried info buffer*/</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                                         <span class="comment">/* area                       */</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    LONG        Error = FALSE;           <span class="comment">/* Set to true if error       */</span></div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;                                         <span class="comment">/* encountered                */</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <span class="keywordtype">bool</span>        WildCard = <span class="keyword">false</span>;        <span class="comment">/* Set to true if a wildcard  */</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;                                         <span class="comment">/* operation                  */</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <span class="keywordtype">bool</span>        QueryApps;               <span class="comment">/* Set to true if a query     */</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;                                         <span class="comment">/* operation                  */</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    <span class="keywordtype">bool</span>        terminate = <span class="keyword">true</span>;        <span class="comment">/* perform WinTerminate call  */</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    <a class="code" href="struct_rx_stem_data.html">RXSTEMDATA</a>  ldp;                     <span class="comment">/* local data                 */</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="keywordtype">size_t</span>      buffersize;              <span class="comment">/* return buffer size         */</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160; </div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160; </div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    buffersize = retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>;      <span class="comment">/* save default buffer size   */</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;               <span class="comment">/* set return value           */</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *Key = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;    <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;    <span class="keywordflow">if</span> (numargs &lt; 2 || numargs &gt; 4 || !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[1]))</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;    }</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    <span class="comment">/* get pointers to args       */</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *IniFile = args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0]))         <span class="comment">/* not specified?             */</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        IniFile = <span class="stringliteral">&quot;WIN.INI&quot;</span>;               <span class="comment">/* default to WIN.INI         */</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *App = args[1].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160; </div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <span class="keywordflow">if</span> (numargs &gt;= 3 &amp;&amp; args[2].strptr)</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        Key = args[2].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160; </div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *Val = NULL;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="keywordflow">if</span> (numargs == 4)</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        Val = args[3].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <span class="comment">/* Check KEY and APP values   */</span></div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="comment">/* for &quot;WildCard&quot;             */</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    <span class="keywordflow">if</span> (!_stricmp(App, <span class="stringliteral">&quot;ALL:&quot;</span>))</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    {</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        App = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        QueryApps = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        WildCard = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160; </div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        <span class="keywordflow">if</span> (numargs != 3)</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;          <span class="comment">/* Error - Not enough args    */</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;            x = 2;                           <span class="comment">/* Arg number of STEM variable*/</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_stricmp(Key, <span class="stringliteral">&quot;ALL:&quot;</span>))</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    {</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        Key = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;        Val = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        QueryApps = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        WildCard = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="keywordflow">if</span> (numargs != 4)</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;          <span class="comment">/* Error - Not enough args    */</span></div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; </div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;            x = 3;                           <span class="comment">/* Arg number of STEM variable*/</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    }</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="comment">/* If this is a &quot;WildCard     */</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <span class="comment">/* search, then allocate mem  */</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    <span class="comment">/* for stem struct and get the*/</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <span class="comment">/* stem name                  */</span></div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;    <span class="keywordflow">if</span> (WildCard == <span class="keyword">true</span>)</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    {</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160; </div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a> = 0;                     <span class="comment">/* get the stem variable name */</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;        strcpy(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>, args[x].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>);</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a> = args[x].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">strlength</a>;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;        <span class="comment">/* uppercase the name         */</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;        <a class="code" href="windows_2rexxutil_8cpp.html#aec33b06d90ac834899b86039851abced">memupper</a>(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>, strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>));</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160; </div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;        <span class="keywordflow">if</span> (ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>-1] != <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;            ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>++] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    }</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160; </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    <span class="keywordtype">char</span> *returnVal = NULL;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="comment">/* get value if is a query    */</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    <span class="keywordflow">if</span> ((numargs == 3 &amp;&amp; _stricmp(Key, <span class="stringliteral">&quot;DELETE:&quot;</span>)) ||</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        WildCard == <span class="keyword">true</span>)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    {</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        lSize = 0x0000ffffL;</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        <span class="comment">/* Allocate a large buffer    */</span></div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        returnVal = (<span class="keywordtype">char</span> *)GlobalAlloc(GPTR, lSize);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        <span class="keywordflow">if</span> (returnVal == NULL)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        {</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a>);</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;        }</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; </div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;        <span class="keywordflow">if</span> (WildCard &amp;&amp; QueryApps)</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;            <span class="comment">/* Retrieve the names of all  */</span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;            <span class="comment">/* applications.              */</span></div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;            lSize = GetPrivateProfileString(NULL, NULL, <span class="stringliteral">&quot;&quot;</span>, returnVal, (DWORD)lSize, IniFile);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WildCard &amp;&amp; !QueryApps)</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;            <span class="comment">/* Retrieve all keys for an   */</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            <span class="comment">/* application                */</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            lSize = GetPrivateProfileString(App, NULL, <span class="stringliteral">&quot;&quot;</span>, returnVal, (DWORD)lSize, IniFile);</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;            <span class="comment">/* Retrieve a single key value*/</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;            lSize = GetPrivateProfileString(App, Key, <span class="stringliteral">&quot;&quot;</span>, returnVal, (DWORD)lSize, IniFile);</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160; </div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        <span class="keywordflow">if</span> (lSize &lt;= 0)</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        {</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;            Error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        }</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (WildCard == <span class="keyword">false</span>)</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        {</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;            <span class="keywordflow">if</span> (lSize &gt; buffersize)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;                retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = (PCH)GlobalAlloc(GMEM_FIXED, lSize);</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;                <span class="keywordflow">if</span> (retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> == NULL)</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                {</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;                    GlobalFree(returnVal);  <span class="comment">/* release buffer */</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                    <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a>);</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;                }</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;            memcpy(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, returnVal, lSize);</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = lSize;</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        }</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    }</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    {                               <span class="comment">/* Set or delete Key          */</span></div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160; </div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <span class="keywordflow">if</span> (!_stricmp(Key, <span class="stringliteral">&quot;DELETE:&quot;</span>) || (numargs == 2) || !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[2]))</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;            <span class="comment">/* Delete application and all */</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;            <span class="comment">/* associated keys            */</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;            Error = !WritePrivateProfileString(App, NULL, NULL, IniFile);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_stricmp(Val, <span class="stringliteral">&quot;DELETE:&quot;</span>) ||</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;                 !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[3]))</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;            <span class="comment">/* Delete a single key        */</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;            Error = !WritePrivateProfileString(App, Key, NULL, IniFile);</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;        {</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;            lSize = args[3].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">strlength</a>;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            <span class="comment">/* Set a single key value     */</span></div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            Error = !WritePrivateProfileString(App, Key, Val, IniFile);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;        }</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160; </div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        <span class="keywordflow">if</span> (Error)</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        {</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;            <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a>);</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        }</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;           <span class="comment">/* just return a null string  */</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160; </div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="comment">    /******************************************</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;<span class="comment">    * If this was a wildcard search, change   *</span></div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;<span class="comment">    * the Val variable from one long string   *</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;<span class="comment">    * of values to a REXX stem variable.      *</span></div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;<span class="comment">    ******************************************/</span></div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160; </div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    <span class="keywordflow">if</span> (WildCard == <span class="keyword">true</span>)</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    {              <span class="comment">/* fill stem variable         */</span></div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; </div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        <span class="keywordflow">if</span> (Error == <span class="keyword">false</span>)</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        {</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;            x = 0;</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;            ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a> = 0;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160; </div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;            <span class="keywordflow">do</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;            {</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                <span class="comment">/* Copy string terminated by \0 to Temp.  Last string will end     */</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                <span class="comment">/* in \0\0 and thus have a length of 0.                            */</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                len = 0;</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160; </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *next = &amp;returnVal[x]; <span class="comment">/* point to string            */</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                len = strlen(next);            <span class="comment">/* get string length          */</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                                               <span class="comment">/* if non-zero length, then   */</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                                               <span class="comment">/* set the stem element       */</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                <span class="keywordflow">if</span> (len != 0)</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                {</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                    x += (len+1);                <span class="comment">/* Increment pointer past the */</span></div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                                                 <span class="comment">/* new string                 */</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;                    strcpy(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>, next);</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a> = len;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>++;</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                    ltoa((<span class="keywordtype">long</span>)ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>, ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>+ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>, 10);</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160; </div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                    <span class="keywordflow">if</span> (ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>[ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>-1] == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                        ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>--;</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">shvnext</a> = NULL;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr = ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>;</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength = strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>;</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">shvnamelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">shvvaluelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">vlen</a>;</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">shvcode</a> = <a class="code" href="rexxapidefs_8h.html#a8ffa6714f4ffb75f4c65cff2ba8e84b9">RXSHV_SET</a>;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                    ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> = 0;</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a>(&amp;ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>) == <a class="code" href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a>)</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                    {</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                        <span class="keywordflow">if</span> (returnVal != NULL)</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                        {</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                            GlobalFree(returnVal);  <span class="comment">/* release buffer */</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                        }</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;    <span class="comment">/* error on non-zero          */</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                    }</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                }</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;            }</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160; </div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            <span class="keywordflow">while</span> (returnVal[x] != <span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;        }</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160; </div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a> = 0;</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160; </div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        <span class="keywordflow">if</span> (returnVal != NULL)</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;        {</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;            GlobalFree(returnVal);</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;            returnVal = NULL;</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        }</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160; </div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        <span class="comment">/* set number returned        */</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;        ltoa((<span class="keywordtype">long</span>)ldp.<a class="code" href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">count</a>, ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>, 10);</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>[ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>+1] = 0;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">shvnext</a> = NULL;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr = ldp.<a class="code" href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">varname</a>;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength = ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>+1;</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">shvnamelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">stemlen</a>+1;</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>;</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(ldp.<a class="code" href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">ibuf</a>);</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">shvvaluelen</a> = ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">shvcode</a> = <a class="code" href="rexxapidefs_8h.html#a8ffa6714f4ffb75f4c65cff2ba8e84b9">RXSHV_SET</a>;</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> = 0;</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a>(&amp;ldp.<a class="code" href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">shvb</a>) == <a class="code" href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a>)</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;          <span class="comment">/* error on non-zero          */</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160; </div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    }                                    <span class="comment">/* * End - IF (Wildcard ... * */</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <span class="keywordflow">if</span> (returnVal != NULL)</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;    {</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        GlobalFree(returnVal);  <span class="comment">/* release buffer                              */</span></div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    }</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160; </div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;}</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160; </div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160; </div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="comment">* Function:  SysLoadFuncs                                                *</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;<span class="comment">* Syntax:    call SysLoadFuncs [option]                                  *</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment">* Return:    null string                                                 *</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160; </div>
<div class="line"><a name="l03439"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a744938a8228e39320c63be371291edc1"> 3439</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a744938a8228e39320c63be371291edc1">SysLoadFuncs</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;{</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    <span class="comment">// this is a NOP now</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;               <span class="comment">/* set return value           */</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;}</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160; </div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160; </div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;<span class="comment">* Function:  SysMkDir                                                    *</span></div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="comment">* Syntax:    call SysMkDir dir                                           *</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="comment">* Params:    dir - Directory to be created.                              *</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;<span class="comment">*            Return code from CreateDirectory()                          *</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; </div>
<div class="line"><a name="l03458"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ab3fda15456e35e5870ffd8d8572c4e4e"> 3458</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, <a class="code" href="unix_2rexxutil_8cpp.html#aadab25a6bd1a2ea790685426d34cdfb1">SysMkDir</a>, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, dir)</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;{</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keywordflow">return</span> CreateDirectory(dir, NULL) != 0 ? 0 : GetLastError();</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;}</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160; </div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160; </div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="comment">* Function:  SysGetErrortext                                             *</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;<span class="comment">* Syntax:    call SysGetErrortext errnumber                              *</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;<span class="comment">* Params:    errnumber - error number to be described                    *</span></div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;<span class="comment">* Return:    Description or empty string                                 *</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160; </div>
<div class="line"><a name="l03474"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8e2d43c32a5b15f4f691016911b418dc"> 3474</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a8e2d43c32a5b15f4f691016911b418dc">SysGetErrortext</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;{</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    DWORD  errnum;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <span class="keywordtype">char</span>  *errmsg;</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    <span class="keywordtype">size_t</span> length;</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160; </div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    <span class="keywordflow">if</span> (numargs != 1)</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;    {</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        <span class="comment">/* If no args, then its an    */</span></div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        <span class="comment">/* incorrect call             */</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;    }</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160; </div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    errnum = atoi(args[0].strptr);</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <span class="keywordflow">if</span> (FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER|FORMAT_MESSAGE_FROM_SYSTEM,NULL,errnum,0,(LPSTR)&amp;errmsg,64,NULL) == 0)</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    {</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = 0x00;</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    }</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;    {                               <span class="comment">/* succeeded                  */</span></div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        length = strlen(errmsg);</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160; </div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;        <span class="comment">// FormatMessage returns strings with trailing CrLf, which we want removed</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;        <span class="keywordflow">if</span> (length &gt;= 1 &amp;&amp; errmsg[length - 1] == 0x0a)</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;        {</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;          errmsg[length - 1] = 0x00;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;          length--;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;        }</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;        <span class="keywordflow">if</span> (length &gt;= 1 &amp;&amp; errmsg[length - 1] == 0x0d)</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        {</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;          errmsg[length - 1] = 0x00;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;          length--;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        }</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160; </div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        <span class="keywordflow">if</span> (length &gt;= retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>)</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        {</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = (PCH)GlobalAlloc(GMEM_ZEROINIT | GMEM_FIXED, strlen(errmsg+1));</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        }</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        strcpy(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,errmsg);</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;        LocalFree(errmsg);</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    }</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;}</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160; </div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="comment">* Function:  SysWinEncryptFile (W2K only)                                *</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="comment">* Syntax:    call SysWinEncryptFile filename                             *</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="comment">* Params:    filename - file to be encrypted                             *</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment">*            Return code from EncryptFile()                              *</span></div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160; </div>
<div class="line"><a name="l03531"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a9b6f54f47164af16463a98a1c5342841"> 3531</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a9b6f54f47164af16463a98a1c5342841">SysWinEncryptFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;{</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;    ULONG  rc;                           <span class="comment">/* Ret code of func           */</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    OSVERSIONINFO vi;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160; </div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    <span class="keywordflow">if</span> (numargs != 1)</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;    {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;        <span class="comment">/* If no args, then its an    */</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        <span class="comment">/* incorrect call             */</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;    }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160; </div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    vi.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(OSVERSIONINFO);</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160; </div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    <span class="keywordflow">if</span> (rc = GetVersionEx(&amp;vi))</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;    {</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <span class="comment">/* allow this only on W2K or newer */</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        <span class="keywordflow">if</span> (vi.dwPlatformId == VER_PLATFORM_WIN32_NT &amp;&amp; vi.dwMajorVersion &gt; 4)</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        {</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;            rc = EncryptFile(args[0].strptr);</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        }</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        {</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            rc = 0;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            SetLastError(ERROR_CANNOT_MAKE);</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;        }</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    }</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;    {</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;%d&quot;</span>, 0);</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    }</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;    {</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;%d&quot;</span>, GetLastError());</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;    }</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;}</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160; </div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="comment">* Function:  SysWinDecryptFile (W2K only)                                *</span></div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="comment">* Syntax:    call SysWinDecryptFile filename                             *</span></div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;<span class="comment">* Params:    filename - file to be decrypted                             *</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;<span class="comment">*            Return code from DecryptFile()                              *</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160; </div>
<div class="line"><a name="l03581"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a479f6f8d462e87801cf8cd9ae7b4240b"> 3581</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a479f6f8d462e87801cf8cd9ae7b4240b">SysWinDecryptFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;{</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160; </div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  ULONG  rc;                           <span class="comment">/* Ret code of func           */</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  OSVERSIONINFO vi;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;  <span class="keywordflow">if</span> (numargs != 1)</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                                       <span class="comment">/* If no args, then its an    */</span></div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                                       <span class="comment">/* incorrect call             */</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160; </div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;    vi.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(OSVERSIONINFO);</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160; </div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;  <span class="keywordflow">if</span> (rc = GetVersionEx(&amp;vi)) {</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;    <span class="comment">/* allow this only on W2K or newer */</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    <span class="keywordflow">if</span> (vi.dwPlatformId == VER_PLATFORM_WIN32_NT &amp;&amp; vi.dwMajorVersion &gt; 4)</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;      rc = DecryptFile(args[0].strptr,0);</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;      rc = 0;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;      SetLastError(ERROR_CANNOT_MAKE);</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;    }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;  }</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160; </div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;  <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;%d&quot;</span>, 0);</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;%d&quot;</span>, GetLastError());</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;}</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160; </div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160; </div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;<span class="comment">* Function:  SysWinVer                                                   *</span></div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment">* Syntax:    call SysWinVer                                              *</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;<span class="comment">* Return:    Windows Version                                             *</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160; </div>
<div class="line"><a name="l03621"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aca01c32b5907ac2ba7c5da1741aa085f"> 3621</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#aca01c32b5907ac2ba7c5da1741aa085f">SysWinVer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;{</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160; </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;  OSVERSIONINFO vi;                    <span class="comment">/* Return RXSTRING            */</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    <span class="keywordtype">char</span> chVerBuf[12];</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160; </div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;  vi.dwOSVersionInfoSize = <span class="keyword">sizeof</span>(vi); <span class="comment">/* if not set --&gt; violation error */</span></div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160; </div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;  <span class="keywordflow">if</span> (numargs != 0)                    <span class="comment">/* validate arg count         */</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160; </div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;  GetVersionEx(&amp;vi);                <span class="comment">/* get version with extended api */</span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;  <span class="keywordflow">if</span> (vi.dwPlatformId == VER_PLATFORM_WIN32s)</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    strcpy(chVerBuf, <span class="stringliteral">&quot;Windows&quot;</span>);       <span class="comment">/* Windows 3.1                */</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;    <span class="keywordflow">if</span> (vi.dwPlatformId == VER_PLATFORM_WIN32_NT)</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      strcpy(chVerBuf, <span class="stringliteral">&quot;WindowsNT&quot;</span>);   <span class="comment">/* Windows NT               */</span></div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;  <span class="keywordflow">else</span> strcpy(chVerBuf, <span class="stringliteral">&quot;Windows95&quot;</span>);  <span class="comment">/* Windows 95               */</span></div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160; </div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                                       <span class="comment">/* format into the buffer     */</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;  wsprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s %lu.%02lu&quot;</span>,</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;             chVerBuf,</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;             vi.dwMajorVersion,</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;             vi.dwMinorVersion);</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;  retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;}</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;<span class="comment">* Function:  SysVersion                                                  *</span></div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;<span class="comment">* Syntax:    Say  SysVersion                                             *</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="comment">* Return:    Operating System and Version                                *</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160; </div>
<div class="line"><a name="l03658"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0dad6273af058ff65ec64445dfe96581"> 3658</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a0dad6273af058ff65ec64445dfe96581">SysVersion</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;{</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;  <span class="comment">/* this is only an alias for SysWinVer */</span></div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#aca01c32b5907ac2ba7c5da1741aa085f">SysWinVer</a>(name, numargs, args, queuename, retstr);</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;}</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160; </div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160; </div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;<span class="comment">* Function:  SysRmDir                                                    *</span></div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;<span class="comment">* Syntax:    call SysRmDir dir                                           *</span></div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;<span class="comment">* Params:    dir - Directory to be removed.                              *</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;<span class="comment">* Return:    NO_UTIL_ERROR                                               *</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="comment">*            Return code from RemoveDirectory()                          *</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160; </div>
<div class="line"><a name="l03676"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ac28fdcb47c3510786ed994725dfeef5b"> 3676</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, <a class="code" href="unix_2rexxutil_8cpp.html#aeb154f4bdbb013dc3d312e63b897b76b">SysRmDir</a>, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, dir)</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;{</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;    <span class="keywordflow">return</span> RemoveDirectory(dir) != 0 ? 0 : GetLastError();</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;}</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160; </div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160; </div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;<span class="comment">* Function:  SysSearchPath                                               *</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;<span class="comment">* Syntax:    call SysSearchPath path, file [, options]                   *</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;<span class="comment">* Params:    path - Environment variable name which specifies a path     *</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;<span class="comment">*                    to be searched (ie &#39;PATH&#39;, &#39;DPATH&#39;, etc).           *</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;<span class="comment">*            file - The file to search for.                              *</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment">*            options -  &#39;C&#39; - Current directory search first (default).  *</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="comment">*                       &#39;N&#39; - No Current directory search. Only searches *</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;<span class="comment">*                             the path as specified.                     *</span></div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;<span class="comment">* Return:    other  - Full path and filespec of found file.              *</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;<span class="comment">*            &#39;&#39;     - Specified file not found along path.               *</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160; </div>
<div class="line"><a name="l03698"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a054a57d2b2b5732c19d54313e1e19dae"> 3698</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a054a57d2b2b5732c19d54313e1e19dae">SysSearchPath</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;{</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;    <span class="keywordtype">char</span>     szFullPath[_MAX_PATH];      <span class="comment">/* returned file name         */</span></div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    <span class="keywordtype">char</span>     szCurDir[_MAX_PATH];        <span class="comment">/* current directory          */</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <span class="keywordtype">char</span>     *szEnvStr = NULL;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160; </div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    LPTSTR pszOnlyFileName;              <span class="comment">/* parm for searchpath        */</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    LPTSTR lpPath = NULL;                <span class="comment">/* ptr to search path+        */</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    UINT   errorMode;</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160; </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    <span class="keywordflow">if</span> (numargs &lt; 2 || numargs &gt; 3 ||</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;        !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0]) ||</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[1]))</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;    {</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;    }</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160; </div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;    <span class="keywordtype">char</span> opt = <span class="charliteral">&#39;C&#39;</span>; <span class="comment">// this is the default</span></div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <span class="keywordflow">if</span> (numargs == 3)</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    {                  <span class="comment">/* process options            */</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;        opt = toupper(args[2].strptr[0]);</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;        <span class="keywordflow">if</span> (opt != <span class="charliteral">&#39;C&#39;</span> &amp;&amp; opt != <span class="charliteral">&#39;N&#39;</span>)</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        {</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;          <span class="comment">/* Invalid option             */</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        }</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    }</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160; </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    szEnvStr = (LPTSTR) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * <a class="code" href="windows_2rexxutil_8cpp.html#ac8e587038055e4f6b6674d01d0b99058">MAX_ENVVAR</a>);</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    <span class="keywordflow">if</span> (szEnvStr != NULL)</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    {</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        DWORD charCount = GetEnvironmentVariable(args[0].strptr, szEnvStr, <a class="code" href="windows_2rexxutil_8cpp.html#ac8e587038055e4f6b6674d01d0b99058">MAX_ENVVAR</a>);</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        <span class="keywordflow">if</span> (charCount == 0)</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;        {</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;            *szEnvStr = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;        }</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (charCount &gt; <a class="code" href="windows_2rexxutil_8cpp.html#ac8e587038055e4f6b6674d01d0b99058">MAX_ENVVAR</a>)</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;        {</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;            szEnvStr = (LPTSTR) realloc(szEnvStr, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * charCount);</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;            <span class="keywordflow">if</span> (szEnvStr != NULL)</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;            {</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                DWORD charCount2 = GetEnvironmentVariable(args[0].strptr, szEnvStr, charCount);</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;                <span class="keywordflow">if</span> (charCount2 == 0 || charCount2 &gt; charCount)</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;                {</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;                    *szEnvStr = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;                }</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;            }</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        }</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    }</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160; </div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;    <span class="keywordflow">if</span> (opt == <span class="charliteral">&#39;N&#39;</span>)</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    {</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        lpPath = (szEnvStr == NULL) ? NULL : strdup(szEnvStr);</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;    }</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opt == <span class="charliteral">&#39;C&#39;</span>)</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    {</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        <span class="comment">/* search current directory   */</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        DWORD charCount = GetCurrentDirectory(_MAX_PATH, szCurDir);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        <span class="keywordflow">if</span> (charCount == 0 || charCount &gt; _MAX_PATH)</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;        {</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;            szCurDir[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;        }</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160; </div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;        <span class="keywordflow">if</span> (szEnvStr != NULL)</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        {</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;            lpPath = (LPTSTR) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (strlen(szCurDir) + 1 + strlen(szEnvStr) + 1));</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;            <span class="keywordflow">if</span> (lpPath != NULL)</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;            {</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;                strcpy(lpPath, szCurDir);</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;                strcat(lpPath, <span class="stringliteral">&quot;;&quot;</span>);</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;                strcat(lpPath, szEnvStr);</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;            }</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;        }</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        {</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;            lpPath = strdup(szCurDir);</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;        }</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    }</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160; </div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;    <span class="comment">/* use DosSearchPath          */</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160; </div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;    DWORD charCount = 0;</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    <span class="keywordflow">if</span> (lpPath != NULL)</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;    {</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        errorMode = SetErrorMode(SEM_FAILCRITICALERRORS);</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;        charCount = <a class="code" href="unix_2rexxutil_8cpp.html#ad302ee7ca379dfc14324dcc41cb8d18a">SearchPath</a>(</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                           (LPCTSTR)lpPath,              <span class="comment">/* path srch, NULL will+      */</span></div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                           (LPCTSTR)args[1].strptr,      <span class="comment">/* address if filename        */</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;                           NULL,                         <span class="comment">/* filename contains .ext     */</span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                           _MAX_PATH,                    <span class="comment">/* size of fullname buffer    */</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;                           szFullPath,                   <span class="comment">/* where to put results       */</span></div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;                           &amp;pszOnlyFileName);</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        SetErrorMode(errorMode);</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;    }</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;    <span class="keywordflow">if</span> (charCount == 0 || charCount &gt; _MAX_PATH)</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;    {</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;        szFullPath[0]=<span class="charliteral">&#39;\0&#39;</span>;              <span class="comment">/* set to NULL if failure     */</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    }</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160; </div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, szFullPath);   <span class="comment">/* pass back result           */</span></div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    free(szEnvStr);</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    free(lpPath);</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;}</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160; </div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160; </div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;<span class="comment">* Function:  SysSleep                                                    *</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment">* Syntax:    call SysSleep secs                                          *</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="comment">* Params:    secs - Number of seconds to sleep.                          *</span></div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="comment">*                   must be in the range 0 .. 2147483                    *</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;<span class="comment">* Return:    0                                                           *</span></div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ac777649b37c1205edd2e46601c955958"> 3814</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysSleep, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, delay)</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;{</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;  <span class="keywordtype">double</span> seconds;</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;  <span class="comment">// try to convert the provided delay to a valid floating point number</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  <span class="keywordflow">if</span> (context-&gt;ObjectToDouble(delay, &amp;seconds) == 0 ||</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;      <a class="code" href="windows_2_platform_definitions_8h.html#a2e1baae9134e580910322362dc23290e">isnan</a>(seconds) || seconds == HUGE_VAL || seconds == -HUGE_VAL)</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;  {</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;      <span class="comment">// 88.902 The &amp;1 argument must be a number; found &quot;&amp;2&quot;</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;      context-&gt;RaiseException3(<a class="code" href="oorexxerrors_8h.html#ab090a8788190e809a21bf936a569fff7">Rexx_Error_Invalid_argument_number</a>, context-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), context-&gt;String(<span class="stringliteral">&quot;delay&quot;</span>), delay);</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;  }</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160; </div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;  <span class="comment">// according to MSDN the maximum is USER_TIMER_MAXIMUM (0x7FFFFFFF) milliseconds,</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;  <span class="comment">// which translates to 2147483.647 seconds</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;  <span class="keywordflow">if</span> (seconds &lt; 0.0 || seconds &gt; 2147483.0)</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;  {</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      <span class="comment">// 88.907 The &amp;1 argument must be in the range &amp;2 to &amp;3; found &quot;&amp;4&quot;</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;      context-&gt;RaiseException(<a class="code" href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a>,</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;          context-&gt;ArrayOfFive(context-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), context-&gt;String(<span class="stringliteral">&quot;delay&quot;</span>),</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;          context-&gt;String(<span class="stringliteral">&quot;0&quot;</span>), context-&gt;String(<span class="stringliteral">&quot;2147483&quot;</span>), delay));</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;  }</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160; </div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;  <span class="comment">// convert to milliseconds, no overflow possible</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;  LONG milliseconds = (LONG) (seconds * 1000);</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;<span class="comment">  /** Using Sleep with a long timeout risks sleeping on a thread with a message</span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;<span class="comment">   *  queue, which can make the system sluggish, or possibly deadlocked.  If the</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="comment">   *  sleep is longer than 333 milliseconds use a window timer to avoid this</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="comment">   *  risk.</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;  <span class="keywordflow">if</span> ( milliseconds &gt; 333 )</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;  {</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;      <span class="keywordflow">if</span> ( !(SetTimer(NULL, 0, milliseconds, (TIMERPROC) <a class="code" href="windows_2rexxutil_8cpp.html#a563a9eb1cdb33946ea9a942899b0b09a">SleepTimerProc</a>)) )</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;      {</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;          <span class="comment">// no timer available, need to abort</span></div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;          context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#a33b78238ad2d773aa0b826ca3ee19194">Rexx_Error_System_resources_user_defined</a>,</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;              context-&gt;String(<span class="stringliteral">&quot;System resources exhausted: cannot start timer&quot;</span>));</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;          <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      }</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160; </div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      MSG msg;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      <span class="keywordflow">while</span> ( GetMessage (&amp;msg, NULL, 0, 0) )</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      {</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;          <span class="keywordflow">if</span> ( msg.message == <a class="code" href="windows_2rexxutil_8cpp.html#a47ea672db15c78539388264846c5fba7">OM_WAKEUP</a> )  <span class="comment">/* If our message, exit loop       */</span></div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;          TranslateMessage( &amp;msg );</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;          DispatchMessage ( &amp;msg );</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;      }</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;  }</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  {</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;      Sleep(milliseconds);</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;  }</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160; </div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;}</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160; </div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;<span class="comment">/*********************************************************************</span></div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;<span class="comment"> *                                                                   *</span></div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;<span class="comment"> *  Routine   : SleepTimerProc                                       *</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;<span class="comment"> *                                                                   *</span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="comment"> *  Purpose   : callback routine for SetTimer set in SysSleep        *</span></div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="comment"> *  Notes     :                                                      *</span></div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;<span class="comment"> *  Arguments : hwnd - window handle                                 *</span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="comment"> *              uMsg - WM_TIMER message                              *</span></div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="comment"> *              idEvent - timer identifier                           *</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment"> *              dwtime - current system time                         *</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="comment"> *  Returns   :                                                      *</span></div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="comment"> *                                                                   *</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;<span class="comment"> *********************************************************************/</span></div>
<div class="line"><a name="l03885"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a563a9eb1cdb33946ea9a942899b0b09a"> 3885</a></span>&#160; VOID CALLBACK <a class="code" href="windows_2rexxutil_8cpp.html#a563a9eb1cdb33946ea9a942899b0b09a">SleepTimerProc</a>(HWND hwnd, UINT uMsg, UINT idEvent, DWORD dwTime) {</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;   DWORD ThreadId;</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;   KillTimer(NULL, idEvent);       <span class="comment">/* kill the timer that just ended */</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;   ThreadId = GetCurrentThreadId();</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;   PostThreadMessage(ThreadId, <a class="code" href="windows_2rexxutil_8cpp.html#a47ea672db15c78539388264846c5fba7">OM_WAKEUP</a>, 0 , 0L); <span class="comment">/* send ourself the wakeup message*/</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160; }</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160; </div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="comment">* Function:  SysTempFileName                                             *</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;<span class="comment">* Syntax:    call SysTempFileName template [,filler]                     *</span></div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;<span class="comment">* Params:    template - Description of filespec desired.  For example:   *</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="comment">*                        C:\TEMP\FILE.???                                *</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="comment">*            filler   - A character which when found in template will be *</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="comment">*                        replaced with random digits until a unique file *</span></div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;<span class="comment">*                        or directory is found.  The default character   *</span></div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;<span class="comment">*                        is &#39;?&#39;.                                         *</span></div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;<span class="comment">* Return:    other - Unique file/directory name.                         *</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;<span class="comment">*            &#39;&#39;    - No more files exist given specified template.       *</span></div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160; </div>
<div class="line"><a name="l03908"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aebba4ef85ab647b2135bad9567fa51d3"> 3908</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#aebba4ef85ab647b2135bad9567fa51d3">SysTempFileName</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;{</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;    CHAR   filler;                       <span class="comment">/* filler character           */</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160; </div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;    <span class="keywordflow">if</span> (numargs &lt; 1 ||                   <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        numargs &gt; 2 ||</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0]) ||</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        args[0].strlength &gt; 512)</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160; </div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    <span class="keywordflow">if</span> (numargs == 2 &amp;&amp;                  <span class="comment">/* get filler character       */</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        !<a class="code" href="rexx_8h.html#aa0444b24c2d2abc9293c516164a715dc">RXNULLSTRING</a>(args[1]))</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    {</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        <span class="keywordflow">if</span> (args[1].strlength != 1)        <span class="comment">/* must be one character      */</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        filler = args[1].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>[0];</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;    }</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;    {</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        filler = <span class="charliteral">&#39;?&#39;</span>;</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    }</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    <span class="comment">/* get the file id            */</span></div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a5273ad4c59f3a26dea4d732d29670e07">GetUniqueFileName</a>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(args[0].strptr), filler, retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160; </div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;}</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160; </div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160; </div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;<span class="comment">* Function:  SysTextScreenRead                                           *</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;<span class="comment">* Syntax:    call SysTextScreenRead row, col [,len]                      *</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="comment">* Params:    row - Horizontal row on the screen to start reading from.   *</span></div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;<span class="comment">*                   The row at the top of the screen is 0.               *</span></div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;<span class="comment">*            col - Vertical column on the screen to start reading from.  *</span></div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="comment">*                   The column at the left of the screen is 0.           *</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;<span class="comment">*            len - The number of characters to read.  The default is the *</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;<span class="comment">*                   rest of the screen.                                  *</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;<span class="comment">* Return:    Characters read from text screen.                           *</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae"> 3951</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae">RexxRoutine3</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysTextScreenRead, <span class="keywordtype">int</span>, row, <span class="keywordtype">int</span>, col, OPTIONAL_int, len)</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;{</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    <span class="keywordtype">int</span>    lPos,lPosOffSet;              <span class="comment">/* positioning                */</span></div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                                         <span class="comment">/* (132x50)                   */</span></div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;    <span class="keywordtype">int</span>    lBufferLen = 16000;           <span class="comment">/* default: 200x80 characters */</span></div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160; </div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;    COORD coordLine;                     <span class="comment">/* coordinates of where to    */</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                                         <span class="comment">/* read characters from       */</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;    DWORD dwCharsRead,dwSumCharsRead;    <span class="comment">/* Handle to Standard Out     */</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    HANDLE hStdout;</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbiInfo; <span class="comment">/* Console information        */</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160; </div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;    hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160; </div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    <span class="keywordflow">if</span> (!GetConsoleScreenBufferInfo(hStdout, &amp;csbiInfo))</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    {</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;    }</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160; </div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3))               <span class="comment">/* check the length           */</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;    {</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;        len = csbiInfo.dwSize.Y * csbiInfo.dwSize.X;</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    }</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160; </div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    coordLine.X = (short)col;</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;    coordLine.Y = (short)row;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160; </div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;    <span class="keywordtype">char</span> *ptr = buffer;</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160; </div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    <span class="keywordflow">if</span> (len &gt; <span class="keyword">sizeof</span>(buffer))</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    {</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;        <span class="comment">// allocate a new buffer</span></div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;        ptr = (<span class="keywordtype">char</span> *)malloc(len);</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;        <span class="keywordflow">if</span> (ptr == NULL)</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;        {</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;        }</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    }</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160; </div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    <span class="keywordflow">if</span> (len &lt; lBufferLen)</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    {</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;        lBufferLen = len;</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    }</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160; </div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    lPos = 0;                                     <span class="comment">/* current position */</span></div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    lPosOffSet = row * csbiInfo.dwSize.X + col;   <span class="comment">/* add offset if not started at beginning */</span></div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    dwSumCharsRead = 0;</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160; </div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;    <span class="keywordflow">while</span> (lPos &lt; len )</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;    {</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160; </div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;        <span class="keywordflow">if</span> (!ReadConsoleOutputCharacter(hStdout, &amp;ptr[lPos], lBufferLen, coordLine, &amp;dwCharsRead))</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        {</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;            <span class="keywordflow">if</span> (ptr != buffer) {</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                free(ptr);</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;            }</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        }</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160; </div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160; </div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;        lPos = lPos + lBufferLen;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        coordLine.Y = (short)((lPos + lPosOffSet) / csbiInfo.dwSize.X);</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        coordLine.X = (short)((lPos + lPosOffSet) % csbiInfo.dwSize.X);</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        dwSumCharsRead = dwSumCharsRead + dwCharsRead;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;    }</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160; </div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;    <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> result = context-&gt;NewString(ptr, dwSumCharsRead);</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    <span class="keywordflow">if</span> (ptr != buffer) {</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        free(ptr);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    }</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;}</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="comment">* Function:  SysTextScreenSize                                           *</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;<span class="comment">* Syntax:    call SysTextScreenSize [option], [rows, colummns]          *</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="comment">*            call SysTextScreenSize [option], [top, left, bottom, right] *</span></div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="comment">* Params:    option - &quot;BUFFERSIZE&quot;, &quot;WINDOWRECT&quot;, &quot;MAXWINDOWSIZE&quot;        *</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;<span class="comment">*               &quot;BUFFERSIZE&quot; (default) return or set console buffer size *</span></div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;<span class="comment">*               &quot;WINDOWRECT&quot; return or set windows position              *</span></div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;<span class="comment">*               &quot;MAXWINDOWSIZE&quot; return maximum window size               *</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="comment">*            lines, columns - set buffer size to lines by columns        *</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="comment">*            top, left, bottom, right - set window size and position     *</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;<span class="comment">* Return:    &quot;BUFFERSIZE&quot; or &quot;MAXWINDOWSIZE&quot;: rows columns               *</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="comment">*            &quot;WINDOWRECT&quot;: top left bottom right                         *</span></div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04045"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a082cae7620e7f850ea04d6fe6b15b583"> 4045</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aadd168e82abdb8bad10a39fc4915309c">RexxRoutine5</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysTextScreenSize,</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    OPTIONAL_CSTRING, optionString,</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;    OPTIONAL_stringsize_t, rows, OPTIONAL_stringsize_t, columns,</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    OPTIONAL_stringsize_t, rows2, OPTIONAL_stringsize_t, columns2)</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;{</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;    <span class="comment">// check for valid option</span></div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">enum</span> { BUFFERSIZE, WINDOWRECT, MAXWINDOWSIZE } console_option;</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;    console_option option;</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;    <span class="keywordflow">if</span> (optionString == NULL || stricmp(optionString, <span class="stringliteral">&quot;BUFFERSIZE&quot;</span>) == 0)</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    {</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;        option = BUFFERSIZE;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;    }</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(optionString, <span class="stringliteral">&quot;WINDOWRECT&quot;</span>) == 0)</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    {</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;        option = WINDOWRECT;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    }</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(optionString, <span class="stringliteral">&quot;MAXWINDOWSIZE&quot;</span>) == 0)</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    {</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        option = MAXWINDOWSIZE;</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    }</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    {</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;    }</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160; </div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="comment">// check for valid SET arguments: either none, or two more, or four more</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <span class="keywordtype">size_t</span> setArgs;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <span class="keywordtype">bool</span> omitted45 = <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(4) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(5);</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    <span class="keywordtype">bool</span> exists23 = <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(3);</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3) &amp;&amp; omitted45)</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    {</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;        setArgs = 0;</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    }</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exists23 &amp;&amp; omitted45)</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    {</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;        setArgs = 2;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;    }</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (exists23 &amp;&amp; <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(4) &amp;&amp; <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(5))</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    {</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;        setArgs = 4;</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    }</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;    {</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    }</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160; </div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    <span class="comment">// check that all SET arguments fit a SHORT</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    <span class="keywordflow">if</span> (!(setArgs == 0 ||</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;         (setArgs == 2 &amp;&amp; rows &lt;= SHRT_MAX &amp;&amp; columns &lt;= SHRT_MAX) ||</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;         (setArgs == 4 &amp;&amp; rows &lt;= SHRT_MAX &amp;&amp; columns &lt;= SHRT_MAX &amp;&amp; rows2 &lt;= SHRT_MAX &amp;&amp; columns2 &lt;= SHRT_MAX)))</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    {</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;    }</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160; </div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;    <span class="comment">// real work starts here</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    CONSOLE_SCREEN_BUFFER_INFO csbi; <span class="comment">// console screen buffer information</span></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <span class="keywordtype">char</span> buffer[100];</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160; </div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    HANDLE hStdout = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160; </div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    <span class="keywordflow">if</span> (setArgs == 0)</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    {</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;        <span class="comment">// this is a GET requset, retrieve console information</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;        <span class="keywordflow">if</span> (GetConsoleScreenBufferInfo(hStdout, &amp;csbi) == NULL)</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;        {</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;            <span class="comment">// console not in character mode, return two or four zeroes</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;            <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(option == WINDOWRECT ? <span class="stringliteral">&quot;0 0 0 0&quot;</span> : <span class="stringliteral">&quot;0 0&quot;</span>);</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;        }</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;    }</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160; </div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;    <span class="keywordflow">if</span> (option == BUFFERSIZE &amp;&amp; setArgs == 0)</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;    {</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;        <span class="comment">// this is a BUFFERSIZE GET, returns two values</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;%d %d&quot;</span>, csbi.dwSize.Y, csbi.dwSize.X);</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    }</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == WINDOWRECT &amp;&amp; setArgs == 0)</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    {</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;        <span class="comment">// this is a WINDOWRECT GET, returns four values</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;%d %d %d %d&quot;</span>, csbi.srWindow.Top, csbi.srWindow.Left, csbi.srWindow.Bottom, csbi.srWindow.Right);</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;    }</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == MAXWINDOWSIZE &amp;&amp; setArgs == 0)</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;    {</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;        <span class="comment">// this is a MAXWINDOWSIZE GET, returns two values</span></div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;%d %d&quot;</span>, csbi.dwMaximumWindowSize.Y, csbi.dwMaximumWindowSize.X);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    }</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == BUFFERSIZE &amp;&amp; setArgs == 2)</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;    {</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        <span class="comment">// this is a BUFFERSIZE SET, requires two more arguments</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;        COORD consoleBuffer;</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;        consoleBuffer.Y = (SHORT)rows;</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;        consoleBuffer.X = (SHORT)columns;</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;        BOOL code = SetConsoleScreenBufferSize(hStdout, consoleBuffer);</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;%d&quot;</span>, code == 0 ? GetLastError() : 0);</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;    }</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (option == WINDOWRECT  &amp;&amp; setArgs == 4)</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    {</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;        <span class="comment">// this is a WINDOWRECT  SET, requires four more arguments</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;        SMALL_RECT consoleWindow;</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        consoleWindow.Top =    (SHORT)rows;</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;        consoleWindow.Left =   (SHORT)columns;</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;        consoleWindow.Bottom = (SHORT)rows2;</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;        consoleWindow.Right =  (SHORT)columns2;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;        BOOL code = SetConsoleWindowInfo(hStdout, 1, &amp;consoleWindow);</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;%d&quot;</span>, code == 0 ? GetLastError() : 0);</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;    }</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;    {</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;    }</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160; </div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;    <span class="comment">// return the buffer as result</span></div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(buffer);</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;}</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160; </div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;<span class="comment">* Function:  RxWinExec                                                   *</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;<span class="comment">* Syntax:    call RxWinExec command,CmdShow                              *</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;<span class="comment">* Parms:     command    - program to execute                             *</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;<span class="comment">*            CmdShow    - Any of the SW_ type values in winuser.h        *</span></div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;<span class="comment">*                         SW_SHOW                 5                      *</span></div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;<span class="comment">*                         SW_HIDE                 0                      *</span></div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;<span class="comment">*                         SW_MINIMIZE etc...      6                      *</span></div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;<span class="comment">*                         numeric values...                              *</span></div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;<span class="comment">* Return:    Process ID or Error code                                    *</span></div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160; </div>
<div class="line"><a name="l04179"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8b05eb4e0ca4a808e31e0a9f64b6bfbc"> 4179</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a8b05eb4e0ca4a808e31e0a9f64b6bfbc">RxWinExec</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;{</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160; </div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;    <span class="keywordtype">int</span>         CmdShow;                 <span class="comment">/* show window style flags    */</span></div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;    <span class="keywordtype">int</span>         index;                   <span class="comment">/* table index                */</span></div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    ULONG       pid;                     <span class="comment">/* PID or error return code   */</span></div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    <span class="keywordtype">size_t</span>      length;                  <span class="comment">/* length of option           */</span></div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;    STARTUPINFO si;</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    PROCESS_INFORMATION procInfo;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160; </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    <span class="comment">// Show window types.</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;    PSZ    show_styles[] =</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    {</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;        <span class="stringliteral">&quot;SHOWNORMAL&quot;</span>,</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        <span class="stringliteral">&quot;SHOWNOACTIVATE&quot;</span>,</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;        <span class="stringliteral">&quot;SHOWMINNOACTIVE&quot;</span>,</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;        <span class="stringliteral">&quot;SHOWMINIMIZED&quot;</span>,</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;        <span class="stringliteral">&quot;SHOWMAXIMIZED&quot;</span>,</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;        <span class="stringliteral">&quot;HIDE&quot;</span>,</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;        <span class="stringliteral">&quot;MINIMIZE&quot;</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;    };</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160; </div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;    <span class="comment">// Show window styles.</span></div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;    ULONG  show_flags[] =</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;    {</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        SW_SHOWNORMAL,</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        SW_SHOWNOACTIVATE,</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        SW_SHOWMINNOACTIVE,</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        SW_SHOWMINIMIZED,</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        SW_SHOWMAXIMIZED,</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;        SW_HIDE,</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        SW_MINIMIZE</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    };</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160; </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a>(retstr, <a class="code" href="windows_2rexxutil_8cpp.html#a86965da6e034d2ecefa88ff3c2d213cc">NO_UTIL_ERROR</a>);  <span class="comment">/* pass back result           */</span></div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160; </div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;    <span class="comment">// Should be 1 or 2 args.</span></div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;    <span class="keywordflow">if</span> ( numargs &lt; 1 || numargs &gt; 2 || !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0]) ||</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;         (numargs == 2 &amp;&amp; !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[1])) || args[0].strlength &gt; <a class="code" href="windows_2rexxutil_8cpp.html#a857514d3bc153b3c607aa02430965307">MAX_CREATEPROCESS_CMDLINE</a> )</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;    {</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;    }</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160; </div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;    <span class="comment">// Show type can be one and only one of the SW_XXX constants.</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;    <span class="keywordflow">if</span> ( numargs &lt; 2 || args[1].strptr == NULL )</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;    {</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;        CmdShow = SW_SHOWNORMAL;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;    }</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;    {</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;        <span class="comment">// Get length of option and search the style table.</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;        length = args[1].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">strlength</a>;</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        <span class="keywordflow">for</span> ( index = 0; index &lt; <span class="keyword">sizeof</span>(show_styles)/<span class="keyword">sizeof</span>(PSZ); index++ )</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        {</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;            <span class="keywordflow">if</span> ( length == strlen(show_styles[index]) &amp;&amp; memicmp(args[1].strptr, show_styles[index], length) == 0 )</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;            {</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                CmdShow = show_flags[index];</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;            }</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;        }</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160; </div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        <span class="keywordflow">if</span> ( index == <span class="keyword">sizeof</span>(show_styles)/<span class="keyword">sizeof</span>(PSZ) )</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;            <span class="comment">// User sent an argument, but not the right one.</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        }</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;    }</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160; </div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;    ZeroMemory(&amp;procInfo, <span class="keyword">sizeof</span>(procInfo));</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    ZeroMemory(&amp;si, <span class="keyword">sizeof</span>(si));</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;    si.cb = <span class="keyword">sizeof</span>(si);</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;    si.dwFlags = STARTF_USESHOWWINDOW;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    si.wShowWindow = (WORD)CmdShow;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160; </div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;    <span class="keywordflow">if</span> ( CreateProcess(NULL, (LPSTR)args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>, NULL, NULL, FALSE, 0, NULL,</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;                       NULL, &amp;si, &amp;procInfo ) )</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    {</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        pid = procInfo.dwProcessId;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    }</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;    {</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;        pid = GetLastError();</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        <span class="keywordflow">if</span> ( pid &gt; 31 )</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        {</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;            <span class="comment">// Maintain compatibility to versions &lt; ooRexx 3.1.2</span></div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;            pid = (ULONG)-((<span class="keywordtype">int</span>)pid);</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        }</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    }</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160; </div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    <span class="comment">// Return value as string.</span></div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;%d&quot;</span>, pid);</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160; </div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="comment">// Close process / thread handles as they are not used / needed.</span></div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    CloseHandle(procInfo.hProcess);</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;    CloseHandle(procInfo.hThread);</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160; </div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;}</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160; </div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160; </div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;<span class="comment">* Function:  SysAddRexxMacro                                             *</span></div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;<span class="comment">* Syntax:    result = SysAddRexxMacro(name, file, &lt;order&gt;)               *</span></div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;<span class="comment">* Params:    name   - loaded name of the macro file                      *</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;<span class="comment">*            file   - file containing the loaded macro                   *</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="comment">*            order  - Either &#39;B&#39;efore or &#39;A&#39;fter.  The default is &#39;B&#39;    *</span></div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="comment">* Return:    return code from RexxAddMacro                               *</span></div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160; </div>
<div class="line"><a name="l04292"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ac6fe7c5da90e2c4887fa2c8c7a887ab6"> 4292</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae">RexxRoutine3</a>(<span class="keywordtype">int</span>, SysAddRexxMacro, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file, OPTIONAL_CSTRING, option)</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;{</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;    <span class="keywordtype">size_t</span> position;         <span class="comment">/* added position             */</span></div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160; </div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;    position = <a class="code" href="rexxapidefs_8h.html#a038955920fa00deca01449bad0e91f7a">RXMACRO_SEARCH_BEFORE</a>;    <span class="comment">/* set default search position*/</span></div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;    <span class="keywordflow">if</span> (option != NULL)                  <span class="comment">/* have an option?            */</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;    {</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;        <span class="keywordflow">switch</span> (*option)</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;        {</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:     <span class="comment">// &#39;B&#39;efore</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                position = <a class="code" href="rexxapidefs_8h.html#a038955920fa00deca01449bad0e91f7a">RXMACRO_SEARCH_BEFORE</a>;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160; </div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:     <span class="comment">// &#39;A&#39;fter</span></div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                position = <a class="code" href="rexxapidefs_8h.html#a58a5ae4ae5134a134de77788be1d4ba2">RXMACRO_SEARCH_AFTER</a>;</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160; </div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;        }</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;    }</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    <span class="comment">/* try to add the macro       */</span></div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;    <span class="keywordflow">return</span>(<span class="keywordtype">int</span>)<a class="code" href="rexx_8h.html#a47198dd151af7d667b5c6066a0a65f40">RexxAddMacro</a>(name, file, position);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;}</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160; </div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;<span class="comment">* Function:  SysReorderRexxMacro                                         *</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="comment">* Syntax:    result = SysReorderRexxMacro(name, order)                   *</span></div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;<span class="comment">* Params:    name   - loaded name of the macro file                      *</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="comment">*            order  - Either &#39;B&#39;efore or &#39;A&#39;fter.                        *</span></div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment">* Return:    return code from RexxReorderMacro                           *</span></div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160; </div>
<div class="line"><a name="l04331"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aef8f1711334e9b05c32ac00e45d77796"> 4331</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysReorderRexxMacro, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, option)</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;{</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;    <span class="keywordtype">size_t</span> position;        <span class="comment">/* added position             */</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160; </div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="keywordflow">switch</span> (*option)</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    {</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:     <span class="comment">// &#39;B&#39;efore</span></div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            position = <a class="code" href="rexxapidefs_8h.html#a038955920fa00deca01449bad0e91f7a">RXMACRO_SEARCH_BEFORE</a>;</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160; </div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:     <span class="comment">// &#39;A&#39;fter</span></div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;            position = <a class="code" href="rexxapidefs_8h.html#a58a5ae4ae5134a134de77788be1d4ba2">RXMACRO_SEARCH_AFTER</a>;</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160; </div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;    }</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    <span class="keywordflow">return</span>(<span class="keywordtype">int</span>)<a class="code" href="rexx_8h.html#aa00dff652e0e5e3ad962551ac22a95cb">RexxReorderMacro</a>(name, position);</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;}</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160; </div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;<span class="comment">* Function:  SysDropRexxMacro                                            *</span></div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="comment">* Syntax:    result = SysDropRexxMacro(name)                             *</span></div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;<span class="comment">* Params:    name   - name of the macro space function                   *</span></div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;<span class="comment">* Return:    return code from RexxDropMacro                              *</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160; </div>
<div class="line"><a name="l04364"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a1a3fdc0cccced5cf032808ba916a327f"> 4364</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysDropRexxMacro, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;{</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="rexx_8h.html#af0e527502183c8c40a249f22f265cc8d">RexxDropMacro</a>(name);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;}</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160; </div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;<span class="comment">* Function:  SysQueryRexxMacro                                           *</span></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;<span class="comment">* Syntax:    result = SysQueryRexxMacro(name)                            *</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;<span class="comment">* Params:    name   - name of the macro space function                   *</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;<span class="comment">* Return:    position of the macro (&#39;B&#39; or &#39;A&#39;), returns null for errors.*</span></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160; </div>
<div class="line"><a name="l04379"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa278b7e70262dd46d0b253d18629290e"> 4379</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, SysQueryRexxMacro, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;{</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> position;         <span class="comment">/* returned position          */</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160; </div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="rexx_8h.html#a86b37abbed59199713b843efab37d3ff">RexxQueryMacro</a>(name, &amp;position) != 0)</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    {</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    }</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    <span class="comment">// before?</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;    <span class="keywordflow">if</span> (position == <a class="code" href="rexxapidefs_8h.html#a038955920fa00deca01449bad0e91f7a">RXMACRO_SEARCH_BEFORE</a>)</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;    {</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;B&quot;</span>;</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;    }</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;A&quot;</span>;                    <span class="comment">/* must be &#39;A&#39;fter            */</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;    }</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;}</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160; </div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;<span class="comment">* Function:  SysClearRexxMacroSpace                                      *</span></div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;<span class="comment">* Syntax:    result = SysClearRexxMacroSpace()                           *</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;<span class="comment">* Return:    return code from RexxClearMacroSpace()                      *</span></div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160; </div>
<div class="line"><a name="l04408"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa052465890b0e94573704f6bdd162c26"> 4408</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aa052465890b0e94573704f6bdd162c26">RexxRoutine0</a>(<span class="keywordtype">int</span>, SysClearRexxMacroSpace)</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;{</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="rexx_8h.html#adbc9a0d41c6b09e57c92767bc664c6e9">RexxClearMacroSpace</a>();          <span class="comment">/* clear the macro space      */</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;}</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160; </div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;<span class="comment">* Function:  SysSaveRexxMacroSpace                                       *</span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;<span class="comment">* Syntax:    result = SysSaveRexxMacroSpace(file)                        *</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;<span class="comment">* Params:    file   - name of the saved macro space file                 *</span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="comment">* Return:    return code from RexxSaveMacroSpace()                       *</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160; </div>
<div class="line"><a name="l04423"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a79831649f3ca8e46b9626e1b4fb2fec5"> 4423</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysSaveRexxMacroSpace, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;{</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="rexx_8h.html#a697908c384958f9d6e256993d81d2aaa">RexxSaveMacroSpace</a>(0, NULL, file);</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;}</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160; </div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;<span class="comment">* Function:  SysLoadRexxMacroSpace                                       *</span></div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;<span class="comment">* Syntax:    result = SysLoadRexxMacroSpace(file)                        *</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;<span class="comment">* Params:    file   - name of the saved macro space file                 *</span></div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="comment">* Return:    return code from RexxLoadMacroSpace()                       *</span></div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160; </div>
<div class="line"><a name="l04438"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a2e98a1844e6a4dfc1373aa3f91253bb3"> 4438</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysLoadRexxMacroSpace, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;{</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)<a class="code" href="rexx_8h.html#a44df40d9d3e5ce5112d8d7ea17d7b532">RexxLoadMacroSpace</a>(0, NULL, file);</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;}</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160; </div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160; </div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;<span class="comment">* Function:  SysBootDrive                                                *</span></div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;<span class="comment">* Syntax:    drive = SysBootDrive()                                      *</span></div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="comment">* Return:    &#39;A: B: C: D: ...&#39;                                           *</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160; </div>
<div class="line"><a name="l04454"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5d6a7cdf1e4b8e8b00acdff80d697a2c"> 4454</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a5d6a7cdf1e4b8e8b00acdff80d697a2c">SysBootDrive</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;{</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;  <span class="keywordflow">if</span> (numargs)                         <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160; </div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;  <span class="keywordflow">if</span> (GetSystemDirectory(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 255) &gt; 0)</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;  {</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[2] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 2;</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  }</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;}</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160; </div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160; </div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;<span class="comment">* Function:  SysSystemDirectory                                          *</span></div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;<span class="comment">* Syntax:    drive = SysSystemDirectory()                                *</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;<span class="comment">* Return:    &#39;C:\WINDOWS ...&#39;                                            *</span></div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160; </div>
<div class="line"><a name="l04480"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a06e2143e7982a013ae2229b68ef6ef92"> 4480</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a06e2143e7982a013ae2229b68ef6ef92">SysSystemDirectory</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;{</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;  <span class="keywordflow">if</span> (numargs)                         <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160; </div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;  <span class="keywordflow">if</span> (GetSystemDirectory(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 255) &gt; 0)</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;  {</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;  }</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* no error on call           */</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;}</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160; </div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160; </div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;<span class="comment">* Function:  SysFileSystemType                                           *</span></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;<span class="comment">* Syntax:    result = SysFileSystemType(&quot;drive&quot;)                         *</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;<span class="comment">* Params:    drive - drive letter (in form of &#39;D:&#39;)                      *</span></div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;<span class="comment">*        or  none - current drive                                        *</span></div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;<span class="comment">* Return:    result - File System Name attached to the specified drive   *</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;<span class="comment">*                     (FAT, HPFS ....)                                   *</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;<span class="comment">*            &#39;&#39; - Empty string in case of any error                      *</span></div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160; </div>
<div class="line"><a name="l04508"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#abc4cf764e7e3a104c541e6a2c9feeccd"> 4508</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#abc4cf764e7e3a104c541e6a2c9feeccd">SysFileSystemType</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;{</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;  <span class="keywordtype">char</span> *      drive;</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;  CHAR chDriveLetter[4];</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;  UINT errorMode;</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160; </div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;                                       <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;  <span class="keywordflow">if</span> (numargs &gt; 1 || ((numargs == 1) &amp;&amp;</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      (args[0].strlength &gt; 2 ||</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      args[0].strlength == 0)))</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;                                       <span class="comment">/* validate the arg           */</span></div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;                                       <span class="comment">/* drive letter?              */</span></div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;  <span class="keywordflow">if</span> ((numargs == 1) &amp;&amp; (strlen(args[0].strptr) == 2 &amp;&amp; args[0].strptr[1] != <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160; </div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;  <span class="keywordflow">if</span> (numargs == 1)</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;  {</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;     <span class="keywordflow">if</span> (args[0].strlength == 1)       <span class="comment">/* need to add a : if only the*/</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;     {</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;        chDriveLetter[0]=args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>[0]; <span class="comment">/* letter was passed in  */</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;        chDriveLetter[1]=<span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;        chDriveLetter[2]=<span class="charliteral">&#39;\\&#39;</span>;         <span class="comment">/* need to add \ because of   */</span></div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;        chDriveLetter[3]=<span class="charliteral">&#39;\0&#39;</span>;         <span class="comment">/* bug in getvolumeinfo       */</span></div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;      }</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;      <span class="keywordflow">else</span>                        <span class="comment">/* have &lt;letter&gt;: , just copy over */</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      {</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;         strcpy(chDriveLetter, args[0].strptr);</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;         chDriveLetter[2]=<span class="charliteral">&#39;\\&#39;</span>;        <span class="comment">/* need to add \ because of   */</span></div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;         chDriveLetter[3]=<span class="charliteral">&#39;\0&#39;</span>;        <span class="comment">/* bug in getvolumeinfo       */</span></div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      }</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      drive = chDriveLetter;</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;  } <span class="keywordflow">else</span> drive = NULL;</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; </div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;  errorMode = SetErrorMode(SEM_FAILCRITICALERRORS);</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160; </div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;  <span class="keywordflow">if</span> (GetVolumeInformation(</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;    drive,    <span class="comment">// address of root directory of the file system</span></div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;    NULL,    <span class="comment">// address of name of the volume</span></div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    0,    <span class="comment">// length of lpVolumeNameBuffer</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    NULL,    <span class="comment">// address of volume serial number</span></div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;    NULL,    <span class="comment">// address of system&#39;s maximum filename length</span></div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;    NULL,    <span class="comment">// address of file system flags</span></div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,    <span class="comment">// address of name of file system</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;    255     <span class="comment">// length of lpFileSystemNameBuffer</span></div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  ))</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;            <span class="comment">/* return a null string       */</span></div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160; </div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  SetErrorMode(errorMode);</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* good completion            */</span></div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;}</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160; </div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160; </div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;<span class="comment">* Function:  SysVolumeLabel                                              *</span></div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;<span class="comment">* Syntax:    result = SysVolumeLabel(&quot;drive&quot;)                            *</span></div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;<span class="comment">* Params:    drive - drive letter (in form of &#39;D:&#39;)                      *</span></div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;<span class="comment">*        or  none - current drive                                        *</span></div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;<span class="comment">* Return     &#39;&#39; - Empty string in case of any error                      *</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160; </div>
<div class="line"><a name="l04574"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a884bfc4d6d3c26f7d0ec0f40d039c073"> 4574</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a884bfc4d6d3c26f7d0ec0f40d039c073">SysVolumeLabel</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;{</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;  <span class="keywordtype">char</span>  *      drive;</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;  CHAR chDriveLetter[4];</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160; </div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;                                       <span class="comment">/* validate arguments         */</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;  <span class="keywordflow">if</span> (numargs &gt; 1 || ((numargs == 1) &amp;&amp;</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;      (args[0].strlength &gt; 2 ||</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;      args[0].strlength == 0)))</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;                                       <span class="comment">/* validate the arg           */</span></div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;                                       <span class="comment">/* drive letter?              */</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;  <span class="keywordflow">if</span> ((numargs == 1) &amp;&amp; (strlen(args[0].strptr) == 2 &amp;&amp; args[0].strptr[1] != <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160; </div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;  <span class="keywordflow">if</span> (numargs == 1)</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;  {</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;     <span class="keywordflow">if</span> (args[0].strlength == 1)       <span class="comment">/* need to add a : if only the*/</span></div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;     {</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;        chDriveLetter[0]=args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>[0];  <span class="comment">/* letter was passed in */</span></div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;        chDriveLetter[1]=<span class="charliteral">&#39;:&#39;</span>;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;        chDriveLetter[2]=<span class="charliteral">&#39;\\&#39;</span>;         <span class="comment">/* need to add \ because of   */</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;        chDriveLetter[3]=<span class="charliteral">&#39;\0&#39;</span>;         <span class="comment">/* bug in getvolumeinfo       */</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;      }</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      <span class="keywordflow">else</span>                        <span class="comment">/* have &lt;letter&gt;: , just copy over */</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;      {</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;         strcpy(chDriveLetter, args[0].strptr);</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;         chDriveLetter[2]=<span class="charliteral">&#39;\\&#39;</span>;        <span class="comment">/* need to add \ because of   */</span></div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;         chDriveLetter[3]=<span class="charliteral">&#39;\0&#39;</span>;        <span class="comment">/* bug in getvolumeinfo       */</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      }</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;      drive = chDriveLetter;</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;  } <span class="keywordflow">else</span> drive = NULL;</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160; </div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;  <span class="keywordflow">if</span> (GetVolumeInformation(</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    drive,           <span class="comment">/* address of root directory of the file system */</span></div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,                  <span class="comment">/*address of name of the volume */</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;    255,                             <span class="comment">/* length of lpVolumeNameBuffer */</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;    NULL,                         <span class="comment">/* address of volume serial number */</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;    NULL,             <span class="comment">/* address of system&#39;s maximum filename length */</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;    NULL,                            <span class="comment">/* address of file system flags */</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;    NULL,                          <span class="comment">/* address of name of file system */</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;    0                            <span class="comment">/* length of lpFileSystemNameBuffer */</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;  ))</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;     retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;            <span class="comment">/* return a null string       */</span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;                <span class="comment">/* good completion            */</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;}</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160; </div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160; </div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="comment">* Function:  SysCreateMutexSem                                           *</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;<span class="comment">* Syntax:    handle = SysCreateMutexSem(&lt;name&gt;)                          *</span></div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;<span class="comment">* Params:    name  - optional name for a mutex semaphore                 *</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;<span class="comment">* Return:    handle - token used as a mutex handle for                   *</span></div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;<span class="comment">*                     SysRequestMutexSem, SysReleaseMutexSem,            *</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="comment">*                     SysCloseMutexSem, and SysOpenEventSem              *</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="comment">*            &#39;&#39; - Empty string in case of any error                      *</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160; </div>
<div class="line"><a name="l04637"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aaf6b012099afc98fd0e8bd1e8621eb46"> 4637</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, SysCreateMutexSem, OPTIONAL_CSTRING, name)</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;{</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    HANDLE    handle;                    <span class="comment">/* mutex handle               */</span></div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;    SECURITY_ATTRIBUTES sa={<span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span>};</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160; </div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;    handle = 0;                          <span class="comment">/* zero the handle            */</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;    <span class="keywordflow">if</span> (name != NULL)                  <span class="comment">/* request for named sem      */</span></div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;    {</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;        <span class="comment">/* create it by name          */</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;        handle = CreateMutex(&amp;sa, <span class="keyword">false</span>, name);</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;        <span class="keywordflow">if</span> (!handle)                            <span class="comment">/* may already be created     */</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;        {</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;            <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;            handle = OpenMutex(MUTEX_ALL_ACCESS, <span class="keyword">true</span>, name);</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;        }</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;    }</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;    <span class="keywordflow">else</span>                                 <span class="comment">/* unnamed semaphore          */</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;    {</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;        handle = CreateMutex(&amp;sa, <span class="keyword">false</span>, NULL);</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;    }</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160; </div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;    <span class="keywordflow">if</span> (handle == NULL) {</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;    }</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160; </div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;    <span class="keywordflow">return</span> context-&gt;Uintptr((<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)handle);</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;}</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160; </div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160; </div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;<span class="comment">* Function:  SysOpenMutexSem                                             *</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;<span class="comment">* Syntax:    result = SysOpenMutexSem(name)                              *</span></div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;<span class="comment">* Params:    name - name of the mutex semaphore                          *</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;<span class="comment">* Return:    result - handle to the mutex                                *</span></div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160; </div>
<div class="line"><a name="l04676"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a243b4bce9007d00e4fca3a1639f116ab"> 4676</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, SysOpenMutexSem, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;{</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;    SECURITY_ATTRIBUTES sa={<span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span>};</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160; </div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                                       <span class="comment">/* get a binary handle        */</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>) OpenMutex(MUTEX_ALL_ACCESS, <span class="keyword">true</span>, name); <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;}</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160; </div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;<span class="comment">* Function:  SysReleaseMutexSem                                          *</span></div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;<span class="comment">* Syntax:    result = SysReleaseMutexSem(handle)                         *</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateMutexSem              *</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;<span class="comment">* Return:    result - return code from ReleaseMutex                      *</span></div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160; </div>
<div class="line"><a name="l04694"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a00ceb7227752b462740f20ab7165559d"> 4694</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysReleaseMutexSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;{</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;    <span class="keywordflow">return</span> !ReleaseMutex((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;}</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160; </div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;<span class="comment">* Function:  SysCloseMutexSem                                            *</span></div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;<span class="comment">* Syntax:    result = SysCloseMutexSem(handle)                           *</span></div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateMutexSem              *</span></div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;<span class="comment">* Return:    result - return code from CloseHandle                       *</span></div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160; </div>
<div class="line"><a name="l04709"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8dfe031adeded0fc3ce3640745fcfac2"> 4709</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysCloseMutexSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;{</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    <span class="keywordflow">return</span> !ReleaseMutex((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;}</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160; </div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;<span class="comment">* Function:  SysRequestMutexSem                                          *</span></div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;<span class="comment">* Syntax:    result = SysRequestMutexSem(handle, &lt;timeout&gt;)              *</span></div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateMutexSem              *</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;<span class="comment">* Return:    result - return code from WaitForSingleObject               *</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160; </div>
<div class="line"><a name="l04724"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3a30335f84a181404728b83bd98c1d2d"> 4724</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysRequestMutexSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h, OPTIONAL_int, timeout)</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;{</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2))</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    {</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;        timeout = INFINITE;       <span class="comment">/* default is no timeout      */</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;    }</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;    <span class="keywordtype">int</span> rc = WaitForSingleObject((HANDLE)h, timeout);</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    <span class="keywordflow">if</span> (rc == WAIT_FAILED)</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;    {</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;    }</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;    {</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;        <span class="keywordflow">return</span> rc;                         <span class="comment">/* format the return code     */</span></div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;    }</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;}</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160; </div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="comment">* Function:  SysCreateEventSem                                           *</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;<span class="comment">* Syntax:    handle = SysCreateEventSem(&lt;name&gt;,&lt;manual&gt;)                 *</span></div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;<span class="comment">* Params:    name  - optional name for a event semaphore                 *</span></div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;<span class="comment">*            any second argument means manual reset event                *</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;<span class="comment">* Return:    handle - token used as a event sem handle for               *</span></div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;<span class="comment">*                     SysPostEventSem, SysClearEventSem,                 *</span></div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;<span class="comment">*                     SysCloseEventSem, and SysOpenEventSem              *</span></div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;<span class="comment">*            &#39;&#39; - Empty string in case of any error                      *</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160; </div>
<div class="line"><a name="l04754"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a822df6c176f05b4585df40629af2d8c4"> 4754</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, SysCreateEventSem, OPTIONAL_CSTRING, name, OPTIONAL_CSTRING, reset)</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;{</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;    HANDLE    handle;                    <span class="comment">/* mutex handle               */</span></div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;    SECURITY_ATTRIBUTES sa={<span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span>};</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;    <span class="keywordtype">bool</span>      manual;</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160; </div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;    handle = 0;                          <span class="comment">/* zero the handle            */</span></div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;    <span class="keywordflow">if</span> (reset != NULL)</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;    {</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;        manual = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;    }</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;    {</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;        manual = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;    }</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160; </div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;    <span class="keywordflow">if</span> (name != NULL)</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    {                                    <span class="comment">/* request for named sem      */</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;                                         <span class="comment">/* create it by name          */</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;        handle = CreateEvent(&amp;sa, manual, <span class="keyword">false</span>, name);</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;        <span class="keywordflow">if</span> (!handle)                       <span class="comment">/* may already be created     */</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        {</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;                                           <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;            handle = OpenEvent(EVENT_ALL_ACCESS, <span class="keyword">true</span>, name);</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        }</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;    }</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;    <span class="keywordflow">else</span>                                 <span class="comment">/* unnamed semaphore          */</span></div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    {</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        handle = CreateEvent(&amp;sa, manual, <span class="keyword">false</span>, NULL);</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    }</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160; </div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;    <span class="keywordflow">if</span> (handle == NULL) {</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;    }</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160; </div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;    <span class="keywordflow">return</span> context-&gt;Uintptr((<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)handle);</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;}</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160; </div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment">* Function:  SysOpenEventSem                                             *</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment">* Syntax:    result = SysOpenEventSem(name)                              *</span></div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment">* Params:    name - name of the event semaphore                          *</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="comment">* Return:    result - return code from OpenEvent                         *</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160; </div>
<div class="line"><a name="l04802"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aa99b04951a3dd00e93a76a3e69bc83f2"> 4802</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, SysOpenEventSem, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;{</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;    SECURITY_ATTRIBUTES sa={<span class="keyword">sizeof</span>(SECURITY_ATTRIBUTES), NULL, <span class="keyword">true</span>};</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160; </div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                                       <span class="comment">/* get a binary handle        */</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>)OpenEvent(EVENT_ALL_ACCESS, <span class="keyword">true</span>, name); <span class="comment">/* try to open it             */</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;}</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160; </div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;<span class="comment">* Function:  SysPostEventSem                                             *</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;<span class="comment">* Syntax:    result = SysPostEventSem(handle)                            *</span></div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;<span class="comment">* Return:    result - return code from SetEvent                          *</span></div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160; </div>
<div class="line"><a name="l04820"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae7b40c43fa6bd58cec7a486b8f49fe6d"> 4820</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysPostEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;{</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    <span class="keywordflow">return</span> !SetEvent((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;}</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160; </div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;<span class="comment">* Function:  SysResetEventSem                                            *</span></div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;<span class="comment">* Syntax:    result = SysResetEventSem(handle)                           *</span></div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;<span class="comment">* Return:    result - return code from ResetEvent                        *</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160; </div>
<div class="line"><a name="l04835"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a36473d49d30f1adc39ba57da6d79be53"> 4835</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysResetEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;{</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;    <span class="keywordflow">return</span> !ResetEvent((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;}</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160; </div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160; </div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;<span class="comment">* Function:  SysPulseEventSem                                            *</span></div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;<span class="comment">* Syntax:    result = SysPulseEventSem(handle)                           *</span></div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;<span class="comment">* Return:    result - return code from PulseEvent                        *</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160; </div>
<div class="line"><a name="l04851"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a76c373c19cf62b77a3e4a7c7d9302993"> 4851</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysPulseEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;{</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;    <span class="keywordflow">return</span> !PulseEvent((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;}</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160; </div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160; </div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;<span class="comment">* Function:  SysCloseEventSem                                            *</span></div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;<span class="comment">* Syntax:    result = SysCloseEventSem(handle)                           *</span></div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;<span class="comment">* Params:    handle - token returned from SysCreateEventSem              *</span></div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;<span class="comment">* Return:    result - return code from CloseHandle                       *</span></div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160; </div>
<div class="line"><a name="l04867"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a40833703f5b327deb66d0fa8ce4baf72"> 4867</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysCloseEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h)</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;{</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;    <span class="keywordflow">return</span> !CloseHandle((HANDLE)h) ? GetLastError() : 0;</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;}</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160; </div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;<span class="comment">* Function:  SysWaitEventSem                                             *</span></div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;<span class="comment">* Syntax:    result = SysWaitEventSem(handle, &lt;timeout&gt;)                 *</span></div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;<span class="comment">* Params:    handle - token returned from SysWaitEventSem                *</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;<span class="comment">* Return:    result - return code from WaitForSingleObject               *</span></div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160; </div>
<div class="line"><a name="l04882"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae5d73f441f7ceaf6a8ab72e13bb4c3c7"> 4882</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysWaitEventSem, <a class="code" href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a>, h, OPTIONAL_int, timeout)</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;{</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(2))</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;    {</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;        timeout = INFINITE;       <span class="comment">/* default is no timeout      */</span></div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;    }</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;    <span class="comment">/* request the semaphore      */</span></div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;    <span class="keywordtype">int</span> rc = WaitForSingleObject((HANDLE)h, timeout);</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;    <span class="keywordflow">if</span> (rc == WAIT_FAILED)</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;    {</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    }</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;    {</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;        <span class="keywordflow">return</span> rc;                         <span class="comment">/* format the return code     */</span></div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;    }</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;}</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160; </div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160; </div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;<span class="comment">* Function:  SysSetPriority                                              *</span></div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;<span class="comment">* Syntax:    result = SysSetPriority(Class, Level)                       *</span></div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;<span class="comment">* Params: Class - The priority class (0-3 or HIGH,REALTIME,NORMAL,IDLE)  *</span></div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;<span class="comment">*         Level  - Amount to change (-15 to +15 or IDLE, LOWEST,...)     *</span></div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160; </div>
<div class="line"><a name="l04911"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#af96a077df14d285590d2972491c58e81"> 4911</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, <a class="code" href="unix_2rexxutil_8cpp.html#a2eaa0915b068bca2cd391a2a0afde88e">SysSetPriority</a>, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, classArg, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, levelArg)</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;{</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;    HANDLE process = GetCurrentProcess();</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;    HANDLE thread = GetCurrentThread();</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160; </div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;    DWORD     iclass=-1;</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    <a class="code" href="rexx_8h.html#aa0199524ada35d939fa20d4625d27d55">wholenumber_t</a> classLevel;               <span class="comment">/* priority class             */</span></div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;    <span class="keywordflow">if</span> (context-&gt;WholeNumber(classArg, &amp;classLevel))</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;    {</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;        <span class="keywordflow">switch</span> (classLevel)</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;        {</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;            <span class="keywordflow">case</span> 0: iclass = IDLE_PRIORITY_CLASS;</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;            <span class="keywordflow">case</span> 1: iclass = NORMAL_PRIORITY_CLASS;</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;            <span class="keywordflow">case</span> 2: iclass = HIGH_PRIORITY_CLASS;</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;            <span class="keywordflow">case</span> 3: iclass = REALTIME_PRIORITY_CLASS;</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;                context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;        }</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;    }</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;    {</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *classStr = context-&gt;ObjectToStringValue(classArg);</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160; </div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;        <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;REALTIME&quot;</span>) == 0)</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;        {</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;            iclass = REALTIME_PRIORITY_CLASS;</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;        }</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;HIGH&quot;</span>) == 0)</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;        {</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;            iclass = HIGH_PRIORITY_CLASS;</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;        }</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!stricmp(classStr, <span class="stringliteral">&quot;NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;        {</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;            iclass = NORMAL_PRIORITY_CLASS;</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;        }</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(classStr, <span class="stringliteral">&quot;IDLE&quot;</span>) == 0)</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;        {</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;            iclass = IDLE_PRIORITY_CLASS;</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        }</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;        {</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;        }</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;    }</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160; </div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160; </div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    <a class="code" href="rexx_8h.html#aa0199524ada35d939fa20d4625d27d55">wholenumber_t</a> level;                    <span class="comment">/* priority level             */</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;    <span class="keywordflow">if</span> (context-&gt;WholeNumber(levelArg, &amp;level))</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;    {</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;        <span class="keywordflow">if</span> (level &lt; -15 || level &gt; 15)</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;        {</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;        }</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    }</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    {</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span> *levelStr = context-&gt;ObjectToStringValue(levelArg);</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160; </div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;        <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;ABOVE_NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;        {</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;            level = THREAD_PRIORITY_ABOVE_NORMAL;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;        }</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;BELOW_NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;        {</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;            level = THREAD_PRIORITY_BELOW_NORMAL;</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;        }</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;HIGHEST&quot;</span>) == 0)</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;        {</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;            level = THREAD_PRIORITY_HIGHEST;</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;        }</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;LOWEST&quot;</span>) == 0)</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;        {</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;            level = THREAD_PRIORITY_LOWEST;</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;        }</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;NORMAL&quot;</span>) == 0)</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;        {</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;            level = THREAD_PRIORITY_NORMAL;</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;        }</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;IDLE&quot;</span>) == 0)</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;        {</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;            level = THREAD_PRIORITY_IDLE;</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        }</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stricmp(levelStr, <span class="stringliteral">&quot;TIME_CRITICAL&quot;</span>) == 0)</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;        {</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;            level = THREAD_PRIORITY_TIME_CRITICAL;</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;        }</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;        {</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;        }</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;    }</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160; </div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;    <span class="keywordtype">int</span> rc = SetPriorityClass(process, iclass);</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;    <span class="keywordflow">if</span> (rc)</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    {</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;        rc = SetThreadPriority(thread, (<span class="keywordtype">int</span>)level);</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;    }</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160; </div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;    <span class="keywordflow">return</span> rc != 0 ? 0 : GetLastError();</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;}</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160; </div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160; </div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;<span class="comment">* Function:  SysQueryProcess                                             *</span></div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;<span class="comment">* Params:    &quot;PID&quot; - (default) returns current process ID                *</span></div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;<span class="comment">*            &quot;TID&quot; - (default) returns current thread ID                 *</span></div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;<span class="comment">*            &quot;PPRIO&quot; - (default) returns current process priority        *</span></div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;<span class="comment">*            &quot;TPRIO&quot; - (default) returns current thread priority         *</span></div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;<span class="comment">*            &quot;PTIME&quot; - (default) returns current process times           *</span></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;<span class="comment">*            &quot;TTIME&quot; - (default) returns current thread times            *</span></div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160; </div>
<div class="line"><a name="l05031"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aae0b90d9935f613faa77c01425eafca3"> 5031</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, <a class="code" href="unix_2rexxutil_8cpp.html#ab5cc3e1c79c1624cd7c4c1faedce8536">SysQueryProcess</a>, OPTIONAL_CSTRING, option)</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;{</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    <span class="keywordflow">if</span> (option == NULL || stricmp(option, <span class="stringliteral">&quot;PID&quot;</span>) == 0)</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;    {</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;        <span class="keywordflow">return</span> context-&gt;WholeNumber(GetCurrentProcessId());</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;    }</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;TID&quot;</span>) == 0)</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;    {</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;        <span class="keywordflow">return</span> context-&gt;WholeNumber(GetCurrentThreadId());</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;    }</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;PPRIO&quot;</span>) == 0)</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;    {</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;        LONG p;</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;        p = GetPriorityClass(GetCurrentProcess());</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160; </div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;        <span class="keywordflow">switch</span> (p)</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;        {</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;            <span class="keywordflow">case</span> HIGH_PRIORITY_CLASS:</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;HIGH&quot;</span>);</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;            <span class="keywordflow">case</span> IDLE_PRIORITY_CLASS:</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;IDLE&quot;</span>);</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;            <span class="keywordflow">case</span> NORMAL_PRIORITY_CLASS:</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;NORMAL&quot;</span>);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;            <span class="keywordflow">case</span> REALTIME_PRIORITY_CLASS:</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;REALTIME&quot;</span>);</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;UNKNOWN&quot;</span>);</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;        }</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;    }</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;TPRIO&quot;</span>) == 0)</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;    {</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;        LONG p;</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;        p = GetThreadPriority(GetCurrentThread());</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160; </div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;        <span class="keywordflow">switch</span> (p)</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;        {</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_ABOVE_NORMAL:</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;ABOVE_NORMAL&quot;</span>);</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_BELOW_NORMAL:</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;BELOW_NORMAL&quot;</span>);</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_HIGHEST:</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;HIGHEST&quot;</span>);</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_IDLE:</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;IDLE&quot;</span>);</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_LOWEST:</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;LOWEST&quot;</span>);</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_NORMAL:</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;NORMAL&quot;</span>);</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;            <span class="keywordflow">case</span> THREAD_PRIORITY_TIME_CRITICAL:</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;TIME_CRITICAL&quot;</span>);</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;                <span class="keywordflow">return</span> context-&gt;String(<span class="stringliteral">&quot;UNKNOWN&quot;</span>);</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;        }</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;    }</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;    <span class="keywordflow">if</span> (stricmp(option, <span class="stringliteral">&quot;PTIME&quot;</span>) == 0 || stricmp(option, <span class="stringliteral">&quot;TTIME&quot;</span>) == 0)</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;    {</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;        FILETIME createT, kernelT, userT, dummy;</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        SYSTEMTIME createST, kernelST, userST;</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;        BOOL ok;</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160; </div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;        <span class="keywordflow">if</span> (*option == <span class="charliteral">&#39;T&#39;</span> || *option == <span class="charliteral">&#39;t&#39;</span>)</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;        {</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;            ok = GetThreadTimes(GetCurrentThread(), &amp;createT,&amp;dummy,&amp;kernelT, &amp;userT);</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;        }</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;        {</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;            ok = GetProcessTimes(GetCurrentProcess(), &amp;createT,&amp;dummy,&amp;kernelT, &amp;userT);</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        }</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160; </div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;        <span class="keywordflow">if</span> (ok)</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;        {</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;            FileTimeToLocalFileTime(&amp;createT, &amp;createT);</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;            FileTimeToSystemTime(&amp;createT, &amp;createST);</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;            FileTimeToSystemTime(&amp;kernelT, &amp;kernelST);</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;            FileTimeToSystemTime(&amp;userT, &amp;userST);</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160; </div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;            <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160; </div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;            wsprintf(buffer, <span class="stringliteral">&quot;Create: %4.4d/%2.2d/%2.2d %d:%2.2d:%2.2d:%3.3d  &quot;</span>\</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;                     <span class="stringliteral">&quot;Kernel: %d:%2.2d:%2.2d:%3.3d  User: %d:%2.2d:%2.2d:%3.3d&quot;</span>,</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;                     createST.wYear,createST.wMonth,createST.wDay,createST.wHour,createST.wMinute,</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;                     createST.wSecond,createST.wMilliseconds,</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;                     kernelST.wHour,kernelST.wMinute,kernelST.wSecond,kernelST.wMilliseconds,</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                     userST.wHour,userST.wMinute,userST.wSecond,userST.wMilliseconds);</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160; </div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;            <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;        }</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    }</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;    context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;}</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160; </div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;<span class="comment">/** SysShutDownSystem()</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;<span class="comment"> *  Interface to the InitiateSystemShutdown() API on Windows.</span></div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;<span class="comment"> *  @param  computer         The name of the computer to shut down.  If omitted</span></div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;<span class="comment"> *                           or the empty string, the local machine is shut</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;<span class="comment"> *                           down.  Otherwise this is the name of a remote</span></div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;<span class="comment"> *                           machine to shut down.</span></div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;<span class="comment"> *  @param  message          If timout is not 0, a shut down dialog is displayed</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="comment"> *                           on the machine being shut down, naming the user who</span></div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="comment"> *                           initiated the shut down, a timer counting down the</span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="comment"> *                           seconds until the machine is shut down, and</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;<span class="comment"> *                           prompting the local user to log off. This parametr</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;<span class="comment"> *                           can be an additional message to add to the dialog</span></div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;<span class="comment"> *                           box.  It can be ommitted if no additional message</span></div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;<span class="comment"> *                           is desired.</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;<span class="comment"> *  @param  timeout          Number of seconds to display the shut down dialog.</span></div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;<span class="comment"> *                           If this is 0 no dialog is displayed.  The default</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;<span class="comment"> *                           is 30 seconds, see the remarks below.  The user can</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;<span class="comment"> *                           force a 0 timeout by explicitly specifying 0.</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;<span class="comment"> *  @param  forceAppsClosed  If true applications with unsaved data are forcibly</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;<span class="comment"> *                           closed.  If false, the user is presented with a</span></div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;<span class="comment"> *                           dialog telling the user to close the applcation(s).</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;<span class="comment"> *  @param  reboot           If true, the system is rebooted, if false the</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;<span class="comment"> *                           system is shut down.</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;<span class="comment"> *  @remarks Note that prior to 4.0.0, the defaults for all arguments were</span></div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;<span class="comment"> *           exactly what the value of each parameter is if omitted.</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;<span class="comment"> *           machine         == NULL</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;<span class="comment"> *           message         == NULL</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;<span class="comment"> *           timeout         == 0</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;<span class="comment"> *           forceAppsClosed == false</span></div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;<span class="comment"> *           reboot          == false</span></div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;<span class="comment"> *           Because of this, there would be no need to check if any argument is</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;<span class="comment"> *           ommitted or not.  However, the consequences of having a 0 timeout</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;<span class="comment"> *           value are severe if the system has an application open with unsaved</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;<span class="comment"> *           data.  Therefore for 4.0.0 and on the default time out value is</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;<span class="comment"> *           changed to 30 (seconds.)</span></div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l05167"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a39b4e0cd06e6572f1e3feee32364cf0d"> 5167</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aadd168e82abdb8bad10a39fc4915309c">RexxRoutine5</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysShutDownSystem, OPTIONAL_CSTRING, computer, OPTIONAL_CSTRING, message, OPTIONAL_uint32_t, timeout,</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;             OPTIONAL_logical_t, forceAppsClosed, OPTIONAL_logical_t, reboot)</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;{</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> result = 0;</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160; </div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;    HANDLE hToken = NULL;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;    TOKEN_PRIVILEGES tkp;</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160; </div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;    <span class="comment">// First we get the token for the current process so we can add the proper</span></div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;    <span class="comment">// shutdown privilege.</span></div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;    <span class="keywordflow">if</span> ( OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken) == 0 )</div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;    {</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;        result = GetLastError();</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;        <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;    }</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160; </div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;    <span class="comment">// Get the locally unique identifier for the shutdown privilege we need,</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;    <span class="comment">// local or remote, depending on what the user specified.</span></div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;    LPCTSTR privilegeName = (computer == NULL || *computer == <span class="charliteral">&#39;\0&#39;</span>) ? SE_SHUTDOWN_NAME : SE_REMOTE_SHUTDOWN_NAME;</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;    <span class="keywordflow">if</span> ( LookupPrivilegeValue(NULL, privilegeName, &amp;tkp.Privileges[0].Luid) == 0 )</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;    {</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;        result = GetLastError();</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;        <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;    }</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160; </div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;    <span class="comment">// We are only going to adjust 1 privilege and we are going to enable it.</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;    tkp.PrivilegeCount = 1;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;    tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160; </div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;    <span class="comment">// The return from this function can not accurately be used to determine if</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;    <span class="comment">// it failed or not.  Instead we need to use GetLastError to determine</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;    <span class="comment">// success.</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;    AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, NULL, 0);</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;    result = GetLastError();</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;    <span class="keywordflow">if</span> ( result != ERROR_SUCCESS )</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;    {</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;        <span class="keywordflow">goto</span> done_out;</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;    }</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160; </div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;    <span class="comment">// Do not shut down in 0 seconds by default.</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3) )</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;    {</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;        timeout = 30;</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    }</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160; </div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;    <span class="comment">// Now just call the API with the parameters specified by the user.</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;    <span class="keywordflow">if</span> ( InitiateSystemShutdown((LPSTR)computer, (LPSTR)message, timeout, (BOOL)forceAppsClosed, (BOOL)reboot) == 0 )</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;    {</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;        result = GetLastError();</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;    }</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160; </div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    <span class="comment">// Finally, restore the shutdown privilege for this process to disabled.</span></div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;    tkp.Privileges[0].Attributes = 0;</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, NULL, 0);</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160; </div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;done_out:</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;    <span class="keywordflow">if</span> ( hToken != NULL )</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;    {</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;        CloseHandle(hToken);</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    }</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;}</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160; </div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;<span class="comment">* Function:  SysSwitchSession                                            *</span></div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;<span class="comment">* Syntax:    result = SysSwitchSession(name)                             *</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;<span class="comment">* Params:    name   - name of target session                             *</span></div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;<span class="comment">* Return:    OS/2 error return code                                      *</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160; </div>
<div class="line"><a name="l05240"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a43e4c7f2d29926c9770be4294462cd5b"> 5240</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysSwitchSession, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name)</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;{</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;    HWND hwnd = FindWindow(NULL, name);</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160; </div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;    <span class="keywordflow">if</span> (hwnd)</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;    {</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;        <span class="keywordflow">if</span> (!SetForegroundWindow(hwnd))</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;        {</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;            <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;        }</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;        {</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;        }</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;    }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;    {</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;    }</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;}</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160; </div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;<span class="comment">* Function:  SysWaitNamedPipe                                            *</span></div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;<span class="comment">* Syntax:    result = SysWaitNamedPipe(name, timeout)                    *</span></div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;<span class="comment">* Params:    name - name of the pipe                                     *</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;<span class="comment">*            timeout - amount of time to wait.                           *</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;<span class="comment">* Return:    Return code from WaitNamedPipe                              *</span></div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160; </div>
<div class="line"><a name="l05272"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aeef8636a9372955f145a52d302b43cc6"> 5272</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysWaitNamedPipe, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, OPTIONAL_int, timeout)</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;{</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(2))</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;    {</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;        timeout = NMPWAIT_USE_DEFAULT_WAIT;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;    }</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;    {</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;        <span class="keywordflow">if</span> (timeout &lt; -1)</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        {</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;        }</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;        <span class="keywordflow">if</span> (timeout == 0)</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;        {</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;            timeout = NMPWAIT_USE_DEFAULT_WAIT;</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;        }</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (timeout == -1)</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;        {</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;            timeout = NMPWAIT_WAIT_FOREVER;</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;        }</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;    }</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160; </div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    <span class="keywordflow">if</span> (WaitNamedPipe(name, timeout))</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;    {</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;    }</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;    {</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;    }</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;}</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160; </div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160; </div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="comment">* Function:  SysDumpVariables                                            *</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;<span class="comment">* Syntax:    result = SysDumpVariables([filename])                       *</span></div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;<span class="comment">* Params:    filename - name of the file where variables are appended to *</span></div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;<span class="comment">*                       (dump is written to stdout if omitted)           *</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment">* Return:    0 - dump completed OK                                       *</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;<span class="comment">*            -1 - failure during dump                                     *</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160; </div>
<div class="line"><a name="l05318"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a561d1a192cdcaffa07ad28637416c273"> 5318</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a561d1a192cdcaffa07ad28637416c273">SysDumpVariables</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;{</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;  LONG      rc;                        <span class="comment">/* Ret code                   */</span></div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;  <a class="code" href="struct___s_h_v_b_l_o_c_k.html">SHVBLOCK</a>  shvb;</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;  HANDLE    outFile = NULL;</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;  <span class="keywordtype">bool</span>      fCloseFile = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;  DWORD     dwBytesWritten = 0;</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;  <span class="keywordtype">char</span>     *buffer = NULL;             <span class="comment">/* ENG: write result file to  */</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;  <span class="keywordtype">char</span>     *current, *end;             <span class="comment">/* memory first, much faster! */</span></div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;  <span class="keywordtype">size_t</span>    buffer_size = 10240;       <span class="comment">/* buffer, realloc&#39;d if needed*/</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;  <span class="keywordtype">size_t</span>    new_size;                  <span class="comment">/* real new size              */</span></div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160; </div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;  <span class="keywordflow">if</span> ( (numargs &gt; 1) ||                <span class="comment">/* wrong number of arguments? */</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;       ((numargs &gt; 0) &amp;&amp; !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0])) )</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;            <span class="comment">/* raise error condition      */</span></div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160; </div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;  <span class="keywordflow">if</span> (numargs &gt; 0)</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;  {</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    <span class="comment">/* open output file for append */</span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;    outFile = CreateFile(args[0].strptr, GENERIC_WRITE | GENERIC_READ,</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;                         0, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL |</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;                         FILE_FLAG_WRITE_THROUGH, NULL);</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;    <span class="keywordflow">if</span> (outFile)</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;    {</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      fCloseFile = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160; </div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      <span class="comment">/* seek to end of file */</span></div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;      SetFilePointer(outFile, 0, 0, FILE_END);</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    }</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;  }</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;    outFile = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160; </div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;                                       <span class="comment">/* write results to memory    */</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;                                       <span class="comment">/* first and then in one step */</span></div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;                                       <span class="comment">/* to disk                    */</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;  buffer = (<span class="keywordtype">char</span>*) calloc(buffer_size,1);</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;  <span class="keywordflow">if</span> (buffer == NULL)</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;            <span class="comment">/* raise error condition      */</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;  current = buffer;</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;  end = current + buffer_size;</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160; </div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;  <span class="keywordflow">do</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;  {</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;    <span class="comment">/* prepare request block */</span></div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">shvnext</a> = NULL;</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr = NULL;      <span class="comment">/* let REXX allocate the memory */</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength = 0;</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">shvnamelen</a> = 0;</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = NULL;     <span class="comment">/* let REXX allocate the memory */</span></div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">shvvaluelen</a> = 0;</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">shvcode</a> = <a class="code" href="rexxapidefs_8h.html#a13e33f27f73fbc0d6b7629cb98fe0de2">RXSHV_NEXTV</a>;</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> = 0;</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160; </div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;    rc = <a class="code" href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a>(&amp;shvb);</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160; </div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;    <span class="keywordflow">if</span> (rc == <a class="code" href="rexxapidefs_8h.html#a9426d3b59bbe38c2ca650385009d6f83">RXSHV_OK</a>)</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;    {</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;      new_size = 5 + 9 + 3 + shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength + shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>;</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;                                     <span class="comment">/* if buffer is not big enough, */</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;                                     <span class="comment">/* reallocate                   */</span></div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;      <span class="keywordflow">if</span> (current + new_size &gt;= end) {</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;        <span class="keywordtype">size_t</span> offset = current - buffer;</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;        buffer_size *= 2;</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;        <span class="comment">/* if new buffer too small, use the minimal fitting size */</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;        <span class="keywordflow">if</span> (buffer_size - offset &lt; new_size) {</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;          buffer_size = new_size + offset;</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;        }</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;        buffer = (<span class="keywordtype">char</span> *)realloc(buffer,buffer_size);</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;        current = buffer + offset;</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;        end = buffer + buffer_size;</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;      }</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;      sprintf(current, <span class="stringliteral">&quot;Name=&quot;</span>);</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;      current += 5;</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;      memcpy(current, shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr, shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength);</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;      current += shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength;</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;      sprintf(current, <span class="stringliteral">&quot;, Value=&#39;&quot;</span>);</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;      current += 9;</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;      memcpy(current, shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>);</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;      current += shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a>;</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;      sprintf(current, <span class="stringliteral">&quot;&#39;\r\n&quot;</span>);</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;      current += 3;</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160; </div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;      <span class="comment">/* free memory allocated by REXX */</span></div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;      <a class="code" href="rexx_8h.html#a5c0290e473e3b0e7e53b55c8a3612e1a">RexxFreeMemory</a>((<span class="keywordtype">void</span> *)shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr);</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;      <a class="code" href="rexx_8h.html#a5c0290e473e3b0e7e53b55c8a3612e1a">RexxFreeMemory</a>((<span class="keywordtype">void</span> *)shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160; </div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;      <span class="comment">/* leave loop if this was the last var */</span></div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;      <span class="keywordflow">if</span> (shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> &amp; <a class="code" href="rexxapidefs_8h.html#adca0acf640b42da003a82c13fcd0ece3">RXSHV_LVAR</a>)</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    }</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;  } <span class="keywordflow">while</span> (rc == <a class="code" href="rexxapidefs_8h.html#a9426d3b59bbe38c2ca650385009d6f83">RXSHV_OK</a>);</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160; </div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;  WriteFile(outFile, buffer, (DWORD)(current - buffer), &amp;dwBytesWritten, NULL);</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;  free(buffer);</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160; </div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;  <span class="keywordflow">if</span> (fCloseFile)</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;    CloseHandle(outFile);</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160; </div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;  <span class="keywordflow">if</span> (rc != <a class="code" href="rexxapidefs_8h.html#adca0acf640b42da003a82c13fcd0ece3">RXSHV_LVAR</a>)</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#acf0a46c8a6b68267ae16d6fe597f9f98">RETVAL</a>(-1)</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#acf0a46c8a6b68267ae16d6fe597f9f98">RETVAL</a>(0)</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;}</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160; </div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160; </div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;<span class="comment">* Function:  SysSetFileDateTime                                          *</span></div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;<span class="comment">* Syntax:    result = SysSetFileDateTime(filename [,newdate] [,newtime]) *</span></div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;<span class="comment">* Params:    filename - name of the file to update                       *</span></div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;<span class="comment">*            newdate  - new date to set in format YYYY-MM-DD (YYYY&gt;1800) *</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;<span class="comment">*            newtime  - new time to set in format HH:MM:SS               *</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;<span class="comment">* Return:    0 - file date/time was updated correctly                    *</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;<span class="comment">*            -1 - failure attribute update                               *</span></div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160; </div>
<div class="line"><a name="l05438"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a631f62f37f0f33e152d5a01b3f99b245"> 5438</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae">RexxRoutine3</a>(<span class="keywordtype">int</span>, <a class="code" href="unix_2rexxutil_8cpp.html#ae415e0f263db631c50550196d163dbe6">SysSetFileDateTime</a>, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, OPTIONAL_CSTRING, newdate, OPTIONAL_CSTRING, newtime)</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;{</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;    BOOL      fOk = FALSE;</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;    FILETIME  sFileTime;</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    FILETIME  sLocalFileTime;</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;    SYSTEMTIME sLocalSysTime;</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160; </div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;    <span class="comment">/* open output file for read/write for update */</span></div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;    HANDLE setFile = CreateFile(name, GENERIC_WRITE | GENERIC_READ,</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;                                FILE_SHARE_READ | FILE_SHARE_WRITE,</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;                                NULL, OPEN_EXISTING, FILE_FLAG_WRITE_THROUGH |</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                                FILE_FLAG_BACKUP_SEMANTICS, NULL);</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;    <span class="keywordflow">if</span> (setFile &amp;&amp; (setFile != INVALID_HANDLE_VALUE))</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;    {</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;        fOk = GetFileTime(setFile, NULL, NULL, &amp;sFileTime);</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;        fOk &amp;= FileTimeToLocalFileTime(&amp;sFileTime, &amp;sLocalFileTime);</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;        fOk &amp;= FileTimeToSystemTime(&amp;sLocalFileTime, &amp;sLocalSysTime);</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;        <span class="keywordflow">if</span> (fOk)</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;        {</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;            <span class="comment">/* file date/time could be read, now parse the new date/time */</span></div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;            <span class="keywordflow">if</span> (newdate != NULL)</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;            {</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;                <span class="comment">/* parse new date */</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;                <span class="keywordflow">if</span> (sscanf(newdate, <span class="stringliteral">&quot;%4hu-%2hu-%2hu&quot;</span>, &amp;sLocalSysTime.wYear,</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;                           &amp;sLocalSysTime.wMonth, &amp;sLocalSysTime.wDay) != 3)</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;                {</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;                    fOk = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;                }</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160; </div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;                <span class="keywordflow">if</span> (sLocalSysTime.wYear &lt; 1800)</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;                {</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;                    fOk = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;                }</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;            }</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160; </div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;            <span class="keywordflow">if</span> (newtime != NULL)</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;            {</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;                <span class="comment">/* parse new time */</span></div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;                <span class="keywordflow">if</span> (sscanf(newtime, <span class="stringliteral">&quot;%2hu:%2hu:%2hu&quot;</span>, &amp;sLocalSysTime.wHour,</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;                           &amp;sLocalSysTime.wMinute, &amp;sLocalSysTime.wSecond) != 3)</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;                {</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;                    fOk = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;                }</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;            }</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160; </div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;            <span class="keywordflow">if</span> (newdate == NULL &amp;&amp; newtime == NULL)</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;            {</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;                <span class="comment">/* we set the timestamp to the current time and date */</span></div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;                GetLocalTime(&amp;sLocalSysTime);</div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;            }</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160; </div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;            <span class="keywordflow">if</span> (fOk)</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;            {</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;                fOk &amp;= SystemTimeToFileTime(&amp;sLocalSysTime, &amp;sLocalFileTime);</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;                fOk &amp;= LocalFileTimeToFileTime(&amp;sLocalFileTime, &amp;sFileTime);</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;                fOk &amp;= SetFileTime(setFile, NULL, NULL, &amp;sFileTime);</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;            }</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;        }</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160; </div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;        CloseHandle(setFile);</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;    }</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160; </div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;    <span class="keywordflow">return</span> fOk ? 0 : 1;</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;}</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160; </div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;<span class="comment">* Function:  SysGetFileDateTime                                          *</span></div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;<span class="comment">* Syntax:    result = SysGetFileDateTime(filename [,timesel])            *</span></div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;<span class="comment">* Params:    filename - name of the file to query                        *</span></div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;<span class="comment">*            timesel  - What filetime to query: Created/Access/Write     *</span></div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;<span class="comment">* Return:    -1 - file date/time query failed                            *</span></div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="comment">*            other - date and time as YYYY-MM-DD HH:MM:SS                *</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160; </div>
<div class="line"><a name="l05514"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ab3cdd81b174125698dc63358463457b6"> 5514</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, <a class="code" href="unix_2rexxutil_8cpp.html#a6d0e601daae44f306aa512f656edeaf9">SysGetFileDateTime</a>, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, name, OPTIONAL_CSTRING, selector)</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;{</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;    FILETIME  sFileTime;</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;    FILETIME  sLocalFileTime;</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;    FILETIME  *psFileCreated = NULL;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;    FILETIME  *psFileAccessed = NULL;</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;    FILETIME  *psFileWritten = NULL;</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;    SYSTEMTIME sLocalSysTime;</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160; </div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;    <span class="keywordflow">if</span> (selector != NULL)</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;    {</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;        <span class="keywordflow">switch</span> (selector[0])</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;        {</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;                psFileCreated = &amp;sFileTime;</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;                psFileAccessed = &amp;sFileTime;</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>:</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;                psFileWritten = &amp;sFileTime;</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;                context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;        }</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;    }</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;    {</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;        psFileWritten = &amp;sFileTime;</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;    }</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160; </div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;    <span class="comment">/* open file for read to query time */</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    HANDLE setFile = CreateFile(name, FILE_READ_ATTRIBUTES,</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;                                FILE_SHARE_READ | FILE_SHARE_WRITE,</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;                                NULL, OPEN_EXISTING, FILE_FLAG_WRITE_THROUGH |</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;                                FILE_FLAG_BACKUP_SEMANTICS, NULL);</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;    <span class="keywordflow">if</span> (setFile != INVALID_HANDLE_VALUE)</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;    {</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;        BOOL fOk = GetFileTime(setFile, psFileCreated, psFileAccessed, psFileWritten);</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;        CloseHandle(setFile);</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;        fOk &amp;= FileTimeToLocalFileTime(&amp;sFileTime, &amp;sLocalFileTime);</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;        fOk &amp;= FileTimeToSystemTime(&amp;sLocalFileTime, &amp;sLocalSysTime);</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160; </div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;        <span class="keywordflow">if</span> (fOk)</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;        {</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;            <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;            sprintf(buffer, <span class="stringliteral">&quot;%4d-%02d-%02d %02d:%02d:%02d&quot;</span>,</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;                    sLocalSysTime.wYear,</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;                    sLocalSysTime.wMonth,</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;                    sLocalSysTime.wDay,</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;                    sLocalSysTime.wHour,</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;                    sLocalSysTime.wMinute,</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;                    sLocalSysTime.wSecond);</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;            <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;        }</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;    }</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;    <span class="keywordflow">return</span> context-&gt;WholeNumber(-1);</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160; </div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;}</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160; </div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160; </div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;<a class="code" href="rexx_8h.html#ac86f469a219a357916379dfb54b03393">RexxReturnCode</a> <a class="code" href="unix_2rexxapitypes_8h.html#a93e16d257e437e184c82b4918857bdae">REXXENTRY</a> <a class="code" href="windows_2rexxutil_8cpp.html#a51cac9f9c515d627456d545f27c76c58">RexxStemSort</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *stemname, <span class="keywordtype">int</span> order, <span class="keywordtype">int</span> <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>,</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;    <span class="keywordtype">size_t</span> start, <span class="keywordtype">size_t</span> end, <span class="keywordtype">size_t</span> firstcol, <span class="keywordtype">size_t</span> lastcol);</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160; </div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;<span class="comment">* Function:  SysStemSort                                                 *</span></div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;<span class="comment">* Syntax:    result = SysStemSort(stem, order, type, start, end,         *</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;<span class="comment">*                                 firstcol, lastcol)                     *</span></div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;<span class="comment">* Params:    stem - name of stem to sort                                 *</span></div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="comment">*            order - &#39;A&#39; or &#39;D&#39; for sort order                           *</span></div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;<span class="comment">*            type - &#39;C&#39;, &#39;I&#39;, &#39;N&#39; for comparision type                   *</span></div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;<span class="comment">*            start - first index to sort                                 *</span></div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;<span class="comment">*            end - last index to sort                                    *</span></div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;<span class="comment">*            firstcol - first column to use as sort key                  *</span></div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;<span class="comment">*            lastcol - last column to use as sort key                    *</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;<span class="comment">* Return:    0 - sort was successful                                     *</span></div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;<span class="comment">*            -1 - sort failed                                            *</span></div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160; </div>
<div class="line"><a name="l05600"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a73a859def741d7f37ff402604263c943"> 5600</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a73a859def741d7f37ff402604263c943">SysStemSort</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">size_t</span> numargs, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> args[], <span class="keyword">const</span> <span class="keywordtype">char</span> *queuename, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;{</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    CHAR          stemName[255];</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;    <span class="keywordtype">size_t</span>        first = 1;</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;    <span class="keywordtype">size_t</span>        last = <a class="code" href="windows_2rexxapitypes_8h.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;    <span class="keywordtype">size_t</span>        firstCol = 0;</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;    <span class="keywordtype">size_t</span>        lastCol = <a class="code" href="windows_2rexxapitypes_8h.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a>;</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;    INT           sortType = <a class="code" href="windows_2rexxutil_8cpp.html#aa34ca575266a3f4b79b915c067dc275e">SORT_CASESENSITIVE</a>;</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;    INT           sortOrder = <a class="code" href="windows_2rexxutil_8cpp.html#a81da4fa77ffcb61150943958eea47cd1">SORT_ASCENDING</a>;</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160; </div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;    <span class="comment">// validate arguments</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;    <span class="keywordflow">if</span> ( (numargs &lt; 1) || (numargs &gt; 7) || !<a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[0]) )</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;    {</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;    }</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160; </div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;    <span class="comment">// remember stem name</span></div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;    memset(stemName, 0, <span class="keyword">sizeof</span>(stemName));</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;    strcpy(stemName, args[0].strptr);</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;    <span class="keywordflow">if</span> ( stemName[args[0].strlength-1] != <span class="charliteral">&#39;.&#39;</span> )</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;    {</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;        stemName[args[0].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">strlength</a>] = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;    }</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160; </div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;    <span class="comment">// check other parameters.  sort order</span></div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;    <span class="keywordflow">if</span> ( (numargs &gt;= 2) &amp;&amp; <a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[1]) )</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;    {</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;        <span class="keywordflow">switch</span> ( args[1].strptr[0] )</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;        {</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;                sortOrder = <a class="code" href="windows_2rexxutil_8cpp.html#a81da4fa77ffcb61150943958eea47cd1">SORT_ASCENDING</a>;</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>:</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;                sortOrder = <a class="code" href="windows_2rexxutil_8cpp.html#acda2338325b3044d2e9cae8c83de6a8b">SORT_DECENDING</a>;</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;        }</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;    }</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;    <span class="comment">// sort type</span></div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;    <span class="keywordflow">if</span> ( (numargs &gt;= 3) &amp;&amp; <a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[2]) )</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;    {</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;        <span class="keywordflow">switch</span> ( args[2].strptr[0] )</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;        {</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;                sortType = <a class="code" href="windows_2rexxutil_8cpp.html#aa34ca575266a3f4b79b915c067dc275e">SORT_CASESENSITIVE</a>;</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;                sortType = <a class="code" href="windows_2rexxutil_8cpp.html#a8d2fa71ddc3683adb805fa0a0680731d">SORT_CASEIGNORE</a>;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;        }</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;    }</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;    <span class="comment">// first element to sort</span></div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;    <span class="keywordflow">if</span> ( (numargs &gt;= 4) &amp;&amp; <a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[3]) )</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;    {</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">string2size_t</a>(args[3].strptr, &amp;first))</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;        {</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;        }</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;        <span class="keywordflow">if</span> ( first == 0 )</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;        {</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;        }</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;    }</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;    <span class="comment">// last element to sort</span></div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;    <span class="keywordflow">if</span> ( (numargs &gt;= 5) &amp;&amp; <a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[4]) )</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    {</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">string2size_t</a>(args[4].strptr, &amp;last))</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;        <span class="keywordflow">if</span> ( last &lt; first )</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;    }</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;    <span class="comment">// first column to sort</span></div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;    <span class="keywordflow">if</span> ( (numargs &gt;= 6) &amp;&amp; <a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[5]) )</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;    {</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">string2size_t</a>(args[5].strptr, &amp;firstCol))</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;        {</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;        }</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;        firstCol--;</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;    }</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;    <span class="comment">// last column to sort</span></div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;    <span class="keywordflow">if</span> ( (numargs == 7) &amp;&amp; <a class="code" href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a>(args[6]) )</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;    {</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">string2size_t</a>(args[6].strptr, &amp;lastCol))</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;        {</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;        }</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;        lastCol--;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;        <span class="keywordflow">if</span> ( lastCol &lt; firstCol )</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;        {</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;        }</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160; </div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;    }</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160; </div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;    <span class="comment">// the sorting is done in the interpreter</span></div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="windows_2rexxutil_8cpp.html#a51cac9f9c515d627456d545f27c76c58">RexxStemSort</a>(stemName, sortOrder, sortType, first, last, firstCol, lastCol) )</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;    {</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;-1&quot;</span>);</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 2;</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a>;</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;    }</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160; </div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;0&quot;</span>);</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 1;</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a>;</div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;}</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160; </div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160; </div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;<span class="comment">* Function:  SysStemDelete                                               *</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;<span class="comment">* Syntax:    result = SysStemDelete(stem, startitem [,itemcount])        *</span></div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;<span class="comment">* Params:    stem - name of stem where item will be deleted              *</span></div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;<span class="comment">*            startitem - index of item to delete                         *</span></div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;<span class="comment">*            itemcount - number of items to delete if more than 1        *</span></div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;<span class="comment">* Return:    0 - delete was successful                                   *</span></div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;<span class="comment">*            -1 - delete failed                                          *</span></div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160; </div>
<div class="line"><a name="l05729"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a132e4df3e76ceb317402a98d9df7e6a7"> 5729</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae">RexxRoutine3</a>(<span class="keywordtype">int</span>, SysStemDelete, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, toStem, <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a>, start, OPTIONAL_stringsize_t, count)</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160; </div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;{</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3))</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;    {</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;        count = 1;</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;    }</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160; </div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;    <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a> items;</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160; </div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> temp = context-&gt;GetStemArrayElement(toStem, 0);</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    <span class="keywordflow">if</span> (temp == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> || !context-&gt;StringSize(temp, &amp;items))</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;    {</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;    }</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160; </div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;    <span class="comment">// make sure the deletion site is within the bounds</span></div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;    <span class="keywordflow">if</span> (start + count - 1 &gt; items)</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;    {</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;    }</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160; </div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;    <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a> index;</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;    <span class="comment">/* now copy the remaining indices up front */</span></div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;    <span class="keywordflow">for</span> ( index = start;  index + count &lt;= items; index++)</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;    {</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;        <span class="comment">// copy from the old index to the new index</span></div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;        <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> value = context-&gt;GetStemArrayElement(toStem, index + count);</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;        <span class="comment">// is this a sparse array?</span></div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;        <span class="keywordflow">if</span> (value == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>)</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;        {</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;            <span class="comment">// return this as a failure</span></div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;        }</div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;        context-&gt;SetStemArrayElement(toStem, index, value);</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;    }</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160; </div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    <span class="comment">/* now delete the items at the end */</span></div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    <span class="keywordflow">for</span> (index = items - count + 1; index &lt;= items; index++)</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;    {</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;        context-&gt;DropStemArrayElement(toStem, index);</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    }</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160; </div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;    context-&gt;SetStemArrayElement(toStem, 0, context-&gt;StringSize(items - count));</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;}</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160; </div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160; </div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;<span class="comment">* Function:  SysStemInsert                                               *</span></div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;<span class="comment">* Syntax:    result = SysStemInsert(stem, position, value)               *</span></div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;<span class="comment">* Params:    stem - name of stem where item will be inserted             *</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;<span class="comment">*            position - index where new item will be inserted            *</span></div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;<span class="comment">*            value - new item value                                      *</span></div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;<span class="comment">* Return:    0 - insert was successful                                   *</span></div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;<span class="comment">*            -1 - insert failed                                          *</span></div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160; </div>
<div class="line"><a name="l05792"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a05d8a781f1567f14112b2766a7cf18ad"> 5792</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae">RexxRoutine3</a>(<span class="keywordtype">int</span>, SysStemInsert, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, toStem, <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a>, position, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, newValue)</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;{</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;    <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a> count;</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160; </div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> temp = context-&gt;GetStemArrayElement(toStem, 0);</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;    <span class="keywordflow">if</span> (temp == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> || !context-&gt;StringSize(temp, &amp;count))</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;    {</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;    }</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160; </div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;    <span class="comment">/* check wether new position is within limits */</span></div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;    <span class="keywordflow">if</span> (position == 0 || (position &gt; count + 1))</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;    {</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;    }</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160; </div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index = count; index &gt;= position; index--)</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;    {</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;        <span class="comment">// copy from the old index to the new index</span></div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;        <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> value = context-&gt;GetStemArrayElement(toStem, index);</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;        <span class="comment">// is this a sparse array?</span></div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;        <span class="keywordflow">if</span> (value == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>)</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;        {</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;            <span class="comment">// return this as a failure</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;        }</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;        context-&gt;SetStemArrayElement(toStem, index + 1, value);</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;    }</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160; </div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;    <span class="comment">// now set the new value and increase the count at stem.0</span></div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;    context-&gt;SetStemArrayElement(toStem, position, newValue);</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;    context-&gt;SetStemArrayElement(toStem, 0, context-&gt;WholeNumber(count + 1));</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;}</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160; </div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160; </div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;<span class="comment">* Function:  SysStemCopy                                                 *</span></div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;<span class="comment">* Syntax:    result = SysStemCopy(fromstem, tostem, from, to, count      *</span></div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;<span class="comment">*                                 [,insert])                             *</span></div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;<span class="comment">* Params:    fromstem - name of source stem                              *</span></div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;<span class="comment">*            tostem - - name of target stem                              *</span></div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;<span class="comment">*            from  - first index in source stem to copy                  *</span></div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;<span class="comment">*            to - position where items are copied/inserted in target stem*</span></div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;<span class="comment">*            count - number of items to copy/insert                      *</span></div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;<span class="comment">*            insert - &#39;I&#39; to indicate insert instead of &#39;O&#39; overwrite    *</span></div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;<span class="comment">* Return:    0 - stem copy was successful                                *</span></div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;<span class="comment">*            -1 - stem copy failed                                       *</span></div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160; </div>
<div class="line"><a name="l05847"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a25020b02829d4d69fb53c8bfeb03222e"> 5847</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a25020b02829d4d69fb53c8bfeb03222e">RexxRoutine6</a>(<span class="keywordtype">int</span>, SysStemCopy, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, fromStem, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, toStem,</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;    OPTIONAL_stringsize_t, from, OPTIONAL_stringsize_t, to, OPTIONAL_stringsize_t, count,</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;    OPTIONAL_CSTRING, option)</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;{</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;    <span class="keywordtype">bool</span> inserting = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160; </div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;    <span class="comment">/* get copy type */</span></div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;    <span class="keywordflow">if</span> (option != NULL)</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;    {</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;        <span class="keywordflow">switch</span> (*option)</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;        {</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;                inserting = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>:</div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;                inserting = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;            {</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;                context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;            }</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;        }</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;    }</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160; </div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;    <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a> fromCount;</div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160; </div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> temp = context-&gt;GetStemArrayElement(fromStem, 0);</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;    <span class="keywordflow">if</span> (temp == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> || !context-&gt;StringSize(temp, &amp;fromCount))</div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;    {</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;    }</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160; </div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;    <span class="comment">// default from location is the first element</span></div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3))</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;    {</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;        from = 1;</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;    }</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160; </div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(4))</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;    {</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;        to = 1;</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;    }</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160; </div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;    <span class="comment">// was a count explicitly specified?</span></div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(5))</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;    {</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;        <span class="comment">// this must be in range</span></div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;        <span class="keywordflow">if</span> ((count &gt; (fromCount - from + 1)) || (fromCount == 0))</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;        {</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;        }</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;    }</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;    {</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;        <span class="comment">// default is to copy everything from the starting position.</span></div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;        count = fromCount - from + 1;</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;    }</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160; </div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;    <a class="code" href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a> toCount = 0;</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;    <span class="comment">// but if it is set, then use that value</span></div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;    temp = context-&gt;GetStemArrayElement(toStem, 0);</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;    <span class="keywordflow">if</span> (temp != <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> &amp;&amp; !context-&gt;StringSize(temp, &amp;toCount))</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;    {</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;    }</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160; </div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;    <span class="comment">// copying out of range?  Error</span></div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;    <span class="keywordflow">if</span> (to &gt; toCount + 1)</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;    {</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;    }</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160; </div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;    <span class="keywordflow">if</span> (inserting)</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;    {</div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;        <span class="comment">/* if we are about to insert the items we have to make room */</span></div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index = toCount; index &gt;= to; index--)</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;        {</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;            <span class="comment">// copy from the old index to the new index</span></div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;            <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> value = context-&gt;GetStemArrayElement(toStem, index);</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;            <span class="comment">// is this a sparse array?</span></div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;            <span class="keywordflow">if</span> (value == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>)</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;            {</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;                <span class="comment">// return this as a failure</span></div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;            }</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;            context-&gt;SetStemArrayElement(toStem, index + count, value);</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;        }</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160; </div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160; </div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;        <span class="comment">// set the new count value in the target</span></div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;        toCount += count;</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;        context-&gt;SetStemArrayElement(toStem, 0, context-&gt;StringSize(toCount));</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;    }</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;    <span class="comment">/* now do the actual copying from the source to target */</span></div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> index = 0; index &lt; count; index++)</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;    {</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;        <span class="comment">// just retrieve and copy</span></div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;        <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> value = context-&gt;GetStemArrayElement(fromStem, from + index);</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;        <span class="comment">// is this a sparse array?</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;        <span class="keywordflow">if</span> (value == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>)</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;        {</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;            <span class="comment">// return this as a failure</span></div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;        }</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;        context-&gt;SetStemArrayElement(toStem, to + index, value);</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;    }</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160; </div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;    <span class="comment">// do we need to update the size?</span></div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;    <span class="keywordflow">if</span> (to + count - 1 &gt; toCount)</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;    {</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;        context-&gt;SetStemArrayElement(toStem, 0, context-&gt;StringSize(to + count - 1));</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;    }</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;}</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160; </div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160; </div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;<span class="comment">* Function:  SysUtilVersion                                              *</span></div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;<span class="comment">* Syntax:    Say SysUtilVersion                                          *</span></div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;<span class="comment">* Return:    REXXUTIL.DLL Version                                        *</span></div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160; </div>
<div class="line"><a name="l05978"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a67e6e676bc309ca8be2ee7d20b825350"> 5978</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aa052465890b0e94573704f6bdd162c26">RexxRoutine0</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, <a class="code" href="unix_2rexxutil_8cpp.html#aafa64d230b88376df6f055cb4490f701">SysUtilVersion</a>)</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;{</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;    <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;                                       <span class="comment">/* format into the buffer     */</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;    sprintf(buffer, <span class="stringliteral">&quot;%d.%d.%d&quot;</span>, ORX_VER, ORX_REL, ORX_MOD);</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;    <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;}</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;<span class="comment"> * Check if the dwFlags arguement to WideCharToMultiByte() can be used by the</span></div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;<span class="comment"> * specified code page.  See MSDN documentation for WideCharToMultiByte() for</span></div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;<span class="comment"> * clarification.  This is used by SysFromUnicode()</span></div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;<span class="comment"> * @param cp  Code page to check.</span></div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;<span class="comment"> * @return Return true if dwFlags can be non-zero, return false if dwFlags must</span></div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;<span class="comment"> *         be zero.</span></div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l05996"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#af0535563767484a571323c5b12f840e3"> 5996</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="windows_2rexxutil_8cpp.html#af0535563767484a571323c5b12f840e3">canUseWideCharFlags</a>(UINT cp)</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;{</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;    <span class="keywordflow">if</span> ( cp == CP_SYMBOL || cp == CP_UTF7 || cp == CP_UTF8 )</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;    {</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;    }</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;    <span class="keywordflow">if</span> ( 50220 &lt;= cp &amp;&amp; cp &lt;= 50222  )</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;    {</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;    }</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;    <span class="keywordflow">if</span> ( cp == 50225 || cp == 50227 || cp == 50229 || cp == 52936 || cp == 54936 )</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;    {</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;    }</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;    <span class="keywordflow">if</span> ( 57002 &lt;= cp &amp;&amp; cp &lt;= 57011  )</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;    {</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;    }</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;}</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160; </div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;<span class="comment">* Function:  SysFromUnicode                                              *</span></div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;<span class="comment">*            Converts a UNICODE string to an ASCII string                *</span></div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;<span class="comment">* Syntax:    result = SysFromUniCode(string,CodePage,MappingFlags,       *</span></div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;<span class="comment">*                                    DefaultChar, outstem.)              *</span></div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;<span class="comment">* Params:    string       - unicode string to be converted               *</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;<span class="comment">*            Codepage     - target codepage                              *</span></div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;<span class="comment">*            MappingFlags - Mapping flags                                *</span></div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;<span class="comment">*            DefaultChar  - default for unmappable chars                 *</span></div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;<span class="comment">*             outstem.    - stem containg the result                     *</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;<span class="comment">*              .!USEDDEFAULTCHAR - 1: character used as default          *</span></div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;<span class="comment">*              .!TEXT     - converted text                               *</span></div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;<span class="comment">* Return:    0 - successfull completetion                                *</span></div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;<span class="comment">*            error code from WideCharToMultiByte                         *</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;<span class="comment">  The following are the OEM code-page identifiers.</span></div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;<span class="comment">    437  MS-DOS United States</span></div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;<span class="comment">    708  Arabic (ASMO 708)</span></div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;<span class="comment">    709  Arabic (ASMO 449+, BCON V4)</span></div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;<span class="comment">    710  Arabic (Transparent Arabic)</span></div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;<span class="comment">    720  Arabic (Transparent ASMO)</span></div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;<span class="comment">    737  Greek (formerly 437G)</span></div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;<span class="comment">    775  Baltic</span></div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;<span class="comment">    850  MS-DOS Multilingual (Latin I)</span></div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;<span class="comment">    852  MS-DOS Slavic (Latin II)</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;<span class="comment">    855  IBM Cyrillic (primarily Russian)</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;<span class="comment">    857  IBM Turkish</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;<span class="comment">    860  MS-DOS Portuguese</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;<span class="comment">    861  MS-DOS Icelandic</span></div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;<span class="comment">    862  Hebrew</span></div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;<span class="comment">    863  MS-DOS Canadian-French</span></div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;<span class="comment">    864  Arabic</span></div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;<span class="comment">    865  MS-DOS Nordic</span></div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;<span class="comment">    866  MS-DOS Russian (former USSR)</span></div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;<span class="comment">    869  IBM Modern Greek</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;<span class="comment">    874  Thai</span></div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;<span class="comment">    932  Japan</span></div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;<span class="comment">    936  Chinese (PRC, Singapore)</span></div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;<span class="comment">    949  Korean</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="comment">    950  Chinese (Taiwan; Hong Kong SAR, PRC)</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;<span class="comment">    1361 Korean (Johab)</span></div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;<span class="comment">  The following are the ANSI code-page identifiers.</span></div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;<span class="comment">    874  Thai</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;<span class="comment">    932  Japan</span></div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;<span class="comment">    936  Chinese (PRC, Singapore)</span></div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;<span class="comment">    949  Korean</span></div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;<span class="comment">    950  Chinese (Taiwan; Hong Kong SAR, PRC)</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;<span class="comment">    1200 Unicode (BMP of ISO 10646)</span></div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;<span class="comment">    1250 Windows 3.1 Eastern European</span></div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;<span class="comment">    1251 Windows 3.1 Cyrillic</span></div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;<span class="comment">    1252 Windows 3.1 Latin 1 (US, Western Europe)</span></div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;<span class="comment">    1253 Windows 3.1 Greek</span></div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;<span class="comment">    1254 Windows 3.1 Turkish</span></div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;<span class="comment">    1255 Hebrew</span></div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;<span class="comment">    1256 Arabic</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;<span class="comment">    1257 Baltic</span></div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;<span class="comment">  COMPOSITECHECK :</span></div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;<span class="comment">    Convert composite characters to precomposed characters.</span></div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;<span class="comment">  DISCARDNS :</span></div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;<span class="comment">    Discard nonspacing characters during conversion.</span></div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;<span class="comment">  SEPCHARS :</span></div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;<span class="comment">    Generate separate characters during conversion. This is the default conversion behavior.</span></div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;<span class="comment">  DEFAULTCHAR :</span></div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;<span class="comment">    Replace exceptions with the default character during conversion.</span></div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160; </div>
<div class="line"><a name="l06095"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#aadb97839ae97dea39f9e97bc6de59565"> 6095</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aadd168e82abdb8bad10a39fc4915309c">RexxRoutine5</a>(<span class="keywordtype">int</span>, SysFromUniCode, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, sourceString, OPTIONAL_CSTRING, codePageOpt,</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;    OPTIONAL_CSTRING, mappingFlags, OPTIONAL_CSTRING, defaultChar, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, stem)</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;{</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *source = context-&gt;StringData(sourceString);</div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;    <span class="keywordtype">size_t</span> sourceLength = context-&gt;StringLength(sourceString);</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160; </div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;    UINT  codePage;</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;    <span class="comment">/* evaluate codepage          */</span></div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;    <span class="keywordflow">if</span> (codePageOpt == NULL)</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;    {</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;        codePage = GetOEMCP();</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;    }</div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;    {</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;        <span class="keywordflow">if</span> (_stricmp(codePageOpt, <span class="stringliteral">&quot;THREAD_ACP&quot;</span>) == 0)</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;        {</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;            codePage = CP_THREAD_ACP;</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;        }</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;ACP&quot;</span>) == 0)</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;        {</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;            codePage = CP_ACP;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;        }</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;MACCP&quot;</span>) == 0)</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;        {</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;            codePage = CP_MACCP;</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;        }</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;OEMCP&quot;</span>) == 0)</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;        {</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;            codePage = CP_OEMCP;</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;        }</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;SYMBOL&quot;</span>) == 0)</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;        {</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;            codePage = CP_SYMBOL;</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;        }</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;UTF7&quot;</span>) == 0)</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;        {</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;            codePage = CP_UTF7;</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;        }</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;UTF8&quot;</span>) == 0)</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;        {</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;            codePage = CP_UTF8;</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;        }</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;        {</div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;            codePage = atoi(codePageOpt);</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;        }</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    }</div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160; </div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    DWORD dwFlags = 0;</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;    <span class="comment">/* evaluate the mapping flags */</span></div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;    <span class="keywordflow">if</span> (mappingFlags != NULL &amp;&amp; *mappingFlags != <span class="charliteral">&#39;\0&#39;</span> )</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;    {</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;        <span class="comment">/* The WC_SEPCHARS, WC_DISCARDNS, and WC_DEFAULTCHAR flags must also</span></div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;<span class="comment">         * specify the WC_COMPOSITECHECK flag.  So, we add that for the user if</span></div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;<span class="comment">         * they skipped it. Those 4 flags are only available for code pages &lt;</span></div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;<span class="comment">         * 50000, excluding 42 (CP_SYMBOL).  See the remarks section in the MSDN</span></div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;<span class="comment">         * docs for clarification.</span></div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;        <span class="keywordflow">if</span> ( codePage &lt; 50000 &amp;&amp; codePage != CP_SYMBOL )</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;        {</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;            <span class="keywordflow">if</span> ( StrStrI(mappingFlags, <span class="stringliteral">&quot;COMPOSITECHECK&quot;</span>) != NULL )</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;            {</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;                dwFlags |= WC_COMPOSITECHECK;</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;            }</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;            <span class="keywordflow">if</span> ( StrStrI(mappingFlags, <span class="stringliteral">&quot;SEPCHARS&quot;</span>) != NULL )</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;            {</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;                dwFlags |= WC_SEPCHARS | WC_COMPOSITECHECK;</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;            }</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;            <span class="keywordflow">if</span> ( StrStrI(mappingFlags, <span class="stringliteral">&quot;DISCARDNS&quot;</span>) != NULL )</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;            {</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;                dwFlags |= WC_DISCARDNS| WC_COMPOSITECHECK;</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;            }</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;            <span class="keywordflow">if</span> ( StrStrI(mappingFlags, <span class="stringliteral">&quot;DEFAULTCHAR&quot;</span>) != NULL )</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;            {</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;                dwFlags |= WC_DEFAULTCHAR | WC_COMPOSITECHECK;</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;            }</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;        }</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160; </div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;        <span class="keywordflow">if</span> ( StrStrI(mappingFlags, <span class="stringliteral">&quot;NO_BEST_FIT&quot;</span>) != NULL )</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;        {</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;            dwFlags |= WC_NO_BEST_FIT_CHARS;</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;        }</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160; </div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;        <span class="keywordflow">if</span> ( StrStrI(mappingFlags, <span class="stringliteral">&quot;ERR_INVALID&quot;</span>) != NULL )</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;        {</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;            <span class="keywordflow">if</span> ( codePage == CP_UTF8 &amp;&amp; <a class="code" href="windows_2rexxutil_8cpp.html#a270882ebf6e7854c46fef5e869667da4">isAtLeastVista</a>() )</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;            {</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;                dwFlags |= <a class="code" href="windows_2rexxutil_8cpp.html#a8f2d1bc0ebfe7e951cbdfaae730143c2">WC_ERR_INVALID_CHARS</a>;</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;            }</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;        }</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( dwFlags == 0 &amp;&amp; ! (codePage &lt; 50000 &amp;&amp; codePage != CP_SYMBOL) )</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;        {</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;        }</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;    }</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160; </div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;    <span class="comment">/* evaluate default charcter  */</span></div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>  *strDefaultChar = NULL;</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;    BOOL  bUsedDefaultChar = FALSE;</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;    BOOL  *pUsedDefaultChar = &amp;bUsedDefaultChar;</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160; </div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;    <span class="keywordflow">if</span> (defaultChar != NULL &amp;&amp; (dwFlags &amp; WC_DEFAULTCHAR) == WC_DEFAULTCHAR)</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;    {</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;        strDefaultChar = defaultChar;</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;    }</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;    {</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;        <span class="comment">/* use our own default character rather than relying on the windows default */</span></div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;        strDefaultChar = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;    }</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160; </div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;    <span class="comment">/* There are a number of invalid combinations of arguments to</span></div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;<span class="comment">     *  WideCharToMultiByte(), see the MSDN docs. Eliminate them here.</span></div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;    <span class="keywordflow">if</span> ( codePage == CP_UTF8 &amp;&amp; dwFlags == <a class="code" href="windows_2rexxutil_8cpp.html#a8f2d1bc0ebfe7e951cbdfaae730143c2">WC_ERR_INVALID_CHARS</a>)</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;    {</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;        strDefaultChar = NULL;</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;        pUsedDefaultChar = NULL;</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;    }</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ! <a class="code" href="windows_2rexxutil_8cpp.html#af0535563767484a571323c5b12f840e3">canUseWideCharFlags</a>(codePage) )</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;    {</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;        dwFlags = 0;</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;        strDefaultChar = NULL;</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;        pUsedDefaultChar = NULL;</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;    }</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160; </div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;    <span class="comment">/* Allocate space for the string, to allow double zero byte termination */</span></div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;    <span class="keywordtype">char</span> *strptr = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_FIXED|GMEM_ZEROINIT, sourceLength + 4);</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;    <span class="keywordflow">if</span> (strptr == NULL)</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;    {</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;    }</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;    memcpy(strptr, source, sourceLength);</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160; </div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;    <span class="comment">/* Query the number of bytes required to store the Dest string */</span></div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;    <span class="keywordtype">int</span> iBytesNeeded = WideCharToMultiByte( codePage,</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;                                        dwFlags,</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;                                        (LPWSTR) strptr,</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;                                        (<span class="keywordtype">int</span>)(sourceLength/2),</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;                                        NULL,</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;                                        0,</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;                                        NULL,</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;                                        NULL);</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160; </div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;    <span class="keywordflow">if</span> (iBytesNeeded == 0)</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;    {</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;        GlobalFree(strptr);</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;    }</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160; </div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;        <span class="comment">// hard error, stop</span></div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;    <span class="keywordtype">char</span> *str = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_FIXED|GMEM_ZEROINIT, iBytesNeeded + 4);</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;    <span class="keywordflow">if</span> (str == NULL)</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;    {</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;    }</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160; </div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;        <span class="comment">/* Do the conversion */</span></div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;    <span class="keywordtype">int</span> iBytesDestination = WideCharToMultiByte(codePage,           <span class="comment">// codepage</span></div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;                                            dwFlags,                <span class="comment">// conversion flags</span></div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;                                            (LPWSTR) strptr,        <span class="comment">// source string</span></div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;                                            (<span class="keywordtype">int</span>)(sourceLength/2),  <span class="comment">// source string length</span></div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;                                            str,                    <span class="comment">// target string</span></div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;                                            (<span class="keywordtype">int</span>)iBytesNeeded,      <span class="comment">// size of target buffer</span></div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                                            strDefaultChar,</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;                                            pUsedDefaultChar);</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160; </div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;    <span class="keywordflow">if</span> (iBytesDestination == 0) <span class="comment">// call to function fails</span></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;    {</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;        GlobalFree(str);          <span class="comment">//  free allocated string</span></div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;        GlobalFree(strptr);       <span class="comment">// free allocated string</span></div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;        <span class="keywordflow">return</span> GetLastError();    <span class="comment">// return error from function call</span></div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;    }</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160; </div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;    <span class="comment">// set whether the default character was used in the output stem</span></div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;    <span class="keywordflow">if</span> (bUsedDefaultChar)</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;    {</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;        context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!USEDDEFAULTCHAR&quot;</span>, context-&gt;True());</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;    }</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;    {</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;        context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!USEDDEFAULTCHAR&quot;</span>, context-&gt;False());</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;    }</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160; </div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!TEXT&quot;</span>, context-&gt;String(str, iBytesNeeded));</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;    GlobalFree(strptr);          <span class="comment">// free allocated string</span></div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;    GlobalFree(str);             <span class="comment">// free allocated string</span></div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;}</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160; </div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;<span class="comment">* Syntax:    result = SysToUniCode(string,CodePage,MappingFlags,outstem.)</span></div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;<span class="comment">* Function:  SysToUnicode                                                *</span></div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;<span class="comment">*            Converts an ASCII to UNICODE                                *</span></div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;<span class="comment">* Syntax:    result = SysToUniCode(string,CodePage,MappingFlags,outstem.)*</span></div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;<span class="comment">* Params:    string       - ascii string to be converted                 *</span></div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;<span class="comment">*            Codepage     - target codepage                              *</span></div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;<span class="comment">*            MappingFlags - Mapping flags                                *</span></div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;<span class="comment">*             outstem.    - stem containg the result                     *</span></div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;<span class="comment">*              .!TEXT     - converted text                               *</span></div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;<span class="comment">* Return:    0 - successfull completetion                                *</span></div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;<span class="comment">*            error code from WideCharToMultiByteToWideChars              *</span></div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;<span class="comment">  For available codepages see function SysFromUniCode.</span></div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;<span class="comment">  Additional parameters for codepages:</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;<span class="comment">    ACP        ANSI code page</span></div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;<span class="comment">    MACCP      Macintosh code page</span></div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;<span class="comment">    OEMCP      OEM code page</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;<span class="comment">    SYMBOL     Windows 2000: Symbol code page (42)</span></div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;<span class="comment">    THREAD_ACP Windows 2000: The current thread&#39;s ANSI code page</span></div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;<span class="comment">    UTF7       Windows NT 4.0 and Windows 2000: Translate using UTF-7</span></div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;<span class="comment">    UTF8       Windows NT 4.0 and Windows 2000: Translate using UTF-8.</span></div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;<span class="comment">               When this is set, dwFlags must be zero.</span></div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;<span class="comment">    PRECOMPOSED       Always use precomposed characters-that is, characters</span></div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;<span class="comment">                      in which a base character and a nonspacing character</span></div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;<span class="comment">                      have a single character value.</span></div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;<span class="comment">                      This is the default translation option.</span></div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;<span class="comment">                      Cannot be used with MB_COMPOSITE.</span></div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;<span class="comment">    COMPOSITE         Always use composite characters that is,</span></div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;<span class="comment">                      characters in which a base character and a nonspacing</span></div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;<span class="comment">                      character have different character values.</span></div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;<span class="comment">                      Cannot be used with MB_PRECOMPOSED.</span></div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;<span class="comment">    ERR_INVALID_CHARS If the function encounters an invalid input character,</span></div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;<span class="comment">                      it fails and GetLastError returns</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;<span class="comment">                      ERROR_NO_UNICODE_TRANSLATION.</span></div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;<span class="comment">    USEGLYPHCHARS     Use glyph characters instead of control characters.</span></div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06336"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5d7bcb59611c778e6e12516da1e47cf4"> 6336</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a5d7bcb59611c778e6e12516da1e47cf4">RexxRoutine4</a>(<span class="keywordtype">int</span>, SysToUniCode, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, source, OPTIONAL_CSTRING, codePageOpt,</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;    OPTIONAL_CSTRING, mappingFlags, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, stem)</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;{</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;    <span class="comment">// evaluate codepage</span></div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;    UINT   codePage;</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;    <span class="keywordflow">if</span> (codePageOpt == NULL)</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;    {</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;        codePage = GetOEMCP();</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;    }</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;    {</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;        <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;THREAD_ACP&quot;</span>) == 0)</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;        {</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;            codePage = CP_THREAD_ACP;</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;        }</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;ACP&quot;</span>) == 0)</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;        {</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;            codePage = CP_ACP;</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;        }</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;MACCP&quot;</span>) == 0)</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;        {</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;            codePage = CP_MACCP;</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;        }</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;OEMCP&quot;</span>) == 0)</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;        {</div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;            codePage = CP_OEMCP;</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;        }</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;SYMBOL&quot;</span>) == 0)</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;        {</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;            codePage = CP_SYMBOL;</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;        }</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;UTF7&quot;</span>) == 0)</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;        {</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;            codePage = CP_UTF7;</div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;        }</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_stricmp(codePageOpt,<span class="stringliteral">&quot;UTF8&quot;</span>) == 0)</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;        {</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;            codePage = CP_UTF8;</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;        }</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;        {</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;            codePage = atoi(codePageOpt);</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;        }</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;    }</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160; </div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;    DWORD  dwFlags = 0;</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;    <span class="comment">// evaluate the mapping flags</span></div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;    <span class="keywordflow">if</span> (mappingFlags != NULL)</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;    {</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(mappingFlags, <span class="stringliteral">&quot;PRECOMPOSED&quot;</span>))</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;        {</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;            dwFlags |= MB_PRECOMPOSED;</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;        }</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(mappingFlags, <span class="stringliteral">&quot;COMPOSITE&quot;</span>))</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;        {</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;            dwFlags  |= MB_COMPOSITE;</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;        }</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(mappingFlags, <span class="stringliteral">&quot;ERR_INVALID&quot;</span>))</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;        {</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;            dwFlags |= MB_ERR_INVALID_CHARS;</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;        }</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a>(mappingFlags, <span class="stringliteral">&quot;USEGLYPHCHARS&quot;</span>))</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;        {</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;            dwFlags |= MB_USEGLYPHCHARS;</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;        }</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;        <span class="keywordflow">if</span> (dwFlags == 0)</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;        {</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;            context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;        }</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;    }</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160; </div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;    <span class="comment">/* Query the number of bytes required to store the Dest string */</span></div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;    ULONG ulWCharsNeeded = MultiByteToWideChar( codePage, dwFlags,</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;        context-&gt;StringData(source), (<span class="keywordtype">int</span>)context-&gt;StringLength(source), NULL, NULL);</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160; </div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;    <span class="keywordflow">if</span> (ulWCharsNeeded == 0)</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;    {</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;    }</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160; </div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;    ULONG ulDataLen = (ulWCharsNeeded)*2;</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160; </div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;    LPWSTR lpwstr = (LPWSTR)GlobalAlloc(GMEM_FIXED|GMEM_ZEROINIT, ulDataLen+4);</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160; </div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;    <span class="comment">// hard error, stop</span></div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;    <span class="keywordflow">if</span> (lpwstr == NULL)</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;    {</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;    }</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160; </div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160; </div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;    <span class="comment">/* Do the conversion */</span></div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;    ulWCharsNeeded = MultiByteToWideChar(codePage,  dwFlags,</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;        context-&gt;StringData(source), (<span class="keywordtype">int</span>)context-&gt;StringLength(source),</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;        lpwstr, ulWCharsNeeded);</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160; </div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;    <span class="keywordflow">if</span> (ulWCharsNeeded == 0) <span class="comment">// call to function fails</span></div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;    {</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;        GlobalFree(lpwstr);       <span class="comment">// free allocated string</span></div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;    }</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160; </div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;    context-&gt;SetStemElement(stem, <span class="stringliteral">&quot;!TEXT&quot;</span>, context-&gt;String((<span class="keyword">const</span> <span class="keywordtype">char</span> *)lpwstr, ulDataLen));</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;    GlobalFree(lpwstr);        <span class="comment">// free allocated string</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;}</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160; </div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;<span class="comment">* Function:  SysWinGetPrinters                                           *</span></div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;<span class="comment">* Syntax:    call SysWinGetPrinters stem.                                *</span></div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;<span class="comment">* Params:    stem. - stem to store infos in                              *</span></div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;<span class="comment">* Return:    error number                                                *</span></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160; </div>
<div class="line"><a name="l06455"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a78930ff29bb93d82b721f7ed220c9929"> 6455</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, SysWinGetPrinters, <a class="code" href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a>, stem)</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;{</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;    DWORD realSize = 0;</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;    DWORD entries = 0;</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;    DWORD currentSize = 10*<span class="keyword">sizeof</span>(PRINTER_INFO_2)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>);</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;    <span class="keywordtype">char</span> *pArray = (<span class="keywordtype">char</span>*) malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*currentSize);</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160; </div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;    {</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;        <span class="keywordflow">if</span> (EnumPrinters(PRINTER_ENUM_LOCAL|PRINTER_ENUM_CONNECTIONS, NULL, 2, (LPBYTE)pArray,</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;                         currentSize, &amp;realSize, &amp;entries) == 0)</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;        {</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;            <span class="comment">// this is not a failure if we get ERROR_INSUFFICIENT_BUFFER</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;            DWORD rc = GetLastError();</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;            <span class="keywordflow">if</span> ( rc != ERROR_INSUFFICIENT_BUFFER )</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;            {</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;                free(pArray);</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;                <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;            }</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;        }</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;        <span class="keywordflow">if</span> ( currentSize &gt;= realSize )</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;        {</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;        }</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;        currentSize = realSize;</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;        realSize = 0;</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;        pArray = (<span class="keywordtype">char</span>*) realloc(pArray, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*currentSize);</div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;    }</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160; </div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;    PRINTER_INFO_2 *pResult = (PRINTER_INFO_2*) pArray;</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160; </div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;    <span class="comment">// set stem.0 to the number of entries then add all the found printers</span></div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;    context-&gt;SetStemArrayElement(stem, 0, context-&gt;WholeNumber(entries));</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;    <span class="keywordflow">while</span> ( entries-- )</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;    {</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;        <span class="keywordtype">char</span>  szBuffer[256];</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;        sprintf(szBuffer,<span class="stringliteral">&quot;%s,%s,%s&quot;</span>, pResult[entries].pPrinterName, pResult[entries].pDriverName,</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;                pResult[entries].pPortName);</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;        context-&gt;SetStemArrayElement(stem, entries + 1, context-&gt;String(szBuffer));</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;    }</div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;    free(pArray);</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;    <span class="keywordflow">return</span> 0;          <span class="comment">// a little reversed...success is false, failure is true</span></div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;}</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160; </div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;<span class="comment">* Function:  SysWinGetDefaultPrinter                                     *</span></div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;<span class="comment">* Syntax:    call SysWinGetDefaultPrinter                                *</span></div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;<span class="comment">* Params:    none                                                        *</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;<span class="comment">* Return:    string describing default printer                           *</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160; </div>
<div class="line"><a name="l06509"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8ef26c9474822266233645d082f9529a"> 6509</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#aa052465890b0e94573704f6bdd162c26">RexxRoutine0</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysWinGetDefaultPrinter)</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;{</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;    <span class="keywordtype">char</span> buffer[256];</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;    buffer[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160; </div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;    GetProfileString(<span class="stringliteral">&quot;Windows&quot;</span>, <span class="stringliteral">&quot;DEVICE&quot;</span>, <span class="stringliteral">&quot;,,,&quot;</span>, buffer, <span class="keyword">sizeof</span>(buffer));</div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;    <span class="keywordflow">return</span> context-&gt;String(buffer);</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;}</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160; </div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160; </div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;<span class="comment">* Function:  SysWinSetDefaultPrinter                                     *</span></div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;<span class="comment">* Syntax:    call SysWinSetDefaultPrinter printer                        *</span></div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;<span class="comment">* Params:    string describing default printer                           *</span></div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;<span class="comment">* Return:    0 on success, otherwise the OS system error number.         *</span></div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06528"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a0d78dbd0e712c5219987d8e2adaeb219"> 6528</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<span class="keywordtype">int</span>, SysWinSetDefaultPrinter, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, printer)</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;{</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160; </div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;    <span class="comment">// Two forms of input are allowed.  The old form of</span></div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;    <span class="comment">// &quot;Printername,Drivername,Portname&quot; and for W2K or later just the printer</span></div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;    <span class="comment">// name.  Count the commas to determine which form this might be.</span></div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 0; printer[i] != <span class="charliteral">&#39;\0&#39;</span>; i++ )</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;    {</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;        <span class="keywordflow">if</span> (printer[i] == <span class="charliteral">&#39;,&#39;</span> )</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;        {</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;            count++;</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;        }</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;    }</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160; </div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;    <span class="keywordflow">if</span> (count != 0 &amp;&amp; count != 2)</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;    {</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;        context-&gt;InvalidRoutine();</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;    }</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;    SetLastError(0);</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160; </div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;    <span class="keywordflow">if</span> (count == 0 )</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;    {</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;        <span class="comment">// This is W2K or later and the user specified just the printer name.</span></div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;        <span class="comment">// This code will work on W2K through Vista.</span></div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;        <span class="keywordflow">if</span> (SetDefaultPrinter(printer) == 0)</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;        {</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;        }</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;        {</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;            <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;        }</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;    }</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;    {</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;        <span class="comment">// The user still specified the old format. Microssoft</span></div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;        <span class="comment">// only provides WriteProfileString() for backward compatibility to</span></div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;        <span class="comment">// 16-bit Windows, and at some point this may no longer be supported.</span></div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;        <span class="comment">// But it still appears to work on XP.</span></div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;        <span class="keywordflow">if</span> (WriteProfileString(<span class="stringliteral">&quot;Windows&quot;</span>, <span class="stringliteral">&quot;DEVICE&quot;</span>, printer) == 0)</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;        {</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;        }</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;        {</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;            <span class="keywordflow">if</span> ( SendMessageTimeout(HWND_BROADCAST, WM_SETTINGCHANGE, 0L, 0L, SMTO_NORMAL, 1000, NULL) == 0 )</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;            {</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;                <span class="comment">// If a window just timed out, then GetLastError() will return 0</span></div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;                <span class="comment">// and the user will get the succes code.  If GetLastError()</span></div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;                <span class="comment">// does not return 0, then chances are something really is</span></div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;                <span class="comment">// wrong.</span></div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;            }</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;            {</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;                <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;            }</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;        }</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;    }</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;}</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160; </div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160; </div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;<span class="comment">* Function:  SysFileCopy                                                 *</span></div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;<span class="comment">* Syntax:    call SysFileCopy FROMfile TOfile                            *</span></div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;<span class="comment">* Params:    FROMfile - file to be copied.                               *</span></div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;<span class="comment">*            TOfile - target file of copy operation.                     *</span></div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;<span class="comment">* Return:    Return code from CopyFile() function.                       *</span></div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160; </div>
<div class="line"><a name="l06603"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a296254b309c28a1ac65687b695144545"> 6603</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysFileCopy, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, fromFile, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, toFile)</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;{</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;    <span class="keywordflow">return</span> CopyFile(fromFile, toFile, 0) ? 0 : GetLastError();</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;}</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160; </div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;<span class="comment">* Function:  SysFileMove                                                 *</span></div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;<span class="comment">* Syntax:    call SysFileMove FROMfile TOfile                            *</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;<span class="comment">* Params:    FROMfile - file to be moved.                                *</span></div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;<span class="comment">*            TOfile - target file of move operation.                     *</span></div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;<span class="comment">* Return:    Return code from MoveFile() function.                       *</span></div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160; </div>
<div class="line"><a name="l06619"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a7901f4ac6d31c9c7d5098fa0c2426289"> 6619</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a>(<span class="keywordtype">int</span>, SysFileMove, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, fromFile, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, toFile)</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;{</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="unix_2rexxutil_8cpp.html#a628da822b4b70d17675932dfe8f6bd77">MoveFile</a>(fromFile, toFile) ? 0 : GetLastError();</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;}</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160; </div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;<span class="comment">* Function:  SysFileExist                                                *</span></div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;<span class="comment">* Syntax:    call SysFileExist file                                      *</span></div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;<span class="comment">* Params:    file - file to check existance of.                          *</span></div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160; </div>
<div class="line"><a name="l06634"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a462a77d8d2290260d6a3703ca4629936"> 6634</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFile, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;{</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;    <span class="comment">// not a file if either of these is one</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; ((dwAttrs &amp; (FILE_ATTRIBUTE_DIRECTORY | FILE_ATTRIBUTE_REPARSE_POINT)) == 0);</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;}</div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160; </div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;<span class="comment">* Function:  SysDirExist                                                 *</span></div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;<span class="comment">* Syntax:    call SysDirExist dir                                        *</span></div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;<span class="comment">* Params:    dir - dir to check existance of.                            *</span></div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160; </div>
<div class="line"><a name="l06651"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a8a54d73d4dce7010e7fd4301c1172b9d"> 6651</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileDirectory, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;{</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_DIRECTORY);</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;}</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160; </div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;<span class="comment">* Function:  SysIsFileLink                                               *</span></div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;<span class="comment">* Syntax:    call SysIsFileLink file                                     *</span></div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;<span class="comment">* Params:    file - file to check if it is a Link (Alias).               *</span></div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160; </div>
<div class="line"><a name="l06667"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a5dbdc13b2f816b53fe9ac1a3ad5d0dd5"> 6667</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileLink, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;{</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_REPARSE_POINT);</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;}</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160; </div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;<span class="comment">* Function:  SysIsFileCompressed                                         *</span></div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;<span class="comment">* Syntax:    call SysIsFileCompressed file                               *</span></div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;<span class="comment">* Params:    file - file to check if it is compressed.                   *</span></div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160; </div>
<div class="line"><a name="l06683"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a3579dc4be9f084679a66565889917881"> 6683</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileCompressed, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;{</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_COMPRESSED);</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;}</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160; </div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;<span class="comment">* Function:  SysIsFileEncrypted                                          *</span></div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;<span class="comment">* Syntax:    call SysIsFileEncrypted file                                *</span></div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;<span class="comment">* Params:    file - file to check if it is Encrypted.                    *</span></div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160; </div>
<div class="line"><a name="l06699"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a459f5f132364b6b6a17252eec76634a2"> 6699</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileEncrypted, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;{</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_ENCRYPTED);</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;}</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160; </div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="comment">* Function:  SysIsFileNotContentIndexed                                  *</span></div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;<span class="comment">* Syntax:    call SysIsFileNotContentIndexed file                        *</span></div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;<span class="comment">* Params:    file - file to check if it is to be indexed by the indexing *</span></div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;<span class="comment">*             service.                                                   *</span></div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160; </div>
<div class="line"><a name="l06716"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a83dd54e01bec4d753bb2264ed713ca5a"> 6716</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileNotContentIndexed, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;{</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_NOT_CONTENT_INDEXED);</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;}</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160; </div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;<span class="comment">* Function:  SysIsFileOffline                                            *</span></div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;<span class="comment">* Syntax:    call SysIsFileOffline file                                  *</span></div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;<span class="comment">* Params:    file - file to check if it is offline                       *</span></div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160; </div>
<div class="line"><a name="l06732"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ac20f39baa86c48aba1a5e5ec7fbf201e"> 6732</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileOffline, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;{</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_OFFLINE);</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;}</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160; </div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;<span class="comment">* Function:  SysIsFileSparse                                             *</span></div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;<span class="comment">* Syntax:    call SysIsFileSparse file                                   *</span></div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;<span class="comment">* Params:    file - file to check if it is sparse                        *</span></div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160; </div>
<div class="line"><a name="l06748"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#af4116770bc9802c4c1a0dd79c13355f0"> 6748</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileSparse, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;{</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_SPARSE_FILE);</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;}</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160; </div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160; </div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;<span class="comment">* Function:  SysIsFileTemporary                                          *</span></div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;<span class="comment">* Syntax:    call SysIsFileTemporary file                                *</span></div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;<span class="comment">* Params:    file - file to check if it is temporary                     *</span></div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160; </div>
<div class="line"><a name="l06765"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#af77371fb642a542daacf2b53473d66db"> 6765</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysIsFileTemporary, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;{</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff) &amp;&amp; (dwAttrs &amp; FILE_ATTRIBUTE_TEMPORARY);</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;}</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160; </div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160; </div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;<span class="comment">* Function:  SysFileExists                                               *</span></div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;<span class="comment">* Syntax:    call SysFileExists  file                                    *</span></div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;<span class="comment">* Params:    file - file to check existence                              *</span></div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;<span class="comment">* Return:    Logical.                                                    *</span></div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160; </div>
<div class="line"><a name="l06782"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#adc187c6008877ece3bd205a513df6d5f"> 6782</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, SysFileExists, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, file)</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;{</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;    DWORD dwAttrs = GetFileAttributes(file);</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;    <span class="keywordflow">return</span> (dwAttrs != 0xffffffff);</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;}</div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160; </div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160; </div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;<span class="comment">* Function:  SysGetLongPathName                                          *</span></div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;<span class="comment">*            Converts the specified path to its long form                *</span></div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;<span class="comment">* Syntax:    longPath = SysGetLongPathName(path)                         *</span></div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;<span class="comment">* Params:    path - a path to an existing file                           *</span></div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;<span class="comment">* Return:    longPath - path converted to its long form                  *</span></div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;<span class="comment">*                       NULL string if path doesn&#39;t exist or call fails  *</span></div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160; </div>
<div class="line"><a name="l06801"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a743232cd18cba569a6395b123c6485e2"> 6801</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysGetLongPathName, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, path)</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;{</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;  CHAR  longPath[<a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>];                 <span class="comment">// long version of path</span></div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;  DWORD code = GetLongPathName(path, longPath, <a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>);</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;  <span class="keywordflow">if</span> ((code == 0) || (code &gt;= <a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>))    <span class="comment">// call failed of buffer too small</span></div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;  {</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;  }</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;  {</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(longPath);</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;  }</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;}</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160; </div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160; </div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;<span class="comment">/*************************************************************************</span></div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;<span class="comment">* Function:  SysGetShortPathName                                         *</span></div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;<span class="comment">*            Converts the specified path to its short form               *</span></div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;<span class="comment">* Syntax:    shortPath = SysGetShortPathName(path)                       *</span></div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;<span class="comment">* Params:    path - a path to an existing file                           *</span></div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;<span class="comment">*                                                                        *</span></div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;<span class="comment">* Return:    shortPath - path converted to its short form                *</span></div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;<span class="comment">*                        NULL string if path doesn&#39;t exist or call fails *</span></div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;<span class="comment">*************************************************************************/</span></div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160; </div>
<div class="line"><a name="l06828"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#ae8ad74a783dbf25e635966de2ccbcf04"> 6828</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a>(<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, SysGetShortPathName, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, path)</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;{</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;  CHAR  shortPath[<a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>];                <span class="comment">// short version of path</span></div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;  DWORD code = GetShortPathName(path, shortPath, <a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>);</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;  <span class="keywordflow">if</span> ((code == 0) || (code &gt;= <a class="code" href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a>))    <span class="comment">// call failed of buffer too small</span></div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;  {</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;    <span class="keywordflow">return</span> context-&gt;NullString();</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;  }</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;  {</div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;    <span class="keywordflow">return</span> context-&gt;NewStringFromAsciiz(shortPath);</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;  }</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;}</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160; </div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160; </div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;<span class="comment">// now build the actual entry list</span></div>
<div class="line"><a name="l06844"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a55bdc28f497f01e1b6f78aa67cf02578"> 6844</a></span>&#160;<a class="code" href="struct___rexx_routine_entry.html">RexxRoutineEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a55bdc28f497f01e1b6f78aa67cf02578">rexxutil_routines</a>[] =</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;{</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a7b9510a9bed0a8609bba2297edd0ed64">SysCls</a>,                      <a class="code" href="windows_2rexxutil_8cpp.html#a7b9510a9bed0a8609bba2297edd0ed64">SysCls</a>),</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysCurPos,                     SysCurPos),</div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysCurState,                   SysCurState),</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a07bc4be1a9a8a49a9472dcb8aad4791a">SysDriveInfo</a>,                <a class="code" href="windows_2rexxutil_8cpp.html#a07bc4be1a9a8a49a9472dcb8aad4791a">SysDriveInfo</a>),</div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a0b1a486d8de452c909c69e57bb7cbbc4">SysDriveMap</a>,                 <a class="code" href="windows_2rexxutil_8cpp.html#a0b1a486d8de452c909c69e57bb7cbbc4">SysDriveMap</a>),</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#aa103e70ed4303627d9eb1a9b3cb2a084">SysDropFuncs</a>,                <a class="code" href="windows_2rexxutil_8cpp.html#aa103e70ed4303627d9eb1a9b3cb2a084">SysDropFuncs</a>),</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#af00eb685356358bb4b5d60e591203c7f">SysFileDelete</a>,                 <a class="code" href="unix_2rexxutil_8cpp.html#af00eb685356358bb4b5d60e591203c7f">SysFileDelete</a>),</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#abad96b5cafd0998ce7fd5b944ecdb305">SysFileSearch</a>,               <a class="code" href="windows_2rexxutil_8cpp.html#abad96b5cafd0998ce7fd5b944ecdb305">SysFileSearch</a>),</div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysFileTree,                   SysFileTree),</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#aade4ab4ab239c0bceb5bcee31210b26e">SysGetKey</a>,                   <a class="code" href="windows_2rexxutil_8cpp.html#aade4ab4ab239c0bceb5bcee31210b26e">SysGetKey</a>),</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a8f324c8049bd9815f0137c01d7e04eeb">SysIni</a>,                      <a class="code" href="windows_2rexxutil_8cpp.html#a8f324c8049bd9815f0137c01d7e04eeb">SysIni</a>),</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a744938a8228e39320c63be371291edc1">SysLoadFuncs</a>,                <a class="code" href="windows_2rexxutil_8cpp.html#a744938a8228e39320c63be371291edc1">SysLoadFuncs</a>),</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#aadab25a6bd1a2ea790685426d34cdfb1">SysMkDir</a>,                      <a class="code" href="unix_2rexxutil_8cpp.html#aadab25a6bd1a2ea790685426d34cdfb1">SysMkDir</a>),</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#aca01c32b5907ac2ba7c5da1741aa085f">SysWinVer</a>,                   <a class="code" href="windows_2rexxutil_8cpp.html#aca01c32b5907ac2ba7c5da1741aa085f">SysWinVer</a>),</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a0dad6273af058ff65ec64445dfe96581">SysVersion</a>,                  <a class="code" href="windows_2rexxutil_8cpp.html#a0dad6273af058ff65ec64445dfe96581">SysVersion</a>),</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#aeb154f4bdbb013dc3d312e63b897b76b">SysRmDir</a>,                      <a class="code" href="unix_2rexxutil_8cpp.html#aeb154f4bdbb013dc3d312e63b897b76b">SysRmDir</a>),</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="class_sys_search_path.html">SysSearchPath</a>,               <a class="code" href="class_sys_search_path.html">SysSearchPath</a>),</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysSleep,                      SysSleep),</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#aebba4ef85ab647b2135bad9567fa51d3">SysTempFileName</a>,             <a class="code" href="windows_2rexxutil_8cpp.html#aebba4ef85ab647b2135bad9567fa51d3">SysTempFileName</a>),</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysTextScreenRead,             SysTextScreenRead),</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysTextScreenSize,             SysTextScreenSize),</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysAddRexxMacro,               SysAddRexxMacro),</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysDropRexxMacro,              SysDropRexxMacro),</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysReorderRexxMacro,           SysReorderRexxMacro),</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysQueryRexxMacro,             SysQueryRexxMacro),</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysClearRexxMacroSpace,        SysClearRexxMacroSpace),</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysLoadRexxMacroSpace,         SysLoadRexxMacroSpace),</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysSaveRexxMacroSpace,         SysSaveRexxMacroSpace),</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a5d6a7cdf1e4b8e8b00acdff80d697a2c">SysBootDrive</a>,                <a class="code" href="windows_2rexxutil_8cpp.html#a5d6a7cdf1e4b8e8b00acdff80d697a2c">SysBootDrive</a>),</div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a06e2143e7982a013ae2229b68ef6ef92">SysSystemDirectory</a>,          <a class="code" href="windows_2rexxutil_8cpp.html#a06e2143e7982a013ae2229b68ef6ef92">SysSystemDirectory</a>),</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#abc4cf764e7e3a104c541e6a2c9feeccd">SysFileSystemType</a>,           <a class="code" href="windows_2rexxutil_8cpp.html#abc4cf764e7e3a104c541e6a2c9feeccd">SysFileSystemType</a>),</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a884bfc4d6d3c26f7d0ec0f40d039c073">SysVolumeLabel</a>,              <a class="code" href="windows_2rexxutil_8cpp.html#a884bfc4d6d3c26f7d0ec0f40d039c073">SysVolumeLabel</a>),</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysCreateMutexSem,             SysCreateMutexSem),</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysOpenMutexSem,               SysOpenMutexSem),</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysCloseMutexSem,              SysCloseMutexSem),</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysRequestMutexSem,            SysRequestMutexSem),</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysReleaseMutexSem,            SysReleaseMutexSem),</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysCreateEventSem,             SysCreateEventSem),</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysOpenEventSem,               SysOpenEventSem),</div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysCloseEventSem,              SysCloseEventSem),</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysResetEventSem,              SysResetEventSem),</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysPostEventSem,               SysPostEventSem),</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysPulseEventSem,              SysPulseEventSem),</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysWaitEventSem,               SysWaitEventSem),</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#a2eaa0915b068bca2cd391a2a0afde88e">SysSetPriority</a>,                <a class="code" href="unix_2rexxutil_8cpp.html#a2eaa0915b068bca2cd391a2a0afde88e">SysSetPriority</a>),</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysSwitchSession,              SysSwitchSession),</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysWaitNamedPipe,              SysWaitNamedPipe),</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#ab5cc3e1c79c1624cd7c4c1faedce8536">SysQueryProcess</a>,               <a class="code" href="unix_2rexxutil_8cpp.html#ab5cc3e1c79c1624cd7c4c1faedce8536">SysQueryProcess</a>),</div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a561d1a192cdcaffa07ad28637416c273">SysDumpVariables</a>,            <a class="code" href="windows_2rexxutil_8cpp.html#a561d1a192cdcaffa07ad28637416c273">SysDumpVariables</a>),</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#ae415e0f263db631c50550196d163dbe6">SysSetFileDateTime</a>,            <a class="code" href="unix_2rexxutil_8cpp.html#ae415e0f263db631c50550196d163dbe6">SysSetFileDateTime</a>),</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#a6d0e601daae44f306aa512f656edeaf9">SysGetFileDateTime</a>,            <a class="code" href="unix_2rexxutil_8cpp.html#a6d0e601daae44f306aa512f656edeaf9">SysGetFileDateTime</a>),</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a73a859def741d7f37ff402604263c943">SysStemSort</a>,                 <a class="code" href="windows_2rexxutil_8cpp.html#a73a859def741d7f37ff402604263c943">SysStemSort</a>),</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysStemDelete,                 SysStemDelete),</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysStemInsert,                 SysStemInsert),</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysStemCopy,                   SysStemCopy),</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(<a class="code" href="unix_2rexxutil_8cpp.html#aafa64d230b88376df6f055cb4490f701">SysUtilVersion</a>,                <a class="code" href="unix_2rexxutil_8cpp.html#aafa64d230b88376df6f055cb4490f701">SysUtilVersion</a>),</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a8b05eb4e0ca4a808e31e0a9f64b6bfbc">RxWinExec</a>,                   <a class="code" href="windows_2rexxutil_8cpp.html#a8b05eb4e0ca4a808e31e0a9f64b6bfbc">RxWinExec</a>),</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a9b6f54f47164af16463a98a1c5342841">SysWinEncryptFile</a>,           <a class="code" href="windows_2rexxutil_8cpp.html#a9b6f54f47164af16463a98a1c5342841">SysWinEncryptFile</a>),</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a479f6f8d462e87801cf8cd9ae7b4240b">SysWinDecryptFile</a>,           <a class="code" href="windows_2rexxutil_8cpp.html#a479f6f8d462e87801cf8cd9ae7b4240b">SysWinDecryptFile</a>),</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="windows_2rexxutil_8cpp.html#a8e2d43c32a5b15f4f691016911b418dc">SysGetErrortext</a>,             <a class="code" href="windows_2rexxutil_8cpp.html#a8e2d43c32a5b15f4f691016911b418dc">SysGetErrortext</a>),</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysFromUniCode,                SysFromUniCode),</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysToUniCode,                  SysToUniCode),</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysWinGetPrinters,             SysWinGetPrinters),</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysWinGetDefaultPrinter,       SysWinGetDefaultPrinter),</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysWinSetDefaultPrinter,       SysWinSetDefaultPrinter),</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160; </div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysShutDownSystem,             SysShutDownSystem),</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysFileCopy,                   SysFileCopy),</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysFileMove,                   SysFileMove),</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFile,                     SysIsFile),</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileDirectory,            SysIsFileDirectory),</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileLink,                 SysIsFileLink),</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileCompressed,           SysIsFileCompressed),</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileEncrypted,            SysIsFileEncrypted),</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileNotContentIndexed,    SysIsFileNotContentIndexed),</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileOffline,              SysIsFileOffline),</div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileSparse,               SysIsFileSparse),</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysIsFileTemporary,            SysIsFileTemporary),</div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysFileExists,                 SysFileExists),</div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysGetLongPathName,            SysGetLongPathName),</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;    <a class="code" href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a>(SysGetShortPathName,           SysGetShortPathName),</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;    <a class="code" href="oorexxapi_8h.html#aa3968b4fd4978493411036d07050237d">REXX_LAST_ROUTINE</a>()</div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;};</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160; </div>
<div class="line"><a name="l06930"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a190441ab7cc17bc681ac6ec286e20974"> 6930</a></span>&#160;<a class="code" href="struct___rexx_package_entry.html">RexxPackageEntry</a> <a class="code" href="windows_2rexxutil_8cpp.html#a190441ab7cc17bc681ac6ec286e20974">rexxutil_package_entry</a> =</div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;{</div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;    <a class="code" href="oorexxapi_8h.html#ad0c9dd799a5ddb561472ac8968ea3705">STANDARD_PACKAGE_HEADER</a></div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;    <a class="code" href="oorexxapi_8h.html#a2fdcd4caf670858f48646a72cde7e620">REXX_INTERPRETER_4_0_0</a>,              <span class="comment">// anything after 4.0.0 will work</span></div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;    <span class="stringliteral">&quot;REXXUTIL&quot;</span>,                          <span class="comment">// name of the package</span></div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;    <span class="stringliteral">&quot;4.0&quot;</span>,                               <span class="comment">// package information</span></div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;    NULL,                                <span class="comment">// no load/unload functions</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;    NULL,</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;    <a class="code" href="windows_2rexxutil_8cpp.html#a55bdc28f497f01e1b6f78aa67cf02578">rexxutil_routines</a>,                   <span class="comment">// the exported functions</span></div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;    NULL                                 <span class="comment">// no methods in this package</span></div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;};</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160; </div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;<span class="comment">// package loading stub.</span></div>
<div class="line"><a name="l06943"></a><span class="lineno"><a class="line" href="windows_2rexxutil_8cpp.html#a1fe346d6c28f686e08c2115992a7cb9b"> 6943</a></span>&#160;<a class="code" href="windows_2rexxutil_8cpp.html#a1fe346d6c28f686e08c2115992a7cb9b">OOREXX_GET_PACKAGE</a>(rexxutil);</div>
<div class="ttc" id="a_array_class_8cpp_html_ac6afabdc09a49a433ee19d8a9486056d"><div class="ttname"><a href="_array_class_8cpp.html#ac6afabdc09a49a433ee19d8a9486056d">min</a></div><div class="ttdeci">#define min(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="_array_class_8cpp_source.html#l00082">ArrayClass.cpp:82</a></div></div>
<div class="ttc" id="a_interpreter_a_p_i_8cpp_html_a229a7d29867d80217a65b76efa1bf09f"><div class="ttname"><a href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a></div><div class="ttdeci">RexxReturnCode RexxEntry RexxVariablePool(PSHVBLOCK pshvblock)</div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_a_p_i_8cpp_source.html#l00392">InterpreterAPI.cpp:392</a></div></div>
<div class="ttc" id="aclass_sys_search_path_html"><div class="ttname"><a href="class_sys_search_path.html">SysSearchPath</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_interpreter_instance_8hpp_source.html#l00070">unix/SysInterpreterInstance.hpp:71</a></div></div>
<div class="ttc" id="acmdparse_8cpp_html_ac765329451135abec74c45e1897abf26"><div class="ttname"><a href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="cmdparse_8cpp_source.html#l00383">cmdparse.cpp:383</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html"><div class="ttname"><a href="oorexxapi_8h.html">oorexxapi.h</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a15c340ee5245f15f32265d54a1e5a3f5"><div class="ttname"><a href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a></div><div class="ttdeci">#define argumentExists(i)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l03777">oorexxapi.h:3777</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a2fdcd4caf670858f48646a72cde7e620"><div class="ttname"><a href="oorexxapi_8h.html#a2fdcd4caf670858f48646a72cde7e620">REXX_INTERPRETER_4_0_0</a></div><div class="ttdeci">#define REXX_INTERPRETER_4_0_0</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00216">oorexxapi.h:216</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a631b22840291b7d860a64ca824ad43eb"><div class="ttname"><a href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a></div><div class="ttdeci">#define REXX_CLASSIC_ROUTINE(n, e)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00192">oorexxapi.h:192</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a895bccfb4968ae24b153351beadd50f7"><div class="ttname"><a href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a></div><div class="ttdeci">#define argumentOmitted(i)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l03778">oorexxapi.h:3778</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_aa3968b4fd4978493411036d07050237d"><div class="ttname"><a href="oorexxapi_8h.html#aa3968b4fd4978493411036d07050237d">REXX_LAST_ROUTINE</a></div><div class="ttdeci">#define REXX_LAST_ROUTINE()</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00193">oorexxapi.h:193</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_aac6f9cb24eb7a7cc0f4e041811275f72"><div class="ttname"><a href="oorexxapi_8h.html#aac6f9cb24eb7a7cc0f4e041811275f72">REXX_TYPED_ROUTINE</a></div><div class="ttdeci">#define REXX_TYPED_ROUTINE(n, e)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00191">oorexxapi.h:191</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_ad0c9dd799a5ddb561472ac8968ea3705"><div class="ttname"><a href="oorexxapi_8h.html#ad0c9dd799a5ddb561472ac8968ea3705">STANDARD_PACKAGE_HEADER</a></div><div class="ttdeci">#define STANDARD_PACKAGE_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00230">oorexxapi.h:230</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a2e34ba6b32f03ebefc4a415684900dce"><div class="ttname"><a href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a></div><div class="ttdeci">#define Rexx_Error_Invalid_argument_range</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00419">oorexxerrors.h:419</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a33b78238ad2d773aa0b826ca3ee19194"><div class="ttname"><a href="oorexxerrors_8h.html#a33b78238ad2d773aa0b826ca3ee19194">Rexx_Error_System_resources_user_defined</a></div><div class="ttdeci">#define Rexx_Error_System_resources_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00068">oorexxerrors.h:68</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a4d878853d7bdfad5156aaecf60880798"><div class="ttname"><a href="oorexxerrors_8h.html#a4d878853d7bdfad5156aaecf60880798">Rexx_Error_Incorrect_call_user_defined</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_call_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00356">oorexxerrors.h:356</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_ab090a8788190e809a21bf936a569fff7"><div class="ttname"><a href="oorexxerrors_8h.html#ab090a8788190e809a21bf936a569fff7">Rexx_Error_Invalid_argument_number</a></div><div class="ttdeci">#define Rexx_Error_Invalid_argument_number</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00414">oorexxerrors.h:414</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_ac62b63c2b452912b30225fc815ff22a8"><div class="ttname"><a href="oorexxerrors_8h.html#ac62b63c2b452912b30225fc815ff22a8">Rexx_Error_System_service_user_defined</a></div><div class="ttdeci">#define Rexx_Error_System_service_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00404">oorexxerrors.h:404</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_af462261a026f211fbb7799b7b2ae5aff"><div class="ttname"><a href="oorexxerrors_8h.html#af462261a026f211fbb7799b7b2ae5aff">Rexx_Error_Incorrect_call_null</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_call_null</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00343">oorexxerrors.h:343</a></div></div>
<div class="ttc" id="arexx_8h_html_a44df40d9d3e5ce5112d8d7ea17d7b532"><div class="ttname"><a href="rexx_8h.html#a44df40d9d3e5ce5112d8d7ea17d7b532">RexxLoadMacroSpace</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxLoadMacroSpace(size_t, CONSTANT_STRING *, CONSTANT_STRING)</div></div>
<div class="ttc" id="arexx_8h_html_a47198dd151af7d667b5c6066a0a65f40"><div class="ttname"><a href="rexx_8h.html#a47198dd151af7d667b5c6066a0a65f40">RexxAddMacro</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxAddMacro(CONSTANT_STRING, CONSTANT_STRING, size_t)</div></div>
<div class="ttc" id="arexx_8h_html_a581e376dc8d3b9132e29014c896b9e70"><div class="ttname"><a href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a></div><div class="ttdeci">const char * CSTRING</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00078">rexx.h:78</a></div></div>
<div class="ttc" id="arexx_8h_html_a5c0290e473e3b0e7e53b55c8a3612e1a"><div class="ttname"><a href="rexx_8h.html#a5c0290e473e3b0e7e53b55c8a3612e1a">RexxFreeMemory</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxFreeMemory(void *)</div><div class="ttdef"><b>Definition:</b> <a href="_registration_a_p_i_8cpp_source.html#l00575">RegistrationAPI.cpp:575</a></div></div>
<div class="ttc" id="arexx_8h_html_a6092009977837102d11ed4338f9e93b5"><div class="ttname"><a href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a></div><div class="ttdeci">size_t logical_t</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00231">rexx.h:231</a></div></div>
<div class="ttc" id="arexx_8h_html_a64dfe004825692637e2075467179fcd9"><div class="ttname"><a href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a></div><div class="ttdeci">struct _RexxStringObject * RexxStringObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00128">rexx.h:128</a></div></div>
<div class="ttc" id="arexx_8h_html_a697908c384958f9d6e256993d81d2aaa"><div class="ttname"><a href="rexx_8h.html#a697908c384958f9d6e256993d81d2aaa">RexxSaveMacroSpace</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxSaveMacroSpace(size_t, CONSTANT_STRING *, CONSTANT_STRING)</div></div>
<div class="ttc" id="arexx_8h_html_a75ec63a6cd56b3486d5b625598b0a8e1"><div class="ttname"><a href="rexx_8h.html#a75ec63a6cd56b3486d5b625598b0a8e1">RXVALIDSTRING</a></div><div class="ttdeci">#define RXVALIDSTRING(r)</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00179">rexx.h:179</a></div></div>
<div class="ttc" id="arexx_8h_html_a86b37abbed59199713b843efab37d3ff"><div class="ttname"><a href="rexx_8h.html#a86b37abbed59199713b843efab37d3ff">RexxQueryMacro</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxQueryMacro(CONSTANT_STRING, unsigned short *)</div></div>
<div class="ttc" id="arexx_8h_html_a96e0cc5eda42aed364b05f3c493e07e8"><div class="ttname"><a href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a></div><div class="ttdeci">struct _RexxObjectPtr * RexxObjectPtr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00127">rexx.h:127</a></div></div>
<div class="ttc" id="arexx_8h_html_a9a119fa1e31a4af78dee3c12225b240a"><div class="ttname"><a href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a></div><div class="ttdeci">#define NULLOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00147">rexx.h:147</a></div></div>
<div class="ttc" id="arexx_8h_html_aa00dff652e0e5e3ad962551ac22a95cb"><div class="ttname"><a href="rexx_8h.html#aa00dff652e0e5e3ad962551ac22a95cb">RexxReorderMacro</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxReorderMacro(CONSTANT_STRING, size_t)</div></div>
<div class="ttc" id="arexx_8h_html_aa0199524ada35d939fa20d4625d27d55"><div class="ttname"><a href="rexx_8h.html#aa0199524ada35d939fa20d4625d27d55">wholenumber_t</a></div><div class="ttdeci">ssize_t wholenumber_t</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00230">rexx.h:230</a></div></div>
<div class="ttc" id="arexx_8h_html_aa0444b24c2d2abc9293c516164a715dc"><div class="ttname"><a href="rexx_8h.html#aa0444b24c2d2abc9293c516164a715dc">RXNULLSTRING</a></div><div class="ttdeci">#define RXNULLSTRING(r)</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00177">rexx.h:177</a></div></div>
<div class="ttc" id="arexx_8h_html_ac86f469a219a357916379dfb54b03393"><div class="ttname"><a href="rexx_8h.html#ac86f469a219a357916379dfb54b03393">RexxReturnCode</a></div><div class="ttdeci">int RexxReturnCode</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00073">rexx.h:73</a></div></div>
<div class="ttc" id="arexx_8h_html_adbc9a0d41c6b09e57c92767bc664c6e9"><div class="ttname"><a href="rexx_8h.html#adbc9a0d41c6b09e57c92767bc664c6e9">RexxClearMacroSpace</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxClearMacroSpace(void)</div><div class="ttdef"><b>Definition:</b> <a href="_macro_space_api_8cpp_source.html#l00113">MacroSpaceApi.cpp:113</a></div></div>
<div class="ttc" id="arexx_8h_html_aebaaee111319541a721e954c64e4423c"><div class="ttname"><a href="rexx_8h.html#aebaaee111319541a721e954c64e4423c">stringsize_t</a></div><div class="ttdeci">size_t stringsize_t</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00228">rexx.h:228</a></div></div>
<div class="ttc" id="arexx_8h_html_aec9d4b9410c6f3c46bcceec8c16e253d"><div class="ttname"><a href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a></div><div class="ttdeci">#define RexxEntry</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00412">rexx.h:412</a></div></div>
<div class="ttc" id="arexx_8h_html_af0e527502183c8c40a249f22f265cc8d"><div class="ttname"><a href="rexx_8h.html#af0e527502183c8c40a249f22f265cc8d">RexxDropMacro</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxDropMacro(CONSTANT_STRING)</div></div>
<div class="ttc" id="arexx_8h_html_af481dd711e94a4b9b636f922b8cfef5c"><div class="ttname"><a href="rexx_8h.html#af481dd711e94a4b9b636f922b8cfef5c">RexxStemObject</a></div><div class="ttdeci">struct _RexxStemObject * RexxStemObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00139">rexx.h:139</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a038955920fa00deca01449bad0e91f7a"><div class="ttname"><a href="rexxapidefs_8h.html#a038955920fa00deca01449bad0e91f7a">RXMACRO_SEARCH_BEFORE</a></div><div class="ttdeci">#define RXMACRO_SEARCH_BEFORE</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00220">rexxapidefs.h:220</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a13e33f27f73fbc0d6b7629cb98fe0de2"><div class="ttname"><a href="rexxapidefs_8h.html#a13e33f27f73fbc0d6b7629cb98fe0de2">RXSHV_NEXTV</a></div><div class="ttdeci">#define RXSHV_NEXTV</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00103">rexxapidefs.h:103</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a3b7f6d1c46549bc61f77491b5824a102"><div class="ttname"><a href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a></div><div class="ttdeci">#define RXSHV_BADN</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00116">rexxapidefs.h:116</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a58a5ae4ae5134a134de77788be1d4ba2"><div class="ttname"><a href="rexxapidefs_8h.html#a58a5ae4ae5134a134de77788be1d4ba2">RXMACRO_SEARCH_AFTER</a></div><div class="ttdeci">#define RXMACRO_SEARCH_AFTER</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00221">rexxapidefs.h:221</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a8ffa6714f4ffb75f4c65cff2ba8e84b9"><div class="ttname"><a href="rexxapidefs_8h.html#a8ffa6714f4ffb75f4c65cff2ba8e84b9">RXSHV_SET</a></div><div class="ttdeci">#define RXSHV_SET</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00097">rexxapidefs.h:97</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a9426d3b59bbe38c2ca650385009d6f83"><div class="ttname"><a href="rexxapidefs_8h.html#a9426d3b59bbe38c2ca650385009d6f83">RXSHV_OK</a></div><div class="ttdeci">#define RXSHV_OK</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00112">rexxapidefs.h:112</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_adca0acf640b42da003a82c13fcd0ece3"><div class="ttname"><a href="rexxapidefs_8h.html#adca0acf640b42da003a82c13fcd0ece3">RXSHV_LVAR</a></div><div class="ttdeci">#define RXSHV_LVAR</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00114">rexxapidefs.h:114</a></div></div>
<div class="ttc" id="astruct___c_o_n_s_t_r_x_s_t_r_i_n_g_html"><div class="ttname"><a href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">_CONSTRXSTRING</a></div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00161">rexx.h:161</a></div></div>
<div class="ttc" id="astruct___c_o_n_s_t_r_x_s_t_r_i_n_g_html_a2e9404fe02b081d420a3fe7412152219"><div class="ttname"><a href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">_CONSTRXSTRING::strptr</a></div><div class="ttdeci">const char * strptr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00163">rexx.h:163</a></div></div>
<div class="ttc" id="astruct___c_o_n_s_t_r_x_s_t_r_i_n_g_html_a38efa660780cb5cfa52aab2881660378"><div class="ttname"><a href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">_CONSTRXSTRING::strlength</a></div><div class="ttdeci">size_t strlength</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00162">rexx.h:162</a></div></div>
<div class="ttc" id="astruct___get_file_data_html"><div class="ttname"><a href="struct___get_file_data.html">_GetFileData</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00424">unix/rexxutil.cpp:424</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_a1d213b7bc77e928f255d7f3a926d8cee"><div class="ttname"><a href="struct___get_file_data.html#a1d213b7bc77e928f255d7f3a926d8cee">_GetFileData::handle</a></div><div class="ttdeci">FILE * handle</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00430">unix/rexxutil.cpp:430</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_a2a8cfa812b5e122b9f2d2934c76b90c2"><div class="ttname"><a href="struct___get_file_data.html#a2a8cfa812b5e122b9f2d2934c76b90c2">_GetFileData::handle</a></div><div class="ttdeci">HANDLE handle</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00273">windows/rexxutil.cpp:273</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_a2c05b6297f1251779e543eda3b683a21"><div class="ttname"><a href="struct___get_file_data.html#a2c05b6297f1251779e543eda3b683a21">_GetFileData::buffer</a></div><div class="ttdeci">char * buffer</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00425">unix/rexxutil.cpp:425</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_a339cdb27bb7facf9b0dce05aec668123"><div class="ttname"><a href="struct___get_file_data.html#a339cdb27bb7facf9b0dce05aec668123">_GetFileData::size</a></div><div class="ttdeci">size_t size</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00426">unix/rexxutil.cpp:426</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_a44d3bf0570ec0be028b72f25b47b9bbb"><div class="ttname"><a href="struct___get_file_data.html#a44d3bf0570ec0be028b72f25b47b9bbb">_GetFileData::residual</a></div><div class="ttdeci">size_t residual</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00428">unix/rexxutil.cpp:428</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_aa37b5982a2d6abfc1a4033a64384796c"><div class="ttname"><a href="struct___get_file_data.html#aa37b5982a2d6abfc1a4033a64384796c">_GetFileData::scan</a></div><div class="ttdeci">char * scan</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00272">windows/rexxutil.cpp:272</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_ac3f434d6ecc6aa55fd87e4ec2e205913"><div class="ttname"><a href="struct___get_file_data.html#ac3f434d6ecc6aa55fd87e4ec2e205913">_GetFileData::scan</a></div><div class="ttdeci">const char * scan</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00429">unix/rexxutil.cpp:429</a></div></div>
<div class="ttc" id="astruct___get_file_data_html_aea4740b27247c658fd7608027ca77bfb"><div class="ttname"><a href="struct___get_file_data.html#aea4740b27247c658fd7608027ca77bfb">_GetFileData::data</a></div><div class="ttdeci">size_t data</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00427">unix/rexxutil.cpp:427</a></div></div>
<div class="ttc" id="astruct___r_x_s_t_r_i_n_g_html"><div class="ttname"><a href="struct___r_x_s_t_r_i_n_g.html">_RXSTRING</a></div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00156">rexx.h:156</a></div></div>
<div class="ttc" id="astruct___r_x_s_t_r_i_n_g_html_a12a97290b407e2e98317b583d6169d9e"><div class="ttname"><a href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">_RXSTRING::strlength</a></div><div class="ttdeci">size_t strlength</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00157">rexx.h:157</a></div></div>
<div class="ttc" id="astruct___r_x_s_t_r_i_n_g_html_ad6b644e71513de3413346382f7850aa5"><div class="ttname"><a href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">_RXSTRING::strptr</a></div><div class="ttdeci">char * strptr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00158">rexx.h:158</a></div></div>
<div class="ttc" id="astruct___rexx_package_entry_html"><div class="ttname"><a href="struct___rexx_package_entry.html">_RexxPackageEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00241">oorexxapi.h:242</a></div></div>
<div class="ttc" id="astruct___rexx_routine_entry_html"><div class="ttname"><a href="struct___rexx_routine_entry.html">_RexxRoutineEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00176">oorexxapi.h:177</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html">_SHVBLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00204">rexx.h:204</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a5712597e70a0e887aee58b7af0f48fbb"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">_SHVBLOCK::shvvaluelen</a></div><div class="ttdeci">size_t shvvaluelen</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00209">rexx.h:209</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a72db975b914c95c3a3fc8d44fa305bc9"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">_SHVBLOCK::shvname</a></div><div class="ttdeci">CONSTANT_RXSTRING shvname</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00206">rexx.h:206</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a7c6a6cadc29672a515765c717393a859"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">_SHVBLOCK::shvret</a></div><div class="ttdeci">unsigned char shvret</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00211">rexx.h:211</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a810460c51dc48bffd7a8eb8031c21571"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">_SHVBLOCK::shvcode</a></div><div class="ttdeci">unsigned char shvcode</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00210">rexx.h:210</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a938afba1f8b39879615e74ce4e2b2b62"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">_SHVBLOCK::shvvalue</a></div><div class="ttdeci">RXSTRING shvvalue</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00207">rexx.h:207</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_aa41396aac73894df176fde7d02e995a3"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">_SHVBLOCK::shvnamelen</a></div><div class="ttdeci">size_t shvnamelen</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00208">rexx.h:208</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_ab0c25e93257d4e78cea5bd42ae515333"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">_SHVBLOCK::shvnext</a></div><div class="ttdeci">struct _SHVBLOCK * shvnext</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00205">rexx.h:205</a></div></div>
<div class="ttc" id="astruct_rexx_call_context___html"><div class="ttname"><a href="struct_rexx_call_context__.html">RexxCallContext_</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l02198">oorexxapi.h:2199</a></div></div>
<div class="ttc" id="astruct_rexx_call_context___html_a3f5f5f0752c0e4c1852b366040180b84"><div class="ttname"><a href="struct_rexx_call_context__.html#a3f5f5f0752c0e4c1852b366040180b84">RexxCallContext_::threadContext</a></div><div class="ttdeci">RexxThreadContext * threadContext</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l02200">oorexxapi.h:2200</a></div></div>
<div class="ttc" id="astruct_rexx_thread_context___html"><div class="ttname"><a href="struct_rexx_thread_context__.html">RexxThreadContext_</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00714">oorexxapi.h:715</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html"><div class="ttname"><a href="struct_rx_stem_data.html">RxStemData</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00439">unix/rexxutil.cpp:439</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a0bba8267727fc8f3036a8a91438f9dc4"><div class="ttname"><a href="struct_rx_stem_data.html#a0bba8267727fc8f3036a8a91438f9dc4">RxStemData::ibuf</a></div><div class="ttdeci">char ibuf[IBUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00441">unix/rexxutil.cpp:441</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a21373b47be6af279312f43a6e960d7a4"><div class="ttname"><a href="struct_rx_stem_data.html#a21373b47be6af279312f43a6e960d7a4">RxStemData::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00450">unix/rexxutil.cpp:450</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a2e408723e89f450d75eb5fdef6755bed"><div class="ttname"><a href="struct_rx_stem_data.html#a2e408723e89f450d75eb5fdef6755bed">RxStemData::varname</a></div><div class="ttdeci">char varname[MAX]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00442">unix/rexxutil.cpp:442</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a2f496b41005d7f07f27ce4a8b840d0da"><div class="ttname"><a href="struct_rx_stem_data.html#a2f496b41005d7f07f27ce4a8b840d0da">RxStemData::shvb</a></div><div class="ttdeci">SHVBLOCK shvb</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00440">unix/rexxutil.cpp:440</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a48f4bdc104cd85c77d9255a1ebbfcb4b"><div class="ttname"><a href="struct_rx_stem_data.html#a48f4bdc104cd85c77d9255a1ebbfcb4b">RxStemData::j</a></div><div class="ttdeci">size_t j</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00448">unix/rexxutil.cpp:448</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a61aa9d45719c5ceb01eea9911541c549"><div class="ttname"><a href="struct_rx_stem_data.html#a61aa9d45719c5ceb01eea9911541c549">RxStemData::stemname</a></div><div class="ttdeci">char stemname[MAX]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00444">unix/rexxutil.cpp:444</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a673c36059850a1e7c82002a0d1dcdc41"><div class="ttname"><a href="struct_rx_stem_data.html#a673c36059850a1e7c82002a0d1dcdc41">RxStemData::vlen</a></div><div class="ttdeci">size_t vlen</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00447">unix/rexxutil.cpp:447</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_a68c96508f447b68f098be0ae064db61e"><div class="ttname"><a href="struct_rx_stem_data.html#a68c96508f447b68f098be0ae064db61e">RxStemData::tlong</a></div><div class="ttdeci">size_t tlong</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00449">unix/rexxutil.cpp:449</a></div></div>
<div class="ttc" id="astruct_rx_stem_data_html_ab78bcafea506cbf1071dd3e07c35588b"><div class="ttname"><a href="struct_rx_stem_data.html#ab78bcafea506cbf1071dd3e07c35588b">RxStemData::stemlen</a></div><div class="ttdeci">size_t stemlen</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00446">unix/rexxutil.cpp:446</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html"><div class="ttname"><a href="struct_rx_tree_data.html">RxTreeData</a></div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00403">unix/rexxutil.cpp:403</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_a247cbae4c11e6d3ecc67578afd588d92"><div class="ttname"><a href="struct_rx_tree_data.html#a247cbae4c11e6d3ecc67578afd588d92">RxTreeData::fileTime</a></div><div class="ttdeci">char fileTime[FILETIME_BUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00409">unix/rexxutil.cpp:409</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_a31e260d4e63a9fbece99ed6602a6deb6"><div class="ttname"><a href="struct_rx_tree_data.html#a31e260d4e63a9fbece99ed6602a6deb6">RxTreeData::fNameSpec</a></div><div class="ttdeci">char fNameSpec[FNAMESPEC_BUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00406">unix/rexxutil.cpp:406</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_a747f380ce3cb6c31f807c7190ae2c616"><div class="ttname"><a href="struct_rx_tree_data.html#a747f380ce3cb6c31f807c7190ae2c616">RxTreeData::foundFile</a></div><div class="ttdeci">char foundFile[FOUNDFILE_BUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00407">unix/rexxutil.cpp:407</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_a9bef0c4b76ac4283092efe843ad39f35"><div class="ttname"><a href="struct_rx_tree_data.html#a9bef0c4b76ac4283092efe843ad39f35">RxTreeData::files</a></div><div class="ttdeci">RexxStemObject files</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00405">unix/rexxutil.cpp:405</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_ab7cd560bf89c478204afa4888b0adb45"><div class="ttname"><a href="struct_rx_tree_data.html#ab7cd560bf89c478204afa4888b0adb45">RxTreeData::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00404">unix/rexxutil.cpp:404</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_acddb7abc4b3f56e3808b655a6290d701"><div class="ttname"><a href="struct_rx_tree_data.html#acddb7abc4b3f56e3808b655a6290d701">RxTreeData::dFNameSpec</a></div><div class="ttdeci">char * dFNameSpec</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00411">unix/rexxutil.cpp:411</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_ae68ea12a13b6f27d8cc0ca9d30d66a6e"><div class="ttname"><a href="struct_rx_tree_data.html#ae68ea12a13b6f27d8cc0ca9d30d66a6e">RxTreeData::foundFileLine</a></div><div class="ttdeci">char foundFileLine[FOUNDFILELINE_BUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00408">unix/rexxutil.cpp:408</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_ae9860099d7c029962a0f1268cfa4b129"><div class="ttname"><a href="struct_rx_tree_data.html#ae9860099d7c029962a0f1268cfa4b129">RxTreeData::fileAttr</a></div><div class="ttdeci">char fileAttr[FILEATTR_BUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00410">unix/rexxutil.cpp:410</a></div></div>
<div class="ttc" id="astruct_rx_tree_data_html_ae9dba9daef69438aa76a3cd65372da61"><div class="ttname"><a href="struct_rx_tree_data.html#ae9dba9daef69438aa76a3cd65372da61">RxTreeData::nFNameSpec</a></div><div class="ttdeci">size_t nFNameSpec</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00414">unix/rexxutil.cpp:414</a></div></div>
<div class="ttc" id="aunix_2rexxapitypes_8h_html_a93e16d257e437e184c82b4918857bdae"><div class="ttname"><a href="unix_2rexxapitypes_8h.html#a93e16d257e437e184c82b4918857bdae">REXXENTRY</a></div><div class="ttdeci">#define REXXENTRY</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxapitypes_8h_source.html#l00061">unix/rexxapitypes.h:61</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_a2eaa0915b068bca2cd391a2a0afde88e"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#a2eaa0915b068bca2cd391a2a0afde88e">SysSetPriority</a></div><div class="ttdeci">size_t RexxEntry SysSetPriority(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l03746">unix/rexxutil.cpp:3746</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_a628da822b4b70d17675932dfe8f6bd77"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#a628da822b4b70d17675932dfe8f6bd77">MoveFile</a></div><div class="ttdeci">int MoveFile(CSTRING fromFile, CSTRING toFile)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l05619">unix/rexxutil.cpp:5619</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_a6d0e601daae44f306aa512f656edeaf9"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#a6d0e601daae44f306aa512f656edeaf9">SysGetFileDateTime</a></div><div class="ttdeci">size_t RexxEntry SysGetFileDateTime(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l04646">unix/rexxutil.cpp:4646</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_aadab25a6bd1a2ea790685426d34cdfb1"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#aadab25a6bd1a2ea790685426d34cdfb1">SysMkDir</a></div><div class="ttdeci">size_t RexxEntry SysMkDir(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l01340">unix/rexxutil.cpp:1340</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_aafa64d230b88376df6f055cb4490f701"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#aafa64d230b88376df6f055cb4490f701">SysUtilVersion</a></div><div class="ttdeci">size_t RexxEntry SysUtilVersion(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l05371">unix/rexxutil.cpp:5371</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_ab5cc3e1c79c1624cd7c4c1faedce8536"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#ab5cc3e1c79c1624cd7c4c1faedce8536">SysQueryProcess</a></div><div class="ttdeci">size_t RexxEntry SysQueryProcess(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l05200">unix/rexxutil.cpp:5200</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_ad302ee7ca379dfc14324dcc41cb8d18a"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#ad302ee7ca379dfc14324dcc41cb8d18a">SearchPath</a></div><div class="ttdeci">int SearchPath(int SearchFlag, const char *path, const char *filename, char *buf, size_t buf_size)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00866">unix/rexxutil.cpp:866</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_ae415e0f263db631c50550196d163dbe6"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#ae415e0f263db631c50550196d163dbe6">SysSetFileDateTime</a></div><div class="ttdeci">size_t RexxEntry SysSetFileDateTime(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l04728">unix/rexxutil.cpp:4728</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_aeb154f4bdbb013dc3d312e63b897b76b"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#aeb154f4bdbb013dc3d312e63b897b76b">SysRmDir</a></div><div class="ttdeci">size_t RexxEntry SysRmDir(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l01422">unix/rexxutil.cpp:1422</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_af00eb685356358bb4b5d60e591203c7f"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#af00eb685356358bb4b5d60e591203c7f">SysFileDelete</a></div><div class="ttdeci">size_t RexxEntry SysFileDelete(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l01508">unix/rexxutil.cpp:1508</a></div></div>
<div class="ttc" id="aunix_2rxqueue_8cpp_html_a6b8ed158971b6467633e570b4a767e5e"><div class="ttname"><a href="unix_2rxqueue_8cpp.html#a6b8ed158971b6467633e570b4a767e5e">line</a></div><div class="ttdeci">char line[LINEBUFSIZE]</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rxqueue_8cpp_source.html#l00081">unix/rxqueue.cpp:81</a></div></div>
<div class="ttc" id="awindows_2_platform_definitions_8h_html_a2e1baae9134e580910322362dc23290e"><div class="ttname"><a href="windows_2_platform_definitions_8h.html#a2e1baae9134e580910322362dc23290e">isnan</a></div><div class="ttdeci">#define isnan(x)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_platform_definitions_8h_source.html#l00147">windows/PlatformDefinitions.h:147</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a2f338919cf0aa5c3d87df8096b8fa972"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a2f338919cf0aa5c3d87df8096b8fa972">uintptr_t</a></div><div class="ttdeci">UINT_PTR uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00050">windows/rexxapitypes.h:50</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a32f2e37ee053cf2ce8ca28d1f74630e5"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00072">windows/rexxapitypes.h:72</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a3c75bb398badb69c7577b21486f9963f"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a3c75bb398badb69c7577b21486f9963f">SIZE_MAX</a></div><div class="ttdeci">#define SIZE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00115">windows/rexxapitypes.h:115</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00073">windows/rexxapitypes.h:73</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a001791a21d538b8b9176287ae60d9b61"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a001791a21d538b8b9176287ae60d9b61">MAX_DIGITS</a></div><div class="ttdeci">#define MAX_DIGITS</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00190">windows/rexxutil.cpp:190</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a02706310c2be4fc4b66273d8e08bcebd"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a02706310c2be4fc4b66273d8e08bcebd">MAX_READ</a></div><div class="ttdeci">#define MAX_READ</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00193">windows/rexxutil.cpp:193</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a0308273194dd52d866703aaeb65c7604"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a0308273194dd52d866703aaeb65c7604">RexxRoutine2</a></div><div class="ttdeci">RexxRoutine2(RexxStringObject, SysCurPos, OPTIONAL_stringsize_t, inrow, OPTIONAL_stringsize_t, incol)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01063">windows/rexxutil.cpp:1063</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a054a57d2b2b5732c19d54313e1e19dae"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a054a57d2b2b5732c19d54313e1e19dae">SysSearchPath</a></div><div class="ttdeci">size_t RexxEntry SysSearchPath(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03698">windows/rexxutil.cpp:3698</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a05ec9ff971191219c0ad575fcba802d5"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a05ec9ff971191219c0ad575fcba802d5">ExtendedFlag</a></div><div class="ttdeci">static int ExtendedFlag</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00319">windows/rexxutil.cpp:319</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a06e2143e7982a013ae2229b68ef6ef92"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a06e2143e7982a013ae2229b68ef6ef92">SysSystemDirectory</a></div><div class="ttdeci">size_t RexxEntry SysSystemDirectory(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l04480">windows/rexxutil.cpp:4480</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a07bc4be1a9a8a49a9472dcb8aad4791a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a07bc4be1a9a8a49a9472dcb8aad4791a">SysDriveInfo</a></div><div class="ttdeci">size_t RexxEntry SysDriveInfo(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01149">windows/rexxutil.cpp:1149</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a09a3b394b8602092d58347b791158062"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a09a3b394b8602092d58347b791158062">MAX_LINE_LEN</a></div><div class="ttdeci">#define MAX_LINE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00200">windows/rexxutil.cpp:200</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a0abf85d7ec2b6300c8e332bee17b1ac9"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a0abf85d7ec2b6300c8e332bee17b1ac9">getOptionsFromArg</a></div><div class="ttdeci">static bool getOptionsFromArg(RexxCallContext *context, char *opts, uint32_t *options, size_t argPos)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02755">windows/rexxutil.cpp:2755</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a0b05abb761c82a2935cf47ac557f164b"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a0b05abb761c82a2935cf47ac557f164b">CH_NL</a></div><div class="ttdeci">#define CH_NL</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00196">windows/rexxutil.cpp:196</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a0b1a486d8de452c909c69e57bb7cbbc4"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a0b1a486d8de452c909c69e57bb7cbbc4">SysDriveMap</a></div><div class="ttdeci">size_t RexxEntry SysDriveMap(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01270">windows/rexxutil.cpp:1270</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a0d640f916a13ffdbfbc4f73da2dde1ed"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a0d640f916a13ffdbfbc4f73da2dde1ed">ERROR_RETSTR</a></div><div class="ttdeci">#define ERROR_RETSTR</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00341">windows/rexxutil.cpp:341</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a0dad6273af058ff65ec64445dfe96581"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a0dad6273af058ff65ec64445dfe96581">SysVersion</a></div><div class="ttdeci">size_t RexxEntry SysVersion(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03658">windows/rexxutil.cpp:3658</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a100635e0d5340c4fb128814f0c116088"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a100635e0d5340c4fb128814f0c116088">SetFileMode</a></div><div class="ttdeci">bool SetFileMode(const char *file, size_t attr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00792">windows/rexxutil.cpp:792</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a115c859efee999b355a6673e2b4d5c1d"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a115c859efee999b355a6673e2b4d5c1d">string2size_t</a></div><div class="ttdeci">bool string2size_t(const char *string, size_t *number)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00480">windows/rexxutil.cpp:480</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a15e10d1f71045e73f802d2ce8d340c8f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a15e10d1f71045e73f802d2ce8d340c8f">BUILDRXSTRING</a></div><div class="ttdeci">#define BUILDRXSTRING(t, s)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00354">windows/rexxutil.cpp:354</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a190441ab7cc17bc681ac6ec286e20974"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a190441ab7cc17bc681ac6ec286e20974">rexxutil_package_entry</a></div><div class="ttdeci">RexxPackageEntry rexxutil_package_entry</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l06930">windows/rexxutil.cpp:6930</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a1fe346d6c28f686e08c2115992a7cb9b"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a1fe346d6c28f686e08c2115992a7cb9b">OOREXX_GET_PACKAGE</a></div><div class="ttdeci">OOREXX_GET_PACKAGE(rexxutil)</div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a25020b02829d4d69fb53c8bfeb03222e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a25020b02829d4d69fb53c8bfeb03222e">RexxRoutine6</a></div><div class="ttdeci">RexxRoutine6(int, SysStemCopy, RexxStemObject, fromStem, RexxStemObject, toStem, OPTIONAL_stringsize_t, from, OPTIONAL_stringsize_t, to, OPTIONAL_stringsize_t, count, OPTIONAL_CSTRING, option)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l05847">windows/rexxutil.cpp:5847</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a26f71277f565e460c73f60a89c8c57e6"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a26f71277f565e460c73f60a89c8c57e6">IBUF_LEN</a></div><div class="ttdeci">#define IBUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00192">windows/rexxutil.cpp:192</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a270882ebf6e7854c46fef5e869667da4"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a270882ebf6e7854c46fef5e869667da4">isAtLeastVista</a></div><div class="ttdeci">bool isAtLeastVista(void)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00511">windows/rexxutil.cpp:511</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a2a931c7ac0ee9eb68945edc736d43a64"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a2a931c7ac0ee9eb68945edc736d43a64">LONG_TIME</a></div><div class="ttdeci">#define LONG_TIME</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00224">windows/rexxutil.cpp:224</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a2c95be1e6d1ce22e37c9bfbd440459b6"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a2c95be1e6d1ce22e37c9bfbd440459b6">formatFile</a></div><div class="ttdeci">static bool formatFile(RexxCallContext *c, char *path, RXTREEDATA *treeData, int32_t *newMask, uint32_t options, WIN32_FIND_DATA *wfd)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01826">windows/rexxutil.cpp:1826</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00211">windows/rexxutil.cpp:211</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a380dd07de146d431f3eef3e765ed27c5"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a380dd07de146d431f3eef3e765ed27c5">safeGetCurrentDirectory</a></div><div class="ttdeci">static bool safeGetCurrentDirectory(RexxCallContext *c, char **pPath, size_t *pPathLen)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02234">windows/rexxutil.cpp:2234</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a392fb874e547e582e9c66a08a1f23326"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a392fb874e547e582e9c66a08a1f23326">MAX</a></div><div class="ttdeci">#define MAX</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00191">windows/rexxutil.cpp:191</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a3b41bbd068254a0c8052a422657b269f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a3b41bbd068254a0c8052a422657b269f">GetFileData</a></div><div class="ttdeci">struct _GetFileData GetFileData</div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a3cb9da7fb9d0e9c4f3ec58492df0aced"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a3cb9da7fb9d0e9c4f3ec58492df0aced">GetLine</a></div><div class="ttdeci">bool GetLine(char *line, size_t size, GetFileData *filedata)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00682">windows/rexxutil.cpp:682</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a3f3162dc59bf43be0b2cf233c862b86e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a3f3162dc59bf43be0b2cf233c862b86e">expandPath2fullPath</a></div><div class="ttdeci">static bool expandPath2fullPath(RexxCallContext *c, char *fSpec, size_t lastSlashPos, char **pPath, size_t *pPathLen)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02378">windows/rexxutil.cpp:2378</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a46f76935abcd584285feb9ee9dbf145f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a46f76935abcd584285feb9ee9dbf145f">badMaskException</a></div><div class="ttdeci">static void badMaskException(RexxThreadContext *c, size_t pos, CSTRING actual)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01589">windows/rexxutil.cpp:1589</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a47277a3785d67b3ec5e850d55cdc6f59"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a47277a3785d67b3ec5e850d55cdc6f59">RexxRoutine1</a></div><div class="ttdeci">RexxRoutine1(int, SysCurState, CSTRING, option)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01110">windows/rexxutil.cpp:1110</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a479f6f8d462e87801cf8cd9ae7b4240b"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a479f6f8d462e87801cf8cd9ae7b4240b">SysWinDecryptFile</a></div><div class="ttdeci">size_t RexxEntry SysWinDecryptFile(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03581">windows/rexxutil.cpp:3581</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a47ea672db15c78539388264846c5fba7"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a47ea672db15c78539388264846c5fba7">OM_WAKEUP</a></div><div class="ttdeci">#define OM_WAKEUP</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00182">windows/rexxutil.cpp:182</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a49e97b805c6dd6cfcae32a44ad4cc273"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a49e97b805c6dd6cfcae32a44ad4cc273">getMaskFromArg</a></div><div class="ttdeci">static bool getMaskFromArg(RexxCallContext *context, char *msk, int32_t *mask, size_t argPos)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02718">windows/rexxutil.cpp:2718</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a4cc054e877104270b1303e92a0fb84eb"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a4cc054e877104270b1303e92a0fb84eb">DO_DIRS</a></div><div class="ttdeci">#define DO_DIRS</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00220">windows/rexxutil.cpp:220</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a51cac9f9c515d627456d545f27c76c58"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a51cac9f9c515d627456d545f27c76c58">RexxStemSort</a></div><div class="ttdeci">RexxReturnCode REXXENTRY RexxStemSort(const char *stemname, int order, int type, size_t start, size_t end, size_t firstcol, size_t lastcol)</div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_a_p_i_8cpp_source.html#l00412">InterpreterAPI.cpp:412</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a52551faaaa7d98c3b68e9a95d1e8812c"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a52551faaaa7d98c3b68e9a95d1e8812c">setAttr</a></div><div class="ttdeci">static bool setAttr(const char *file, uint32_t attr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01787">windows/rexxutil.cpp:1787</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a5273ad4c59f3a26dea4d732d29670e07"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a5273ad4c59f3a26dea4d732d29670e07">GetUniqueFileName</a></div><div class="ttdeci">VOID GetUniqueFileName(CHAR *Template, CHAR Filler, CHAR *file)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00903">windows/rexxutil.cpp:903</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a54ccc207dbdfb1a2e67a5cc304128e92"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a54ccc207dbdfb1a2e67a5cc304128e92">FNAMESPEC_BUF_LEN</a></div><div class="ttdeci">#define FNAMESPEC_BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00253">windows/rexxutil.cpp:253</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a54dbb1c1fdba5d4447120978a87597f2"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a54dbb1c1fdba5d4447120978a87597f2">getFileSpecFromArg</a></div><div class="ttdeci">static char * getFileSpecFromArg(RexxCallContext *context, CSTRING fSpec, size_t *fSpecLen, size_t *fSpecBufLen, size_t argPos)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02824">windows/rexxutil.cpp:2824</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a55bdc28f497f01e1b6f78aa67cf02578"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a55bdc28f497f01e1b6f78aa67cf02578">rexxutil_routines</a></div><div class="ttdeci">RexxRoutineEntry rexxutil_routines[]</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l06844">windows/rexxutil.cpp:6844</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a561d1a192cdcaffa07ad28637416c273"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a561d1a192cdcaffa07ad28637416c273">SysDumpVariables</a></div><div class="ttdeci">size_t RexxEntry SysDumpVariables(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l05318">windows/rexxutil.cpp:5318</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a563a9eb1cdb33946ea9a942899b0b09a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a563a9eb1cdb33946ea9a942899b0b09a">SleepTimerProc</a></div><div class="ttdeci">VOID CALLBACK SleepTimerProc(HWND, UINT, UINT, DWORD)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03885">windows/rexxutil.cpp:3885</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a5c58f57f9c642ad0a72ebbd45697aa6e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a5c58f57f9c642ad0a72ebbd45697aa6e">adjustFSpec</a></div><div class="ttdeci">static char * adjustFSpec(char *fSpec)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02176">windows/rexxutil.cpp:2176</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a5d442f6d8ad1ae6a5e00c3bc1ea09d26"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">VALID_ROUTINE</a></div><div class="ttdeci">#define VALID_ROUTINE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00348">windows/rexxutil.cpp:348</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a5d6a7cdf1e4b8e8b00acdff80d697a2c"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a5d6a7cdf1e4b8e8b00acdff80d697a2c">SysBootDrive</a></div><div class="ttdeci">size_t RexxEntry SysBootDrive(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l04454">windows/rexxutil.cpp:4454</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a5d7bcb59611c778e6e12516da1e47cf4"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a5d7bcb59611c778e6e12516da1e47cf4">RexxRoutine4</a></div><div class="ttdeci">RexxRoutine4(int, SysToUniCode, RexxStringObject, source, OPTIONAL_CSTRING, codePageOpt, OPTIONAL_CSTRING, mappingFlags, RexxStemObject, stem)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l06336">windows/rexxutil.cpp:6336</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a5e22cbe91a4d63890d01dd36e7a1c373"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a5e22cbe91a4d63890d01dd36e7a1c373">CDROM</a></div><div class="ttdeci">#define CDROM</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00209">windows/rexxutil.cpp:209</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a61b5662eb07457abc8f49702f3e1ec6d"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a61b5662eb07457abc8f49702f3e1ec6d">RXTREEDATA</a></div><div class="ttdeci">struct RxTreeData RXTREEDATA</div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a62ca51b78468397b2ef98ee55a5e6e2a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a62ca51b78468397b2ef98ee55a5e6e2a">REMOTE</a></div><div class="ttdeci">#define REMOTE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00210">windows/rexxutil.cpp:210</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a65011e5ea12430a310b308c79481064e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a65011e5ea12430a310b308c79481064e">badSFTOptsException</a></div><div class="ttdeci">static void badSFTOptsException(RexxThreadContext *c, size_t pos, CSTRING actual)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01572">windows/rexxutil.cpp:1572</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a678e1944f71f0f39ab10e16949e0892e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a678e1944f71f0f39ab10e16949e0892e">safeLocalFree</a></div><div class="ttdeci">void safeLocalFree(void *p)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00389">windows/rexxutil.cpp:389</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a68d9824fe1262211e7976735da2bbc49"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a68d9824fe1262211e7976735da2bbc49">FNAMESPEC_BUF_EXTRA</a></div><div class="ttdeci">#define FNAMESPEC_BUF_EXTRA</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00252">windows/rexxutil.cpp:252</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a6a24fbb8516a67c00ceb454e189be4ac"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a6a24fbb8516a67c00ceb454e189be4ac">ERROR_NOMEM</a></div><div class="ttdeci">#define ERROR_NOMEM</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00334">windows/rexxutil.cpp:334</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a6a75e2ce6e9d93b82e81e440c25e64af"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a6a75e2ce6e9d93b82e81e440c25e64af">recursiveFindFile</a></div><div class="ttdeci">static bool recursiveFindFile(RexxCallContext *c, char *path, RXTREEDATA *treeData, int32_t *targetMask, int32_t *newMask, uint32_t options)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02029">windows/rexxutil.cpp:2029</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a6ba3cd3a913e871f79c104129cb9ceb3"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a6ba3cd3a913e871f79c104129cb9ceb3">RAMDISK</a></div><div class="ttdeci">#define RAMDISK</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00212">windows/rexxutil.cpp:212</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a6e9ceaba82ebbe3b12d1b23aa029e0b1"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a6e9ceaba82ebbe3b12d1b23aa029e0b1">isWindowsVersion</a></div><div class="ttdeci">static bool isWindowsVersion(DWORD major, DWORD minor, unsigned int sp, unsigned int type, unsigned int condition)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00430">windows/rexxutil.cpp:430</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a7063b4325a083ec0efd84153ed2b695f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a7063b4325a083ec0efd84153ed2b695f">getPath</a></div><div class="ttdeci">static bool getPath(RexxCallContext *c, char *fSpec, char **path, char *filename, size_t *pathLen)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02537">windows/rexxutil.cpp:2537</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a73a859def741d7f37ff402604263c943"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a73a859def741d7f37ff402604263c943">SysStemSort</a></div><div class="ttdeci">size_t RexxEntry SysStemSort(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l05600">windows/rexxutil.cpp:5600</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a744938a8228e39320c63be371291edc1"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a744938a8228e39320c63be371291edc1">SysLoadFuncs</a></div><div class="ttdeci">size_t RexxEntry SysLoadFuncs(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03439">windows/rexxutil.cpp:3439</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a779a231240dce6d3984b74c927665585"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a779a231240dce6d3984b74c927665585">neededSize</a></div><div class="ttdeci">size_t neededSize(size_t need, size_t have)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01603">windows/rexxutil.cpp:1603</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a7b9510a9bed0a8609bba2297edd0ed64"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a7b9510a9bed0a8609bba2297edd0ed64">SysCls</a></div><div class="ttdeci">size_t RexxEntry SysCls(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01029">windows/rexxutil.cpp:1029</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a80754ae58acc97441c981a0dcfa41784"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a80754ae58acc97441c981a0dcfa41784">FOUNDFILE_BUF_LEN</a></div><div class="ttdeci">#define FOUNDFILE_BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00254">windows/rexxutil.cpp:254</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a81da4fa77ffcb61150943958eea47cd1"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a81da4fa77ffcb61150943958eea47cd1">SORT_ASCENDING</a></div><div class="ttdeci">#define SORT_ASCENDING</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00240">windows/rexxutil.cpp:240</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8468fc5c1c06493766b86dbf139a06ea"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8468fc5c1c06493766b86dbf139a06ea">CloseFile</a></div><div class="ttdeci">void CloseFile(GetFileData *filedata)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00617">windows/rexxutil.cpp:617</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a857514d3bc153b3c607aa02430965307"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a857514d3bc153b3c607aa02430965307">MAX_CREATEPROCESS_CMDLINE</a></div><div class="ttdeci">#define MAX_CREATEPROCESS_CMDLINE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00201">windows/rexxutil.cpp:201</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a86965da6e034d2ecefa88ff3c2d213cc"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a86965da6e034d2ecefa88ff3c2d213cc">NO_UTIL_ERROR</a></div><div class="ttdeci">#define NO_UTIL_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00333">windows/rexxutil.cpp:333</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a87c3675528926b05b45c2c52e4d2f61a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a87c3675528926b05b45c2c52e4d2f61a">expandNonPath2fullPath</a></div><div class="ttdeci">static bool expandNonPath2fullPath(RexxCallContext *c, char *fSpec, char **pPath, size_t *pPathLen, int *lastSlashPos)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02274">windows/rexxutil.cpp:2274</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a884bfc4d6d3c26f7d0ec0f40d039c073"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a884bfc4d6d3c26f7d0ec0f40d039c073">SysVolumeLabel</a></div><div class="ttdeci">size_t RexxEntry SysVolumeLabel(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l04574">windows/rexxutil.cpp:4574</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8983afb4113449c47f41a55a283a10a2"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8983afb4113449c47f41a55a283a10a2">MyOpenFile</a></div><div class="ttdeci">bool MyOpenFile(const char *file, GetFileData *filedata)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00549">windows/rexxutil.cpp:549</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8b05eb4e0ca4a808e31e0a9f64b6bfbc"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8b05eb4e0ca4a808e31e0a9f64b6bfbc">RxWinExec</a></div><div class="ttdeci">size_t RexxEntry RxWinExec(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l04179">windows/rexxutil.cpp:4179</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8bfc2021af2e7e6fbf2228a180d815a9"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8bfc2021af2e7e6fbf2228a180d815a9">CH_CR</a></div><div class="ttdeci">#define CH_CR</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00195">windows/rexxutil.cpp:195</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8cfc1e4e30c978d1e83e3eb208d4704f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8cfc1e4e30c978d1e83e3eb208d4704f">getBiggerBuffer</a></div><div class="ttdeci">static bool getBiggerBuffer(RexxCallContext *c, char **dBuf, size_t *nBuf, size_t needed, size_t nStaticBuffer)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01628">windows/rexxutil.cpp:1628</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8d2fa71ddc3683adb805fa0a0680731d"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8d2fa71ddc3683adb805fa0a0680731d">SORT_CASEIGNORE</a></div><div class="ttdeci">#define SORT_CASEIGNORE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00238">windows/rexxutil.cpp:238</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8e2d43c32a5b15f4f691016911b418dc"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8e2d43c32a5b15f4f691016911b418dc">SysGetErrortext</a></div><div class="ttdeci">size_t RexxEntry SysGetErrortext(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03474">windows/rexxutil.cpp:3474</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8e8620ee2f273dd41763f510f939f6ae"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8e8620ee2f273dd41763f510f939f6ae">RexxRoutine3</a></div><div class="ttdeci">RexxRoutine3(RexxStringObject, SysTextScreenRead, int, row, int, col, OPTIONAL_int, len)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03951">windows/rexxutil.cpp:3951</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8f2d1bc0ebfe7e951cbdfaae730143c2"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8f2d1bc0ebfe7e951cbdfaae730143c2">WC_ERR_INVALID_CHARS</a></div><div class="ttdeci">#define WC_ERR_INVALID_CHARS</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00248">windows/rexxutil.cpp:248</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a8f324c8049bd9815f0137c01d7e04eeb"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a8f324c8049bd9815f0137c01d7e04eeb">SysIni</a></div><div class="ttdeci">size_t RexxEntry SysIni(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03183">windows/rexxutil.cpp:3183</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a905bac200e324b59c174b62407251311"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a905bac200e324b59c174b62407251311">DO_FILES</a></div><div class="ttdeci">#define DO_FILES</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00221">windows/rexxutil.cpp:221</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a9a8e700d56e7d858108b755ad3edb52e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a9a8e700d56e7d858108b755ad3edb52e">FREE</a></div><div class="ttdeci">#define FREE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00208">windows/rexxutil.cpp:208</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a9b6f54f47164af16463a98a1c5342841"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a9b6f54f47164af16463a98a1c5342841">SysWinEncryptFile</a></div><div class="ttdeci">size_t RexxEntry SysWinEncryptFile(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03531">windows/rexxutil.cpp:3531</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a9bcc5b47f981040a9256b2cb11459b67"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a9bcc5b47f981040a9256b2cb11459b67">RXSTEMDATA</a></div><div class="ttdeci">struct RxStemData RXSTEMDATA</div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_a9ea4a6e038359484e4f837e13931235b"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#a9ea4a6e038359484e4f837e13931235b">ExtendedChar</a></div><div class="ttdeci">static char ExtendedChar</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00320">windows/rexxutil.cpp:320</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa0404bdc143b8c96d8f09f38be3de977"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa0404bdc143b8c96d8f09f38be3de977">RNDFACTOR</a></div><div class="ttdeci">#define RNDFACTOR</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00198">windows/rexxutil.cpp:198</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa052465890b0e94573704f6bdd162c26"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa052465890b0e94573704f6bdd162c26">RexxRoutine0</a></div><div class="ttdeci">RexxRoutine0(int, SysClearRexxMacroSpace)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l04408">windows/rexxutil.cpp:4408</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa103e70ed4303627d9eb1a9b3cb2a084"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa103e70ed4303627d9eb1a9b3cb2a084">SysDropFuncs</a></div><div class="ttdeci">size_t RexxEntry SysDropFuncs(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01405">windows/rexxutil.cpp:1405</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa1bef0fc54efabb9b00ed4300eb55d08"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa1bef0fc54efabb9b00ed4300eb55d08">FOUNDFILELINE_BUF_LEN</a></div><div class="ttdeci">#define FOUNDFILELINE_BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00257">windows/rexxutil.cpp:257</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa34ca575266a3f4b79b915c067dc275e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa34ca575266a3f4b79b915c067dc275e">SORT_CASESENSITIVE</a></div><div class="ttdeci">#define SORT_CASESENSITIVE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00237">windows/rexxutil.cpp:237</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa482ee7aac998fef8df1ba15360b2548"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa482ee7aac998fef8df1ba15360b2548">EDITABLE_TIME</a></div><div class="ttdeci">#define EDITABLE_TIME</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00223">windows/rexxutil.cpp:223</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa577bd9dd9463fe358b0eada0fcd44fd"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa577bd9dd9463fe358b0eada0fcd44fd">newAttr</a></div><div class="ttdeci">static uint32_t newAttr(int32_t *mask, uint32_t attr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01724">windows/rexxutil.cpp:1724</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa7768c7412471a88c3cb717fb1d32c0a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa7768c7412471a88c3cb717fb1d32c0a">nullStringException</a></div><div class="ttdeci">void nullStringException(RexxThreadContext *c, CSTRING fName, size_t pos)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00384">windows/rexxutil.cpp:384</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aa7d955f6716c7a050f227f023a68378e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aa7d955f6716c7a050f227f023a68378e">illegalFileNameChars</a></div><div class="ttdeci">static bool illegalFileNameChars(char *fSpec)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02930">windows/rexxutil.cpp:2930</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aac1f74a2a44349000b99fe6511e7a04f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aac1f74a2a44349000b99fe6511e7a04f">REMOVABLE</a></div><div class="ttdeci">#define REMOVABLE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00213">windows/rexxutil.cpp:213</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aadd168e82abdb8bad10a39fc4915309c"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aadd168e82abdb8bad10a39fc4915309c">RexxRoutine5</a></div><div class="ttdeci">RexxRoutine5(uint32_t, SysFileTree, CSTRING, fSpec, RexxStemObject, files, OPTIONAL_CSTRING, opts, OPTIONAL_CSTRING, targetAttr, OPTIONAL_CSTRING, newAttr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03006">windows/rexxutil.cpp:3006</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aade4ab4ab239c0bceb5bcee31210b26e"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aade4ab4ab239c0bceb5bcee31210b26e">SysGetKey</a></div><div class="ttdeci">size_t RexxEntry SysGetKey(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03108">windows/rexxutil.cpp:3108</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_abad96b5cafd0998ce7fd5b944ecdb305"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#abad96b5cafd0998ce7fd5b944ecdb305">SysFileSearch</a></div><div class="ttdeci">size_t RexxEntry SysFileSearch(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01445">windows/rexxutil.cpp:1445</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_abc3b77de14a663c431be8eb5d662534d"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#abc3b77de14a663c431be8eb5d662534d">mystrstr</a></div><div class="ttdeci">char * mystrstr(const char *haystack, const char *needle, size_t hlen, size_t nlen, bool sensitive)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00828">windows/rexxutil.cpp:828</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_abc4cf764e7e3a104c541e6a2c9feeccd"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#abc4cf764e7e3a104c541e6a2c9feeccd">SysFileSystemType</a></div><div class="ttdeci">size_t RexxEntry SysFileSystemType(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l04508">windows/rexxutil.cpp:4508</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_abcc1848edcb5c704edb90e565fabfbfb"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#abcc1848edcb5c704edb90e565fabfbfb">P_GDFSE</a></div><div class="ttdeci">BOOL(WINAPI * P_GDFSE)(LPCTSTR, PULARGE_INTEGER, PULARGE_INTEGER, PULARGE_INTEGER)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00325">windows/rexxutil.cpp:325</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_abcd0a22ee4346cad5706adb6d2119429"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#abcd0a22ee4346cad5706adb6d2119429">USED</a></div><div class="ttdeci">#define USED</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00207">windows/rexxutil.cpp:207</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_abd39eb7c47cb01d7b35816a79c6a5c4a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#abd39eb7c47cb01d7b35816a79c6a5c4a">FILETIME_BUF_LEN</a></div><div class="ttdeci">#define FILETIME_BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00255">windows/rexxutil.cpp:255</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_ac0c299988aa45f396d7e7296bfa59851"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#ac0c299988aa45f396d7e7296bfa59851">RECURSE</a></div><div class="ttdeci">#define RECURSE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00219">windows/rexxutil.cpp:219</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_ac8e587038055e4f6b6674d01d0b99058"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#ac8e587038055e4f6b6674d01d0b99058">MAX_ENVVAR</a></div><div class="ttdeci">#define MAX_ENVVAR</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00199">windows/rexxutil.cpp:199</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aca01c32b5907ac2ba7c5da1741aa085f"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aca01c32b5907ac2ba7c5da1741aa085f">SysWinVer</a></div><div class="ttdeci">size_t RexxEntry SysWinVer(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03621">windows/rexxutil.cpp:3621</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_accb279e5c95197bb20c3bdd3da404a65"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#accb279e5c95197bb20c3bdd3da404a65">getPathBuffer</a></div><div class="ttdeci">static char * getPathBuffer(RexxCallContext *context, size_t fSpecLen, size_t *pathLen)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02892">windows/rexxutil.cpp:2892</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_acda2338325b3044d2e9cae8c83de6a8b"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#acda2338325b3044d2e9cae8c83de6a8b">SORT_DECENDING</a></div><div class="ttdeci">#define SORT_DECENDING</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00241">windows/rexxutil.cpp:241</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_acf0a46c8a6b68267ae16d6fe597f9f98"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#acf0a46c8a6b68267ae16d6fe597f9f98">RETVAL</a></div><div class="ttdeci">#define RETVAL(retc)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00359">windows/rexxutil.cpp:359</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_ad90439a5509c675aa2831862c06eb6f2"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#ad90439a5509c675aa2831862c06eb6f2">goodOpts</a></div><div class="ttdeci">static bool goodOpts(RexxCallContext *c, char *opts, uint32_t *pOpts)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02602">windows/rexxutil.cpp:2602</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_adada93f8bb67eb09cc09eaf8fa985c6a"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">INVALID_ROUTINE</a></div><div class="ttdeci">#define INVALID_ROUTINE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00347">windows/rexxutil.cpp:347</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_adb30d8462f397fcbb11dd7b1d5b5c0a9"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#adb30d8462f397fcbb11dd7b1d5b5c0a9">sameAttr</a></div><div class="ttdeci">static bool sameAttr(int32_t *mask, uint32_t attr, uint32_t options)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l01656">windows/rexxutil.cpp:1656</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_ae4d961e7dafe171134d03b2c3a1f3897"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#ae4d961e7dafe171134d03b2c3a1f3897">pGetDiskFreeSpaceEx</a></div><div class="ttdeci">static P_GDFSE pGetDiskFreeSpaceEx</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00327">windows/rexxutil.cpp:327</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_ae64f2f78f77dc2698028906d97e18751"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#ae64f2f78f77dc2698028906d97e18751">NAME_ONLY</a></div><div class="ttdeci">#define NAME_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00222">windows/rexxutil.cpp:222</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_ae7800c48813cfde08f4ad9334789064b"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#ae7800c48813cfde08f4ad9334789064b">RXIGNORE</a></div><div class="ttdeci">#define RXIGNORE</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00226">windows/rexxutil.cpp:226</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aebba4ef85ab647b2135bad9567fa51d3"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aebba4ef85ab647b2135bad9567fa51d3">SysTempFileName</a></div><div class="ttdeci">size_t RexxEntry SysTempFileName(const char *name, size_t numargs, CONSTRXSTRING args[], const char *queuename, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l03908">windows/rexxutil.cpp:3908</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aec33b06d90ac834899b86039851abced"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aec33b06d90ac834899b86039851abced">memupper</a></div><div class="ttdeci">void memupper(char *location, size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00529">windows/rexxutil.cpp:529</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aefc28d36acacd154db483ba3270e0b37"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aefc28d36acacd154db483ba3270e0b37">outOfMemoryException</a></div><div class="ttdeci">void outOfMemoryException(RexxThreadContext *c)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00370">windows/rexxutil.cpp:370</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_af0535563767484a571323c5b12f840e3"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#af0535563767484a571323c5b12f840e3">canUseWideCharFlags</a></div><div class="ttdeci">static bool canUseWideCharFlags(UINT cp)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l05996">windows/rexxutil.cpp:5996</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_af5783b65f7e7692b546465d7e0cfaae8"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#af5783b65f7e7692b546465d7e0cfaae8">systemServiceExceptionCode</a></div><div class="ttdeci">static void systemServiceExceptionCode(RexxThreadContext *c, CSTRING api, uint32_t rc)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00404">windows/rexxutil.cpp:404</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_afca154868d5055477f8ec8a5cc3eb1c1"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#afca154868d5055477f8ec8a5cc3eb1c1">ERROR_FILEOPEN</a></div><div class="ttdeci">#define ERROR_FILEOPEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00335">windows/rexxutil.cpp:335</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_afe308f9c1d5692562360266352823789"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#afe308f9c1d5692562360266352823789">FILEATTR_BUF_LEN</a></div><div class="ttdeci">#define FILEATTR_BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00256">windows/rexxutil.cpp:256</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_afe9206b49de233d2bde1c1a031672236"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#afe9206b49de233d2bde1c1a031672236">ReadNextBuffer</a></div><div class="ttdeci">bool ReadNextBuffer(GetFileData *filedata)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l00631">windows/rexxutil.cpp:631</a></div></div>
<div class="ttc" id="awindows_2rexxutil_8cpp_html_aff8064d281bdc392e8186b81f986e6a2"><div class="ttname"><a href="windows_2rexxutil_8cpp.html#aff8064d281bdc392e8186b81f986e6a2">goodMask</a></div><div class="ttdeci">static bool goodMask(RexxCallContext *c, char *msk, int32_t *mask)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxutil_8cpp_source.html#l02675">windows/rexxutil.cpp:2675</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_8b29bd360d363874c010699c0e4edfe4.html">executor</a></li><li class="navelem"><a class="el" href="dir_b12c9cdd073ecc75d378afe044a8807c.html">sandbox</a></li><li class="navelem"><a class="el" href="dir_6f8e204b311fad1e21be914fb6af8fc9.html">jlf</a></li><li class="navelem"><a class="el" href="dir_4796bfee7d29ff8f3ba63e631cf48035.html">trunk</a></li><li class="navelem"><a class="el" href="dir_810b14902c641731e177eb53eeb0aca8.html">extensions</a></li><li class="navelem"><a class="el" href="dir_ed6260cdad95d33bad1e950aadf28838.html">rexxutil</a></li><li class="navelem"><a class="el" href="dir_da82a56450c1465ee658593a35899280.html">platform</a></li><li class="navelem"><a class="el" href="dir_92c19dc0c7fc193ae158da71f240e089.html">windows</a></li><li class="navelem"><a class="el" href="windows_2rexxutil_8cpp.html">rexxutil.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">executor.master</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
