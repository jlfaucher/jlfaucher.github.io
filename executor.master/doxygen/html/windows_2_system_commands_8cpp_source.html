<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>executor.master: SystemCommands.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('windows_2_system_commands_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">windows/SystemCommands.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="windows_2_system_commands_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2009 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* http://www.oorexx.org/license.html                          */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/*  wincmd.c - C methods for handling calls to system exits and subcommand    */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/*             handlers.                                                      */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*  C methods:                                                                */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/*    SysCommand     - Method to invoke a subcommand handler                  */</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">/*  Internal routines:                                                        */</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/*    sys_command - Run a command through system command processor.           */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span>                    <span class="comment">/* Get strcpy, strcat, etc.       */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;process.h&gt;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_core_8h.html">RexxCore.h</a>&quot;</span>                    <span class="comment">/* global REXX declarations     */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_string_class_8hpp.html">StringClass.hpp</a>&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_activity_8hpp.html">RexxActivity.hpp</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_activity_manager_8hpp.html">ActivityManager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_protected_object_8hpp.html">ProtectedObject.hpp</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_internal_apis_8h.html">RexxInternalApis.h</a>&quot;</span>          <span class="comment">/* Get private REXXAPI API&#39;s         */</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="windows_2_system_interpreter_8hpp.html">SystemInterpreter.hpp</a>&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_interpreter_instance_8hpp.html">InterpreterInstance.hpp</a>&quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="windows_2_sys_interpreter_instance_8hpp.html">SysInterpreterInstance.hpp</a>&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#af8b26a786d53e6b7f7cecd5aaed426a2">   63</a></span>&#160;<span class="preprocessor">#define CMDBUFSIZE32S 260              </span><span class="comment">/* Max size of executable cmd     */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a12571d967b8aa851a674bca98e3ce741">   64</a></span>&#160;<span class="preprocessor">#define CMDBUFSIZENT 8092              </span><span class="comment">/* Max size of executable cmd     */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#ab2ae233d238e79adf66d9ad253bdc56f">   65</a></span>&#160;<span class="preprocessor">#define CMDDEFNAME32S &quot;COMMAND.COM&quot;</span>    <span class="comment">/* Default Win 95   cmd handler   */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#af158ec5c6f79e087d6c8098aa9a1f3cb">   66</a></span>&#160;<span class="preprocessor">#define CMDDEFNAMENT &quot;CMD.EXE&quot;</span>         <span class="comment">/* Default Win NT   cmd handler   */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#ac5f4cf1c989af592617184f7a7e5c372">   67</a></span>&#160;<span class="preprocessor">#define UNKNOWN_COMMAND 1              </span><span class="comment">/* unknown command return code    */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#include &quot;direct.h&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a0a85173c80294c4f706b3f0c4007a654">   70</a></span>&#160;<span class="preprocessor">#define SYSENV &quot;CMD&quot;</span>                   <span class="comment">/* Default windows cmd environment*/</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a1235f65c4930309556ce62155f324b85">   71</a></span>&#160;<span class="preprocessor">#define COMSPEC &quot;COMSPEC&quot;</span>              <span class="comment">/*      cmd handler env name      */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a6a826c01ea925bae9cc70f696b144862">   73</a></span>&#160;<span class="preprocessor">#define SHOWWINDOWFLAGS SW_HIDE        </span><span class="comment">// determines visibility of cmd</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                       <span class="comment">// window SHOW, HIDE etc...</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                       <span class="comment">// function prototypes</span><span class="comment"></span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> * Retrieve the globally default initial address.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> * @return The string name of the default address.</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<a class="code" href="class_rexx_string.html">RexxString</a> *<a class="code" href="class_system_interpreter.html#a7740c59653d2ea0c7599477d458d554a">SystemInterpreter::getDefaultAddressName</a>()</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">return</span> OREF_INITIALADDRESS;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/* Handle &quot;SET XX=YYY&quot; command in same process */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a021f53ec302c805d15cb963a03fb0d41">   88</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2_system_commands_8cpp.html#a021f53ec302c805d15cb963a03fb0d41">sys_process_set</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> *command, <span class="keyword">const</span> <span class="keywordtype">char</span> * cmd, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> &amp;rc)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    rc = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * eqsign;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * st;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">char</span> name[256];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">char</span> value[4096];</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    eqsign = strchr(cmd, <span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (!eqsign)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    st = &amp;cmd[4];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">while</span> ((*st) &amp;&amp; (*st == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        st++;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (st == eqsign)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    strncpy(name, st, eqsign-st);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    name[eqsign-st]=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (ExpandEnvironmentStrings(eqsign+1, value, 4095) &amp;&amp; SetEnvironmentVariable(name,value))</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        rc = context-&gt;False();     <span class="comment">// just return a zero</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, context-&gt;String(command), <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>, context-&gt;WholeNumberToObject(GetLastError()));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">/* Returns a copy of s without quotes */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">  126</a></span>&#160;<span class="keywordtype">char</span> *<a class="code" href="windows_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">unquote</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">char</span> *unquoted = (<span class="keywordtype">char</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * strlen(s) + 1);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">if</span> (unquoted != NULL)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordtype">char</span> *p = unquoted;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">while</span> ( (*p = *s++) != 0 )</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                p++;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        *p = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">return</span> unquoted;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">/* Handle &quot;CD XXX&quot; command in same process */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#ab5be8821f2dff7028a7837479b0d7791">  147</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2_system_commands_8cpp.html#ab5be8821f2dff7028a7837479b0d7791">sys_process_cd</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> *command, <span class="keyword">const</span> <span class="keywordtype">char</span> * cmd, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> &amp;res)</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;{</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * st;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    res = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    st = &amp;cmd[3];</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">while</span> ((*st) &amp;&amp; (*st == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        st++;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!*st)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">if</span> ((strlen(st) == 2) &amp;&amp; (st[1] == <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        rc = _chdrive(toupper( *st ) - <span class="charliteral">&#39;A&#39;</span> + 1);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordtype">char</span> *unquoted = <a class="code" href="windows_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">unquote</a>(st);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (unquoted == NULL)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        rc = _chdir(unquoted);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        free(unquoted);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, context-&gt;String(command), <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>, context-&gt;WholeNumberToObject(GetLastError()));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        res = context-&gt;False();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">/*-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> | Name:       sysCommandNT                                                   |</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> |                                                                            |</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> | Arguments:  cmd - Command to be executed                                   |</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> |                                                                            |</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> | Returned:   rc - Return Code                                               |</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> |                  Note: if CreateProcess fails return GetLastError code     |</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> |                  else return rc from executed command                      |</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> |                                                                            |</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> | Notes:      Handles processing of a system command on a Windows NT system  |</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> |                                                                      |</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">  ----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#a0677cc47da77924e557be6df899c632b">  202</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="windows_2_system_commands_8cpp.html#a0677cc47da77924e557be6df899c632b">sysCommandNT</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> *command, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmdstring_ptr, <span class="keywordtype">bool</span> direct, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> &amp;result)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    DWORD rc;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    STARTUPINFO siStartInfo;                  <span class="comment">// process startup info</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    PROCESS_INFORMATION piProcInfo;           <span class="comment">// returned process info</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">char</span> ctitle[256];</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    DWORD creationFlags;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">bool</span> titleChanged;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    ZeroMemory(&amp;siStartInfo, <span class="keyword">sizeof</span>(siStartInfo));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    ZeroMemory(&amp;piProcInfo, <span class="keyword">sizeof</span>(piProcInfo));</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">    /****************************************************************************/</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">/* Invoke the system command handler to execute the command                 */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">    /****************************************************************************/</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    siStartInfo.cb = <span class="keyword">sizeof</span>(siStartInfo);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    siStartInfo.hStdInput = GetStdHandle(STD_INPUT_HANDLE);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    siStartInfo.hStdOutput = GetStdHandle(STD_OUTPUT_HANDLE);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    siStartInfo.hStdError = GetStdHandle(STD_ERROR_HANDLE);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    titleChanged = GetConsoleTitle(ctitle, 255) != 0;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    siStartInfo.lpTitle = (LPSTR)cmdstring_ptr;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    creationFlags = GetPriorityClass(GetCurrentProcess()) | CREATE_NEW_PROCESS_GROUP;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (!siStartInfo.hStdInput &amp;&amp; !siStartInfo.hStdOutput &amp;&amp; !titleChanged)  <span class="comment">/* is REXXHIDE running without console */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (!direct)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            siStartInfo.wShowWindow = <a class="code" href="windows_2_system_commands_8cpp.html#a6a826c01ea925bae9cc70f696b144862">SHOWWINDOWFLAGS</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            siStartInfo.dwFlags |= STARTF_USESHOWWINDOW;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="class_system_interpreter.html#a72768e7c52aef38a6971ad86963802fc">SystemInterpreter::explicitConsole</a>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            creationFlags |= CREATE_NEW_CONSOLE; <span class="comment">/* new console if CMD ord COMMAND was specified */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">else</span>              <span class="comment">/* just use standard handles if we are running in a console */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">if</span> (direct)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            siStartInfo.dwFlags = STARTF_USESTDHANDLES; <span class="comment">/* no SW_HIDE for direct commands */</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            siStartInfo.dwFlags = STARTF_USESHOWWINDOW | STARTF_USESTDHANDLES;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        siStartInfo.wShowWindow = <a class="code" href="windows_2_system_commands_8cpp.html#a6a826c01ea925bae9cc70f696b144862">SHOWWINDOWFLAGS</a>;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">if</span> (CreateProcess(NULL,           <span class="comment">// address of module name</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                      (LPSTR)cmdstring_ptr,<span class="comment">// address of command line</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                      NULL,                <span class="comment">// address of process security attrs</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                      NULL,                <span class="comment">// address of thread security attrs</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                      <span class="keyword">true</span>,                <span class="comment">// new process inherits handles?</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                      <span class="comment">// creation flags</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                      creationFlags,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                      NULL,                <span class="comment">// address of new environment block</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                      NULL,                <span class="comment">// address of current directory name</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                      &amp;siStartInfo,        <span class="comment">// address of STARTUPINFO</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                      &amp;piProcInfo))        <span class="comment">// address of PROCESS_INFORMATION</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">// CreateProcess succeeded, now wait for the process to end.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">if</span> (titleChanged)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            SetConsoleTitle(siStartInfo.lpTitle);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <a class="code" href="class_system_interpreter.html#a8af46bfa4d07229a432957782591efdb">SystemInterpreter::exceptionHostProcess</a> = piProcInfo.hProcess;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="class_system_interpreter.html#ab5a55dfa94b0b1bc90653ad33b369507">SystemInterpreter::exceptionHostProcessId</a> = piProcInfo.dwProcessId;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (WAIT_FAILED != WaitForSingleObject ( piProcInfo.hProcess, INFINITE ) )</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">// Completed ok, get termination rc</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            GetExitCodeProcess(piProcInfo.hProcess, &amp;rc);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            rc = GetLastError();    <span class="comment">// Bad termination, get error code</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            context-&gt;RaiseCondition(<span class="stringliteral">&quot;FAILURE&quot;</span>, context-&gt;String(command), <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>, context-&gt;WholeNumberToObject(rc));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            result = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// The new process must be detached so it will be discarded</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="comment">// automatically after execution.  The thread must be closed first</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (titleChanged)</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            SetConsoleTitle(ctitle);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        CloseHandle(piProcInfo.hThread);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        CloseHandle(piProcInfo.hProcess);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="comment">// return this as a failure for now ... the caller might try this again</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// later</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <a class="code" href="class_system_interpreter.html#a8af46bfa4d07229a432957782591efdb">SystemInterpreter::exceptionHostProcess</a> = NULL;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="class_system_interpreter.html#ab5a55dfa94b0b1bc90653ad33b369507">SystemInterpreter::exceptionHostProcessId</a> = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, context-&gt;String(command), <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>, context-&gt;Int32ToObject(rc));</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        result = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// this is a zero return</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    result = context-&gt;False();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/* Name:       sys_command                                                    */</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">/* Arguments:  cmd - Command to be executed                                   */</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">/* Returned:   rc - Return Code                                               */</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">/*                  Note: if non-zero rc from DosExecPgm return DosExecPgm rc */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">/*                  else if non-zero termination code from system return code */</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">/*                  else return rc from executed command                      */</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">/* Notes:      Handles processing of a system command.  Finds location of     */</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">/*             system command handler using the COMSPEC environment variable  */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/*             and invokes the system specific routine which invokes the      */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">/*             command handler with the command to be executed                */</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="windows_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">  330</a></span>&#160;<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="windows_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>(<a class="code" href="struct_rexx_exit_context__.html">RexxExitContext</a> *context, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> address, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> command)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;{</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// address the command information</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd = context-&gt;StringData(command);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *cl_opt = <span class="stringliteral">&quot; /c &quot;</span>; <span class="comment">// The &quot;/c&quot; opt for system commandd handler</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *interncmd;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// Remove the &quot;quiet sign&quot; if present</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span> (cmd[0] == <span class="charliteral">&#39;@&#39;</span>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        interncmd = cmd + 1;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        interncmd = cmd;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">/* Check for redirection symbols, ignore them when enclosed in double</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">     * quotes.  If there are more than 2 double qoutes, cmd.exe strips off the</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">     * first and last.  To preserve what the user sent to us, we count the</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">     * double quotes, and, if more than two, add a double quote to the front and</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">     * end of the string.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordtype">size_t</span> quoteCount    = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordtype">bool</span>   noDirectInvoc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">bool</span>   inQuotes      = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; strlen(interncmd); i++)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> (interncmd[i] == <span class="charliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            inQuotes = !inQuotes;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            quoteCount++;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="comment">/* if we&#39;re in the unquoted part and the current character is one of */</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">/* the redirection characters or the &amp; for multiple commands then we */</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="comment">/* will no longer try to invoke the command directly                 */</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">if</span> (!inQuotes &amp;&amp; (strchr(<span class="stringliteral">&quot;&lt;&gt;|&amp;&quot;</span>, interncmd[i]) != NULL))</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                noDirectInvoc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">if</span> ( quoteCount &gt; 2 )</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    i = 0; <span class="comment">// reset to zero for next usage</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// scan for the first non-whitespace character</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">size_t</span> j = 0;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">while</span> (interncmd[j] == <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        j++;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> result = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span> (!noDirectInvoc)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordtype">char</span> tmp[8];</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        strncpy(tmp, &amp;interncmd[j], 4);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        tmp[4] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">if</span> (!stricmp(<span class="stringliteral">&quot;set &quot;</span>,tmp))</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="windows_2_system_commands_8cpp.html#a021f53ec302c805d15cb963a03fb0d41">sys_process_set</a>(context, cmd, &amp;interncmd[j], result))</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            strncpy(tmp, &amp;interncmd[j], 3);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            tmp[3] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">if</span> (!stricmp(<span class="stringliteral">&quot;cd &quot;</span>,tmp))</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="windows_2_system_commands_8cpp.html#ab5be8821f2dff7028a7837479b0d7791">sys_process_cd</a>(context, cmd, &amp;interncmd[j], result))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            {   <span class="comment">// Check if the command is to change drive</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="keywordflow">if</span> ((tmp[1] == <span class="charliteral">&#39;:&#39;</span>) &amp;&amp; ((tmp[2] == <span class="charliteral">&#39; &#39;</span>) || (!tmp[2])))</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="keywordtype">int</span> code = _chdrive(toupper( tmp[0] ) - <span class="charliteral">&#39;A&#39;</span> + 1);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    <span class="keywordflow">if</span> (code != 0)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        context-&gt;RaiseCondition(<span class="stringliteral">&quot;ERROR&quot;</span>, command, <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>, context-&gt;WholeNumberToObject(code));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        <span class="comment">// 0 result.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        <span class="keywordflow">return</span> context-&gt;False();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    <span class="comment">// Check if a START command is specified, if so do not</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    <span class="comment">// invoke the command directly.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    strncpy(tmp, &amp;interncmd[j], 6);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    tmp[6] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    noDirectInvoc = stricmp(<span class="stringliteral">&quot;start &quot;</span>,tmp) == 0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *sys_cmd_handler; <span class="comment">// Pointer to system cmd handler</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// Determine the system command interpreter.  This could be the full path</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// name if COMSPEC is set, or a default name if it isn&#39;t.  We no longer</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// suport Windows 95, so the default will be cmd.exe. But, it is still</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// possible for people to set COMSPEC to command.com, so we could end up</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// with command.com</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> ( (sys_cmd_handler = getenv(<a class="code" href="windows_2_system_commands_8cpp.html#a1235f65c4930309556ce62155f324b85">COMSPEC</a>)) == NULL )</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        sys_cmd_handler = <a class="code" href="windows_2_system_commands_8cpp.html#af158ec5c6f79e087d6c8098aa9a1f3cb">CMDDEFNAMENT</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">// Determine the maximum possible buffer size needed to pass the final</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// command to sysCommandNT().</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordtype">size_t</span> maxBufferSize = strlen(sys_cmd_handler) + 1</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                           + strlen(cl_opt)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                           + strlen(&amp;interncmd[j])</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                           + 2   <span class="comment">// Two possible extra quotes</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                           + 1;  <span class="comment">// Terminating null</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordtype">char</span>  cmdstring[<a class="code" href="windows_2_system_commands_8cpp.html#a12571d967b8aa851a674bca98e3ce741">CMDBUFSIZENT</a>];    <span class="comment">// Default static buffer.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordtype">char</span> *cmdstring_ptr = cmdstring;  <span class="comment">// Will point to static buffer.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span> ( maxBufferSize &gt; <a class="code" href="windows_2_system_commands_8cpp.html#a12571d967b8aa851a674bca98e3ce741">CMDBUFSIZENT</a> )</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">// Allocate dynamic memory and set cmdstring_ptr to point to it.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        cmdstring_ptr = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, maxBufferSize);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span> ( cmdstring_ptr == NULL )</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#a33b78238ad2d773aa0b826ca3ee19194">Rexx_Error_System_resources_user_defined</a>,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                     context-&gt;String(<span class="stringliteral">&quot;Failed to allocate memory&quot;</span>));</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">// We want maxBufferSize to relect the actual size of the buffer we are</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="comment">// using so that we can test the return from SearchPath()</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        maxBufferSize = <a class="code" href="windows_2_system_commands_8cpp.html#a12571d967b8aa851a674bca98e3ce741">CMDBUFSIZENT</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="class_system_interpreter.html#a31d5b5290dd5514ab1cc45f60a0eeefc">SystemInterpreter::exceptionConsole</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="class_system_interpreter.html#a72768e7c52aef38a6971ad86963802fc">SystemInterpreter::explicitConsole</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// Check whether or not the command to invoke is cmd.exe or command.com</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    _strupr(strcpy(cmdstring_ptr, &amp;interncmd[j]));</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">bool</span> searchFile = strstr(cmdstring_ptr, <span class="stringliteral">&quot;CMD&quot;</span>) != NULL;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (searchFile)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">if</span> (cmdstring_ptr[0] == <span class="charliteral">&#39;\&quot;&#39;</span>)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            cmdstring_ptr++;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">while</span> (cmdstring_ptr[i] &amp;&amp; (cmdstring_ptr[i] != <span class="charliteral">&#39;\&quot;&#39;</span>))</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                i++;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            cmdstring_ptr[i]=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmdstring_ptr[0] == <span class="charliteral">&#39;\&#39;&#39;</span>)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            cmdstring_ptr++;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">while</span> (cmdstring_ptr[i] &amp;&amp; (cmdstring_ptr[i] != <span class="charliteral">&#39;\&#39;&#39;</span>))</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                i++;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            cmdstring_ptr[i]=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">while</span> (cmdstring_ptr[i] &amp;&amp; (cmdstring_ptr[i] != <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                i++;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            cmdstring_ptr[i]=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        LPSTR filepart;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> count = <a class="code" href="unix_2rexxutil_8cpp.html#ad302ee7ca379dfc14324dcc41cb8d18a">SearchPath</a>(NULL, cmdstring_ptr, <span class="stringliteral">&quot;.EXE&quot;</span>, (<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)(maxBufferSize - 1), cmdstring, &amp;filepart);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordtype">bool</span> fileFound = count != 0 &amp;&amp; count &lt;= maxBufferSize;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">// Set pointer back again to cmd buffer (might have been increased)</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        cmdstring_ptr = cmdstring;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">if</span> (fileFound &amp;&amp; !stricmp(sys_cmd_handler, cmdstring_ptr))</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <a class="code" href="class_system_interpreter.html#a31d5b5290dd5514ab1cc45f60a0eeefc">SystemInterpreter::exceptionConsole</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <a class="code" href="class_system_interpreter.html#a72768e7c52aef38a6971ad86963802fc">SystemInterpreter::explicitConsole</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// First check whether we can run the command directly as a program. (There</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// can be no file redirection when not using cmd.exe or command.com)</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_system_interpreter.html#a72768e7c52aef38a6971ad86963802fc">SystemInterpreter::explicitConsole</a> || !noDirectInvoc)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="comment">// Invoke this directly.  If we fail, we fall through and try again.</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="windows_2_system_commands_8cpp.html#a0677cc47da77924e557be6df899c632b">sysCommandNT</a>(context, cmd, &amp;interncmd[j], <span class="keyword">true</span>, result))</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">if</span> ( cmdstring_ptr != cmdstring )</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                <span class="comment">// Not pointing to static buffer so we need to free it.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                LocalFree(cmdstring_ptr);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">// We couldn&#39;t invoke the command directly, or we tried and failed.  So,</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// pass the command to cmd.exe or command.com.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// Start the command buffer with the system cmd handler</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    strcpy(cmdstring_ptr,sys_cmd_handler);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// Check whether or not the user specified the /k option.  If so do not use</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// the /c option.  The /k option can only be specified as the first</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// argument, and if used, keeps the command handler process open after the</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// command has finished.  Normally the /c option would be usee to close the</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// command handler process when the command is finished..</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span> (!( (strlen(interncmd) &gt; j+1) &amp;&amp; (interncmd[j] == <span class="charliteral">&#39;/&#39;</span>)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;           &amp;&amp; ((interncmd[j+1] == <span class="charliteral">&#39;k&#39;</span>) || (interncmd[j+1] == <span class="charliteral">&#39;K&#39;</span>))</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;           &amp;&amp; ((interncmd[j+2] == <span class="charliteral">&#39; &#39;</span>) || (interncmd[j+2] == <span class="charliteral">&#39;\0&#39;</span>)) ))</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        strcat(cmdstring_ptr,cl_opt);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <a class="code" href="class_system_interpreter.html#a31d5b5290dd5514ab1cc45f60a0eeefc">SystemInterpreter::exceptionConsole</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        strcat(cmdstring_ptr,<span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// Add cmd to be executed, possibly quoting it to preserve embedded quotes.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> ( quoteCount&gt; 2 )</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        strcat(cmdstring_ptr,<span class="stringliteral">&quot;\&quot;&quot;</span>);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        strcat(cmdstring_ptr,interncmd);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        strcat(cmdstring_ptr,<span class="stringliteral">&quot;\&quot;&quot;</span>);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        strcat(cmdstring_ptr,interncmd);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// Invoke the command</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="windows_2_system_commands_8cpp.html#a0677cc47da77924e557be6df899c632b">sysCommandNT</a>(context, cmd, cmdstring_ptr, <span class="keyword">false</span>, result))</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// Failed, get error code and return</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        context-&gt;RaiseCondition(<span class="stringliteral">&quot;FAILURE&quot;</span>, context-&gt;String(cmd), <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>, context-&gt;WholeNumberToObject(GetLastError()));</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">if</span> ( cmdstring_ptr != cmdstring )</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="comment">// Not pointing to static buffer so we need to free it.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            LocalFree(cmdstring_ptr);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> ( cmdstring_ptr != cmdstring )</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">// Not pointing to static buffer so we need to free it.</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        LocalFree(cmdstring_ptr);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="class_system_interpreter.html#a31d5b5290dd5514ab1cc45f60a0eeefc">SystemInterpreter::exceptionConsole</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"> * Register the standard system command handlers.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> * @param instance The created instance.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_sys_interpreter_instance.html#a7b868224b41c0f61b943bf04987a7d12">SysInterpreterInstance::registerCommandHandlers</a>(<a class="code" href="class_interpreter_instance.html">InterpreterInstance</a> *instance)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// Windows only has the single command environment, we also register this</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">// under &quot;&quot; for the default handler</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="class_sys_interpreter_instance.html#a3c9fcd0c5d745bf2661bd9e3445f7af5">instance</a>-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;CMD&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="windows_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <a class="code" href="class_sys_interpreter_instance.html#a3c9fcd0c5d745bf2661bd9e3445f7af5">instance</a>-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;COMMAND&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="windows_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <a class="code" href="class_sys_interpreter_instance.html#a3c9fcd0c5d745bf2661bd9e3445f7af5">instance</a>-&gt;<a class="code" href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">addCommandHandler</a>(<span class="stringliteral">&quot;&quot;</span>, (<a class="code" href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a>)<a class="code" href="windows_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a>);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="ttc" id="a_activity_manager_8hpp_html"><div class="ttname"><a href="_activity_manager_8hpp.html">ActivityManager.hpp</a></div></div>
<div class="ttc" id="a_interpreter_instance_8hpp_html"><div class="ttname"><a href="_interpreter_instance_8hpp.html">InterpreterInstance.hpp</a></div></div>
<div class="ttc" id="a_protected_object_8hpp_html"><div class="ttname"><a href="_protected_object_8hpp.html">ProtectedObject.hpp</a></div></div>
<div class="ttc" id="a_rexx_activity_8hpp_html"><div class="ttname"><a href="_rexx_activity_8hpp.html">RexxActivity.hpp</a></div></div>
<div class="ttc" id="a_rexx_core_8h_html"><div class="ttname"><a href="_rexx_core_8h.html">RexxCore.h</a></div></div>
<div class="ttc" id="a_rexx_internal_apis_8h_html"><div class="ttname"><a href="_rexx_internal_apis_8h.html">RexxInternalApis.h</a></div></div>
<div class="ttc" id="a_string_class_8hpp_html"><div class="ttname"><a href="_string_class_8hpp.html">StringClass.hpp</a></div></div>
<div class="ttc" id="aclass_interpreter_instance_html"><div class="ttname"><a href="class_interpreter_instance.html">InterpreterInstance</a></div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_instance_8hpp_source.html#l00055">InterpreterInstance.hpp:56</a></div></div>
<div class="ttc" id="aclass_interpreter_instance_html_a8e5cdb7cf93d6cdcf8ceda46d4e13d50"><div class="ttname"><a href="class_interpreter_instance.html#a8e5cdb7cf93d6cdcf8ceda46d4e13d50">InterpreterInstance::addCommandHandler</a></div><div class="ttdeci">void addCommandHandler(const char *name, const char *registeredName)</div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_instance_8cpp_source.html#l00779">InterpreterInstance.cpp:779</a></div></div>
<div class="ttc" id="aclass_rexx_string_html"><div class="ttname"><a href="class_rexx_string.html">RexxString</a></div><div class="ttdef"><b>Definition:</b> <a href="_string_class_8hpp_source.html#l00121">StringClass.hpp:121</a></div></div>
<div class="ttc" id="aclass_sys_interpreter_instance_html_a3c9fcd0c5d745bf2661bd9e3445f7af5"><div class="ttname"><a href="class_sys_interpreter_instance.html#a3c9fcd0c5d745bf2661bd9e3445f7af5">SysInterpreterInstance::instance</a></div><div class="ttdeci">InterpreterInstance * instance</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_sys_interpreter_instance_8hpp_source.html#l00064">unix/SysInterpreterInstance.hpp:64</a></div></div>
<div class="ttc" id="aclass_sys_interpreter_instance_html_a7b868224b41c0f61b943bf04987a7d12"><div class="ttname"><a href="class_sys_interpreter_instance.html#a7b868224b41c0f61b943bf04987a7d12">SysInterpreterInstance::registerCommandHandlers</a></div><div class="ttdeci">void registerCommandHandlers(InterpreterInstance *i)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00797">unix/SystemCommands.cpp:797</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_a31d5b5290dd5514ab1cc45f60a0eeefc"><div class="ttname"><a href="class_system_interpreter.html#a31d5b5290dd5514ab1cc45f60a0eeefc">SystemInterpreter::exceptionConsole</a></div><div class="ttdeci">static bool exceptionConsole</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_interpreter_8hpp_source.html#l00102">windows/SystemInterpreter.hpp:102</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_a72768e7c52aef38a6971ad86963802fc"><div class="ttname"><a href="class_system_interpreter.html#a72768e7c52aef38a6971ad86963802fc">SystemInterpreter::explicitConsole</a></div><div class="ttdeci">static bool explicitConsole</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_interpreter_8hpp_source.html#l00103">windows/SystemInterpreter.hpp:103</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_a7740c59653d2ea0c7599477d458d554a"><div class="ttname"><a href="class_system_interpreter.html#a7740c59653d2ea0c7599477d458d554a">SystemInterpreter::getDefaultAddressName</a></div><div class="ttdeci">static RexxString * getDefaultAddressName()</div><div class="ttdef"><b>Definition:</b> <a href="unix_2_system_commands_8cpp_source.html#l00101">unix/SystemCommands.cpp:101</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_a8af46bfa4d07229a432957782591efdb"><div class="ttname"><a href="class_system_interpreter.html#a8af46bfa4d07229a432957782591efdb">SystemInterpreter::exceptionHostProcess</a></div><div class="ttdeci">static HANDLE exceptionHostProcess</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_interpreter_8hpp_source.html#l00101">windows/SystemInterpreter.hpp:101</a></div></div>
<div class="ttc" id="aclass_system_interpreter_html_ab5a55dfa94b0b1bc90653ad33b369507"><div class="ttname"><a href="class_system_interpreter.html#ab5a55dfa94b0b1bc90653ad33b369507">SystemInterpreter::exceptionHostProcessId</a></div><div class="ttdeci">static ULONG exceptionHostProcessId</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_interpreter_8hpp_source.html#l00100">windows/SystemInterpreter.hpp:100</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a33b78238ad2d773aa0b826ca3ee19194"><div class="ttname"><a href="oorexxerrors_8h.html#a33b78238ad2d773aa0b826ca3ee19194">Rexx_Error_System_resources_user_defined</a></div><div class="ttdeci">#define Rexx_Error_System_resources_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00068">oorexxerrors.h:68</a></div></div>
<div class="ttc" id="arexx_8h_html_a64dfe004825692637e2075467179fcd9"><div class="ttname"><a href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a></div><div class="ttdeci">struct _RexxStringObject * RexxStringObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00128">rexx.h:128</a></div></div>
<div class="ttc" id="arexx_8h_html_a96e0cc5eda42aed364b05f3c493e07e8"><div class="ttname"><a href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a></div><div class="ttdeci">struct _RexxObjectPtr * RexxObjectPtr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00127">rexx.h:127</a></div></div>
<div class="ttc" id="arexx_8h_html_a9a119fa1e31a4af78dee3c12225b240a"><div class="ttname"><a href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a></div><div class="ttdeci">#define NULLOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00147">rexx.h:147</a></div></div>
<div class="ttc" id="arexx_8h_html_aec9d4b9410c6f3c46bcceec8c16e253d"><div class="ttname"><a href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a></div><div class="ttdeci">#define RexxEntry</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00412">rexx.h:412</a></div></div>
<div class="ttc" id="astruct_rexx_exit_context___html"><div class="ttname"><a href="struct_rexx_exit_context__.html">RexxExitContext_</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l02970">oorexxapi.h:2971</a></div></div>
<div class="ttc" id="aunix_2rexxapitypes_8h_html_a5212c3741a3e463415430503c49e2147"><div class="ttname"><a href="unix_2rexxapitypes_8h.html#a5212c3741a3e463415430503c49e2147">REXXPFN</a></div><div class="ttdeci">void * REXXPFN</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxapitypes_8h_source.html#l00064">unix/rexxapitypes.h:64</a></div></div>
<div class="ttc" id="aunix_2rexxutil_8cpp_html_ad302ee7ca379dfc14324dcc41cb8d18a"><div class="ttname"><a href="unix_2rexxutil_8cpp.html#ad302ee7ca379dfc14324dcc41cb8d18a">SearchPath</a></div><div class="ttdeci">int SearchPath(int SearchFlag, const char *path, const char *filename, char *buf, size_t buf_size)</div><div class="ttdef"><b>Definition:</b> <a href="unix_2rexxutil_8cpp_source.html#l00866">unix/rexxutil.cpp:866</a></div></div>
<div class="ttc" id="awindows_2_sys_interpreter_instance_8hpp_html"><div class="ttname"><a href="windows_2_sys_interpreter_instance_8hpp.html">SysInterpreterInstance.hpp</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_a021f53ec302c805d15cb963a03fb0d41"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#a021f53ec302c805d15cb963a03fb0d41">sys_process_set</a></div><div class="ttdeci">bool sys_process_set(RexxExitContext *context, const char *command, const char *cmd, RexxObjectPtr &amp;rc)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00088">windows/SystemCommands.cpp:88</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_a0677cc47da77924e557be6df899c632b"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#a0677cc47da77924e557be6df899c632b">sysCommandNT</a></div><div class="ttdeci">bool sysCommandNT(RexxExitContext *context, const char *command, const char *cmdstring_ptr, bool direct, RexxObjectPtr &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00202">windows/SystemCommands.cpp:202</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_a1235f65c4930309556ce62155f324b85"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#a1235f65c4930309556ce62155f324b85">COMSPEC</a></div><div class="ttdeci">#define COMSPEC</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00071">windows/SystemCommands.cpp:71</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_a12571d967b8aa851a674bca98e3ce741"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#a12571d967b8aa851a674bca98e3ce741">CMDBUFSIZENT</a></div><div class="ttdeci">#define CMDBUFSIZENT</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00064">windows/SystemCommands.cpp:64</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_a6a826c01ea925bae9cc70f696b144862"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#a6a826c01ea925bae9cc70f696b144862">SHOWWINDOWFLAGS</a></div><div class="ttdeci">#define SHOWWINDOWFLAGS</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00073">windows/SystemCommands.cpp:73</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_a775cad78401f7d77c12a07e9a042eb7e"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#a775cad78401f7d77c12a07e9a042eb7e">unquote</a></div><div class="ttdeci">char * unquote(const char *s)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00126">windows/SystemCommands.cpp:126</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_ab5be8821f2dff7028a7837479b0d7791"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#ab5be8821f2dff7028a7837479b0d7791">sys_process_cd</a></div><div class="ttdeci">bool sys_process_cd(RexxExitContext *context, const char *command, const char *cmd, RexxObjectPtr &amp;res)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00147">windows/SystemCommands.cpp:147</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_af158ec5c6f79e087d6c8098aa9a1f3cb"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#af158ec5c6f79e087d6c8098aa9a1f3cb">CMDDEFNAMENT</a></div><div class="ttdeci">#define CMDDEFNAMENT</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00066">windows/SystemCommands.cpp:66</a></div></div>
<div class="ttc" id="awindows_2_system_commands_8cpp_html_afb2d8ac3e06eeeb0b38d31e9623cc375"><div class="ttname"><a href="windows_2_system_commands_8cpp.html#afb2d8ac3e06eeeb0b38d31e9623cc375">systemCommandHandler</a></div><div class="ttdeci">RexxObjectPtr RexxEntry systemCommandHandler(RexxExitContext *context, RexxStringObject address, RexxStringObject command)</div><div class="ttdef"><b>Definition:</b> <a href="windows_2_system_commands_8cpp_source.html#l00330">windows/SystemCommands.cpp:330</a></div></div>
<div class="ttc" id="awindows_2_system_interpreter_8hpp_html"><div class="ttname"><a href="windows_2_system_interpreter_8hpp.html">SystemInterpreter.hpp</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00073">windows/rexxapitypes.h:73</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_8b29bd360d363874c010699c0e4edfe4.html">executor</a></li><li class="navelem"><a class="el" href="dir_b12c9cdd073ecc75d378afe044a8807c.html">sandbox</a></li><li class="navelem"><a class="el" href="dir_6f8e204b311fad1e21be914fb6af8fc9.html">jlf</a></li><li class="navelem"><a class="el" href="dir_4796bfee7d29ff8f3ba63e631cf48035.html">trunk</a></li><li class="navelem"><a class="el" href="dir_568b253ddbf98cea92a6c65945d41c59.html">interpreter</a></li><li class="navelem"><a class="el" href="dir_d4404b4bd34c68f45870030da437ebcb.html">platform</a></li><li class="navelem"><a class="el" href="dir_bc2966eddec1584a403ae7e749318f97.html">windows</a></li><li class="navelem"><a class="el" href="windows_2_system_commands_8cpp.html">SystemCommands.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">executor.master</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
