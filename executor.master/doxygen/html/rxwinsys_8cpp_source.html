<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>executor.master: rxwinsys.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('rxwinsys_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">rxwinsys.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="rxwinsys_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2014 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* http://www.oorexx.org/license.html                          */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;windows.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oorexxapi_8h.html">oorexxapi.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;ddeml.h&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;shlobj.h&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;shlwapi.h&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a863767a09c485a9508bd5c2691cc176b">   49</a></span>&#160;<span class="preprocessor">#define STR_BUFFER    256</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a898de5d3084088a18a1ad49afd09fcce">   50</a></span>&#160;<span class="preprocessor">#define MAX_TIME_DATE 128</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">// The OS specifies a maximum size for a registry key name as 255.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a70a2a0fc201636e21395c65e53cd6a45">   53</a></span>&#160;<span class="preprocessor">#define MAX_REGISTRY_KEY_SIZE 256</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">   55</a></span>&#160;<span class="preprocessor">#define MSG_TIMEOUT  5000 </span><span class="comment">// 5000ms</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#if (WINVER &gt;= 0x0500)</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#define MSG_TIMEOUT_OPTS (SMTO_ABORTIFHUNG|SMTO_NORMAL|SMTO_NOTIMEOUTIFNOTHUNG)</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">   59</a></span>&#160;<span class="preprocessor">#define MSG_TIMEOUT_OPTS (SMTO_ABORTIFHUNG|SMTO_NORMAL)</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/*   Subroutine Name:   memupper                                     */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">/*   Descriptive Name:  uppercase a memory location                  */</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">/*   Entry Point:       memupper                                     */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">/*   Input:             memory to upper case                         */</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">/*                      length of memory location                    */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/*                                                                   */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aec33b06d90ac834899b86039851abced">   76</a></span>&#160;<span class="keywordtype">void</span>  <a class="code" href="rxwinsys_8cpp.html#aec33b06d90ac834899b86039851abced">memupper</a>(</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">char</span>    *location,                   <span class="comment">/* location to uppercase      */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">size_t</span>   length)                     <span class="comment">/* length to uppercase        */</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;{</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">for</span> (; length--; location++)         <span class="comment">/* loop for entire string     */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                       <span class="comment">/* uppercase in place         */</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    *location = toupper(*location);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/* Numeric Return calls                                              */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">/*********************************************************************/</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#adada93f8bb67eb09cc09eaf8fa985c6a">   90</a></span>&#160;<span class="preprocessor">#define  INVALID_ROUTINE 40            </span><span class="comment">/* Raise Rexx error           */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a5d442f6d8ad1ae6a5e00c3bc1ea09d26">   91</a></span>&#160;<span class="preprocessor">#define  VALID_ROUTINE    0            </span><span class="comment">/* Successful completion      */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;VOID <a class="code" href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4">Little2BigEndian</a>(BYTE *pbInt, INT iSize);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aa4f1da35c2a9292a48922975f164f1a9">   95</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rxwinsys_8cpp.html#aa4f1da35c2a9292a48922975f164f1a9">dwordPtrToRexx</a>(DWORD_PTR val, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> r)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    _snprintf(r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <a class="code" href="rexxapidefs_8h.html#aafe89561a7a66ed3a673b3b65920ead8">RXAUTOBUFLEN</a>, <span class="stringliteral">&quot;%Iu&quot;</span>, val);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a0b8dab23e0c8f6aa54b19ae8e5163afd">  102</a></span>&#160;LONG <a class="code" href="rxwinsys_8cpp.html#a0b8dab23e0c8f6aa54b19ae8e5163afd">HandleArgError</a>(<a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> r, BOOL ToMuch)</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 2;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = <span class="charliteral">&#39;4&#39;</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[1] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      r-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[2] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">return</span> 40;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">  111</a></span>&#160;<span class="preprocessor">#define CHECKARG(argexpctl, argexpcth) \</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">   if ((argc &lt; argexpctl) || (argc &gt; argexpcth)) return HandleArgError(retstr, (argc &gt; argexpcth))</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">/* macros for a easier return code */</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">  116</a></span>&#160;<span class="preprocessor">#define RETC(retcode) { \</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">                   retstr-&gt;strlength = 1;\</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">                   if (retcode) retstr-&gt;strptr[0] = &#39;1&#39;; else retstr-&gt;strptr[0] = &#39;0&#39;; \</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">                   retstr-&gt;strptr[1] = &#39;\0&#39;; \</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">                   return 0; \</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">                }</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">  123</a></span>&#160;<span class="preprocessor">#define RETERR  { \</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">                   retstr-&gt;strlength = 1;\</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">                   retstr-&gt;strptr[0] = &#39;1&#39;; \</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">                   retstr-&gt;strptr[1] = &#39;\0&#39;; \</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">                   return 40; \</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">                }</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">  131</a></span>&#160;<span class="preprocessor">#define RETVAL(retvalue)  { \</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">                   itoa(retvalue, retstr-&gt;strptr, 10); \</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">                   retstr-&gt;strlength = strlen(retstr-&gt;strptr);\</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">                   return 0; \</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">                }</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">  138</a></span>&#160;<span class="preprocessor">#define RET_HANDLE(retvalue)  { \</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">                   pointer2string(retstr, retvalue); \</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">                   return 0; \</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">                }</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/* Note many existing programs abbreviate HKEY_LOCAL_MACHINE to &quot;LOCAL_MACHINE&quot;,</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> * or &quot;MACHINE&quot;, and many do not.  Many existing programs use the full</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> * HKEY_LOCAL_MACHINE.  So the comparison needs to remain strstr.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">  149</a></span>&#160;<span class="preprocessor">#define GET_HKEY(argum, ghk) { \</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">     ghk = NULL; \</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">     if (strstr(argum,&quot;MACHINE&quot;</span>)) ghk = HKEY_LOCAL_MACHINE; else \</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;     if (strstr(argum,&quot;CLASSES&quot;)) ghk = HKEY_CLASSES_ROOT; else \</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;     if (strstr(argum,&quot;CURRENT_USER&quot;)) ghk = HKEY_CURRENT_USER; else \</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;     if (strstr(argum,&quot;USERS&quot;)) ghk = HKEY_USERS; else \</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;     if (strstr(argum,&quot;PERFORMANCE&quot;)) ghk = HKEY_PERFORMANCE_DATA; else \</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;     if (strstr(argum,&quot;CURRENT_CONFIG&quot;)) ghk = HKEY_CURRENT_CONFIG; else \</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;     if (strstr(argum,&quot;DYN_DATA&quot;)) ghk = HKEY_DYN_DATA; else \</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;     string2pointer(argum, (void **)&amp;ghk); \</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">  162</a></span>&#160;<span class="preprocessor">#define GET_HANDLE(argum, ghk) string2pointer(argum, (void **)&amp;(ghk))</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">  165</a></span>&#160;<span class="preprocessor">#define SET_VARIABLE(varname, data, retc) {\</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">             shvb.shvnext = NULL; \</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">             shvb.shvname.strptr = varname; \</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">             shvb.shvname.strlength = strlen(varname); \</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">             shvb.shvnamelen = shvb.shvname.strlength; \</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">             shvb.shvvalue.strptr = data; \</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">             shvb.shvvalue.strlength = strlen(data); \</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">             shvb.shvvaluelen = strlen(data); \</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">             shvb.shvcode = RXSHV_SYSET; \</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">             shvb.shvret = 0; \</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">             if (RexxVariablePool(&amp;shvb) == RXSHV_BADN) RETC(retc); \</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">        }</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ade9d152280c1d2af148410b016cd7eb0">  179</a></span>&#160;<span class="preprocessor">#define GET_TYPE_INDEX(type, index)   \</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">{                                     \</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">    switch (type)                     \</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">    {                                 \</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">      case EVENTLOG_ERROR_TYPE:       \</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">         index=0;                     \</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">          break;                      \</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">      case EVENTLOG_WARNING_TYPE:     \</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">         index=1;                     \</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">         break;                       \</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">      case EVENTLOG_INFORMATION_TYPE: \</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">         index=2;                     \</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">         break;                       \</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">      case EVENTLOG_SUCCESS:          \</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">         index=2;                     \</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">         break;                       \</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">      case EVENTLOG_AUDIT_SUCCESS:    \</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">         index=3;                     \</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">         break;                       \</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">      case EVENTLOG_AUDIT_FAILURE:    \</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">         index=4;                     \</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">         break;                       \</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">      default:                        \</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">        index=5;                      \</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">    }                                 \</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a979f67d6cbf3d7a5ae0e2a1138243055">  206</a></span>&#160;<span class="keywordtype">bool</span> <span class="keyword">inline</span> <a class="code" href="rxwinsys_8cpp.html#a979f67d6cbf3d7a5ae0e2a1138243055">isHex</a>(<a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> value)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">return</span> ((value[0] == <span class="charliteral">&#39;0&#39;</span>) &amp;&amp; (toupper(value[1]) == <span class="charliteral">&#39;X&#39;</span>));</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">/********************************************************************</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">* Function:  string2pointer(string)                                 *</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">* Purpose:   Validates and converts an ASCII-Z string from string   *</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">*            form to a pointer value.  Returns false if the number  *</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">*            is not valid, true if the number was successfully      *</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">*            converted.                                             *</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">*                                                                   *</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">* RC:        true - Good number converted                           *</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">*            false - Invalid number supplied.                       *</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">*********************************************************************/</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#adc61f50ce845794946655e4e64a0b1ce">  224</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#adc61f50ce845794946655e4e64a0b1ce">string2pointer</a>(</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">string</span>,                  <span class="comment">/* string to convert          */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">void</span> **pointer)                      <span class="comment">/* converted number           */</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> ( strlen(<span class="keywordtype">string</span>) == 0 )</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        *pointer = NULL;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="rxwinsys_8cpp.html#a979f67d6cbf3d7a5ae0e2a1138243055">isHex</a>(<span class="keywordtype">string</span>) )</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> (<span class="keywordtype">string</span>[1] == <span class="charliteral">&#39;x&#39;</span> ?</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                sscanf(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;0x%p&quot;</span>, pointer) == 1 : sscanf(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;0X%p&quot;</span>, pointer) == 1);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">return</span> sscanf(<span class="keywordtype">string</span>, <span class="stringliteral">&quot;%p&quot;</span>, pointer) == 1;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">  244</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a>(<a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> result, <span class="keywordtype">void</span> *pointer)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> ( pointer == NULL )</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        result-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 1;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        result-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = <span class="charliteral">&#39;0&#39;</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        result-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        sprintf(result-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;0x%p&quot;</span>, pointer);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        result-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(result-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">// TODO START The following functions come from from oodCommon.cpp, need to put</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">// all this stuff all together in a common object.</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> * Converts a pointer-sized type to a pointer-string, or 0 if the type is null.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * @param result   [out] Pointer-string is returned here.  Ensure the storage</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> *                 pointed to is big enough for a 64-bit pointer.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> * @param pointer  [in] The pointer, or pointer-sized type to convert.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> * @remarks  Pointer-sized type is used to indicate that this will work for</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> *           opaque types, like HANDLE, HMENU, HINST, UINT_PTR, DWORD_PTR, etc.,</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> *           that are pointer size.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> *           For now, 0 is returned for null rather than 0x00000000 because</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> *           many, many places in the Windows specific classes test for 0 to</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> *           detect error.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> *           This function should go away when the Windows classes are converted</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> *           to use .Pointer for all pointer-sized data types.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a7046e5c2e30d1af95378157f4133b37d">  282</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a>(<span class="keywordtype">char</span> *result, <span class="keywordtype">void</span> *pointer)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> ( pointer == NULL )</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        sprintf(result, <span class="stringliteral">&quot;0&quot;</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        sprintf(result, <span class="stringliteral">&quot;0x%p&quot;</span>, pointer);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> * Variation of above.  Converts the pointer and returns it as a</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> * RexxStringObject.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> * @param c        Method context we are operating in.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> * @param pointer  Pointer to convert</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"> * @return A string object representing the pointer as either 0xffff1111 if not</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"> *         null or as 0 if null.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a896d02ed0b3faddb7e6227458bb4b9f5">  305</a></span>&#160;<a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a> <a class="code" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c, <span class="keywordtype">void</span> *pointer)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;{</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">char</span> buf[32];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a>(buf, pointer);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span> c-&gt;String(buf);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">// TODO END</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> * Resolves a, possibly omitted, registry key handle in string form to a HKEY.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> * Most of the registry functions require an open &#39;parent&#39; key handle.  Most of</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> * the WindowsRegistry methods allow the user to omitt the parent key handle, in</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> * which case the stored &#39;current key&#39; value is used.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> * @param c         Method context we are operating under.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> * @param hkParent  The parent key value to resolve.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"> * @return  A HKEY resolved from hkParent, which could be the null value.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a0522202e1701ae0b677d272e5dc94be8">  327</a></span>&#160;HKEY <a class="code" href="rxwinsys_8cpp.html#a0522202e1701ae0b677d272e5dc94be8">getParentKeyHandle</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> hkParent)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;{</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    HKEY hk = NULL;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> ( hkParent == NULL )</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        hkParent = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> rxHK = c-&gt;GetObjectVariable(<span class="stringliteral">&quot;CURRENT_KEY&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> ( rxHK != <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            hkParent = c-&gt;ObjectToStringValue(rxHK);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ! <a class="code" href="rxwinsys_8cpp.html#a979f67d6cbf3d7a5ae0e2a1138243055">isHex</a>(hkParent) )</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;MACHINE&quot;</span>) ) hk = HKEY_LOCAL_MACHINE;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;CLASSES&quot;</span>) ) hk = HKEY_CLASSES_ROOT;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;CURRENT_USER&quot;</span>) ) hk = HKEY_CURRENT_USER;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;USERS&quot;</span>) ) hk = HKEY_USERS;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;PERFORMANCE&quot;</span>) ) hk = HKEY_PERFORMANCE_DATA;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;CURRENT_CONFIG&quot;</span>) ) hk = HKEY_CURRENT_CONFIG;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( StrStrI(hkParent, <span class="stringliteral">&quot;DYN_DATA&quot;</span>) ) hk = HKEY_DYN_DATA;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> ( hk == NULL )</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#adc61f50ce845794946655e4e64a0b1ce">string2pointer</a>(hkParent, (<span class="keywordtype">void</span> **)&amp;hk);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">return</span> hk;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">  359</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, WSRegistry_init)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    context-&gt;SetObjectVariable(<span class="stringliteral">&quot;CURRENT_KEY&quot;</span>, <a class="code" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a>(context, HKEY_LOCAL_MACHINE));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ad4f9272a7360cf1e9e0105ddce923664">  365</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, getCurrent_Key)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> context-&gt;GetObjectVariable(<span class="stringliteral">&quot;CURRENT_KEY&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aa36257908629d82200dfd8cffd7588aa">  370</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa36257908629d82200dfd8cffd7588aa">RexxMethod1</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, setCurrent_Key, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, regKeyHandle)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    context-&gt;SetObjectVariable(<span class="stringliteral">&quot;CURRENT_KEY&quot;</span>, regKeyHandle);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aec8aea68f408c775b0078618ee3417c3">  376</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(POINTERSTRING, getLocal_Machine)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">return</span> HKEY_LOCAL_MACHINE;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ae4799f73b2a6a572431b1cb727f35fdf">  381</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(POINTERSTRING, getCurrent_User)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;{</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">return</span> HKEY_CURRENT_USER;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a6d94c88d7ff20324f4efd44f70fccb7a">  386</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(POINTERSTRING, getUsers)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> HKEY_USERS;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a17a67fcb6bd66166d2ea4e6d366d5346">  391</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(POINTERSTRING, getClasses_Root)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">return</span> HKEY_CLASSES_ROOT;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aa25e15d67ed8cd0d87343863ee073020">  396</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(POINTERSTRING, getPerformance_Data)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> HKEY_PERFORMANCE_DATA;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a1d645acbcf363baaf65e3a00cec04e0b">  401</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(POINTERSTRING, getCurrent_Config)</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;{</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">return</span> HKEY_CURRENT_CONFIG;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">/** WindowsRegistry::delete() | WindowsRegistry::deleteKey()</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> *  Deletes a registry key.  Maps to both the delete() and the deleteKey()</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> *  methods.</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> *  delete() deletes a subkey and all its descendents (subkeys.)  deleteKey()</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"> *  will only delete the subkey if it is empty, i.e. it contains no subkeys.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"> *  @param hkParent    [optional] A handle to an open registry key, or the name</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment"> *                     of one of the prefined, always open, registry keys. The</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"> *                     key must have been opened with the DELETE access right.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"> *                     If this argument is omitted then the CURRENT_KEY</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> *                     attribute is used.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> *  @param subkeyName  The name of the subkey to be deleted.  The name is case</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> *                     insensitive.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> *  @return O on success, otherwise the Windows system error code.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">  425</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSRegistry_delete, OPTIONAL_CSTRING, hkParent, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a>, subKeyName)</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;{</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    HKEY hk = <a class="code" href="rxwinsys_8cpp.html#a0522202e1701ae0b677d272e5dc94be8">getParentKeyHandle</a>(context, hkParent);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> ( strcmp(context-&gt;GetMessageName(), <span class="stringliteral">&quot;DELETEKEY&quot;</span>) == 0 )</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span> RegDeleteKey(hk, subKeyName);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">return</span> SHDeleteKey(hk, subKeyName);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">/** WindowsRegistry::open()</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"> *  Opens a subkey with the specified access rights.  When the open is</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"> *  successful, the CURRENT_KEY attribute is set to the opened key.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"> *  @param hkParent    [optional] A handle to an open registry key, or the name</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"> *                     of one of the prefined, always open, registry keys. The</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"> *                     key must have been opened with the DELETE access right.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"> *                     If this argument is omitted then the CURRENT_KEY</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"> *                     attribute is used.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"> *  @param subkeyName  [optional] The name of the subkey to be opened.  The name</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"> *                     is case insensitive.  If this argument is omitted or the</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"> *                     empty string, the operating system will open a new handle</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"> *                     to the key identified by hkParent.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"> *  @param access      [optional] A string of 0 or more keywords specifying the</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"> *                     desired access rights.  The default if this argument is</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"> *                     omitted is all access.  Specifying a higher level of</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"> *                     access than the user has, will cause the open to fail.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a13ff8b1b17cbc0e24ffc50eef5beb06e">  461</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a13ff8b1b17cbc0e24ffc50eef5beb06e">RexxMethod3</a>(<a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, WSRegistry_open, OPTIONAL_CSTRING, hkParent, OPTIONAL_CSTRING, subKeyName, OPTIONAL_CSTRING, access)</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c = context;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    DWORD dwAccess = 0;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    HKEY hk = <a class="code" href="rxwinsys_8cpp.html#a0522202e1701ae0b677d272e5dc94be8">getParentKeyHandle</a>(context, hkParent);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">// Docs say, have always said, that the access arg can be more than one</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">// keyword. So, even if &quot;ALL&quot; makes the other keywords unnecessary, we can&#39;t</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// rely on it being the only word in the string.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(3) || StrStrI(access, <span class="stringliteral">&quot;ALL&quot;</span>) != 0 )</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        dwAccess = KEY_ALL_ACCESS;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;WRITE&quot;</span>))     dwAccess |= KEY_WRITE;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;READ&quot;</span>))      dwAccess |= KEY_READ;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;QUERY&quot;</span>))     dwAccess |= KEY_QUERY_VALUE | KEY_ENUMERATE_SUB_KEYS;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;INQUIRE&quot;</span>))   dwAccess |= KEY_QUERY_VALUE;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;ENUMERATE&quot;</span>)) dwAccess |= KEY_ENUMERATE_SUB_KEYS;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;SET&quot;</span>))       dwAccess |= KEY_SET_VALUE;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;DELETE&quot;</span>))    dwAccess |= KEY_SET_VALUE;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;CREATE&quot;</span>))    dwAccess |= KEY_CREATE_SUB_KEY;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;NOTIFY&quot;</span>))    dwAccess |= KEY_NOTIFY;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;EXECUTE&quot;</span>))   dwAccess |= KEY_EXECUTE;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span> (StrStrI(access, <span class="stringliteral">&quot;LINK&quot;</span>))      dwAccess |= KEY_CREATE_LINK;  <span class="comment">// reserved for system use only.</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> result = c-&gt;WholeNumber(0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    HKEY hkResult = NULL;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> ( RegOpenKeyEx(hk, subKeyName, 0, dwAccess, &amp;hkResult ) == ERROR_SUCCESS)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        result = <a class="code" href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a>(context, hkResult);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        c-&gt;SetObjectVariable(<span class="stringliteral">&quot;CURRENT_KEY&quot;</span>, result);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a6891bcb6f438ab4b0c39b0bbafeda798">  500</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a6891bcb6f438ab4b0c39b0bbafeda798">WSRegistryKey</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;{</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    HKEY hk;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,5);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;CREATE&quot;</span>) == 0 )</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        HKEY hkResult;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">if</span> (RegCreateKey(hk, argv[2].strptr, &amp;hkResult ) == ERROR_SUCCESS)</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(hkResult);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;CLOSE&quot;</span>) == 0 )</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">if</span> (RegCloseKey(hk) == ERROR_SUCCESS)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;QUERY&quot;</span>) == 0 )</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordtype">char</span> Class[256];</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        DWORD retcode, cbClass, cSubKeys, cbMaxSubKeyLen,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        cbMaxClassLen, cValues, cbMaxValueNameLen, cbMaxValueLen, cbSecurityDescriptor;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        FILETIME ftLastWriteTime;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        SYSTEMTIME stTime;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        cbClass = 256;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span> ((retcode=RegQueryInfoKey(hk,                             <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;             Class,    <span class="comment">// address of buffer for class string</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;             &amp;cbClass,    <span class="comment">// address of size of class string buffer</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;             NULL,    <span class="comment">// reserved</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;             &amp;cSubKeys,    <span class="comment">// address of buffer for number of subkeys</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;             &amp;cbMaxSubKeyLen,    <span class="comment">// address of buffer for longest subkey name length</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;             &amp;cbMaxClassLen,    <span class="comment">// address of buffer for longest class string length</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;             &amp;cValues,    <span class="comment">// address of buffer for number of value entries</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;             &amp;cbMaxValueNameLen,    <span class="comment">// address of buffer for longest value name length</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;             &amp;cbMaxValueLen,    <span class="comment">// address of buffer for longest value data length</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;             &amp;cbSecurityDescriptor,    <span class="comment">// address of buffer for security descriptor length</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;             &amp;ftLastWriteTime     <span class="comment">// address of buffer for last write time</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            )) == ERROR_SUCCESS)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="keywordflow">if</span> (FileTimeToSystemTime(&amp;ftLastWriteTime, &amp;stTime))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, %ld, %ld, %04d/%02d/%02d, %02d:%02d:%02d&quot;</span>,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                            Class, cSubKeys, cValues, stTime.wYear, stTime.wMonth, stTime.wDay,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                            stTime.wHour, stTime.wMinute, stTime.wSecond);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, %ld, %ld&quot;</span>,Class, cSubKeys, cValues);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;LIST&quot;</span>) == 0 )</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        DWORD retcode, ndx=0;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordtype">char</span> Name[256];</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordtype">char</span> sname[64];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="struct___s_h_v_b_l_o_c_k.html">SHVBLOCK</a> shvb;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            retcode = RegEnumKey(hk,    <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                 ndx++,    <span class="comment">// index of subkey to query</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                 Name,    <span class="comment">// address of buffer for subkey name</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                                 <span class="keyword">sizeof</span>(Name));     <span class="comment">// size of subkey buffer</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <span class="keywordflow">if</span> (retcode == ERROR_SUCCESS)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                strcpy(sname, argv[2].strptr);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="comment">// make sure there is a period on the stem name</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                <span class="keywordflow">if</span> (sname[argv[2].strlength - 1] != <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    strcat(sname, <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                sprintf(sname + strlen(sname),<span class="stringliteral">&quot;%d&quot;</span>, ndx);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, Name, 2);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retcode != ERROR_NO_MORE_ITEMS)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        } <span class="keywordflow">while</span> (retcode == ERROR_SUCCESS);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;FLUSH&quot;</span>) == 0 )</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (RegFlushKey(hk) == ERROR_SUCCESS)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        {</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        }</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a8f9110a61183846d9639d03fcc472e6d">  630</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a8f9110a61183846d9639d03fcc472e6d">WSRegistryValue</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    HKEY hk;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    LONG rc;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,5);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;SET&quot;</span>) == 0 )</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        DWORD valType;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        DWORD dwNumber;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        DWORD dataLen;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        <span class="keyword">const</span> BYTE * data;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;EXPAND&quot;</span>)) valType = REG_EXPAND_SZ;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;MULTI&quot;</span>)) valType = REG_MULTI_SZ;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;NUMBER&quot;</span>)) valType = REG_DWORD;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;BINARY&quot;</span>)) valType = REG_BINARY;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;LINK&quot;</span>)) valType = REG_LINK;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;RESOURCELIST&quot;</span>)) valType = REG_RESOURCE_LIST;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;RESOURCEDESC&quot;</span>)) valType = REG_FULL_RESOURCE_DESCRIPTOR;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;RESOURCEREQS&quot;</span>)) valType = REG_RESOURCE_REQUIREMENTS_LIST;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;BIGENDIAN&quot;</span>)) valType = REG_DWORD_BIG_ENDIAN;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[4].strptr,<span class="stringliteral">&quot;NONE&quot;</span>)) valType = REG_NONE;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            valType = REG_SZ;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> ((valType == REG_DWORD) || (valType == REG_DWORD_BIG_ENDIAN))</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            dwNumber = atoi(argv[3].strptr);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">if</span> (valType == REG_DWORD_BIG_ENDIAN)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4">Little2BigEndian</a>((BYTE *) &amp;dwNumber, <span class="keyword">sizeof</span>(dwNumber));</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            data = (<span class="keyword">const</span> BYTE *) &amp;dwNumber;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            dataLen = <span class="keyword">sizeof</span>(dwNumber);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            data = (<span class="keyword">const</span> BYTE *) argv[3].strptr;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            <span class="keywordflow">switch</span> (valType)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keywordflow">case</span> REG_BINARY:</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <span class="keywordflow">case</span> REG_NONE:</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="keywordflow">case</span> REG_LINK:</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">case</span> REG_RESOURCE_LIST:</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="keywordflow">case</span> REG_FULL_RESOURCE_DESCRIPTOR:</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">case</span> REG_RESOURCE_REQUIREMENTS_LIST:</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    dataLen = (DWORD)argv[3].strlength;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <span class="keywordflow">case</span> REG_EXPAND_SZ:</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                <span class="keywordflow">case</span> REG_MULTI_SZ:</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                <span class="keywordflow">case</span> REG_SZ:</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    dataLen = (DWORD)argv[3].strlength+1;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">if</span> (RegSetValueEx(hk, argv[2].strptr, 0, valType, data, dataLen) == ERROR_SUCCESS)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;QUERY&quot;</span>) == 0 )</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        DWORD valType, cbData;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordtype">char</span> * valData, *vType;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        cbData = <span class="keyword">sizeof</span>(valData);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (RegQueryValueEx(hk,        <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                            argv[2].strptr,    <span class="comment">// address of name of value to query</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                            NULL,        <span class="comment">// reserved</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                            &amp;valType,    <span class="comment">// address of buffer for value type</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                            NULL,        <span class="comment">// NULL to get the size</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                            &amp;cbData) == ERROR_SUCCESS) <span class="comment">// address of data buffer size</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            valData = (<span class="keywordtype">char</span> *)GlobalAlloc(GPTR, cbData);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="keywordflow">if</span> (!valData)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="keywordflow">if</span> (RegQueryValueEx(hk,    <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                argv[2].strptr,    <span class="comment">// address of name of value to query</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                NULL,    <span class="comment">// reserved</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                &amp;valType,    <span class="comment">// address of buffer for value type</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                (LPBYTE)valData,    <span class="comment">// address of data buffer</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                &amp;cbData) == ERROR_SUCCESS) <span class="comment">// address of data buffer size</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="comment">// If the size of the value data is larger than the default</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="comment">// return string buffer, we need to allocate a bigger buffer.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <span class="keywordflow">if</span> ( cbData + <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;RESOURCEDESC, &quot;</span>) &gt; <a class="code" href="rxwinsys_8cpp.html#a863767a09c485a9508bd5c2691cc176b">STR_BUFFER</a> )</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = (<span class="keywordtype">char</span> *)<a class="code" href="rexx_8h.html#ac802de91298eaadf17dca98c4dc9db25">RexxAllocateMemory</a>(cbData + <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;RESOURCEDESC, &quot;</span>));</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                    <span class="keywordflow">if</span> ( retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> == NULL )</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keywordflow">switch</span> (valType)</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    <span class="keywordflow">case</span> REG_MULTI_SZ:</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        vType = <span class="stringliteral">&quot;MULTI&quot;</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    <span class="keywordflow">case</span> REG_DWORD:</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                        vType = <span class="stringliteral">&quot;NUMBER&quot;</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, %ld&quot;</span>,vType, *(DWORD *)valData);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    <span class="keywordflow">case</span> REG_BINARY:</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                        vType = <span class="stringliteral">&quot;BINARY&quot;</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    <span class="keywordflow">case</span> REG_NONE:</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                        vType = <span class="stringliteral">&quot;NONE&quot;</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="keywordflow">case</span> REG_SZ:</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                        vType = <span class="stringliteral">&quot;NORMAL&quot;</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, %s&quot;</span>,vType, valData);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <span class="keywordflow">case</span> REG_EXPAND_SZ:</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                        vType = <span class="stringliteral">&quot;EXPAND&quot;</span>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, %s&quot;</span>,vType, valData);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    <span class="keywordflow">case</span> REG_RESOURCE_LIST:</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        vType = <span class="stringliteral">&quot;RESOURCELIST&quot;</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">case</span> REG_FULL_RESOURCE_DESCRIPTOR:</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        vType = <span class="stringliteral">&quot;RESOURCEDESC&quot;</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                    <span class="keywordflow">case</span> REG_RESOURCE_REQUIREMENTS_LIST:</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                        vType = <span class="stringliteral">&quot;RESOURCEREQS&quot;</span>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    <span class="keywordflow">case</span> REG_LINK:</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                        vType = <span class="stringliteral">&quot;LINK&quot;</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, &quot;</span>,vType);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        memcpy(&amp;retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>)], valData, cbData);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                    <span class="keywordflow">case</span> REG_DWORD_BIG_ENDIAN:</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                        {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                            DWORD dwNumber;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                            vType = <span class="stringliteral">&quot;BIGENDIAN&quot;</span>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            dwNumber = * (DWORD *)valData;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            <a class="code" href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4">Little2BigEndian</a>((BYTE *) &amp;dwNumber, <span class="keyword">sizeof</span>(dwNumber));</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                            sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s, %ld&quot;</span>,vType, dwNumber);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        vType = <span class="stringliteral">&quot;OTHER&quot;</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%s,&quot;</span>,vType);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="keywordflow">if</span> ((valType == REG_MULTI_SZ) ||</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                    (valType == REG_BINARY) ||</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    (valType == REG_RESOURCE_LIST) ||</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                    (valType == REG_FULL_RESOURCE_DESCRIPTOR) ||</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                    (valType == REG_RESOURCE_REQUIREMENTS_LIST) ||</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                    (valType == REG_NONE))</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(vType) + 2 + cbData;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                GlobalFree(valData);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            GlobalFree(valData);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;LIST&quot;</span>) == 0 )</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        DWORD retcode, ndx=0, valType, cbValue, cbData, initData = 1024;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="keywordtype">char</span> * valData, *<a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a>, Name[256];</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordtype">char</span> sname[300];</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="struct___s_h_v_b_l_o_c_k.html">SHVBLOCK</a> shvb;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        valData = (<span class="keywordtype">char</span> *)GlobalAlloc(GPTR, initData);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> (!valData)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="comment">// Copy the stem name to our sname buffer, point to the last character.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">// Ensure the last character is a period, then point to the start of the</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment">// tail.</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        strcpy(sname, argv[2].strptr);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a> = sname + argv[2].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">strlength</a> - 1;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">if</span> ( *<a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a> != <span class="charliteral">&#39;.&#39;</span>)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            *++<a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a> = <span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a>++;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            cbData = initData;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            cbValue = <span class="keyword">sizeof</span>(Name);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            retcode = RegEnumValue(hk,    <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                   ndx++,    <span class="comment">// index of subkey to query</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                   Name,    <span class="comment">// address of buffer for subkey name</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                   &amp;cbValue,</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                   NULL,    <span class="comment">// reserved</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                                   &amp;valType,    <span class="comment">// address of buffer for type code</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                   (LPBYTE)valData,    <span class="comment">// address of buffer for value data</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                                   &amp;cbData);     <span class="comment">// address for size of data buffer</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">if</span> ((retcode == ERROR_MORE_DATA) &amp;&amp; (cbData &gt; initData))   <span class="comment">/* we need more memory */</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                GlobalFree(valData);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                initData = cbData;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                valData = (<span class="keywordtype">char</span> *)GlobalAlloc(GPTR, cbData);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                <span class="keywordflow">if</span> (!valData) <a class="code" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    ndx--;                      <span class="comment">/* try to get the previous one again */</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                cbValue = <span class="keyword">sizeof</span>(Name);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                retcode = RegEnumValue(hk,    <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                       ndx++,    <span class="comment">// index of subkey to query</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                       Name,    <span class="comment">// address of buffer for subkey name</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                       &amp;cbValue,</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                                       NULL,    <span class="comment">// reserved</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                                       &amp;valType,    <span class="comment">// address of buffer for type code</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                                       (LPBYTE)valData,    <span class="comment">// address of buffer for value data</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                       &amp;cbData);     <span class="comment">// address for size of data buffer</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            }</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="keywordflow">if</span> (retcode == ERROR_SUCCESS)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                sprintf(<a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a>, <span class="stringliteral">&quot;%d.Name&quot;</span>, ndx);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, Name, 2);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                sprintf(<a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a>, <span class="stringliteral">&quot;%d.Type&quot;</span>, ndx);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="keywordflow">switch</span> (valType)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                    <span class="keywordflow">case</span> REG_EXPAND_SZ:</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;EXPAND&quot;</span>, 2);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                    <span class="keywordflow">case</span> REG_NONE:</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;NONE&quot;</span>, 2);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                    <span class="keywordflow">case</span> REG_DWORD:</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;NUMBER&quot;</span>, 2);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    <span class="keywordflow">case</span> REG_MULTI_SZ:</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;MULTI&quot;</span>, 2);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    <span class="keywordflow">case</span> REG_BINARY:</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;BINARY&quot;</span>, 2);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                    <span class="keywordflow">case</span> REG_SZ:</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;NORMAL&quot;</span>, 2);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                    <span class="keywordflow">case</span> REG_RESOURCE_LIST:</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;RESOURCELIST&quot;</span>, 2);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                    <span class="keywordflow">case</span> REG_FULL_RESOURCE_DESCRIPTOR:</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;RESOURCEDESC&quot;</span>, 2);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    <span class="keywordflow">case</span> REG_RESOURCE_REQUIREMENTS_LIST:</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;RESOURCEREQS&quot;</span>, 2);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <span class="keywordflow">case</span> REG_LINK:</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;LINK&quot;</span>, 2);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                    <span class="keywordflow">case</span> REG_DWORD_BIG_ENDIAN:</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;BIGENDIAN&quot;</span>, 2);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;OTHER&quot;</span>, 2);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                sprintf(<a class="code" href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a>, <span class="stringliteral">&quot;%d.Data&quot;</span>, ndx);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <span class="keywordflow">if</span> ((valType == REG_MULTI_SZ) ||</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    (valType == REG_BINARY) ||</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    (valType == REG_LINK) ||</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    (valType == REG_RESOURCE_LIST) ||</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    (valType == REG_FULL_RESOURCE_DESCRIPTOR) ||</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    (valType == REG_RESOURCE_REQUIREMENTS_LIST) ||</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    (valType == REG_NONE))</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">shvnext</a> = NULL;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strptr = sname;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength = strlen(sname);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">shvnamelen</a> = shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">shvname</a>.strlength;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = valData;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">shvvalue</a>.<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = cbData;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">shvvaluelen</a> = cbData;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">shvcode</a> = <a class="code" href="rexxapidefs_8h.html#ab6272ae3efe7604608fa2b9a9d809b08">RXSHV_SYSET</a>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    shvb.<a class="code" href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">shvret</a> = 0;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a>(&amp;shvb) == <a class="code" href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a>)</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                        GlobalFree(valData);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(2);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                }</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((valType == REG_EXPAND_SZ) || (valType == REG_SZ))</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, valData, 2);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((valType == REG_DWORD) || (valType == REG_DWORD_BIG_ENDIAN))</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                {</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    <span class="keywordtype">char</span> tmp[30];</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    DWORD dwNumber;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                    dwNumber = *(DWORD *) valData;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    <span class="keywordflow">if</span> (valType == REG_DWORD_BIG_ENDIAN)</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                    {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4">Little2BigEndian</a>((BYTE *)&amp;dwNumber, <span class="keyword">sizeof</span>(dwNumber));</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                    }</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                    ltoa(dwNumber, tmp, 10);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, tmp, 2);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                {</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                    <a class="code" href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a>(sname, <span class="stringliteral">&quot;&quot;</span>, 2);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            }</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retcode != ERROR_NO_MORE_ITEMS)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                GlobalFree(valData);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        } <span class="keywordflow">while</span> (retcode == ERROR_SUCCESS);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        GlobalFree(valData);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;DELETE&quot;</span>) == 0 )</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    {</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="keywordflow">if</span> ((rc = RegDeleteValue(hk, argv[2].strptr)) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(rc);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    }</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;}</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a3f2d72d2d742fcd1b1304b1416e42fc1"> 1018</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a3f2d72d2d742fcd1b1304b1416e42fc1">WSRegistryFile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;{</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    DWORD retc, rc;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    HKEY hk;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    HANDLE hToken;              <span class="comment">/* handle to process token */</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    TOKEN_PRIVILEGES tkp;        <span class="comment">/* ptr. to token structure */</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,5);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;CONNECT&quot;</span>) == 0 )</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        HKEY hkResult;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">if</span> (RegConnectRegistry(argv[2].strptr, hk, &amp;hkResult ) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(hkResult);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;SAVE&quot;</span>) == 0 )</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    {</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="comment">/* set SE_BACKUP_NAME privilege.  */</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">if</span> (!OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken))</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(GetLastError());</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        LookupPrivilegeValue(NULL, SE_BACKUP_NAME,&amp;tkp.Privileges[0].Luid);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        tkp.PrivilegeCount = 1;  <span class="comment">/* one privilege to set    */</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="comment">/* Set SE_BACKUP_NAME privilege for this process. */</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160; </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0,</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                              (PTOKEN_PRIVILEGES) NULL, 0);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordflow">if</span> ((rc = GetLastError()) != ERROR_SUCCESS)</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(rc);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">if</span> ((retc = RegSaveKey(hk, argv[2].strptr, NULL)) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(retc);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;LOAD&quot;</span>) == 0 || strcmp(argv[0].strptr, <span class="stringliteral">&quot;RESTORE&quot;</span>) == 0 ||</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;              strcmp(argv[0].strptr, <span class="stringliteral">&quot;REPLACE&quot;</span>) == 0 || strcmp(argv[0].strptr, <span class="stringliteral">&quot;UNLOAD&quot;</span>) == 0 )</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <span class="comment">/* set SE_RESTORE_NAME privilege.  */</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordflow">if</span> (!OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken))</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(GetLastError())</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        LookupPrivilegeValue(NULL, SE_RESTORE_NAME,&amp;tkp.Privileges[0].Luid);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        tkp.PrivilegeCount = 1;  <span class="comment">/* one privilege to set    */</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        tkp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">/* Set SE_BACKUP_NAME privilege for this process. */</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        AdjustTokenPrivileges(hToken, FALSE, &amp;tkp, 0, (PTOKEN_PRIVILEGES) NULL, 0);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keywordflow">if</span> ((rc = GetLastError()) != ERROR_SUCCESS)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(rc);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;UNLOAD&quot;</span>) == 0 )</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;            <span class="keywordflow">if</span> ((retc = RegUnLoadKey(hk, argv[2].strptr)) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(retc);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;LOAD&quot;</span>) == 0 )</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            <span class="keywordflow">if</span> ((retc = RegLoadKey(hk, argv[2].strptr, argv[3].strptr)) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(retc);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;RESTORE&quot;</span>) == 0 )</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            DWORD vola;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[3].strptr, <span class="stringliteral">&quot;VOLATILE&quot;</span>)) vola = REG_WHOLE_HIVE_VOLATILE;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;            <span class="keywordflow">else</span> vola = 0;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            <span class="keywordflow">if</span> ((retc = RegRestoreKey(hk, argv[2].strptr, vola)) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(retc);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;REPLACE&quot;</span>) == 0 )</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> * p;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a>(argv[1].strptr, hk);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[2].strptr, <span class="stringliteral">&quot;%NULL%&quot;</span>))</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                p = NULL;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                p = argv[2].<a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">strptr</a>;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            <span class="keywordflow">if</span> ((retc = RegReplaceKey(hk, p, argv[3].strptr, argv[4].strptr)) == ERROR_SUCCESS)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;            {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(retc);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="comment">// MessageBox(0,&quot;Illegal registry file command!&quot;,&quot;Error&quot;,MB_OK | MB_ICONHAND | MB_SYSTEMMODAL);</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160; </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a95805306813e3e6ced3700d40a30bc57"> 1172</a></span>&#160;HDDEDATA CALLBACK <a class="code" href="rxwinsys_8cpp.html#a95805306813e3e6ced3700d40a30bc57">DDECallback</a>(UINT wType,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                              UINT wFmt,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                              HCONV hConv,</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                              HSZ hsz1,</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                              HSZ hsz2,</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                              HDDEDATA hDDEData,</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                              DWORD dwData1,</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                              DWORD dwData2)</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;{</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;}</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f"> 1184</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(LPSTR lpszCmd)</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;{</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    DWORD dwDDEInst = 0;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    UINT ui;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    HSZ hszProgman;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    HCONV hConv;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    HDDEDATA hExecData;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    HDDEDATA exRes;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    ui = DdeInitialize(&amp;dwDDEInst,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                       (PFNCALLBACK)<a class="code" href="rxwinsys_8cpp.html#a95805306813e3e6ced3700d40a30bc57">DDECallback</a>,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                       CBF_FAIL_ALLSVRXACTIONS,</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                       0l);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (ui != DMLERR_NO_ERROR) <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    hszProgman = DdeCreateStringHandle(dwDDEInst,</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                       <span class="stringliteral">&quot;PROGMAN&quot;</span>,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                       CP_WINANSI);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    hConv = DdeConnect(dwDDEInst,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                       hszProgman,</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                       hszProgman,</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                       NULL);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    DdeFreeStringHandle(dwDDEInst, hszProgman);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">if</span> (!hConv) <span class="keywordflow">return</span> FALSE;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    hExecData = DdeCreateDataHandle(dwDDEInst,</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                    (LPBYTE)lpszCmd,</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                    lstrlen(lpszCmd)+1,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                    0,</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                    NULL,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                    0,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                    0);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    exRes = DdeClientTransaction((LPBYTE)hExecData,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                         (DWORD)-1,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                         hConv,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                         NULL,</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                         0,</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                         XTYP_EXECUTE,</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                         2000, <span class="comment">// ms timeout</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                         NULL);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    DdeDisconnect(hConv);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    DdeUninitialize(dwDDEInst);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">return</span> exRes != 0;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;}</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a641bab07262677c041b5a24836568a3b"> 1246</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a641bab07262677c041b5a24836568a3b">AddPMGroup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *lpszGroup, <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszPath)</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;{</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="keywordflow">if</span> (lpszPath &amp;&amp; lstrlen(lpszPath))</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                 <span class="stringliteral">&quot;[CreateGroup(%s,%s)]&quot;</span>,</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                 lpszGroup,</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                 lpszPath);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    }</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                 <span class="stringliteral">&quot;[CreateGroup(%s)]&quot;</span>,</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                 lpszGroup);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(buf);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;}</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab9ca6ff3dfca8bcd984786209f13eb6f"> 1267</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#ab9ca6ff3dfca8bcd984786209f13eb6f">DeletePMGroup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *lpszGroup)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;{</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordtype">char</span> buf[512];</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">if</span> (lpszGroup &amp;&amp; lstrlen(lpszGroup))</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                 <span class="stringliteral">&quot;[DeleteGroup(%s)]&quot;</span>,</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                 lpszGroup);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(buf);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01281"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a9e2ac1c349c2c1c1314f3ca7bc783d76"> 1281</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a9e2ac1c349c2c1c1314f3ca7bc783d76">ShowPMGroup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *lpszGroup, WORD wCmd)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;{</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordtype">char</span> buf[512];</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    <span class="keywordflow">if</span> (lpszGroup &amp;&amp; lstrlen(lpszGroup))</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                 <span class="stringliteral">&quot;[ShowGroup(%s,%u)]&quot;</span>,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                 lpszGroup,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                 wCmd);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(buf);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a3770181092e510c5e03cd5c5a87412bb"> 1297</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a3770181092e510c5e03cd5c5a87412bb">AddPMItem</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *lpszCmdLine,</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszCaption,</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszIconPath,</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;               WORD  wIconIndex,</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszDir,</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;               BOOL  bLast,</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszHotKey,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszModifier,</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;               BOOL  bMin)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;{</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordtype">char</span> buf[2048];</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordtype">int</span> Pos;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">if</span> (bLast) Pos = -1; <span class="keywordflow">else</span> Pos = 0;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">if</span> (lpszIconPath &amp;&amp; lstrlen(lpszIconPath))</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                 <span class="stringliteral">&quot;[AddItem(%s,%s,%s,%u,%d,%d,%s,%d,%d)]&quot;</span>,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                 lpszCmdLine,</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                 lpszCaption,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                 lpszIconPath,</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                 wIconIndex,</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                 Pos,Pos,</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                 lpszDir,</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                 MAKEWORD( atoi(lpszHotKey), atoi(lpszModifier)),</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                 bMin);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                 <span class="stringliteral">&quot;[AddItem(%s,%s,&quot;</span><span class="stringliteral">&quot;,&quot;</span><span class="stringliteral">&quot;,%d,%d,%s,%d,%d)]&quot;</span>,</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                 lpszCmdLine,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                 lpszCaption,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                 Pos, Pos,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                 lpszDir,</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                 MAKEWORD( atoi(lpszHotKey), atoi(lpszModifier)),</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                 bMin);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(buf);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;}</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a98884c42b72ef3d5412e4cb75329427d"> 1341</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a98884c42b72ef3d5412e4cb75329427d">DeletePMItem</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *lpszItem)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;{</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordtype">char</span> buf[512];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (lpszItem &amp;&amp; lstrlen(lpszItem))</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        wsprintf(buf,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                 <span class="stringliteral">&quot;[DeleteItem(%s)]&quot;</span>,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                 lpszItem);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(buf);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;}</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a6aebe62a6353288e498c27ba2b73fd06"> 1356</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a6aebe62a6353288e498c27ba2b73fd06">LeavePM</a>(BOOL bSaveGroups)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;{</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordtype">char</span> buf[256];</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    wsprintf(buf,</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;             <span class="stringliteral">&quot;[ExitProgman(%u)]&quot;</span>,</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;             bSaveGroups ? 1 : 0);</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160; </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a>(buf);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">// Function: BOOL GetCurrentUserDesktopLocation</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">// This function reads the  CurrentUser Desktop Path from the registry.</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="comment">// Syntax:   call GetCurrentUserDesktopLocation( LPBYTE szDesktopDir, LPDWORD  lpcbData )</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">// Params:</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">//  szDesktopDir   - Drive and Path of the Desktop to be returned</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">//  lpcbData       _ Max Size of szDesktopDir on entry, Size of szDesktopDir on exit</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="comment">//   return :  TRUE  - No error</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">//             FALSE - Error</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a488502d996bd507bcc41951bac8a158b"> 1384</a></span>&#160;<span class="preprocessor">#define IDS_REGISTRY_KEY_CURRENT_SHELLFOLDER &quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders&quot;</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ad42c2318880b503ec1233da392dbc8a3"> 1385</a></span>&#160;<span class="preprocessor">#define IDS_CURRENT_DESKTOP                  &quot;Desktop&quot;</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ac45ef67420c753c3fca077db710e87d8"> 1387</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#ac45ef67420c753c3fca077db710e87d8">GetCurrentUserDesktopLocation</a> ( LPBYTE szDesktopDir, LPDWORD  lpcbData )</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;{</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   HKEY hKey;                      <span class="comment">//handle of key</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   <span class="keywordtype">long</span> rc;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   DWORD Type ;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;   szDesktopDir[0] =<span class="charliteral">&#39;\0&#39;</span>;         <span class="comment">//initialize return</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;   <span class="keywordflow">if</span> ( (rc = RegOpenKeyEx(HKEY_CURRENT_USER,</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                           <a class="code" href="rxwinsys_8cpp.html#a488502d996bd507bcc41951bac8a158b">IDS_REGISTRY_KEY_CURRENT_SHELLFOLDER</a>,</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                           0,</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                           KEY_QUERY_VALUE,</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                           &amp;hKey)) == ERROR_SUCCESS )</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;      <span class="keywordflow">if</span> ( (rc = RegQueryValueEx(hKey,                      <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                           <a class="code" href="rxwinsys_8cpp.html#ad42c2318880b503ec1233da392dbc8a3">IDS_CURRENT_DESKTOP</a> ,            <span class="comment">// address of name of value to query</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                           NULL,                            <span class="comment">// reserved</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                           &amp;Type,                         <span class="comment">// address of buffer for value type</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                           szDesktopDir ,                   <span class="comment">// address of returned data</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                           lpcbData)) == ERROR_SUCCESS )    <span class="comment">// .. returned here</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        RegCloseKey ( hKey ) ;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      RegCloseKey ( hKey ) ;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   }</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160; </div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;   <span class="comment">// Error occured</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;   <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;}</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="comment">// Function: BOOL GetAllUserDesktopLocation</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="comment">// This function reads All UsersDesktop Path from the registry.</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="comment">// Syntax:   call GetAllUserDesktopLocation( LPBYTE szDesktopDir, LPDWORD  lpcbData )</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">// Params:</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">//  szDesktopDir   - Drive and Path of the Desktop to be returned</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">//  lpcbData       _ Max Size of szDesktopDir on entry, Size of szDesktopDir on exit</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">//   return :  TRUE  - No error</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">//             FALSE - Error</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ac6683912e961b3a2992e58f6a9d6d9a7"> 1436</a></span>&#160;<span class="preprocessor">#define IDS_REGISTRY_KEY_ALL_NT_SHELLFOLDER &quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders&quot;</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a3640418d6a7f42f9d410735abf1a9700"> 1437</a></span>&#160;<span class="preprocessor">#define IDS_ALL_NT_DESKTOP                  &quot;Common Desktop&quot;</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab15ed64bd872dd9652da26c913deb44e"> 1439</a></span>&#160;<span class="preprocessor">#define IDS_REGISTRY_KEY_ALL_9x_SHELLFOLDER &quot;.DEFAULT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders&quot;</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a1652e3dc6e2e3f1b127b20724d7db6fc"> 1440</a></span>&#160;<span class="preprocessor">#define IDS_ALL_9x_DESKTOP                  &quot;Desktop&quot;</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a95a1da4c78960210d661cf18315fab81"> 1443</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a95a1da4c78960210d661cf18315fab81">GetAllUserDesktopLocation</a> ( LPBYTE szDesktopDir, LPDWORD  lpcbData )</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;{</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;   HKEY hKey;                      <span class="comment">//handle of key</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   <span class="keywordtype">long</span> rc;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   DWORD lpType ;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;   LPTSTR lpValueName ;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160; </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   szDesktopDir[0] =<span class="charliteral">&#39;\0&#39;</span>;         <span class="comment">//initialize return</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;   <span class="comment">// Test, if 95/98/Millenium or NT/Win2000</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;   rc = RegOpenKeyEx(HKEY_LOCAL_MACHINE,</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                   <a class="code" href="rxwinsys_8cpp.html#ac6683912e961b3a2992e58f6a9d6d9a7">IDS_REGISTRY_KEY_ALL_NT_SHELLFOLDER</a>,</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                   0,</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                   KEY_QUERY_VALUE,</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                   &amp;hKey) ;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;   lpValueName = <a class="code" href="rxwinsys_8cpp.html#a3640418d6a7f42f9d410735abf1a9700">IDS_ALL_NT_DESKTOP</a> ;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;   <span class="keywordflow">if</span> ( rc == ERROR_SUCCESS )</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <span class="keywordflow">if</span> ( (rc = RegQueryValueEx(hKey,                      <span class="comment">// handle of key to query</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                 lpValueName ,                    <span class="comment">// address of name of value to query</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                 NULL,                            <span class="comment">// reserved</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                 &amp;lpType,                         <span class="comment">// address of buffer for value type</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                                 szDesktopDir ,                   <span class="comment">// address of returned data</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                                 lpcbData)) == ERROR_SUCCESS )    <span class="comment">// .. returned here</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        RegCloseKey ( hKey ) ;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="keywordflow">return</span> TRUE ;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      RegCloseKey ( hKey ) ;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;   }</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;   <span class="comment">// Error occured</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;   <span class="keywordflow">return</span> FALSE ;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;}</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="comment">// Function: BOOL AddPMDesktopIcon</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="comment">// This function creates a shortcut to a file on the desktop.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">// Syntax:   call AddPmDesktopIcon( lpszName, lpszProgram, lpszIcon, iIconIndex, lpszWorkDir,</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">//                                  lpszLocation, lpszArguments, iscKey, iscModifier, run )</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">// Params:</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">//  lpszName       - Name of the short cut, displayed on the desktop below the icon</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">//  lpszProgram    - full name of the file of the shortcut referes to</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">//  lpszIcon       - full name of the icon file</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">//  iIconIndex     - index of the icon within the icon file</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">//  lpszWorkDir    - working directory of the shortcut</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">//  lpszLocation   - &quot;PERSONAL&quot;  : icon is only on desktop for current user</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">//                 - &quot;COMMON&quot;    : icon is displayed on desktop of all users</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">//                 - &quot;&quot;          : it&#39;s a link and can be placed in any folder</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">//  lpszArguments  - arguments passed to the shortcut</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">//  iScKey         - shortcut key</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">//  iScModifier    - modifier of shortcut key</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">//  run            - run application in  a : NORMAL</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment">//                                           MINIMIZED</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">//                                           MAXIMIZED    window</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">//   return :  TRUE  - No error</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">//             FALSE - Error</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a9912094b274bf4ae8401bb08305e27fe"> 1511</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a9912094b274bf4ae8401bb08305e27fe">AddPMDesktopIcon</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *lpszName,</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszProgram,</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszIcon,</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                      <span class="keywordtype">int</span>   iIconIndex,</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszWorkDir,</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszLocation,</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszArguments,</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                      <span class="keywordtype">int</span>   iScKey,</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                      <span class="keywordtype">int</span>   iScModifier,</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszRun )</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;{</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    HRESULT      hres;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    IShellLink*  psl;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    BOOL         bRc = TRUE;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="keywordtype">int</span>          iRun = SW_NORMAL;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    CoInitialize(NULL);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="comment">// Get a pointer to the IShellLink interface.</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    hres = CoCreateInstance(CLSID_ShellLink, NULL, CLSCTX_INPROC_SERVER, IID_IShellLink, (LPVOID *)&amp;psl);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (SUCCEEDED(hres))</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        IPersistFile* ppf;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <span class="comment">// Set the path to the shortcut target</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        psl-&gt;SetPath(lpszProgram );</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="comment">// icon location. default of iIconIndex is 0, set in WINSYSTM.CLS</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        psl-&gt;SetIconLocation(lpszIcon, iIconIndex);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="comment">// command-line arguments</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        psl-&gt;SetArguments(lpszArguments );</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160; </div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="comment">//shortcut key, the conversion to hex is done in WINSYSTM.CLS</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        <span class="comment">// modificationflag:</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="comment">// The modifier flags can be a combination of the following values:</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <span class="comment">// HOTKEYF_SHIFT   = SHIFT key      0x01</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="comment">// HOTKEYF_CONTROL = CTRL key       0x02</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="comment">// HOTKEYF_ALT     = ALT key        0x04</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        <span class="comment">// HOTKEYF_EXT     = Extended key   0x08</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        psl-&gt;SetHotkey(MAKEWORD( iScKey, iScModifier) );</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="comment">// working directory</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        psl-&gt;SetWorkingDirectory(lpszWorkDir );</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="comment">// run in normal, maximized , minimized window, default is NORMAL, set in WINSYSTM.CLS</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keywordflow">if</span> ( !stricmp(lpszRun,<span class="stringliteral">&quot;MAXIMIZED&quot;</span>) )</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            iRun = SW_SHOWMAXIMIZED;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !stricmp(lpszRun,<span class="stringliteral">&quot;MINIMIZED&quot;</span>) )</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            iRun = SW_SHOWMINNOACTIVE;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160; </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        psl-&gt;SetShowCmd(iRun );</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// Query IShellLink for the IPersistFile interface for saving the</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="comment">// shortcut in persistent storage.</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        hres = psl-&gt;QueryInterface(IID_IPersistFile, (<span class="keywordtype">void</span> **)&amp;ppf);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">if</span> (SUCCEEDED(hres))</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            WCHAR wsz[MAX_PATH];</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            CHAR  szShortCutName[MAX_PATH];</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            CHAR  szDesktopDir[MAX_PATH];</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            DWORD dwSize = MAX_PATH;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            <span class="comment">// If strlen(lpszLocation is &lt; 6, then lpszName contains a full qualified filename</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            <span class="keywordflow">if</span> (strlen(lpszLocation)&gt;5)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            {</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                <span class="comment">// if icon should only be created on the desktop of current user</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                <span class="comment">// get current user</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                <span class="keywordflow">if</span> (!stricmp(lpszLocation,<span class="stringliteral">&quot;PERSONAL&quot;</span>))</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                    bRc = <a class="code" href="rxwinsys_8cpp.html#ac45ef67420c753c3fca077db710e87d8">GetCurrentUserDesktopLocation</a> ( (LPBYTE)szDesktopDir , &amp;dwSize ) ;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;                {  <span class="comment">// Location is COMMON</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                    bRc = <a class="code" href="rxwinsys_8cpp.html#a95a1da4c78960210d661cf18315fab81">GetAllUserDesktopLocation</a> ( (LPBYTE)szDesktopDir , &amp;dwSize ) ;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                <span class="keywordflow">if</span> ( bRc)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;                    <span class="comment">//.lnk must be added to identify the file as a shortcut</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;                    sprintf( szShortCutName, <span class="stringliteral">&quot;%s\\%s.lnk&quot;</span>, szDesktopDir, lpszName);</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;                }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;            }</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            <span class="keywordflow">else</span>   <span class="comment">/* empty specifier so it&#39;s a link */</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                sprintf( szShortCutName, <span class="stringliteral">&quot;%s.lnk&quot;</span>, lpszName); <span class="comment">/* lpszName contains a full qualified filename */</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="comment">// Continueonly, if bRC is TRUE</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="keywordflow">if</span> ( bRc )</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                <span class="comment">// Ensure that the string is Unicode.</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                MultiByteToWideChar(CP_ACP, 0, szShortCutName, -1, wsz, MAX_PATH);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                <span class="comment">// Save the link by calling IPersistFile::Save.</span></div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                hres = ppf-&gt;Save(wsz, TRUE);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                <span class="keywordflow">if</span> (!SUCCEEDED(hres))</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                    bRc = FALSE;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                ppf-&gt;Release();</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                bRc = FALSE;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            bRc = FALSE;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        psl-&gt;Release();</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        bRc = FALSE;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">return</span> bRc;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;}</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="comment">// Function: INT DelPMDesktopIcon</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="comment">// This function deletes a shortcut created with AddPMDektopIcon</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">// Syntax:   call DelPMDesktopIcon( lpszName,lpszLocation )</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">// Params:</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="comment">//  lpszName       - Name of the short cut to be deleted</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="comment">//   return :  0      - No error</span></div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="comment">//             others - Error codes from DeleteFile</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="comment">//   Note: The returncode of GetCurrentXXXDesktopLocation is not checked because</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="comment">//         this hould be handeled by DeleteFile. So if an error occured during this</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="comment">//         function, file nit found is returned</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a9a375c99e3f826aa1479b4ae4923888e"> 1659</a></span>&#160;INT <a class="code" href="rxwinsys_8cpp.html#a9a375c99e3f826aa1479b4ae4923888e">DelPMDesktopIcon</a>( <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszName, <span class="keyword">const</span> <span class="keywordtype">char</span> *lpszLocation)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;{</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    CHAR  szDesktopDir[MAX_PATH];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    CHAR  szShortCutName[MAX_PATH];</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    DWORD dwSize = MAX_PATH;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160; </div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="comment">// get the location (directory) of the shortcut file in dependency of</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="comment">// the specified location</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keywordflow">if</span> (!stricmp(lpszLocation,<span class="stringliteral">&quot;PERSONAL&quot;</span>))</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    {</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#ac45ef67420c753c3fca077db710e87d8">GetCurrentUserDesktopLocation</a> ( (LPBYTE)szDesktopDir , &amp;dwSize );</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    {  <span class="comment">// Location is COMMON</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a95a1da4c78960210d661cf18315fab81">GetAllUserDesktopLocation</a> ( (LPBYTE)szDesktopDir , &amp;dwSize );</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    }</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">//.lnk must be added to identify the file as a shortcut</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    sprintf( szShortCutName, <span class="stringliteral">&quot;%s\\%s.lnk&quot;</span>, szDesktopDir, lpszName);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">if</span> (!DeleteFile(szShortCutName))</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;}</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a553d6a324d3fe6f2ba079a73b3d3d938"> 1689</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a553d6a324d3fe6f2ba079a73b3d3d938">WSProgManager</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;{</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,11);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="keywordflow">if</span> (strcmp( argv[0].strptr, <span class="stringliteral">&quot;ADDGROUP&quot;</span>) == 0 )</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a641bab07262677c041b5a24836568a3b">AddPMGroup</a>(argv[1].strptr, argv[2].strptr));</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    }</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;DELGROUP&quot;</span>) == 0 )</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#ab9ca6ff3dfca8bcd984786209f13eb6f">DeletePMGroup</a>(argv[1].strptr));</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    }</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;SHOWGROUP&quot;</span>) == 0 )</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        INT stype;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="keywordflow">if</span> ( strcmp(argv[2].strptr, <span class="stringliteral">&quot;MAX&quot;</span>) == 0 )</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        {</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            stype = 3;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[2].strptr, <span class="stringliteral">&quot;MIN&quot;</span>) == 0 )</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        {</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            stype = 2;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            stype = 1;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a9e2ac1c349c2c1c1314f3ca7bc783d76">ShowPMGroup</a>(argv[1].strptr, (WORD)stype));</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;ADDITEM&quot;</span>) == 0 )</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="keywordflow">if</span> (argc &gt; 7)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a3770181092e510c5e03cd5c5a87412bb">AddPMItem</a>(argv[1].strptr, argv[2].strptr, argv[3].strptr, (WORD)atoi(argv[4].strptr), argv[5].strptr,\</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                            (BOOL)atoi(argv[6].strptr), argv[7].strptr, argv[8].strptr, (BOOL)atoi(argv[9].strptr)));</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        }</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a3770181092e510c5e03cd5c5a87412bb">AddPMItem</a>(argv[1].strptr, argv[2].strptr, argv[3].strptr, (WORD)atoi(argv[4].strptr), argv[5].strptr,\</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                            (BOOL)atoi(argv[6].strptr), <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0));</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;DELITEM&quot;</span>) == 0 )</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a98884c42b72ef3d5412e4cb75329427d">DeletePMItem</a>(argv[1].strptr));</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(argv[0].strptr, <span class="stringliteral">&quot;LEAVE&quot;</span>) == 0 )</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <span class="keywordflow">if</span> ( strcmp(argv[1].strptr, <span class="stringliteral">&quot;SAVE&quot;</span>) == 0 )</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a6aebe62a6353288e498c27ba2b73fd06">LeavePM</a>(TRUE));</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a6aebe62a6353288e498c27ba2b73fd06">LeavePM</a>(FALSE));</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    }</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;ADDDESKTOPICON&quot;</span>) == 0 )</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!<a class="code" href="rxwinsys_8cpp.html#a9912094b274bf4ae8401bb08305e27fe">AddPMDesktopIcon</a>( argv[1].strptr, argv[2].strptr, argv[3].strptr, atoi(argv[4].strptr),</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                argv[5].strptr, argv[6].strptr, argv[7].strptr, atoi(argv[8].strptr),</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                atoi(argv[9].strptr), argv[10].strptr ));</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;DELDESKTOPICON&quot;</span>) == 0 )</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(<a class="code" href="rxwinsys_8cpp.html#a9a375c99e3f826aa1479b4ae4923888e">DelPMDesktopIcon</a>( argv[1].strptr, argv[2].strptr));</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    }</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;}</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="comment">//  Section for the WindowsEventLog class</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="comment">//-----------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160; </div>
<div class="line"><a name="l01774"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a0a474da6cd0be4c9cda56b3117ce2fcb"> 1774</a></span>&#160;<span class="preprocessor">#define WSEL_DEFAULT_EVENTS_ARRAY_SIZE      512</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ac39d1e16ee52dc59170c491859b46cde"> 1775</a></span>&#160;<span class="preprocessor">#define WSEL_DEFAULT_SOURCE                 &quot;Application&quot;</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a01110c4f8c467f1ead522c735bb03231"> 1776</a></span>&#160;<span class="preprocessor">#define HANDLE_ATTRIBUTE                    &quot;CURRENTHANDLE&quot;</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#acd4df271e9d7f1d95ad77935c918829c"> 1777</a></span>&#160;<span class="preprocessor">#define RECORDS_ATTRIBUTE                   &quot;EVENTS&quot;</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a56f833879bcc8e4e40bfa5703ef90150"> 1778</a></span>&#160;<span class="preprocessor">#define INITCODE_ATTRIBUTE                  &quot;INITCODE&quot;</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#af00eef1f14766857695424b90e5442c6"> 1779</a></span>&#160;<span class="preprocessor">#define MIN_READ_BUFFER_ATTRIBUTE           &quot;MINIMUMREADBUFFER&quot;</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ad39997964eafc3b9de2b4a2bfbe47b92"> 1780</a></span>&#160;<span class="preprocessor">#define MIN_READ_MIN_ATTRIBUTE              &quot;MINIMUMREADMIN&quot;</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab646f82c393af4916b407863aaac0299"> 1781</a></span>&#160;<span class="preprocessor">#define MIN_READ_MAX_ATTRIBUTE              &quot;MINIMUMREADMAX&quot;</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">// This is the OS defined maximum size for any single record.</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a8a12589d48e2c2d4ffcefea84b5f7c29"> 1784</a></span>&#160;<span class="preprocessor">#define MAX_RECORD_SIZE                     256 * 1024</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">// The default max and min read buffer sizes.</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a74f1846a02d7f8b0ad0599c7a3a041da"> 1787</a></span>&#160;<span class="preprocessor">#define MAX_READ_KB_COUNT                   256</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#acfb938f3543ca035196470d762cf7b0e"> 1788</a></span>&#160;<span class="preprocessor">#define MAX_READ_BUFFER                     MAX_READ_KB_COUNT * 1024</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a037f5d76557f9c16409aeab83fe120bb"> 1789</a></span>&#160;<span class="preprocessor">#define MIN_READ_KB_COUNT                   16</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aa4b024b952732c31c2d25e166e5b135e"> 1790</a></span>&#160;<span class="preprocessor">#define MIN_READ_BUFFER                     MIN_READ_KB_COUNT  * 1024</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a2d3d1d62890a860f95780130bf735f1d"> 1792</a></span>&#160;<span class="preprocessor">#define BAD_RECORD_ARRAY_MSG   &quot;The events attribute has been altered so it is no longer an array object&quot;</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a4ccce5d332e65e26ace760c0ccf608cc"> 1793</a></span>&#160;<span class="preprocessor">#define BAD_RECORD_START_MSG   &quot;Requested start exceeds number of records&quot;</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a953f077e4879920ecb6f4fa8a06d5454"> 1794</a></span>&#160;<span class="preprocessor">#define TOO_SMALLBUFFER_MSG    &quot;An event log record is too large (%u) for the read buffer (%u.)&quot;</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a368e6727c639f7b558a93a5d90e17e71"> 1795</a></span>&#160;<span class="preprocessor">#define START_RECORD_OUT_OF_RANGE_MSG &quot;The start record (%u) is out of range; (%u - %u)&quot;</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a06c944ad5a39b2926947690ecd1c65f9"> 1796</a></span>&#160;<span class="preprocessor">#define END_RECORD_OUT_OF_RANGE_MSG &quot;start and count produce an end record (%u) out of range; (%u - %u)&quot;</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15b"> 1798</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">enum</span> {<a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba062e05b5bc3b37029e8ba3c3a32d6d1f">record_count</a>, <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15baa7a345feda2b0e57c9c1628e29af6f88">oldest_record</a>, <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba19c5aa8fcb5755c3ec2a835229ac6ba2">youngest_record</a>} <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15b">LogNumberOp</a>;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="comment"> * Query the registery for the name of an event record&#39;s message file. The file</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment"> * name of the message file is stored as a value of a subkey under an</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment"> * application log. The subkey name is the source name of the event.  The value</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment"> * name corresponds to the type of message file, event, parameter, or category.</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment"> * (Although the category message file is not currently used by the</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="comment"> * WindowsEventLog object.)</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;<span class="comment"> * @param pValueName  The name of the value whose data is being sought. The data</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;<span class="comment"> *                    is the message file name.</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="comment"> * @param logName     The name of the event log.</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment"> * @param source      The source of the event in the specified event log.</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="comment"> * @param fileBuffer  [out] The message file path name is returned in this</span></div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="comment"> *                    buffer, which must be at least MAX_PATH in size.</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a43db62bb156d454cda719114b57c7ad7"> 1815</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#a43db62bb156d454cda719114b57c7ad7">lookupMessageFile</a>(<span class="keywordtype">char</span> *pValueName, <span class="keywordtype">char</span> *logName, <span class="keywordtype">char</span> *source, <span class="keywordtype">char</span> *fileBuffer)</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;{</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordtype">char</span> eventLogKey[] = <span class="stringliteral">&quot;SYSTEM\\CurrentControlSet\\Services\\EventLog\\&quot;</span>;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    DWORD  dataSize;                   <span class="comment">// size of the message file name returned from RegQueryValueEx</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    DWORD  valueType = REG_EXPAND_SZ;  <span class="comment">// type for call to RegQueryValueEx</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordtype">char</span>  *valueData;                  <span class="comment">// value returned from RegQueryValueEx</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordtype">char</span>  *pKey;                       <span class="comment">// name of complete key</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    HKEY   hKey;                       <span class="comment">// handle of key</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">// If there is no value in the registry for the message file, or an error</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// happens, return the empty string</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    fileBuffer[0] =<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">// Build the complete key name</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    pKey = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, strlen(eventLogKey) + strlen(logName) + 1 + strlen(source) + 1);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    sprintf(pKey, <span class="stringliteral">&quot;%s%s\\%s&quot;</span>, eventLogKey, logName, source);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordflow">if</span> ( RegOpenKeyEx(HKEY_LOCAL_MACHINE, pKey, 0, KEY_QUERY_VALUE, &amp;hKey) == ERROR_SUCCESS )</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        <span class="comment">// Use null for the data value to query for the size of the data.</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keywordflow">if</span> ( RegQueryValueEx(hKey, pValueName, NULL, &amp;valueType, NULL, &amp;dataSize) == ERROR_SUCCESS )</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        {</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            <span class="comment">// No error getting the size of the message file name, allocate a</span></div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            <span class="comment">// buffer and get the value</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            valueData = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, dataSize);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="keywordflow">if</span> ( RegQueryValueEx(hKey, pValueName, NULL, &amp;valueType, (LPBYTE)valueData, &amp;dataSize) == ERROR_SUCCESS )</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                <span class="comment">// Place the message file path name in the return buffer,</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                <span class="comment">// expanding any environment variables in the process.</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                ExpandEnvironmentStrings(valueData, fileBuffer, MAX_PATH);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            LocalFree(valueData);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        }</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    LocalFree(pKey);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;}</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment"> * Search a list of messages files for a specified message ID and, if found,</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment"> * format and return the message.</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment"> * @param files      List of message files separated by a semi-colon.</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment"> * @param msgID      The message ID to search for.</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment"> * @param ppInserts  Possible array of insertion strings to use when formatting</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment"> *                   the message.</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment"> * @param lpMsgBuf   On success, a returned buffer containing the formatted</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment"> *                   message.</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment"> * @return True if the message was found and formatted, false if not found or</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="comment"> *         any other error.</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="comment"> * @note On success, lpMsgBuf will have been allocated by FormatMessage().  This</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="comment"> *       buffer must be freed by the caller with LocalFree().</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a38366f94d2b029adc212fe72dcb0104f"> 1871</a></span>&#160;BOOL <a class="code" href="rxwinsys_8cpp.html#a38366f94d2b029adc212fe72dcb0104f">findAndFormatDescription</a>(<span class="keywordtype">char</span> *files, DWORD msgID, <span class="keywordtype">char</span> **ppInserts, LPVOID *lpMsgBuf )</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;{</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    HINSTANCE h = NULL;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="keywordtype">char</span>     *pBuffer = NULL;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="keywordtype">char</span>     *pTemp = NULL;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordtype">char</span>     *pNext = NULL;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    DWORD     count = 0;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="keywordflow">if</span> ( *files != <span class="charliteral">&#39;\0&#39;</span> )</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    {</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        DWORD flags = FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_HMODULE | FORMAT_MESSAGE_ARGUMENT_ARRAY;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        DWORD langID = MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        pBuffer = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, strlen(files) + 1);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <span class="keywordflow">if</span> ( pBuffer != NULL )</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;            strcpy(pBuffer, files);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;            pTemp = pBuffer;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;            <span class="keywordflow">while</span> ( pTemp != NULL &amp;&amp; count == 0 )</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;                pNext = strchr(pTemp, <span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                <span class="keywordflow">if</span> ( pNext != NULL )</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;                {</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;                    *pNext = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;                    pNext++;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;                }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;                h = LoadLibrary(pTemp);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;                <span class="keywordflow">if</span> ( h != NULL )</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;                    count = FormatMessage(flags, h, msgID, langID, (LPTSTR)lpMsgBuf, 0, ppInserts);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;                    FreeLibrary(h);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;                    h = NULL;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;                }</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                pTemp = pNext;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            LocalFree(pBuffer);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        }</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    }</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">return</span>(count != 0);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;}</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment"> * Builds up the descriptive message that goes with an event record.</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="comment"> * @param pEvLogRecord  Event record of interest.</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment"> * @param pchSource     Source of event with an event log.</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment"> * @param ppMessage     Formatted description is returned here.</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab14501d93a4200a18cab8bfd014cea85"> 1921</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#ab14501d93a4200a18cab8bfd014cea85">getEventDescription</a>(PEVENTLOGRECORD pEvLogRecord , <span class="keyword">const</span> <span class="keywordtype">char</span> *pchSource, <span class="keywordtype">char</span> **ppMessage)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;{</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordtype">char</span>  *pchString = NULL;           <span class="comment">// pointer to substitution string within event log record</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordtype">int</span>    iStringLen = 0;             <span class="comment">// accumulation of the string length</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    HINSTANCE hInstance = NULL;        <span class="comment">// handle for message files</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    LPVOID    lpMsgBuf = NULL;         <span class="comment">// buffer to format the string</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keywordtype">char</span>      *pSubstitutions[100];    <span class="comment">// array of substitution strings</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordtype">char</span>      chMessageFile[MAX_PATH]; <span class="comment">// name of message file</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keywordtype">char</span>      *pchPercent;             <span class="comment">// pointer to &quot;%%&quot; within a substitution string</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">// Initialize the array of substitution strings.</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    memset(pSubstitutions, 0, <span class="keyword">sizeof</span>(pSubstitutions));</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="comment">// Point to first substitution string in the event log record.</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    pchString = (<span class="keywordtype">char</span>*)pEvLogRecord + pEvLogRecord-&gt;StringOffset;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160; </div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">// It is possible that the substitution strings themselves contain</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="comment">// substitutions in the form of %%nn.  The replacement for these comes from</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">// the &#39;ParameterMessageFile&#39;</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="comment">// Loop over all the substitution strings, replacing each &quot;%%&quot; with a value</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="comment">// from the ParameterMessageFile. This builds an array of formatted</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="comment">// substitution strings.</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    for ( <span class="keywordtype">int</span> i = 0; i &lt; pEvLogRecord-&gt;NumStrings; i++ )</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    {</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="comment">// If a substitution string contains &quot;%%&quot;, the name of the parameter</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="comment">// message file is read from the registry log. Each &quot;%%&quot; is followed by</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <span class="comment">// an id, which is the id of the parameter string to be loaded from the</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <span class="comment">// parameter message file.  The %% and id are then replaced by the</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="comment">// parameter string in the substitution string by FormatMessage().</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span> ( (pchPercent = strstr(pchString, <span class="stringliteral">&quot;%%&quot;</span>)) )</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            <span class="comment">// This substitution string contains a placeholder for parameters.</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="comment">// Get the name of parameter message file from the registry.</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a43db62bb156d454cda719114b57c7ad7">lookupMessageFile</a>(<span class="stringliteral">&quot;ParameterMessageFile&quot;</span>, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(pchSource),</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                              (<span class="keywordtype">char</span> *)pEvLogRecord + <span class="keyword">sizeof</span>(EVENTLOGRECORD), chMessageFile);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            DWORD flags = FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_HMODULE | FORMAT_MESSAGE_IGNORE_INSERTS;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            DWORD langID = MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <span class="keywordtype">int</span>   <span class="keywordtype">id</span> = atoi(pchPercent + 2);   <span class="comment">// ID of message to be loaded</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            <span class="comment">// Load the parameter message file and format the substitution</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <span class="comment">// string.</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            <span class="keywordflow">if</span> ( (hInstance = LoadLibrary(chMessageFile)) != NULL )</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                <span class="keywordflow">if</span> ( FormatMessage(flags, hInstance, <span class="keywordtype">id</span>, langID, (LPTSTR)&amp;pSubstitutions[i], 0, 0) == 0 )</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                {</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                    <span class="comment">// An error occurred formatting the string, use the empty</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                    <span class="comment">// string.</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                    pSubstitutions[i] = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, 1);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                FreeLibrary(hInstance);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                hInstance = NULL;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            }</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                <span class="comment">// The parameter message file could not be loaded, use the empty</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                <span class="comment">// string.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                pSubstitutions[i] = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, 1);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;            <span class="comment">// Accumulate the total string length.</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            iStringLen += (int)strlen(pSubstitutions[i]) + 1;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        }</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        {</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            <span class="comment">// The substitution string does not have any replaceable parameters,</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            <span class="comment">// use them as is.</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            iStringLen += (int)strlen(pchString) + 1;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            pSubstitutions[i] = (<span class="keywordtype">char</span> *)LocalAlloc(LMEM_FIXED, strlen(pchString) + 1);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            strcpy(pSubstitutions[i], pchString);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="comment">// Point to next substitution string within the log record.</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        pchString += strlen(pchString) + 1;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="comment">// Get the name of event log  message file from the registry</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a43db62bb156d454cda719114b57c7ad7">lookupMessageFile</a>(<span class="stringliteral">&quot;EventMessageFile&quot;</span>, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(pchSource),</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                      (<span class="keywordtype">char</span> *)pEvLogRecord + <span class="keyword">sizeof</span>(EVENTLOGRECORD), chMessageFile);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160; </div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="comment">// Search for the message ID in the all event message files and format the</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="comment">// descriptive message if it is found.</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="rxwinsys_8cpp.html#a38366f94d2b029adc212fe72dcb0104f">findAndFormatDescription</a>(chMessageFile, pEvLogRecord-&gt;EventID, pSubstitutions, &amp;lpMsgBuf) )</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    {</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="comment">// The message ID was found and the descriptive message was formatted.</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">// So return that.</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        *ppMessage = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, strlen((<span class="keywordtype">char</span>*)lpMsgBuf) + 1);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        strcpy(*ppMessage, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)lpMsgBuf);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        <span class="comment">// lpMsgBuf will have been allocated by FormatMessage(), it is no longer</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="comment">// needed so free it here.</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        LocalFree(lpMsgBuf);</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    }</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="comment">// The  message ID was not found, or some other error. Use the</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="comment">// substitution strings for the descriptive message, if there are any.</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <span class="keywordflow">if</span> ( pEvLogRecord-&gt;NumStrings )</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            *ppMessage = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, iStringLen + 1);</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; pEvLogRecord-&gt;NumStrings; i++ )</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            {</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                strcat(*ppMessage, pSubstitutions[i]);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                strcat(*ppMessage, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            <span class="comment">// No substitution strings, just return the empty string for the</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            <span class="comment">// descriptive message.</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            *ppMessage = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, 1);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <span class="comment">// Free any substitution strings.</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; pEvLogRecord-&gt;NumStrings; i++ )</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        LocalFree(pSubstitutions[i]);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;}</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment"> * Translates the security ID value in the event log record to a user name, or</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment"> * &quot;N/A&quot; if that is not possible.</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"> * @param pEvLogRecord  Pointer to event log record.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment"> * @return  Allocated string naming the user.</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment"> * @note The string is allocated using LocalAlloc and must be freed using</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment"> *       LocalFree.</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a6f29f77dec6b904b670cbaa9a30d9ac4"> 2055</a></span>&#160;<span class="keywordtype">char</span> * <a class="code" href="rxwinsys_8cpp.html#a6f29f77dec6b904b670cbaa9a30d9ac4">getEventUserName</a>(PEVENTLOGRECORD pEvLogRecord)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;{</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    SID   *psid;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordtype">char</span>  *pUserID = NULL;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    DWORD  sizeID = 0;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordtype">char</span>   defUserID[] = <span class="stringliteral">&quot;N/A&quot;</span>;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// Needed for LookupAccountSid(), but not used.</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    SID_NAME_USE strDummy;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordtype">char</span>  *pDomain = NULL;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    DWORD sizeDomain = 0;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordflow">if</span> ( pEvLogRecord-&gt;UserSidLength == 0 )</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="comment">// No SID record avaialable return default user ID</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        pUserID = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, strlen(defUserID) + 1);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        strcpy(pUserID, defUserID);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    }</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="comment">// Get the SID record within the event log record</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        psid = (SID *)((<span class="keywordtype">char</span>*)pEvLogRecord + pEvLogRecord-&gt;UserSidOffset);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160; </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="comment">// Get the size required for the return buffers</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        LookupAccountSid(NULL, psid, pUserID, &amp;sizeID, pDomain, &amp;sizeDomain, &amp;strDummy);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        pUserID = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, std::max(sizeID, (DWORD)strlen(defUserID) + 1));</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        pDomain = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, sizeDomain);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordflow">if</span> ( LookupAccountSid(NULL, psid, pUserID, &amp;sizeID, pDomain, &amp;sizeDomain, &amp;strDummy) == 0 )</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <span class="comment">// Some type of error, just use the default.</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            strcpy(pUserID, defUserID);</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <span class="comment">// Historically, the domain name has not been returned to the ooRexx</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        <span class="comment">// user.  Seems as though some one might want it.</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        LocalFree(pDomain);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">return</span> pUserID;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;}</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="comment"> * Allocates a buffer and fills it with the event log record&#39;s binary data field</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment"> * converted to a character representation.  I.e., 4115 would be converted to a</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment"> * series of chars: 01000103 (0x1013 == 4115) and returned in the buffer.</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment"> * @param pEvLogRecord  [in]  Pointer to an event log record.</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment"> * @param ppBinData     [out] Allocated buffer address is returned here.</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment"> * @return  Number of characters used to represent the binary data bytes, with 0</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment"> *          having the special meaning that there was no binary data in the</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment"> *          event record. When 0 is returned, the actual size of the buffer is</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment"> *          1.</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment"> * @note The buffer is allocated using LocalAlloc and must be freed using</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;<span class="comment"> *       LocalFree.</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a94cb90524f59e324cf51d65819c4002f"> 2113</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rxwinsys_8cpp.html#a94cb90524f59e324cf51d65819c4002f">getEventBinaryData</a>(PEVENTLOGRECORD pEvLogRecord, <span class="keywordtype">char</span> **ppBinData )</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;{</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="keywordtype">char</span>  *pRecData;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    <span class="keywordtype">char</span>   pTemp[3];</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordtype">char</span>  *p;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">if</span> ( pEvLogRecord-&gt;DataLength != 0 )</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        *ppBinData = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, (pEvLogRecord-&gt;DataLength + 1) * 2);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        p = *ppBinData;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        pRecData = (<span class="keywordtype">char</span>*)pEvLogRecord + pEvLogRecord-&gt;DataOffset;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        for ( DWORD i = 0; i &lt; pEvLogRecord-&gt;DataLength; i++ )</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            _snprintf(pTemp, <span class="keyword">sizeof</span>(pTemp), <span class="stringliteral">&quot;%02x&quot;</span>, *pRecData);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            memcpy(p, pTemp, 2);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            p += 2;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            pRecData++;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        *ppBinData = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, 1);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160; </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordflow">return</span> (pEvLogRecord-&gt;DataLength * 2);</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;}</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160; </div>
<div class="line"><a name="l02142"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a04d50ab193eca808cc1ebb64b47a1788"> 2142</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#a04d50ab193eca808cc1ebb64b47a1788">systemServiceException</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context, <span class="keywordtype">char</span> *msg)</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;{</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#ac62b63c2b452912b30225fc815ff22a8">Rexx_Error_System_service_user_defined</a>, context-&gt;NewStringFromAsciiz(msg));</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;}</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab5384a0ced990b4c4cd4148fc52c66cd"> 2147</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#ab5384a0ced990b4c4cd4148fc52c66cd">outOfMemoryException</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;{</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a04d50ab193eca808cc1ebb64b47a1788">systemServiceException</a>(c, <span class="stringliteral">&quot;Failed to allocate memory&quot;</span>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;}</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab80971a64f26cbbb73989c0d7a9718dc"> 2152</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#ab80971a64f26cbbb73989c0d7a9718dc">wrongArgValueException</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c, <span class="keywordtype">int</span> pos, <span class="keyword">const</span> <span class="keywordtype">char</span> *list, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> actual)</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;{</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    c-&gt;RaiseException(<a class="code" href="oorexxerrors_8h.html#ac33b057994061ab05d6cb021d56b8452">Rexx_Error_Incorrect_method_list</a>,</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                      c-&gt;ArrayOfFour(c-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), c-&gt;WholeNumberToObject(pos), c-&gt;String(list), actual));</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;}</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160; </div>
<div class="line"><a name="l02158"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#af98461dd226ef19bc267fae53cab7f7a"> 2158</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#ab80971a64f26cbbb73989c0d7a9718dc">wrongArgValueException</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c, <span class="keywordtype">int</span> pos, <span class="keyword">const</span> <span class="keywordtype">char</span> *list, <span class="keyword">const</span> <span class="keywordtype">char</span> *actual)</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;{</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#ab80971a64f26cbbb73989c0d7a9718dc">wrongArgValueException</a>(c, pos, list, c-&gt;NewStringFromAsciiz(actual));</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;}</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02163"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aab5e324ac01f845f5194a0b3bd0d850a"> 2163</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="rxwinsys_8cpp.html#aab5e324ac01f845f5194a0b3bd0d850a">wrongClassException</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c, <span class="keywordtype">int</span> pos, <span class="keyword">const</span> <span class="keywordtype">char</span> *n)</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;{</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    c-&gt;RaiseException3(<a class="code" href="oorexxerrors_8h.html#a0395a9255c4ae96c92e371187c9389c0">Rexx_Error_Incorrect_method_noclass</a>, c-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), c-&gt;WholeNumberToObject(pos), c-&gt;NewStringFromAsciiz(n));</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;}</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02170"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a4c604199aba0fbfcec58cf158e43bc48"> 2170</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="rxwinsys_8cpp.html#a4c604199aba0fbfcec58cf158e43bc48">setCurrentHandle</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context, HANDLE h)</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;{</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#a01110c4f8c467f1ead522c735bb03231">HANDLE_ATTRIBUTE</a>, context-&gt;NewPointer(h));</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;}</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment"> * Gets the handle value at the CURRENTHANDLE attribute. If the handle is not</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment"> * null, it is an open handle to an event log.</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="comment"> * @param context  The method context we are operating under.</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment"> * @return An event handle.  It is not unexpected that this handle is NULL.</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#abc4960e61cfba1fc781c802c1ab019ce"> 2183</a></span>&#160;HANDLE <a class="code" href="rxwinsys_8cpp.html#abc4960e61cfba1fc781c802c1ab019ce">getCurrentHandle</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context)</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;{</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    HANDLE h = NULL;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> ptr = context-&gt;GetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#a01110c4f8c467f1ead522c735bb03231">HANDLE_ATTRIBUTE</a>);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordflow">if</span> ( ptr != <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        h = (HANDLE)context-&gt;PointerValue((<a class="code" href="rexx_8h.html#aebdf384b016ed3ba91995946dbce0d55">RexxPointerObject</a>)ptr);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">return</span> h;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;}</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment"> * Gets the minimum read buffer size for reading event records from the object</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment"> * attribute.  This minimum can be changed by the user.  If some error happens,</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment"> * then the original default value is returned.</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment"> * @param c  The method context we are operating under.</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment"> * @return  The current minimum buffer size.</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a7b184a37509bbcfe3cb46b4f60ac879f"> 2204</a></span>&#160;DWORD <a class="code" href="rxwinsys_8cpp.html#a7b184a37509bbcfe3cb46b4f60ac879f">getMinimumReadBufferSize</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *c)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;{</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> val = 0;</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160; </div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> ptr = c-&gt;GetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#af00eef1f14766857695424b90e5442c6">MIN_READ_BUFFER_ATTRIBUTE</a>);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="keywordflow">if</span> ( ptr != <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="keywordflow">if</span> ( ! c-&gt;ObjectToUnsignedInt32(ptr, &amp;val) )</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            val = <a class="code" href="rxwinsys_8cpp.html#aa4b024b952732c31c2d25e166e5b135e">MIN_READ_BUFFER</a>;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        }</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    }</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordflow">return</span> (DWORD)val;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;}</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment"> * Gets the records array (the array at the EVENTS attribute.)  The array is</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment"> * emptied before it is returnd.</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment"> * @param context  The method context we are operating under.</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment"> * @return The empty records array on success, a null object on error.</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="comment"> * @note  If NULLOBJECT is returned an exception has been raised.</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a518a7a5ade9839384bae06ec5751ac40"> 2229</a></span>&#160;<a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a> <a class="code" href="rxwinsys_8cpp.html#a518a7a5ade9839384bae06ec5751ac40">getRecordArray</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context)</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;{</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    <a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a> records = <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a>;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> ptr = context-&gt;GetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#acd4df271e9d7f1d95ad77935c918829c">RECORDS_ATTRIBUTE</a>);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordflow">if</span> ( ptr != <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="keywordflow">if</span> ( context-&gt;IsArray(ptr) )</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            records = (<a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a>)ptr;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    }</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160; </div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <span class="keywordflow">if</span> ( records == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    {</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#a7bbb006f59adeabeff7fcc82ebd31713">Rexx_Error_Execution_user_defined</a>,</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;                                 context-&gt;NewStringFromAsciiz(<a class="code" href="rxwinsys_8cpp.html#a2d3d1d62890a860f95780130bf735f1d">BAD_RECORD_ARRAY_MSG</a>));</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;        context-&gt;SendMessage0(records, <span class="stringliteral">&quot;EMPTY&quot;</span>);</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    }</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">return</span> records;</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;}</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">/**  getOpenEventLog()</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="comment"> * Gets the opened handle to the specified event log.</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="comment"> * For the WindowsEventLog class, a currently opened event log handle always</span></div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment"> * take precedence over anything specified by the user.  If currentHandle is not</span></div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment"> * null, then server and source are always ignored.</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="comment"> * If there is not a currently opened handle, then the user specified server and</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment"> * source are used.  Both server and source have defaults, so the user does not</span></div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment"> * need to specify either.</span></div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment"> * Note that in the OpenEventLog() call, null is used to indicate the default</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment"> * server (the local machine.)  If the user omitted the server arg, then sever</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="comment"> * will be null, which gives us the default automatically.  Also note that</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment"> * historically the empty string has also been used to indicate the default, so</span></div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment"> * that is maintained here.</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment"> * @param context  The method context pointer</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment"> * @param server   The server to open the event log on.  If specified this must</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="comment"> *                 be in UNC format, but we do not check for that, merely let</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="comment"> *                 the function fail.</span></div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="comment"> * @param source   The source event log to open, may be omitted.</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment"> * @param pHandle  The opened handle is returned here.</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment"> * @param pRC      On an OS error, the value of GetLastError() is returned here,</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment"> *                 otherwise 0 is returned here.</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment"> * @return         True indicates that the event log handle was opened by this</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment"> *                 function and should be closed by the caller.  False</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment"> *                 indicates that the handle comes from the currentHandle</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment"> *                 attribute and should not be closed by the caller.</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb"> 2287</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb">getOpenEventLog</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context, <span class="keyword">const</span> <span class="keywordtype">char</span> *server, <span class="keyword">const</span> <span class="keywordtype">char</span> *source, HANDLE *pHandle, DWORD *pRC)</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;{</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordtype">bool</span> didOpen = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    *pRC = 0;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    HANDLE hEventLog = <a class="code" href="rxwinsys_8cpp.html#abc4960e61cfba1fc781c802c1ab019ce">getCurrentHandle</a>(context);</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keywordflow">if</span> ( hEventLog == NULL )</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="keywordflow">if</span> ( server != NULL &amp;&amp; strlen(server) == 0 )</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            server = NULL;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        <span class="keywordflow">if</span> ( source == NULL || strlen(source) == 0 )</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            source = <a class="code" href="rxwinsys_8cpp.html#ac39d1e16ee52dc59170c491859b46cde">WSEL_DEFAULT_SOURCE</a>;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160; </div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        hEventLog = OpenEventLog(server, source);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">if</span> ( hEventLog == NULL )</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            *pRC = GetLastError();</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        {</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;            didOpen = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    }</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    *pHandle = hEventLog;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keywordflow">return</span> didOpen;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;}</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment"> * If the current handle attribute has an opened handle, then it is closed.</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment"> * @param context  The method context we are operating under.</span></div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment"> * @return  0 if there is no open handle, or on success.  If there is an error</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment"> *          closing an open handle, then the system error code is returned.</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ac83e426576b8f8f96731edaca025157d"> 2328</a></span>&#160;DWORD <a class="code" href="rxwinsys_8cpp.html#ac83e426576b8f8f96731edaca025157d">closeEventLog</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context)</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;{</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    DWORD rc = 0;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    HANDLE hEventLog = <a class="code" href="rxwinsys_8cpp.html#abc4960e61cfba1fc781c802c1ab019ce">getCurrentHandle</a>(context);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keywordflow">if</span> ( hEventLog != NULL )</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        rc = (CloseEventLog(hEventLog) == 0) ? GetLastError() : 0;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a4c604199aba0fbfcec58cf158e43bc48">setCurrentHandle</a>(context, NULL);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    }</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;}</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment"> * Gets either the total count of records in the event log, or the record number</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment"> * of the oldest record, or the record number of the youngest record in the</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment"> * event log.</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="comment"> * The first record written to the log is record number 1, so 1 is often the</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="comment"> * oldest record.  However, if the user elects to have the log records</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="comment"> * over-written when the log is full, the oldest record will no longer be 1 as</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="comment"> * soon as the log starts to overwrite exsiting records.</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment"> * @param context     The method context we are operating under.</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment"> * @param numberType  The number operation, i.e. what to do.</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment"> * @param server      The server arg, see getOpenEventLog() for details.</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="comment"> * @param source      The source arg, see getOpenEventLog() for details.</span></div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="comment"> * @return The number requested on success, or the negated system error code on</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="comment"> *         failure.</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aaaec8ce37979776accc70e9a83b8e3bb"> 2359</a></span>&#160;<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> <a class="code" href="rxwinsys_8cpp.html#aaaec8ce37979776accc70e9a83b8e3bb">getEventLogNumber</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context, <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15b">LogNumberOp</a> numberType, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> server, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> source)</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;{</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;    <a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> retNum = 0;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    HANDLE hEventLog;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;    DWORD number;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    BOOL success;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160; </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    <span class="comment">// We use number to hold a returned error code, if there is one.</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    <span class="keywordtype">bool</span> didOpen = <a class="code" href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb">getOpenEventLog</a>(context, server, source, &amp;hEventLog, &amp;number);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160; </div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">if</span> ( hEventLog == NULL )</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        retNum = -(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>)number;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        <span class="keywordflow">goto</span> finished;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    }</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160; </div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    <span class="comment">// Unfortunately, on Vista, GetOldestEventLogRecord() returns an error if</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    <span class="comment">// the log is empty.  So, we work around that.</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    DWORD count;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    success = GetNumberOfEventLogRecords(hEventLog, &amp;count);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <span class="keywordflow">if</span> ( ! success )</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        retNum = -(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>)GetLastError();</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <span class="keywordflow">goto</span> finished;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    }</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordflow">if</span> ( count == 0 )</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        retNum = 0;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        <span class="keywordflow">goto</span> finished;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    }</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160; </div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    DWORD oldest;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    success = GetOldestEventLogRecord(hEventLog, &amp;oldest);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    <span class="keywordflow">if</span> ( ! success )</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    {</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        retNum = -(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>)GetLastError();</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="keywordflow">goto</span> finished;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    }</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    <span class="keywordflow">switch</span> ( numberType )</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    {</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba062e05b5bc3b37029e8ba3c3a32d6d1f">record_count</a> :</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;            retNum = count;</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15baa7a345feda2b0e57c9c1628e29af6f88">oldest_record</a> :</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            retNum = oldest;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba19c5aa8fcb5755c3ec2a835229ac6ba2">youngest_record</a> :</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;            retNum = oldest + count - 1;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        default :</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;            <span class="comment">// This really should be impossible.</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    }</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;finished:</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    <span class="keywordflow">if</span> ( didOpen )</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        CloseEventLog(hEventLog);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="keywordflow">return</span> retNum;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;}</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment"> * Convenience function to do most of the arg checking for the</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment"> * WindowsEventLog::readRecords() method.</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment"> * @param context    The method context we&#39;re operating under.</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment"> * @param hLog       The opened handle to the event log we are dealing with.</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment"> * @param direction  The direction arg (arg 1) passed to the method.</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment"> * @param start      The start arg (arg 4) passed to the method.</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment"> * @param count      Pointer to the count arg (arg 5) passed to the method.  The</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment"> *                   true count of records to be read is returned here.</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment"> * @param flags      Pointer to the flags to use in the ReadEventLog() API.  The</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment"> *                   actual flags to use are based on the args passed to the</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment"> *                   method and returned here.</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment"> * @param rc         A returned error code, 0 or a system error code.</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment"> * @return           True if things should continue, or false if they should not</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment"> *                   continue.</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment"> * @note             If false is returned, it is likely that an exception has</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment"> *                   been raised.  But, it may just be an OS system error.  In</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment"> *                   all cases the value of rc should be returned to the</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment"> *                   interpreter. If an exception has not been raised, it is the</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment"> *                   system error code that needs to be returned to the ooRexx</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment"> *                   programmer.</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a0bb43c76e5cefb507fab2e661b85cb83"> 2452</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="rxwinsys_8cpp.html#a0bb43c76e5cefb507fab2e661b85cb83">checkReadRecordsArgs</a>(<a class="code" href="struct_rexx_method_context__.html">RexxMethodContext</a> *context, HANDLE hLog, <a class="code" href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a> direction,</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                          <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> start, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> *count, DWORD *flags, DWORD *rc)</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;{</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;    *flags = EVENTLOG_FORWARDS_READ;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(1) )</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    {</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        <span class="keywordflow">if</span> ( stricmp(<span class="stringliteral">&quot;FORWARDS&quot;</span>, direction) == 0 )</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            ; <span class="comment">// Do nothing, flags are correct.</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        }</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( stricmp(<span class="stringliteral">&quot;BACKWARDS&quot;</span>, direction) == 0 )</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            *flags = EVENTLOG_BACKWARDS_READ;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        }</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;        {</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#ab80971a64f26cbbb73989c0d7a9718dc">wrongArgValueException</a>(context, 1, <span class="stringliteral">&quot;FORWARDS, BACKWARDS&quot;</span>, direction);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        }</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    }</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(4) || <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(5) )</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(4) )</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        {</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            context-&gt;RaiseException2(<a class="code" href="oorexxerrors_8h.html#a2c7c3fa4d6a576b5cf85176ea712cbfb">Rexx_Error_Incorrect_method_noarg</a>, context-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), context-&gt;WholeNumberToObject(4));</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a>(5) )</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;        {</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; </div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            context-&gt;RaiseException2(<a class="code" href="oorexxerrors_8h.html#a2c7c3fa4d6a576b5cf85176ea712cbfb">Rexx_Error_Incorrect_method_noarg</a>, context-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>), context-&gt;WholeNumberToObject(5));</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;        }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        *flags |= EVENTLOG_SEEK_READ;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    }</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        *flags |= EVENTLOG_SEQUENTIAL_READ;</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160; </div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    DWORD totalRecords;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    <span class="keywordflow">if</span> ( GetNumberOfEventLogRecords(hLog, &amp;totalRecords) == 0 )</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    {</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        *rc = GetLastError();</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    }</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160; </div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <span class="comment">// We only need good start and count values if we are doing a seek read.</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="comment">// The start value is ignored on sequential reads.  The oldest record has</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    <span class="comment">// the smallest record number, always.</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordflow">if</span> ( *flags &amp; EVENTLOG_SEEK_READ )</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    {</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        DWORD oldestRecord;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        <span class="keywordflow">if</span> ( GetOldestEventLogRecord(hLog, &amp;oldestRecord) == 0 )</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            *rc = GetLastError();</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160; </div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        DWORD youngestRecord = oldestRecord + totalRecords - 1;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        <span class="keywordtype">char</span>  tmp[256];</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160; </div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        <span class="keywordflow">if</span> ( youngestRecord &lt; start || start &lt; oldestRecord )</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        {</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;            _snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <a class="code" href="rxwinsys_8cpp.html#a368e6727c639f7b558a93a5d90e17e71">START_RECORD_OUT_OF_RANGE_MSG</a>, start, oldestRecord, youngestRecord);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160; </div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#ac991ff07ea2917919d739ad1937a4eb6">Rexx_Error_Incorrect_method_user_defined</a>,</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                                     context-&gt;NewStringFromAsciiz(tmp));</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160; </div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        DWORD endRecord;</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        <span class="keywordflow">if</span> ( *flags &amp; EVENTLOG_FORWARDS_READ )</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        {</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            endRecord = start + *count - 1;</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        }</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;            endRecord = start - *count + 1;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;        }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        <span class="keywordflow">if</span> ( youngestRecord &lt; endRecord || endRecord &lt; oldestRecord )</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            _snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <a class="code" href="rxwinsys_8cpp.html#a06c944ad5a39b2926947690ecd1c65f9">END_RECORD_OUT_OF_RANGE_MSG</a>, endRecord, oldestRecord, youngestRecord);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#ac991ff07ea2917919d739ad1937a4eb6">Rexx_Error_Incorrect_method_user_defined</a>,</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;                                     context-&gt;NewStringFromAsciiz(tmp));</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        }</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    }</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    {</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        <span class="comment">// For a sequential read, start is ignored.  But having a valid count</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        <span class="comment">// value makes looping through the log easier.</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        *count = totalRecords;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;    }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;}</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a89f130df48a2cead2ca86ede05b19785"> 2552</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="rxwinsys_8cpp.html#a89f130df48a2cead2ca86ede05b19785">isGoodEventType</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>)</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;{</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> == EVENTLOG_SUCCESS          ||</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;            <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> == EVENTLOG_AUDIT_FAILURE    ||</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;            <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> == EVENTLOG_AUDIT_SUCCESS    ||</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;            <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> == EVENTLOG_ERROR_TYPE       ||</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> == EVENTLOG_INFORMATION_TYPE ||</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;            <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> == EVENTLOG_WARNING_TYPE);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;}</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="comment">/** WindowsEventLog::init()</span></div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment"> * The init() method for the WindowsEventLog object.  Sets the object attributes</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="comment"> * to their default values.</span></div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a1042a09a841a5240ac3bb404bf8d47d1"> 2567</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(<span class="keywordtype">int</span>, WSEventLog_init)</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;{</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a> obj = context-&gt;NewArray(<a class="code" href="rxwinsys_8cpp.html#a0a474da6cd0be4c9cda56b3117ce2fcb">WSEL_DEFAULT_EVENTS_ARRAY_SIZE</a>);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#acd4df271e9d7f1d95ad77935c918829c">RECORDS_ATTRIBUTE</a>, obj);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160; </div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#af00eef1f14766857695424b90e5442c6">MIN_READ_BUFFER_ATTRIBUTE</a>, context-&gt;WholeNumberToObject(<a class="code" href="rxwinsys_8cpp.html#aa4b024b952732c31c2d25e166e5b135e">MIN_READ_BUFFER</a>));</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;    context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#ad39997964eafc3b9de2b4a2bfbe47b92">MIN_READ_MIN_ATTRIBUTE</a>, context-&gt;WholeNumberToObject(<a class="code" href="rxwinsys_8cpp.html#a037f5d76557f9c16409aeab83fe120bb">MIN_READ_KB_COUNT</a>));</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#ab646f82c393af4916b407863aaac0299">MIN_READ_MAX_ATTRIBUTE</a>, context-&gt;WholeNumberToObject(<a class="code" href="rxwinsys_8cpp.html#a74f1846a02d7f8b0ad0599c7a3a041da">MAX_READ_KB_COUNT</a>));</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160; </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#a56f833879bcc8e4e40bfa5703ef90150">INITCODE_ATTRIBUTE</a>, context-&gt;WholeNumberToObject(0));</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160; </div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a4c604199aba0fbfcec58cf158e43bc48">setCurrentHandle</a>(context, NULL);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160; </div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;}</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="comment">/** WindowsEventLog::open()</span></div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="comment"> *  Opens a handle to the specified event log.</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="comment"> * @param server   [optional] The server to open the event log on.  If specified</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment"> *                 this should be in UNC format.  The default is the local</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment"> *                 machine.  The empty string can also be used to specify the</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="comment"> *                 local macnine.</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="comment"> * @param source   [optional] The event log to open, the default is the</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="comment"> *                 Application log.  The empty string can also be used to</span></div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="comment"> *                 specify the local machine.</span></div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="comment"> * @note  The event logging service will open the Application log if the</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="comment"> *        specified log (the source arg) can not be found.</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a15a6cff8d86b1ee1282cf3168fc87617"> 2599</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_open, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source)</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;{</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">// Close an already opened handle if there is one.</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#ac83e426576b8f8f96731edaca025157d">closeEventLog</a>(context);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="comment">// See the comment header for getOpenEventLog() for detail on the server and</span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;    <span class="comment">// source arguments.</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <span class="keywordflow">if</span> ( server != NULL &amp;&amp; strlen(server) == 0 )</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        server = NULL;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    }</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="keywordflow">if</span> ( source == NULL || strlen(source) == 0 )</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        source = <a class="code" href="rxwinsys_8cpp.html#ac39d1e16ee52dc59170c491859b46cde">WSEL_DEFAULT_SOURCE</a>;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    }</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    HANDLE hEventLog = OpenEventLog(server, source);</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="keywordflow">if</span> ( hEventLog == NULL )</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        <span class="keywordflow">return</span> GetLastError();</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    }</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160; </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a4c604199aba0fbfcec58cf158e43bc48">setCurrentHandle</a>(context, hEventLog);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;}</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment">/** WindowsEventLog::getNumber()</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment"> * Returns the number of event records in the specified log.</span></div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment"> * @param server     The server to open the event log on.  If specified this</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment"> *                   should be in UNC format.  The default is the local machine.</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment"> *                   macnine.</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment"> * @param source     The event log to open, the default is the Application log.</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment"> *                   machine.</span></div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment"> * @return  The count of records in the log.</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ae916296235b3177c0593b81579ae6c6f"> 2640</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>, WSEventLog_getNumber, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source)</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;{</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#aaaec8ce37979776accc70e9a83b8e3bb">getEventLogNumber</a>(context, <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba062e05b5bc3b37029e8ba3c3a32d6d1f">record_count</a>, server, source);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;}</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="comment">/** WindowsEventLog::getFirst()</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="comment"> * Returns the record number of the first recorded, or oldest, event.  Event</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="comment"> * log messages are numbered sequentially, with the oldest record having the</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="comment"> * lowest record number.</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="comment"> * @param server     The server to open the event log on.  If specified this</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="comment"> *                   should be in UNC format.  The default is the local machine.</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="comment"> *                   macnine.</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="comment"> * @param source     The event log to open, the default is the Application log.</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="comment"> *                   machine.</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="comment"> * @return  The record number of the first recorded event.</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a1b8a542ce21d0f2e7fc2a71abb4d0cdb"> 2662</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>, WSEventLog_getFirst, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source)</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;{</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#aaaec8ce37979776accc70e9a83b8e3bb">getEventLogNumber</a>(context, <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15baa7a345feda2b0e57c9c1628e29af6f88">oldest_record</a>, server, source);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;}</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">/** WindowsEventLog::getLast()</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="comment"> * Returns the record number of the last recorded, or youngest, event.  Event</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="comment"> * log messages are numbered sequentially, with the oldest record have the</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="comment"> * lowest record number.</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment"> * @param server     The server to open the event log on.  If specified this</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="comment"> *                   should be in UNC format.  The default is the local machine.</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="comment"> *                   macnine.</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="comment"> * @param source     The event log to open, the default is the Application log.</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;<span class="comment"> *                   machine.</span></div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment"> * @return  The record number of the last recorded event.</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02684"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a88e1a5a0a58dad7c6ffb1fe5f631b0c8"> 2684</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>, WSEventLog_getLast, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source)</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;{</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#aaaec8ce37979776accc70e9a83b8e3bb">getEventLogNumber</a>(context, <a class="code" href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba19c5aa8fcb5755c3ec2a835229ac6ba2">youngest_record</a>, server, source);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;}</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment">/** WindowsEventLog::isFull()</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="comment"> * Queries the event log to see if it is full.</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="comment"> * @return  True if event log is full, othewise false.  False is also returned</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="comment"> *          if any system error happens.</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aae8cd7bd04fa9651fe4c089f87ef8897"> 2696</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a>(<a class="code" href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a>, WSEventLog_isFull, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source)</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;{</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    HANDLE hLog;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    DWORD rc = 0;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    BOOL isFull = FALSE;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="comment">// An error is just ignored and false returned.</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordtype">bool</span> didOpen = <a class="code" href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb">getOpenEventLog</a>(context, server, source, &amp;hLog, &amp;rc);</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160; </div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    <span class="keywordflow">if</span> ( hLog != NULL )</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    {</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        EVENTLOG_FULL_INFORMATION efi;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        DWORD needed;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <span class="keywordflow">if</span> ( GetEventLogInformation(hLog, EVENTLOG_FULL_INFO, (<span class="keywordtype">void</span> *)&amp;efi, <span class="keyword">sizeof</span>(efi), &amp;needed) != 0 )</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;        {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            isFull = efi.dwFull ? TRUE : FALSE;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        }</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    }</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160; </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">if</span> ( didOpen )</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        CloseEventLog(hLog);</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    }</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <span class="keywordflow">return</span> isFull;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;}</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="comment">/** WindowsEventLog::clear()</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="comment"> * Clears, empties, the specified event log.  Optionally backs up the log before</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="comment"> * clearing it.</span></div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="comment"> * @param server     The server to open the event log on.  If specified this</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="comment"> *                   should be in UNC format.  The default is the local machine.</span></div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;<span class="comment"> *                   macnine.</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="comment"> * @param source     The event log to open, the default is the Application log.</span></div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="comment"> *                   machine.</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment"> * @param backupFile  If specified, the log will be backed up to this file.</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="comment"> *                    There is no default value.  If backupFile is omitted, the</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="comment"> *                    log is not backed up.  If a file name is supplied with no</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="comment"> *                    extension, the the default event log extension of &quot;.evt&quot;</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment"> *                    is added.</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment"> * @return            0 on success, the system error code otherwise.</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment"> * @note Note for the ooRexx docs:  The backup file can not exist on a remote</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment"> *       machine. In particular, you can not use a backup file that is on a</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment"> *       network mapped drive.  The clear operation will fail with rc 3 &#39;The</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment"> *       system cannot find the path specified.&#39;</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a4e5c8e76cd6cf339f33c80fd434e3d8d"> 2749</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a13ff8b1b17cbc0e24ffc50eef5beb06e">RexxMethod3</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_clear, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source,</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            OPTIONAL_CSTRING, backupFile)</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;{</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    HANDLE hEventLog;</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    DWORD rc = 0;</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <span class="keywordtype">bool</span> didOpen = <a class="code" href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb">getOpenEventLog</a>(context, server, source, &amp;hEventLog, &amp;rc);</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160; </div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keywordflow">if</span> ( hEventLog == NULL )</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    {</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <span class="keywordflow">if</span> ( backupFile != NULL &amp;&amp; strlen(backupFile) == 0 )</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        backupFile = NULL;</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160; </div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="comment">// If the user supplied a backup file name, and it does not have an</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="comment">// extension, then add the default extension for event log files.  Note that</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;    <span class="comment">// PathAddExtension() only adds the extension if the file does not already</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    <span class="comment">// have any extension.</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    <span class="keywordtype">char</span> *pDupeName = NULL;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    <span class="keywordflow">if</span> ( backupFile != NULL )</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    {</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;        pDupeName = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, MAX_PATH);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        <span class="keywordflow">if</span> ( ! pDupeName )</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        {</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#ab5384a0ced990b4c4cd4148fc52c66cd">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        strcpy(pDupeName, backupFile);</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        PathAddExtension(pDupeName, <span class="stringliteral">&quot;.evt&quot;</span>);</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;    <span class="keywordflow">if</span> ( ClearEventLog(hEventLog, pDupeName) == 0 )</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    {</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        rc = GetLastError();</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    <span class="comment">// If the arg to LocalFree() is null, LocalFree() does nothing.</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    LocalFree(pDupeName);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160; </div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">if</span> ( didOpen )</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    {</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        CloseEventLog(hEventLog);</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    }</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160; </div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;}</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="comment">/**  WindowsEventLog::write()</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment"> * Write an event to an event log.  In theory all args are optional, but that</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment"> * would not be much of an event.</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment"> * @param server     The server to open the event log on.  If specified this</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="comment"> *                   should be in UNC format.  The default is the local machine.</span></div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="comment"> *                   macnine.</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="comment"> * @param source     The event log to open, the default is the Application log.</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment"> *                   machine.</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment"> * @param type       The event type (EVENTLOG_SUCCESS EVENTLOG_AUDIT_FAILURE,</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment"> *                   etc.,) the default is 1.</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment"> * @param category   The event category, default is 0.</span></div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment"> * @param id         The event ID, default is 0.</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment"> * @param data       Raw binary data, default is none.</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="comment"> * @param strings    Args 7 to any number.  Any number of strings.  These are</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment"> *                   the insertion strings used to contruct the event</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment"> *                   descripiton.</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment"> * @return 0 on success, system error code on failure.</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a4cd8b7f46126137e3d9c80126cc5eacd"> 2826</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a4cd8b7f46126137e3d9c80126cc5eacd">RexxMethod7</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_write, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source,</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;            OPTIONAL_uint16_t, t, OPTIONAL_uint16_t, category, OPTIONAL_uint32_t, <span class="keywordtype">id</span>,</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;            OPTIONAL_RexxStringObject, rawData, <a class="code" href="oorexxapi_8h.html#aae1e6d73838504107707970bedfb1a40">ARGLIST</a>, args)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;{</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    DWORD rc = 0;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160; </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    WORD         <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>         = 1;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    <span class="keywordtype">void</span>        *data         = NULL;</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    DWORD        dataSize     = 0;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    WORD         countStrings = 0;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> **strings      = NULL;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160; </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="comment">// See the comment header for getOpenEventLog() for detail on the server and</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;    <span class="comment">// source arguments.</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    <span class="keywordflow">if</span> ( server != NULL &amp;&amp; strlen(server) == 0 )</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    {</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        server = NULL;</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <span class="keywordflow">if</span> ( source == NULL || strlen(source) == 0 )</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;    {</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;        source = <a class="code" href="rxwinsys_8cpp.html#ac39d1e16ee52dc59170c491859b46cde">WSEL_DEFAULT_SOURCE</a>;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160; </div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(3) &amp;&amp; <a class="code" href="rxwinsys_8cpp.html#a89f130df48a2cead2ca86ede05b19785">isGoodEventType</a>(t) )</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a> = t;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    }</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a>(6) )</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    {</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        dataSize = (DWORD)context-&gt;StringLength(rawData);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        data = malloc(dataSize);</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        <span class="keywordflow">if</span> ( data != NULL )</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        {</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;            memcpy(data, (<span class="keywordtype">void</span> *)context-&gt;StringData(rawData), dataSize);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;            dataSize = 0;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    }</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    <span class="keywordtype">size_t</span> argc = context-&gt;ArraySize(args);</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    <span class="keywordflow">if</span> ( argc &gt; 6 )</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    {</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;        strings = (<span class="keyword">const</span> <span class="keywordtype">char</span> **)malloc((argc - 6) * <span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keywordtype">char</span> **));</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;        <span class="keywordflow">if</span> ( strings != NULL )</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        {</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> **p = strings;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">size_t</span> i = 7; i &lt;= argc; i++, countStrings++)</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;            {</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a> obj = context-&gt;ArrayAt(args, i);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                <span class="keywordflow">if</span> ( obj == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                {</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                }</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                {</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                    *p++ = context-&gt;ObjectToStringValue(obj);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                }</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            }</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        }</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    }</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160; </div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    HANDLE hSource = RegisterEventSource(server, source);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    <span class="keywordflow">if</span> ( hSource != NULL )</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    {</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <span class="keywordflow">if</span> ( ReportEvent(hSource, <a class="code" href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a>, category, <span class="keywordtype">id</span>, NULL, countStrings, dataSize, strings, data) == 0 )</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;        {</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;            rc = GetLastError();</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        }</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160; </div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        DeregisterEventSource(hSource);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    }</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        rc = GetLastError();</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    }</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160; </div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <span class="keywordflow">if</span> ( data != NULL )</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    {</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        free(data);</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keywordflow">if</span> ( strings != NULL )</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        free(strings);</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    }</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;}</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment">/** WindowsEventLog::minimumRead=</span></div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;<span class="comment"> * Sets the minimumReadBuffer attribute.  This attribute controls the minimum</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment"> * allocation size of the buffer used to read in event log records.  This value</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment"> * is specified in multiples of 1 KB and must be wtihin the range of</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;<span class="comment"> * MIN_READ_KB_COUNT and MAX_READ_KB_COUNT.</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;<span class="comment"> * @param  countKB  The number of kilobytes for the minimum buffer allocation.</span></div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02926"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a46144ff513e2a29f7fa0087176733fba"> 2926</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa36257908629d82200dfd8cffd7588aa">RexxMethod1</a>(<span class="keywordtype">int</span>, WSEventLog_minimumReadSet, <a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, countKB)</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;{</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    <span class="keywordflow">if</span> ( countKB &lt; <a class="code" href="rxwinsys_8cpp.html#a037f5d76557f9c16409aeab83fe120bb">MIN_READ_KB_COUNT</a> || <a class="code" href="rxwinsys_8cpp.html#a74f1846a02d7f8b0ad0599c7a3a041da">MAX_READ_KB_COUNT</a> &lt; countKB )</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    {</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        context-&gt;RaiseException(</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;            <a class="code" href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a>,</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;            context-&gt;ArrayOfFive(context-&gt;String(<span class="stringliteral">&quot;positional&quot;</span>),</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;                                 context-&gt;Int32ToObject(1),</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;                                 context-&gt;Int32ToObject(<a class="code" href="rxwinsys_8cpp.html#a037f5d76557f9c16409aeab83fe120bb">MIN_READ_KB_COUNT</a>),</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                                 context-&gt;Int32ToObject(<a class="code" href="rxwinsys_8cpp.html#a74f1846a02d7f8b0ad0599c7a3a041da">MAX_READ_KB_COUNT</a>),</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                                 context-&gt;Int32ToObject(countKB)));</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    }</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    {</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        context-&gt;SetObjectVariable(<a class="code" href="rxwinsys_8cpp.html#af00eef1f14766857695424b90e5442c6">MIN_READ_BUFFER_ATTRIBUTE</a>, context-&gt;WholeNumberToObject(countKB * 1024));</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    }</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;}</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="comment">/** WindowsEventLog::minimumRead</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;<span class="comment"> * Returns the current setting for the minimum read buffer.  The value returned</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;<span class="comment"> * is the size of the buffer in KiloBytes.</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="comment"> * @return  The minimum size allocation size of the event log read buffer</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="comment"> *          buffer, in KiloBytes.  E.g., if the minimum is set at a 4096 byte</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment"> *          buffer, then the return will be 4.</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a82d5d569144eef6703bc6b05355442cd"> 2954</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_minimumReadGet)</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;{</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#a7b184a37509bbcfe3cb46b4f60ac879f">getMinimumReadBufferSize</a>(context) / 1024;</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;}</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;<span class="comment">/**  WindowsEventLog::readRecords()</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;<span class="comment"> * Reads records from an event log.  If no args are given then all records from</span></div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="comment"> * the default system (the local machine) and the default source (the</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;<span class="comment"> * Application log) are read.</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;<span class="comment"> * Each record is read from the event log, formatted into a string</span></div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="comment"> * representation and placed in an ooRexx array object. The array object is the</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;<span class="comment"> * &#39;events&#39; attribute of the WindowsEventLog.  Before the read is started, the</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;<span class="comment"> * array is emptied.  After each read, the array will contain the records for</span></div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="comment"> * the previous read.</span></div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="comment"> * @param direction  FORWARDS or BACKWARDS default is forwards.  The oldest</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment"> *                   record is considered record 1.</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="comment"> * @param server     The server to open the event log on.  If specified this</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="comment"> *                   should be in UNC format.  The default is the local machine.</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;<span class="comment"> *                   macnine.</span></div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;<span class="comment"> * @param source     The event log to open, the default is the Application log.</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="comment"> *                   The empty string can also be used to specify the local</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment"> *                   machine.</span></div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment"> * @param start      First record to read.  The default is all records.  If a</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment"> *                   start record is specified then count is mandatory.</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment"> * @param count      Count of records to read.  Only used if start is specified,</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="comment"> *                   in which case count is not optional.</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;<span class="comment"> * @return           0 on success, the system error code on failure.</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a8358f05531abd3a6714a285702ea2cf8"> 2987</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a8358f05531abd3a6714a285702ea2cf8">RexxMethod5</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_readRecords, OPTIONAL_CSTRING, direction, OPTIONAL_CSTRING, server,</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;            OPTIONAL_CSTRING, source, OPTIONAL_uint32_t, start, OPTIONAL_uint32_t, count)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;{</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    DWORD rc = 0;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    HANDLE hLog;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160; </div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="keywordtype">bool</span> didOpen = <a class="code" href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb">getOpenEventLog</a>(context, server, source, &amp;hLog, &amp;rc);</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160; </div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;    <span class="keywordflow">if</span> ( hLog == NULL )</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;    {</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    }</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="comment">// source is optional, but if it was omitted we need to set the variable to</span></div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="comment">// the default.  It is used later.</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordflow">if</span> ( source == NULL )</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    {</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        source = <a class="code" href="rxwinsys_8cpp.html#ac39d1e16ee52dc59170c491859b46cde">WSEL_DEFAULT_SOURCE</a>;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    }</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    DWORD flags;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;    <span class="keywordflow">if</span> ( ! <a class="code" href="rxwinsys_8cpp.html#a0bb43c76e5cefb507fab2e661b85cb83">checkReadRecordsArgs</a>(context, hLog, direction, start, &amp;count, &amp;flags, &amp;rc) )</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    {</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;        <span class="keywordflow">if</span> ( didOpen )</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            CloseEventLog(hLog);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;        <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    }</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160; </div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    <span class="comment">// Array to convert the event type into its string representation.</span></div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;    <span class="keywordtype">char</span>   evType[6][12]={<span class="stringliteral">&quot;Error&quot;</span>,<span class="stringliteral">&quot;Warning&quot;</span>,<span class="stringliteral">&quot;Information&quot;</span>,<span class="stringliteral">&quot;Success&quot;</span>,<span class="stringliteral">&quot;Failure&quot;</span>,<span class="stringliteral">&quot;Unknown&quot;</span>};</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;    <span class="keywordtype">int</span>    evTypeIndex;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160; </div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    PEVENTLOGRECORD pEvLogRecord;        <span class="comment">// pointer to one event record</span></div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    PVOID  pBuffer = NULL;               <span class="comment">// buffer for event records</span></div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    DWORD  bufferPos = 0;                <span class="comment">// position within the eventlog buffer</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    DWORD  bytesRead;                    <span class="comment">// count of bytes read into buffer by ReadEventlog</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    DWORD  needed;                       <span class="comment">// returned from ReadEventlog if buffer to small</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordtype">char</span> * pchEventSource  = NULL;       <span class="comment">// source from event log record</span></div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="keywordtype">char</span> * pchComputerName = NULL;       <span class="comment">// computer name of event</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="keywordtype">char</span> * pchMessage = NULL;            <span class="comment">// text of description string</span></div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordtype">char</span> * pBinaryData = NULL;           <span class="comment">// raw data of event log record</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="keywordtype">char</span>   time[<a class="code" href="rxwinsys_8cpp.html#a898de5d3084088a18a1ad49afd09fcce">MAX_TIME_DATE</a>];          <span class="comment">// converted time of event</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <span class="keywordtype">char</span>   date[<a class="code" href="rxwinsys_8cpp.html#a898de5d3084088a18a1ad49afd09fcce">MAX_TIME_DATE</a>];          <span class="comment">// converted date of event</span></div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    <span class="keyword">struct </span>tm * DateTime;                <span class="comment">// converted from elapsed seconds</span></div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="keywordtype">char</span> * pchStrBuf = NULL;             <span class="comment">// temp buffer for event string</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    <span class="keywordtype">char</span> * pchUser = NULL;               <span class="comment">// user name for event</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;    DWORD  countRecords = 0;             <span class="comment">// number of event log records processed</span></div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; </div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="comment">// We&#39;ll try to allocate a buffer big enough to hold all the records, but</span></div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;    <span class="comment">// not bigger than our max.  Same idea for a minimum, we&#39;ll make sure the</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    <span class="comment">// buffer is at least a minimum size.  The minimum size can be adjusted by</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="comment">// the user, up to the maximum size of one record.</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;    DWORD bufSize = count * 1024;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    DWORD minSize = <a class="code" href="rxwinsys_8cpp.html#a7b184a37509bbcfe3cb46b4f60ac879f">getMinimumReadBufferSize</a>(context);</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    bufSize = bufSize &gt; <a class="code" href="rxwinsys_8cpp.html#acfb938f3543ca035196470d762cf7b0e">MAX_READ_BUFFER</a> ? <a class="code" href="rxwinsys_8cpp.html#acfb938f3543ca035196470d762cf7b0e">MAX_READ_BUFFER</a> : bufSize;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    bufSize = bufSize &lt; minSize ? minSize : bufSize;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160; </div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    pBuffer = LocalAlloc(LPTR, bufSize);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;    <span class="keywordflow">if</span> ( pBuffer == NULL )</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    {</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#ab5384a0ced990b4c4cd4148fc52c66cd">outOfMemoryException</a>(context);</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    }</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    <span class="comment">// Get the ooRexx array object that will hold the event records.</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a> rxRecords = <a class="code" href="rxwinsys_8cpp.html#a518a7a5ade9839384bae06ec5751ac40">getRecordArray</a>(context);</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keywordflow">if</span> ( rxRecords == <a class="code" href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a> )</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    {</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    }</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; </div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    BOOL success = TRUE;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; </div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="comment">// Loop through the event log reading the number of records specified by the</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    <span class="comment">// ooRexx programmer.</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;    <span class="keywordflow">while</span> ( (countRecords &lt; count) &amp;&amp; (success = ReadEventLog(hLog, flags, start, pBuffer, bufSize, &amp;bytesRead, &amp;needed)) )</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    {</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        pEvLogRecord = (PEVENTLOGRECORD)pBuffer;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;        bufferPos = 0;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160; </div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;        <span class="keywordflow">while</span> ( (bufferPos &lt; bytesRead) &amp;&amp; (countRecords &lt; count) )</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;        {</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;            <span class="keywordflow">if</span> (flags &amp; EVENTLOG_FORWARDS_READ)</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;            {</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                start = pEvLogRecord-&gt;RecordNumber + 1;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;            }</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;            {</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                start = pEvLogRecord-&gt;RecordNumber - 1;</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;            }</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160; </div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;            <span class="comment">// Count each event record</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            countRecords++;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160; </div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;            <span class="comment">// Gather together all the pieces that will make up our final string</span></div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;            <span class="comment">// representation of this record.</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160; </div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;            <span class="comment">// Get index to event type string</span></div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#ade9d152280c1d2af148410b016cd7eb0">GET_TYPE_INDEX</a>(pEvLogRecord-&gt;EventType, evTypeIndex);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;            <span class="comment">// Get time and date converted to local time.  The TimeWritten field</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;            <span class="comment">// in the event log record struct is 32 bits but in VC++ 8.0, and</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;            <span class="comment">// on, time_t is inlined to be 64-bits, and on 64-bit Windows time_t</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;            <span class="comment">// is 64-bit to begin with.  So, _localtime32() needs to be used.</span></div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;            <span class="comment">// However, VC++ 7.0 doesn&#39;t appear to have __time32_t.</span></div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;<span class="preprocessor">#if _MSC_VER &lt; 1400</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;            DateTime = localtime((<span class="keyword">const</span> time_t *)&amp;pEvLogRecord-&gt;TimeWritten);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;            DateTime = _localtime32((<span class="keyword">const</span> __time32_t *)&amp;pEvLogRecord-&gt;TimeWritten);</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            strftime(date, <a class="code" href="rxwinsys_8cpp.html#a898de5d3084088a18a1ad49afd09fcce">MAX_TIME_DATE</a>,<span class="stringliteral">&quot;%x&quot;</span>, DateTime);</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;            strftime(time, <a class="code" href="rxwinsys_8cpp.html#a898de5d3084088a18a1ad49afd09fcce">MAX_TIME_DATE</a>,<span class="stringliteral">&quot;%X&quot;</span>, DateTime);</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; </div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            <span class="comment">// Get the event source, computer name, and user name strings.</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;            pchEventSource  = (<span class="keywordtype">char</span>*)pEvLogRecord + <span class="keyword">sizeof</span>(EVENTLOGRECORD);</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;            pchComputerName = pchEventSource + strlen(pchEventSource)+1;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;            pchUser = <a class="code" href="rxwinsys_8cpp.html#a6f29f77dec6b904b670cbaa9a30d9ac4">getEventUserName</a>(pEvLogRecord);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160; </div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;            <span class="comment">// Build the description string, which involves a look up from the</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;            <span class="comment">// message files and possibly some string substitution.</span></div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#ab14501d93a4200a18cab8bfd014cea85">getEventDescription</a>(pEvLogRecord, source, &amp;pchMessage);</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160; </div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            <span class="comment">// Get any binary data associated with the record.</span></div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;            <span class="keywordtype">size_t</span> cch = <a class="code" href="rxwinsys_8cpp.html#a94cb90524f59e324cf51d65819c4002f">getEventBinaryData</a>(pEvLogRecord, &amp;pBinaryData);</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160; </div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            <span class="comment">// Calculate how big a buffer we need for the final string, and</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;            <span class="comment">// allocate it.</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;            <span class="keywordtype">size_t</span> len = strlen(evType[evTypeIndex]) + 1 +</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;                         strlen(date) + 1 +</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;                         strlen(time) + 1 +</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;                         strlen(pchEventSource) + 3 +</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;                         12 +</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;                         strlen(pchUser) + 1 +</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;                         strlen(pchComputerName) + 1 +</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;                         strlen(pchMessage) + 3 +</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                         cch + 3;</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            pchStrBuf = (<span class="keywordtype">char</span> *)LocalAlloc(LPTR, len);</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160; </div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;            <span class="comment">// Put it all together.  The binary data is surrounded by single</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;            <span class="comment">// quotes so that the ooRexx user can parse it out.</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;            <span class="comment">// Type Date Time Source Id User Computer Details rawData</span></div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;            sprintf(pchStrBuf,</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                    <span class="stringliteral">&quot;%s %s %s &#39;%s&#39; %u %s %s &#39;%s&#39; &#39;&quot;</span>,</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                    evType[evTypeIndex],</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                    date,</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                    time,</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                    pchEventSource,</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                    LOWORD(pEvLogRecord-&gt;EventID),</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                    pchUser,</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;                    pchComputerName,</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;                    pchMessage);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160; </div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;            <span class="comment">// Now we need to tack on the binary data, the last apostrophe,</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;            <span class="comment">// and the trailing null.</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;            len = strlen(pchStrBuf);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;            memcpy((pchStrBuf + len), pBinaryData, cch);</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;            len += cch;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160; </div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;            *(pchStrBuf + len++) = <span class="charliteral">&#39;\&#39;&#39;</span>;</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;            *(pchStrBuf + len) = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160; </div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;            LocalFree(pchMessage);</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;            pchMessage = NULL;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;            LocalFree(pBinaryData);</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;            LocalFree(pchUser);</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            pchMessage = NULL;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160; </div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;            <span class="comment">// Add the record to the array.</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;            context-&gt;ArrayPut(rxRecords, context-&gt;NewString(pchStrBuf, len), countRecords);</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160; </div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;            LocalFree(pchStrBuf);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160; </div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;            <span class="comment">// Update postion and point to next event record</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;            bufferPos += pEvLogRecord-&gt;Length;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;            pEvLogRecord = (PEVENTLOGRECORD)(((<span class="keywordtype">char</span>*)pEvLogRecord) + pEvLogRecord-&gt;Length);</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        }</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        memset(pBuffer, 0, bufSize);</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;    }</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160; </div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;    <span class="keywordflow">if</span> ( ! success )</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    {</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        rc = GetLastError();</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160; </div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;        <span class="keywordflow">if</span> ( rc == ERROR_INSUFFICIENT_BUFFER )</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        {</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;            <span class="comment">// Seems unlikely the buffer could be too small, but if it is we&#39;re</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;            <span class="comment">// not going to fool with trying to reallocate a bigger buffer.</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;            <span class="keywordtype">char</span> tmp[256];</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;            _snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <a class="code" href="rxwinsys_8cpp.html#a953f077e4879920ecb6f4fa8a06d5454">TOO_SMALLBUFFER_MSG</a>, needed, bufSize);</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;            context-&gt;RaiseException1(<a class="code" href="oorexxerrors_8h.html#a7bbb006f59adeabeff7fcc82ebd31713">Rexx_Error_Execution_user_defined</a>, context-&gt;NewStringFromAsciiz(tmp));</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;        }</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( rc == ERROR_HANDLE_EOF )</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;        {</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;            <span class="comment">// If we read to the end of log, we&#39;ll count that as okay.</span></div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            rc = 0;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        }</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    }</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <span class="comment">// Clean up and return.</span></div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    LocalFree(pBuffer);</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160; </div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <span class="keywordflow">if</span> ( didOpen )</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    {</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        CloseEventLog(hLog);</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;    }</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;}</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;<span class="comment">/** WindowsEventLog::getLogNames()</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;<span class="comment"> * Obtains a list of all the event log names on the current system.</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment"> * @param   logNames [in/out]</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="comment"> *            An .array object in which the event log names are returned.</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;<span class="comment"> * @return  An OS return code, 0 on success, the system error code on failure.</span></div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;<span class="comment"> * @note    The passed in array is emptied before the log names are added.  On</span></div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;<span class="comment"> *          error, the array will also be empty.</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aab2f8eb77b53df1926191842b6bbbea3"> 3211</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#aa36257908629d82200dfd8cffd7588aa">RexxMethod1</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_getLogNames, <a class="code" href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a>, obj)</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;{</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    DWORD rc = 0;</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> key[] = <span class="stringliteral">&quot;SYSTEM\\CurrentControlSet\\Services\\EventLog\\&quot;</span>;</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    HKEY hKey;</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160; </div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;    <span class="keywordflow">if</span> ( ! context-&gt;IsOfType(obj, <span class="stringliteral">&quot;ARRAY&quot;</span>) )</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;    {</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#aab5e324ac01f845f5194a0b3bd0d850a">wrongClassException</a>(context, 1, <span class="stringliteral">&quot;Array&quot;</span>);</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;    }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;    <a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a> logNames = (<a class="code" href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a>)obj;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160; </div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    context-&gt;SendMessage0(logNames, <span class="stringliteral">&quot;EMPTY&quot;</span>);</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160; </div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <span class="comment">// Open the ..\Services\EventLog key and then enumerate each of its subkeys.</span></div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="comment">// The name of each subkey is the name of an event log.</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160; </div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    rc = RegOpenKeyEx(HKEY_LOCAL_MACHINE, key, 0, KEY_ENUMERATE_SUB_KEYS, &amp;hKey);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;    <span class="keywordflow">if</span> ( rc == ERROR_SUCCESS )</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    {</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        DWORD index = 0;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        TCHAR name[<a class="code" href="rxwinsys_8cpp.html#a70a2a0fc201636e21395c65e53cd6a45">MAX_REGISTRY_KEY_SIZE</a>];</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        DWORD cName = <a class="code" href="rxwinsys_8cpp.html#a70a2a0fc201636e21395c65e53cd6a45">MAX_REGISTRY_KEY_SIZE</a>;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <span class="keywordflow">while</span> ( (rc = RegEnumKeyEx(hKey, index, name, &amp;cName, NULL, NULL, NULL, NULL)) == ERROR_SUCCESS )</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        {</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            context-&gt;ArrayAppendString(logNames, name, strlen(name));</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            index++;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            cName = <a class="code" href="rxwinsys_8cpp.html#a70a2a0fc201636e21395c65e53cd6a45">MAX_REGISTRY_KEY_SIZE</a>;</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        }</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="keywordflow">if</span> ( rc == ERROR_NO_MORE_ITEMS )</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;            <span class="comment">// Not an error, this is the expected.</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;            rc = 0;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        }</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            <span class="comment">// An actual error, empty the array.</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            context-&gt;SendMessage0(logNames, <span class="stringliteral">&quot;EMPTY&quot;</span>);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160; </div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        RegCloseKey(hKey);</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;    }</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160; </div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    <span class="keywordflow">return</span> rc;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;}</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment">/** WindowsEventLog::close()</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment"> *  If we have an open open event log handle, closes it.</span></div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment"> *  @return   Returns 0 on success and if there is no open handle to begin with.</span></div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment"> *            If there is an error attempting to close an open handle, the OS</span></div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment"> *            system error code is returned.</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab269f86e5fb844f400ec37a3af78d452"> 3267</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_close)</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;{</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#ac83e426576b8f8f96731edaca025157d">closeEventLog</a>(context);</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;}</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="comment">/** WindowsEventLog::uninit()</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;<span class="comment"> *  Uninit method for the class.  Simply makes sure, if we have an open handle,</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="comment"> *  it gets closed.</span></div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a1ccb3708023801bb02cb5b732deae2be"> 3277</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a>(<a class="code" href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>, WSEventLog_uninit)</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;{</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#ac83e426576b8f8f96731edaca025157d">closeEventLog</a>(context);</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;}</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160; </div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;<span class="comment">/* This method is used as a convenient way to test code. */</span></div>
<div class="line"><a name="l03284"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a263f89989778bb5d216f48c65bc38cd6"> 3284</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a263f89989778bb5d216f48c65bc38cd6">RexxMethod4</a>(<span class="keywordtype">int</span>, WSEventLog_test, <a class="code" href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a>, data, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source, <a class="code" href="oorexxapi_8h.html#aae1e6d73838504107707970bedfb1a40">ARGLIST</a>, args)</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;{</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;}</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; </div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160; </div>
<div class="line"><a name="l03291"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ac4c60d2bbdb36c3210f28ecbb571e06c"> 3291</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#ac4c60d2bbdb36c3210f28ecbb571e06c">WSCtrlWindow</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;{</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    HWND       hW;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    HWND       thW;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    <span class="keywordtype">char</span>      *tmp_ptr;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;    DWORD_PTR  dwResult;</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;    LRESULT    lResult;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160; </div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(1,10);</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;DESK&quot;</span>))</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    {</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(GetDesktopWindow());</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    }</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;FIND&quot;</span>))</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    {</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        hW = FindWindow(NULL, argv[1].strptr);</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(hW);</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    }</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;FINDCHILD&quot;</span>))</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    {</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, thW);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160; </div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        hW = FindWindowEx(thW, NULL, NULL, argv[2].strptr);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(hW);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    }</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;SETFG&quot;</span>))</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;        hW =  GetForegroundWindow();</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, thW);</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160; </div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;        <span class="keywordflow">if</span> (hW != thW)</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;        {</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;            SetForegroundWindow(thW);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        }</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(hW);</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    }</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;GETFG&quot;</span>))</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    {</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(GetForegroundWindow())</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    }</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;TITLE&quot;</span>))</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    {</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,3);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        <span class="keywordflow">if</span> (hW != NULL)</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        {</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;            <span class="keywordflow">if</span> (argc ==3)</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            {</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!SetWindowText(hW, argv[2].strptr));</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;            }</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;            {</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;                <span class="comment">// GetWindowText do not work for controls from other processes and for listboxes</span></div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;                <span class="comment">// Now using WM_GETTEXT which works for all controls.</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;                <span class="comment">// The return string was limitted to 255 characters, now it&#39;s unlimited.</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;                <span class="comment">// retstr-&gt;strlength = GetWindowText(hW, retstr-&gt;strptr, 255);</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160; </div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;                <span class="comment">// at first get the text length to determine if the default lenght (255)of strptr would be exceeded.</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                lResult = SendMessageTimeout(hW, WM_GETTEXTLENGTH ,0, 0, <a class="code" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a>, <a class="code" href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">MSG_TIMEOUT</a>, &amp;dwResult);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;                <span class="comment">// time out or error?</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;                <span class="keywordflow">if</span> (lResult == 0)</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                {</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                    <span class="comment">// an error, but we return an empty string</span></div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                }</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;                {</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = dwResult;</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;                }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;                <span class="keywordflow">if</span> ( retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> &gt; (<a class="code" href="rexxapidefs_8h.html#aafe89561a7a66ed3a673b3b65920ead8">RXAUTOBUFLEN</a> - 1)  )</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;                {</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;                    <span class="comment">// text larger than 255, allocate a new one</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                    <span class="comment">// the original REXX retstr-&gt;strptr must not be released! REXX keeps track of this</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                    tmp_ptr = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_FIXED|GMEM_ZEROINIT, retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> + 1);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                    <span class="keywordflow">if</span> (!tmp_ptr)</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;                    {</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;                        <a class="code" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;                    }</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = tmp_ptr;</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;                }</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;                <span class="comment">// now get the text</span></div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;                lResult = SendMessageTimeout(hW, WM_GETTEXT, retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> + 1, (LPARAM)retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;                                             <a class="code" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a>, <a class="code" href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">MSG_TIMEOUT</a>, &amp;dwResult);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;                <span class="comment">// time out or error?</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;                <span class="keywordflow">if</span> (lResult == 0)</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;                {</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;                    <span class="comment">// an error, but we return an empty string</span></div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;                }</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;                {</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = dwResult;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;                }</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160; </div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;                <span class="comment">// if still no text found, the control may be a listbox, for which LB_GETTEXT must be used</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;                <span class="keywordflow">if</span> ( retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> == 0 )</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                {</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;                    <span class="comment">// at first get the selected item</span></div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;                    <span class="keywordtype">int</span> curSel;</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;                    lResult = SendMessageTimeout(hW, LB_GETCURSEL, 0, 0, <a class="code" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a>, <a class="code" href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">MSG_TIMEOUT</a>, &amp;dwResult);</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;                    <span class="comment">// time out or error?</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;                    <span class="keywordflow">if</span> (lResult == 0)</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;                    {</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;                        <span class="comment">// an error, but we return an empty string</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;                        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                    }</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;                    {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                        curSel = (int) dwResult;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                    }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                    <span class="keywordflow">if</span> (curSel != LB_ERR)</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                    {</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                        <span class="comment">// get the text length and allocate a new strptr if needed</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                        lResult = SendMessageTimeout(hW, LB_GETTEXTLEN, curSel, 0, <a class="code" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a>, <a class="code" href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">MSG_TIMEOUT</a>, &amp;dwResult);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                        <span class="comment">// time out or error?</span></div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                        <span class="keywordflow">if</span> (lResult == 0)</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                        {</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                            <span class="comment">// an error, but we return an empty string</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                        }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                        {</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = dwResult;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;                        }</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160; </div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                        <span class="keywordflow">if</span> ( retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> &gt; (<a class="code" href="rexxapidefs_8h.html#aafe89561a7a66ed3a673b3b65920ead8">RXAUTOBUFLEN</a> - 1)  )</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                        {</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                            tmp_ptr = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_FIXED|GMEM_ZEROINIT, retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> + 1);</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                            <span class="keywordflow">if</span> (!tmp_ptr)</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                            {</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;                                <a class="code" href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;                            }</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;                            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = tmp_ptr;</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;                        }</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;                        lResult = SendMessageTimeout(hW, LB_GETTEXT, curSel, (LPARAM)retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <a class="code" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a>, <a class="code" href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">MSG_TIMEOUT</a>, &amp;dwResult);</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                        <span class="comment">// time out or error?</span></div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                        <span class="keywordflow">if</span> (lResult == 0)</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                        {</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;                            <span class="comment">// an error, but we return an empty string</span></div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                        }</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                        {</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = dwResult;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                        }</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                    }</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                }</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;            }</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;        }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        {</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            <span class="keywordflow">if</span> (argc ==3)</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            {</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!SetConsoleTitle(argv[2].strptr))</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            }</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;            {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;                retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = GetConsoleTitle(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 255);</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;            }</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;        }</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    }</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;CLASS&quot;</span>))</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        {</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = GetClassName(hW, retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 255);</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        }</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    }</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160; </div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;SHOW&quot;</span>))</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    {</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        {</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            INT sw;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;HIDE&quot;</span>)) sw = SW_HIDE;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;                <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;MAX&quot;</span>)) sw = SW_SHOWMAXIMIZED;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;                <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;MIN&quot;</span>)) sw = SW_MINIMIZE;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;                <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;RESTORE&quot;</span>)) sw = SW_RESTORE;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;            <span class="keywordflow">else</span> sw = SW_SHOW;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(ShowWindow(hW, sw))</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        }</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    }</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;HNDL&quot;</span>))</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;    {</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;        {</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            INT gw;</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160; </div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;            <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;NEXT&quot;</span>)) gw = GW_HWNDNEXT;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;PREV&quot;</span>)) gw = GW_HWNDPREV;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;FIRSTCHILD&quot;</span>)) gw = GW_CHILD;</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;FIRST&quot;</span>)) gw = GW_HWNDFIRST;</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;LAST&quot;</span>)) gw = GW_HWNDLAST;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[2].strptr,<span class="stringliteral">&quot;OWNER&quot;</span>)) gw = GW_OWNER;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;            <span class="keywordflow">else</span> <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(GetWindow(hW, gw));</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        }</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        {</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0)</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        }</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    }</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;ID&quot;</span>))</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;    {</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160; </div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(GetDlgCtrlID(hW))</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;    }</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;ATPOS&quot;</span>))</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;    {</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;        POINT pt;</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,4);</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        pt.x = atol(argv[1].strptr);</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        pt.y = atol(argv[2].strptr);</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        <span class="keywordflow">if</span> (argc == 4)</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[3].strptr, hW);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        }</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;        {</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;            hW = 0;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        }</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(ChildWindowFromPointEx(hW, pt, CWP_ALL));</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;        }</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        {</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(WindowFromPoint(pt));</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        }</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;    }</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;RECT&quot;</span>))</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;    {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;        RECT r;</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        <span class="keywordflow">if</span> (hW &amp;&amp; GetWindowRect(hW, &amp;r))</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;            sprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>,<span class="stringliteral">&quot;%d,%d,%d,%d&quot;</span>,r.left, r.top, r.right, r.bottom);</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    }</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;GETSTATE&quot;</span>))</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    {</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        {</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;            <span class="keywordflow">if</span> (!IsWindow(hW)) strcpy(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Illegal Handle&quot;</span>);</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;            {</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                <span class="keywordflow">if</span> (IsWindowEnabled(hW)) strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Enabled &quot;</span>);</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                <span class="keywordflow">else</span> strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Disabled &quot;</span>);</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                <span class="keywordflow">if</span> (IsWindowVisible(hW)) strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Visible &quot;</span>);</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                <span class="keywordflow">else</span> strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Invisible &quot;</span>);</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;                <span class="keywordflow">if</span> (IsZoomed(hW)) strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Zoomed &quot;</span>);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsIconic(hW)) strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Minimized &quot;</span>);</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                <span class="keywordflow">if</span> (GetForegroundWindow() == hW) strcat(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <span class="stringliteral">&quot;Foreground &quot;</span>);</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;            }</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;        }</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;    }</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;GETSTYLE&quot;</span>))</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    {</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;        {</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;            WINDOWINFO wi;</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160; </div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;            wi.cbSize = <span class="keyword">sizeof</span>(WINDOWINFO);</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;            <span class="keywordflow">if</span> ( GetWindowInfo(hW, &amp;wi) )</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;            {</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                _snprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <a class="code" href="rexxapidefs_8h.html#aafe89561a7a66ed3a673b3b65920ead8">RXAUTOBUFLEN</a>, <span class="stringliteral">&quot;0x%08x 0x%08x&quot;</span>, wi.dwStyle, wi.dwExStyle);</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;            }</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            {</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                _snprintf(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, <a class="code" href="rexxapidefs_8h.html#aafe89561a7a66ed3a673b3b65920ead8">RXAUTOBUFLEN</a>, <span class="stringliteral">&quot;%d&quot;</span>, GetLastError());</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            }</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;        }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;    }</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;ENABLE&quot;</span>))</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;    {</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        {</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(EnableWindow(hW, atoi(argv[2].strptr)));</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        }</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    }</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;MOVE&quot;</span>))</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;    {</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(4,4);</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;        {</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;            RECT r;</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;            <span class="keywordflow">if</span> (!GetWindowRect(hW, &amp;r))</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            {</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            }</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!MoveWindow(hW, atol(argv[2].strptr), atol(argv[3].strptr), r.right - r.left, r.bottom-r.top, TRUE))</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;        }</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;    }</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;SIZE&quot;</span>))</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;    {</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(4,4);</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;        {</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;            RECT r;</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;            <span class="keywordflow">if</span> (!GetWindowRect(hW, &amp;r))</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;            {</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;            }</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!SetWindowPos(hW, NULL, r.left, r.top,  atol(argv[2].strptr), atol(argv[3].strptr), SWP_NOMOVE | SWP_NOZORDER))</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;        }</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;    }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1); <span class="comment">/* in this case 0 is an error */</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;}</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160; </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160; </div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160; </div>
<div class="line"><a name="l03645"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a64769fa0a2d68f0f904e1b9cc10b33f7"> 3645</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a64769fa0a2d68f0f904e1b9cc10b33f7">WSCtrlSend</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;{</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;    HWND hW,HwndFgWin;</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160; </div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(1,10);</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160; </div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;KEY&quot;</span>) == 0 )</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;    {</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(4,5);</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;        <span class="keywordflow">if</span> (hW)</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;        {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            WPARAM k;</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            LPARAM l;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160; </div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            k = (WPARAM)atoi(argv[2].strptr);</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;            <span class="keywordflow">if</span> (argc == 5)</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;            {</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                l = strtol(argv[4].strptr,<span class="charliteral">&#39;\0&#39;</span>,16);</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            }</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;            {</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                l = 0;</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;            }</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160; </div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;            <span class="comment">/* Combination of keys (e.g. SHIFT END) and function keys (e.g. F1) dont worked                 */</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            <span class="comment">/* The reson is, that the WM_KEWUP/Doen message cannot handle this !                            */</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;            <span class="comment">/* To get the function keys working, WM_KEYDOWN/UP can be used, but the message MUST be posted! */</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;            <span class="comment">/* To get key combination working the keybd_event function must be use. But .....               */</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;            <span class="comment">/* The window must be in the Foreground and The handle must be associated:                      */</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;            <span class="comment">/* To get these working, the REXX code must be lok like:                                        */</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;            <span class="comment">/* EditHandle = npe~Handle                                                                      */</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;            <span class="comment">/* npe~ToForeground                                                                             */</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;            <span class="comment">/* npe~AssocWindow(np~Handle)                                                                   */</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;            <span class="comment">/* npe~SendKeyDown(&quot;SHIFT&quot;)                                                                     */</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;            <span class="comment">/* npe~SendKeyDown(&quot;HOME&quot;)                                                                      */</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;            <span class="comment">/* npe~SendKeyUp(&quot;SHIFT&quot;)                                                                       */</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;            <span class="comment">/* npe~SendKeyUp(&quot;HOME&quot;)                                                                        */</span></div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160; </div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;            <span class="keywordflow">if</span> (argv[3].strptr[0] == <span class="charliteral">&#39;D&#39;</span>)</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;            {</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                HwndFgWin = GetForegroundWindow();</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;                <span class="keywordflow">if</span> ( hW == HwndFgWin)</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;                {</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                    <span class="keywordflow">if</span> (l != 0)</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;                    {</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;                        keybd_event((BYTE)k,0,KEYEVENTF_EXTENDEDKEY,0);</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                    }</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;                    {</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;                        keybd_event((BYTE)k,0,0,0);</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                    }</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160; </div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                }</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;                {</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                    itoa(PostMessage(hW,WM_KEYDOWN, k,l), retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 10);</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                }</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;            }</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (argv[3].strptr[0] == <span class="charliteral">&#39;U&#39;</span>)</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;            {</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;                HwndFgWin = GetForegroundWindow();</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                <span class="keywordflow">if</span> ( hW == HwndFgWin )</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;                {</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;                    <span class="keywordflow">if</span> (l == 1)</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;                    {</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;                        keybd_event((BYTE)k,0,KEYEVENTF_KEYUP | KEYEVENTF_EXTENDEDKEY,0);</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;                    }</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                    {</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                        keybd_event((BYTE)k,0,KEYEVENTF_KEYUP,0);</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                    }</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160; </div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;                }</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;                {</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;                    itoa(PostMessage(hW,WM_KEYUP, k, l | 0xC0000000), retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 10);</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[0] = <span class="charliteral">&#39;1&#39;</span>;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>[1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                }</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            }</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;            <span class="comment">/* WM_CHAR don&#39;t works for ALT key combinations                             */</span></div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;            <span class="comment">/* WM_SYSKEYDOWN and hW,WM_SYSKEYUP must used                               */</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( l != 0 )</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;            {</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;                itoa(PostMessage(hW,WM_SYSKEYDOWN, k,l), retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 10);</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;                itoa(PostMessage(hW,WM_SYSKEYUP, k,l), retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 10);</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;            }</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;            {</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;                itoa(SendNotifyMessage(hW,WM_CHAR, k,l), retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 10);</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;            }</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;            retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = strlen(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>);</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        }</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;    }</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;MSG&quot;</span>) == 0 )</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;    {</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;        UINT   msg;</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        WPARAM wp;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        LPARAM lp;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160; </div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(5,6);</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160; </div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[2].strptr, msg);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[3].strptr, wp);</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[4].strptr, lp);</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160; </div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;        <span class="comment">/* The 6th arg can, optionally, be used as an extra qualifier.  Currently</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;<span class="comment">         * only used in one case.</span></div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;        <span class="keywordflow">if</span> ( argc &gt; 5 &amp;&amp; argv[5].strptr[0] == <span class="charliteral">&#39;E&#39;</span> )</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        {</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;            lp = (LPARAM)<span class="stringliteral">&quot;Environment&quot;</span>;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        }</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;        <span class="keywordflow">if</span> ( SendNotifyMessage(hW, msg, wp, lp) )</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;        {</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(0)</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;        }</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;        {</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(GetLastError())</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        }</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;    }</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr,<span class="stringliteral">&quot;TO&quot;</span>) == 0 )  <span class="comment">/* Send message Time Out */</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;        UINT      msg, timeOut;</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;        WPARAM    wp;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;        LPARAM    lp;</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;        DWORD_PTR dwResult;</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;        LRESULT   lResult;</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160; </div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(6,7);</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160; </div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hW);</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[2].strptr, msg);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[3].strptr, wp);</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[4].strptr, lp);</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[5].strptr, timeOut);</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160; </div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;        <span class="comment">/* The 7th arg can, optionally, be used as an extra qualifier.  Currently</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="comment">         * only used in one case.</span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;        <span class="keywordflow">if</span> ( argc &gt; 6 &amp;&amp; argv[6].strptr[0] == <span class="charliteral">&#39;E&#39;</span> )</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;        {</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;            lp = (LPARAM)<span class="stringliteral">&quot;Environment&quot;</span>;</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;        }</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160; </div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        lResult = SendMessageTimeout(hW, msg, wp, lp, <a class="code" href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a>, timeOut, &amp;dwResult);</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        <span class="keywordflow">if</span> ( lResult == 0 )</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        {</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;            <span class="comment">/* Some error occurred, if last error is 0 it is a time out,</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;<span class="comment">             * otherwise some other system error.</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            DWORD err = GetLastError();</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;            <span class="keywordflow">if</span> ( err == 0 )</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;            {</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                err = 1;  <span class="comment">// We are going to negate this.</span></div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;            }</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(-(INT)err);</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;        }</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;        {</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rxwinsys_8cpp.html#aa4f1da35c2a9292a48922975f164f1a9">dwordPtrToRexx</a>(dwResult, retstr);</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;        }</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    }</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( strcmp(argv[0].strptr, <span class="stringliteral">&quot;MAP&quot;</span>) == 0 )</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;    {</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(MapVirtualKey((UINT)atoi(argv[1].strptr), 2));</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    }</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160; </div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1);  <span class="comment">/* in this case 0 is an error */</span></div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;}</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160; </div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160; </div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160; </div>
<div class="line"><a name="l03827"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a7b8407ca317e5b94252f24c3d4278634"> 3827</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a7b8407ca317e5b94252f24c3d4278634">WSCtrlMenu</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;{</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(1,10);</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160; </div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;    <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;GET&quot;</span>))</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;    {</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;        HWND hMenu;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hMenu);</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160; </div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(GetMenu(hMenu));</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;    }</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;SYS&quot;</span>))</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    {</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;        HWND hMenu;</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hMenu);</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160; </div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(GetSystemMenu(hMenu, FALSE));</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;    }</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;SUB&quot;</span>))</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    {</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;        HMENU hMenu;</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hMenu);</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160; </div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a>(GetSubMenu(hMenu, atoi(argv[2].strptr)));</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    }</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;ID&quot;</span>))</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    {</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(3,3);</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;        HMENU hMenu;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hMenu);</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160; </div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(GetMenuItemID(hMenu, atoi(argv[2].strptr)));</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;    }</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;CNT&quot;</span>))</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;    {</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;        HMENU hMenu;</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hMenu);</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160; </div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(GetMenuItemCount(hMenu));</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;    }</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;TEXT&quot;</span>))</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    {</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;        HMENU hM;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;        UINT flag;</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(4,4);</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160; </div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hM);</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;        <span class="keywordflow">if</span> (!hM)</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        {</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0);</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;        }</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;        <span class="keywordflow">if</span> (argv[3].strptr[0] == <span class="charliteral">&#39;C&#39;</span>)</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;        {</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;            flag = MF_BYCOMMAND;</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;        }</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;        {</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;            flag = MF_BYPOSITION;</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;        }</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160; </div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = GetMenuString(hM, atol(argv[2].strptr), retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, 255, flag);</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    }</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr,<span class="stringliteral">&quot;STATE&quot;</span>))</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;    {</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,4);</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160; </div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;        HMENU hMenu;</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a>(argv[1].strptr, hMenu);</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160; </div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;        <span class="keywordflow">if</span> ( argc == 2 )</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        {</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(IsMenu(hMenu));</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;        }</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160; </div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(4,4);</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160; </div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        UINT flags;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        UINT pos = atoi(argv[3].strptr);</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160; </div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        flags = GetMenuState(hMenu, pos, MF_BYPOSITION);</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160; </div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        <span class="keywordflow">if</span> ( flags == 0xffffffff )</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        {</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;            <span class="comment">// Error, most likely no such position.  Return false.</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(0);</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;        }</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160; </div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;        <span class="keywordflow">if</span> ( argv[2].strptr[0] == <span class="charliteral">&#39;M&#39;</span> )</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        {</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>((flags &amp; MF_POPUP) ? 1 : 0);</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;        }</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( argv[2].strptr[0] == <span class="charliteral">&#39;C&#39;</span> )</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;        {</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>((flags &amp; MF_CHECKED) ? 1 : 0);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;        }</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;        {</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(((flags &amp; MF_POPUP) == 0 &amp;&amp; (flags &amp; MF_SEPARATOR) != 0) ? 1 : 0);</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        }</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    }</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160; </div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1)  <span class="comment">/* in this case 0 is an error */</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;}</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160; </div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160; </div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160; </div>
<div class="line"><a name="l03938"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ab25c779b25621573c1ae0bbfd588d988"> 3938</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#ab25c779b25621573c1ae0bbfd588d988">WSClipboard</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> argv[], <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">PRXSTRING</a> retstr)</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;{</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;    BOOL ret = FALSE;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160; </div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(1,2);</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160; </div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;    <span class="keywordflow">if</span> (!strcmp(argv[0].strptr, <span class="stringliteral">&quot;COPY&quot;</span>))</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    {</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;        HGLOBAL hmem;</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        <span class="keywordtype">char</span> * membase;</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160; </div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a>(2,2);</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;        hmem = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_MOVEABLE | GMEM_DDESHARE, argv[1].strlength + 1);</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;        membase = (<span class="keywordtype">char</span> *) GlobalLock(hmem);</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160; </div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;        <span class="keywordflow">if</span> (membase)</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        {</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;            memcpy(membase, argv[1].strptr, argv[1].strlength + 1);</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;            <span class="keywordflow">if</span> (OpenClipboard(NULL) &amp;&amp; EmptyClipboard())</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;            {</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;                ret = SetClipboardData(CF_TEXT, hmem) != NULL;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;            }</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;            GlobalUnlock(membase);</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;            CloseClipboard();</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;        }</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(!ret)</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;    }</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr, <span class="stringliteral">&quot;PASTE&quot;</span>))</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    {</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        HGLOBAL hmem;</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;        <span class="keywordtype">char</span> * membase;</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        <span class="keywordflow">if</span> (IsClipboardFormatAvailable(CF_TEXT) &amp;&amp; OpenClipboard(NULL))</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;        {</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;            hmem = GetClipboardData(CF_TEXT);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;            membase = (<span class="keywordtype">char</span> *) GlobalLock(hmem);</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;            <span class="keywordflow">if</span> (membase)</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;            {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;                <span class="keywordtype">size_t</span> s = GlobalSize(hmem);</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;                <span class="keywordflow">if</span> (s&gt;255)</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;                {</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;                    retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> = (<span class="keywordtype">char</span> *)GlobalAlloc(GMEM_FIXED, s);</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;                    <span class="keywordflow">if</span> (retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a> == NULL)</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;                    {</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;                        CloseClipboard();</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                    }</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                }</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;                s = strlen(membase);</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;                memcpy(retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">strptr</a>, membase, s+1);</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;                retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = s;</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                GlobalUnlock(membase);</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;                CloseClipboard();</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;            }</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;            {</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;                CloseClipboard();</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;            }</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;        }</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;        retstr-&gt;<a class="code" href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">strlength</a> = 0;</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    }</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr, <span class="stringliteral">&quot;EMPTY&quot;</span>))</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;    {</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;        <span class="keywordflow">if</span> (IsClipboardFormatAvailable(CF_TEXT))</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;        {</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;            BOOL ret;</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;            <span class="keywordflow">if</span> (!OpenClipboard(NULL))</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;            {</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(1)</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;            }</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;            ret = !EmptyClipboard();</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;            CloseClipboard();</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;            <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(ret)</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        }</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0)</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    }</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(argv[0].strptr, <span class="stringliteral">&quot;AVAIL&quot;</span>))</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;    {</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(IsClipboardFormatAvailable(CF_TEXT))</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;    }</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    {</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <a class="code" href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a>(-1)</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    }</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;}</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160; </div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160; </div>
<div class="line"><a name="l04026"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4"> 4026</a></span>&#160;VOID <a class="code" href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4">Little2BigEndian</a>(BYTE *pbInt, INT iSize)</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;{</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;    <span class="comment">/* convert any integer number from little endian to big endian or vice versa */</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    BYTE  bTemp[32];</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;    INT   i;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160; </div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;    <span class="keywordflow">if</span> (iSize &lt;= 32)</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;    {</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; iSize; i++)</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        {</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;            bTemp[i] = pbInt[iSize - i - 1];</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        }</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160; </div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        memcpy(pbInt, bTemp, iSize);</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    }</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;}</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;<span class="comment"> * Prior to 4.0.0, this function was documented as a work around to use the</span></div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;<span class="comment"> * WindowObject class when no WindowManager object had been instantiated.  So</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;<span class="comment"> * for now it needs to stay. Does nothing.</span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l04048"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a2bf76a4c885462297fa33be50621f23d"> 4048</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a> <a class="code" href="rxwinsys_8cpp.html#a2bf76a4c885462297fa33be50621f23d">InstWinSysFuncs</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *funcname, <span class="keywordtype">size_t</span> argc, <a class="code" href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">CONSTRXSTRING</a> *argv, <span class="keyword">const</span> <span class="keywordtype">char</span> *qname, <a class="code" href="struct___r_x_s_t_r_i_n_g.html">RXSTRING</a> *retstr)</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;{</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;   <a class="code" href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a>(0)</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;}</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160; </div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160; </div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<span class="comment">// now build the actual entry lists</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#aea6576dd77c5ea1e5f74559f9d8e2c72"> 4055</a></span>&#160;<a class="code" href="struct___rexx_routine_entry.html">RexxRoutineEntry</a> <a class="code" href="rxwinsys_8cpp.html#aea6576dd77c5ea1e5f74559f9d8e2c72">rxwinsys_functions</a>[] =</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;{</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#a6891bcb6f438ab4b0c39b0bbafeda798">WSRegistryKey</a>,    <a class="code" href="rxwinsys_8cpp.html#a6891bcb6f438ab4b0c39b0bbafeda798">WSRegistryKey</a>),</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#a8f9110a61183846d9639d03fcc472e6d">WSRegistryValue</a>,  <a class="code" href="rxwinsys_8cpp.html#a8f9110a61183846d9639d03fcc472e6d">WSRegistryValue</a>),</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#a3f2d72d2d742fcd1b1304b1416e42fc1">WSRegistryFile</a>,   <a class="code" href="rxwinsys_8cpp.html#a3f2d72d2d742fcd1b1304b1416e42fc1">WSRegistryFile</a>),</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#a553d6a324d3fe6f2ba079a73b3d3d938">WSProgManager</a>,    <a class="code" href="rxwinsys_8cpp.html#a553d6a324d3fe6f2ba079a73b3d3d938">WSProgManager</a>),</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#ac4c60d2bbdb36c3210f28ecbb571e06c">WSCtrlWindow</a>,     <a class="code" href="rxwinsys_8cpp.html#ac4c60d2bbdb36c3210f28ecbb571e06c">WSCtrlWindow</a>),</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#a64769fa0a2d68f0f904e1b9cc10b33f7">WSCtrlSend</a>,       <a class="code" href="rxwinsys_8cpp.html#a64769fa0a2d68f0f904e1b9cc10b33f7">WSCtrlSend</a>),</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#a7b8407ca317e5b94252f24c3d4278634">WSCtrlMenu</a>,       <a class="code" href="rxwinsys_8cpp.html#a7b8407ca317e5b94252f24c3d4278634">WSCtrlMenu</a>),</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(<a class="code" href="rxwinsys_8cpp.html#ab25c779b25621573c1ae0bbfd588d988">WSClipboard</a>,      <a class="code" href="rxwinsys_8cpp.html#ab25c779b25621573c1ae0bbfd588d988">WSClipboard</a>),</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    <a class="code" href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a>(InstWinFuncs,     <a class="code" href="rxwinsys_8cpp.html#a2bf76a4c885462297fa33be50621f23d">InstWinSysFuncs</a>),</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;    <a class="code" href="oorexxapi_8h.html#aa3968b4fd4978493411036d07050237d">REXX_LAST_ROUTINE</a>()</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;};</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160; </div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160; </div>
<div class="line"><a name="l04070"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#af95a969590a9d7254ba1bd81dee2fb7a"> 4070</a></span>&#160;<a class="code" href="struct___rexx_method_entry.html">RexxMethodEntry</a> <a class="code" href="rxwinsys_8cpp.html#af95a969590a9d7254ba1bd81dee2fb7a">rxwinsys_methods</a>[] = {</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSRegistry_init,            WSRegistry_init),</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(setCurrent_Key,             setCurrent_Key),</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getCurrent_Key,             getCurrent_Key),</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getLocal_Machine,           getLocal_Machine),</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getCurrent_User,            getCurrent_User),</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getUsers,                   getUsers),</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getClasses_Root,            getClasses_Root),</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getPerformance_Data,        getPerformance_Data),</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(getCurrent_Config,          getCurrent_Config),</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSRegistry_delete,          WSRegistry_delete),</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSRegistry_open,            WSRegistry_open),</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160; </div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_test,            WSEventLog_test),</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_init,            WSEventLog_init),</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_uninit,          WSEventLog_uninit),</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_open,            WSEventLog_open),</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_close,           WSEventLog_close),</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_write,           WSEventLog_write),</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_readRecords,     WSEventLog_readRecords),</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_minimumReadSet,  WSEventLog_minimumReadSet),</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_minimumReadGet,  WSEventLog_minimumReadGet),</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_getNumber,       WSEventLog_getNumber),</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_getFirst,        WSEventLog_getFirst),</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_getLast,         WSEventLog_getLast),</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_isFull,          WSEventLog_isFull),</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_getLogNames,     WSEventLog_getLogNames),</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;    <a class="code" href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a>(WSEventLog_clear,           WSEventLog_clear),</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;    <a class="code" href="oorexxapi_8h.html#aa79fa4e96e285c543fe061ec82bd1328">REXX_LAST_METHOD</a>()</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;};</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160; </div>
<div class="line"><a name="l04101"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a916703b7b817e3f0dd920db2e66e79b9"> 4101</a></span>&#160;<a class="code" href="struct___rexx_package_entry.html">RexxPackageEntry</a> <a class="code" href="rxwinsys_8cpp.html#a916703b7b817e3f0dd920db2e66e79b9">rxwinsys_package_entry</a> =</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;{</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;    <a class="code" href="oorexxapi_8h.html#ad0c9dd799a5ddb561472ac8968ea3705">STANDARD_PACKAGE_HEADER</a></div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;    <a class="code" href="oorexxapi_8h.html#a2fdcd4caf670858f48646a72cde7e620">REXX_INTERPRETER_4_0_0</a>,              <span class="comment">// anything after 4.0.0 will work</span></div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    <span class="stringliteral">&quot;RXWINSYS&quot;</span>,                          <span class="comment">// name of the package</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;    <span class="stringliteral">&quot;4.0&quot;</span>,                               <span class="comment">// package information</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;    NULL,                                <span class="comment">// no load/unload functions</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    NULL,</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#aea6576dd77c5ea1e5f74559f9d8e2c72">rxwinsys_functions</a>,                  <span class="comment">// the exported functions</span></div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;    <a class="code" href="rxwinsys_8cpp.html#af95a969590a9d7254ba1bd81dee2fb7a">rxwinsys_methods</a>                     <span class="comment">// the exported methods</span></div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;};</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160; </div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;<span class="comment">// package loading stub.</span></div>
<div class="line"><a name="l04114"></a><span class="lineno"><a class="line" href="rxwinsys_8cpp.html#a618659792e71825430e8054f92f5f49b"> 4114</a></span>&#160;<a class="code" href="rxwinsys_8cpp.html#a618659792e71825430e8054f92f5f49b">OOREXX_GET_PACKAGE</a>(rxwinsys);</div>
<div class="ttc" id="a_interpreter_a_p_i_8cpp_html_a229a7d29867d80217a65b76efa1bf09f"><div class="ttname"><a href="_interpreter_a_p_i_8cpp.html#a229a7d29867d80217a65b76efa1bf09f">RexxVariablePool</a></div><div class="ttdeci">RexxReturnCode RexxEntry RexxVariablePool(PSHVBLOCK pshvblock)</div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_a_p_i_8cpp_source.html#l00393">InterpreterAPI.cpp:393</a></div></div>
<div class="ttc" id="acmdparse_8cpp_html_ac765329451135abec74c45e1897abf26"><div class="ttname"><a href="cmdparse_8cpp.html#ac765329451135abec74c45e1897abf26">type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> <a href="cmdparse_8cpp_source.html#l01888">cmdparse.cpp:1888</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html"><div class="ttname"><a href="oorexxapi_8h.html">oorexxapi.h</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a15c340ee5245f15f32265d54a1e5a3f5"><div class="ttname"><a href="oorexxapi_8h.html#a15c340ee5245f15f32265d54a1e5a3f5">argumentExists</a></div><div class="ttdeci">#define argumentExists(i)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l03777">oorexxapi.h:3777</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a2fdcd4caf670858f48646a72cde7e620"><div class="ttname"><a href="oorexxapi_8h.html#a2fdcd4caf670858f48646a72cde7e620">REXX_INTERPRETER_4_0_0</a></div><div class="ttdeci">#define REXX_INTERPRETER_4_0_0</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00216">oorexxapi.h:216</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a3b7812132db743fbc8ed27b9a77136cd"><div class="ttname"><a href="oorexxapi_8h.html#a3b7812132db743fbc8ed27b9a77136cd">REXX_METHOD</a></div><div class="ttdeci">#define REXX_METHOD(n, e)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00211">oorexxapi.h:211</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a631b22840291b7d860a64ca824ad43eb"><div class="ttname"><a href="oorexxapi_8h.html#a631b22840291b7d860a64ca824ad43eb">REXX_CLASSIC_ROUTINE</a></div><div class="ttdeci">#define REXX_CLASSIC_ROUTINE(n, e)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00192">oorexxapi.h:192</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_a895bccfb4968ae24b153351beadd50f7"><div class="ttname"><a href="oorexxapi_8h.html#a895bccfb4968ae24b153351beadd50f7">argumentOmitted</a></div><div class="ttdeci">#define argumentOmitted(i)</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l03778">oorexxapi.h:3778</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_aa3968b4fd4978493411036d07050237d"><div class="ttname"><a href="oorexxapi_8h.html#aa3968b4fd4978493411036d07050237d">REXX_LAST_ROUTINE</a></div><div class="ttdeci">#define REXX_LAST_ROUTINE()</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00193">oorexxapi.h:193</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_aa79fa4e96e285c543fe061ec82bd1328"><div class="ttname"><a href="oorexxapi_8h.html#aa79fa4e96e285c543fe061ec82bd1328">REXX_LAST_METHOD</a></div><div class="ttdeci">#define REXX_LAST_METHOD()</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00212">oorexxapi.h:212</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_aae1e6d73838504107707970bedfb1a40"><div class="ttname"><a href="oorexxapi_8h.html#aae1e6d73838504107707970bedfb1a40">ARGLIST</a></div><div class="ttdeci">RexxArrayObject ARGLIST</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l04331">oorexxapi.h:4331</a></div></div>
<div class="ttc" id="aoorexxapi_8h_html_ad0c9dd799a5ddb561472ac8968ea3705"><div class="ttname"><a href="oorexxapi_8h.html#ad0c9dd799a5ddb561472ac8968ea3705">STANDARD_PACKAGE_HEADER</a></div><div class="ttdeci">#define STANDARD_PACKAGE_HEADER</div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00230">oorexxapi.h:230</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a0395a9255c4ae96c92e371187c9389c0"><div class="ttname"><a href="oorexxerrors_8h.html#a0395a9255c4ae96c92e371187c9389c0">Rexx_Error_Incorrect_method_noclass</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_method_noclass</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00567">oorexxerrors.h:567</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a2c7c3fa4d6a576b5cf85176ea712cbfb"><div class="ttname"><a href="oorexxerrors_8h.html#a2c7c3fa4d6a576b5cf85176ea712cbfb">Rexx_Error_Incorrect_method_noarg</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_method_noarg</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00525">oorexxerrors.h:525</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a2e34ba6b32f03ebefc4a415684900dce"><div class="ttname"><a href="oorexxerrors_8h.html#a2e34ba6b32f03ebefc4a415684900dce">Rexx_Error_Invalid_argument_range</a></div><div class="ttdeci">#define Rexx_Error_Invalid_argument_range</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00469">oorexxerrors.h:469</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_a7bbb006f59adeabeff7fcc82ebd31713"><div class="ttname"><a href="oorexxerrors_8h.html#a7bbb006f59adeabeff7fcc82ebd31713">Rexx_Error_Execution_user_defined</a></div><div class="ttdeci">#define Rexx_Error_Execution_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00603">oorexxerrors.h:603</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_ac33b057994061ab05d6cb021d56b8452"><div class="ttname"><a href="oorexxerrors_8h.html#ac33b057994061ab05d6cb021d56b8452">Rexx_Error_Incorrect_method_list</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_method_list</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00535">oorexxerrors.h:535</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_ac62b63c2b452912b30225fc815ff22a8"><div class="ttname"><a href="oorexxerrors_8h.html#ac62b63c2b452912b30225fc815ff22a8">Rexx_Error_System_service_user_defined</a></div><div class="ttdeci">#define Rexx_Error_System_service_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00453">oorexxerrors.h:453</a></div></div>
<div class="ttc" id="aoorexxerrors_8h_html_ac991ff07ea2917919d739ad1937a4eb6"><div class="ttname"><a href="oorexxerrors_8h.html#ac991ff07ea2917919d739ad1937a4eb6">Rexx_Error_Incorrect_method_user_defined</a></div><div class="ttdeci">#define Rexx_Error_Incorrect_method_user_defined</div><div class="ttdef"><b>Definition:</b> <a href="oorexxerrors_8h_source.html#l00522">oorexxerrors.h:522</a></div></div>
<div class="ttc" id="arexx_8h_html_a581e376dc8d3b9132e29014c896b9e70"><div class="ttname"><a href="rexx_8h.html#a581e376dc8d3b9132e29014c896b9e70">CSTRING</a></div><div class="ttdeci">const char * CSTRING</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00078">rexx.h:78</a></div></div>
<div class="ttc" id="arexx_8h_html_a6092009977837102d11ed4338f9e93b5"><div class="ttname"><a href="rexx_8h.html#a6092009977837102d11ed4338f9e93b5">logical_t</a></div><div class="ttdeci">size_t logical_t</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00231">rexx.h:231</a></div></div>
<div class="ttc" id="arexx_8h_html_a64dfe004825692637e2075467179fcd9"><div class="ttname"><a href="rexx_8h.html#a64dfe004825692637e2075467179fcd9">RexxStringObject</a></div><div class="ttdeci">struct _RexxStringObject * RexxStringObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00128">rexx.h:128</a></div></div>
<div class="ttc" id="arexx_8h_html_a67754d7374685ba954286d7268debd80"><div class="ttname"><a href="rexx_8h.html#a67754d7374685ba954286d7268debd80">RexxArrayObject</a></div><div class="ttdeci">struct _RexxArrayObject * RexxArrayObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00130">rexx.h:130</a></div></div>
<div class="ttc" id="arexx_8h_html_a96e0cc5eda42aed364b05f3c493e07e8"><div class="ttname"><a href="rexx_8h.html#a96e0cc5eda42aed364b05f3c493e07e8">RexxObjectPtr</a></div><div class="ttdeci">struct _RexxObjectPtr * RexxObjectPtr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00127">rexx.h:127</a></div></div>
<div class="ttc" id="arexx_8h_html_a9a119fa1e31a4af78dee3c12225b240a"><div class="ttname"><a href="rexx_8h.html#a9a119fa1e31a4af78dee3c12225b240a">NULLOBJECT</a></div><div class="ttdeci">#define NULLOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00147">rexx.h:147</a></div></div>
<div class="ttc" id="arexx_8h_html_ac802de91298eaadf17dca98c4dc9db25"><div class="ttname"><a href="rexx_8h.html#ac802de91298eaadf17dca98c4dc9db25">RexxAllocateMemory</a></div><div class="ttdeci">void *REXXENTRY RexxAllocateMemory(size_t)</div><div class="ttdef"><b>Definition:</b> <a href="_registration_a_p_i_8cpp_source.html#l00553">RegistrationAPI.cpp:553</a></div></div>
<div class="ttc" id="arexx_8h_html_aebdf384b016ed3ba91995946dbce0d55"><div class="ttname"><a href="rexx_8h.html#aebdf384b016ed3ba91995946dbce0d55">RexxPointerObject</a></div><div class="ttdeci">struct _RexxPointerObject * RexxPointerObject</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00132">rexx.h:132</a></div></div>
<div class="ttc" id="arexx_8h_html_aec9d4b9410c6f3c46bcceec8c16e253d"><div class="ttname"><a href="rexx_8h.html#aec9d4b9410c6f3c46bcceec8c16e253d">RexxEntry</a></div><div class="ttdeci">#define RexxEntry</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00235">rexx.h:235</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_a3b7f6d1c46549bc61f77491b5824a102"><div class="ttname"><a href="rexxapidefs_8h.html#a3b7f6d1c46549bc61f77491b5824a102">RXSHV_BADN</a></div><div class="ttdeci">#define RXSHV_BADN</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00116">rexxapidefs.h:116</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_aafe89561a7a66ed3a673b3b65920ead8"><div class="ttname"><a href="rexxapidefs_8h.html#aafe89561a7a66ed3a673b3b65920ead8">RXAUTOBUFLEN</a></div><div class="ttdeci">#define RXAUTOBUFLEN</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00058">rexxapidefs.h:58</a></div></div>
<div class="ttc" id="arexxapidefs_8h_html_ab6272ae3efe7604608fa2b9a9d809b08"><div class="ttname"><a href="rexxapidefs_8h.html#ab6272ae3efe7604608fa2b9a9d809b08">RXSHV_SYSET</a></div><div class="ttdeci">#define RXSHV_SYSET</div><div class="ttdef"><b>Definition:</b> <a href="rexxapidefs_8h_source.html#l00100">rexxapidefs.h:100</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a01110c4f8c467f1ead522c735bb03231"><div class="ttname"><a href="rxwinsys_8cpp.html#a01110c4f8c467f1ead522c735bb03231">HANDLE_ATTRIBUTE</a></div><div class="ttdeci">#define HANDLE_ATTRIBUTE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01776">rxwinsys.cpp:1776</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a037f5d76557f9c16409aeab83fe120bb"><div class="ttname"><a href="rxwinsys_8cpp.html#a037f5d76557f9c16409aeab83fe120bb">MIN_READ_KB_COUNT</a></div><div class="ttdeci">#define MIN_READ_KB_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01789">rxwinsys.cpp:1789</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a04d50ab193eca808cc1ebb64b47a1788"><div class="ttname"><a href="rxwinsys_8cpp.html#a04d50ab193eca808cc1ebb64b47a1788">systemServiceException</a></div><div class="ttdeci">void systemServiceException(RexxMethodContext *context, char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02142">rxwinsys.cpp:2142</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a0522202e1701ae0b677d272e5dc94be8"><div class="ttname"><a href="rxwinsys_8cpp.html#a0522202e1701ae0b677d272e5dc94be8">getParentKeyHandle</a></div><div class="ttdeci">HKEY getParentKeyHandle(RexxMethodContext *c, CSTRING hkParent)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00327">rxwinsys.cpp:327</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a06c944ad5a39b2926947690ecd1c65f9"><div class="ttname"><a href="rxwinsys_8cpp.html#a06c944ad5a39b2926947690ecd1c65f9">END_RECORD_OUT_OF_RANGE_MSG</a></div><div class="ttdeci">#define END_RECORD_OUT_OF_RANGE_MSG</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01796">rxwinsys.cpp:1796</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a0a474da6cd0be4c9cda56b3117ce2fcb"><div class="ttname"><a href="rxwinsys_8cpp.html#a0a474da6cd0be4c9cda56b3117ce2fcb">WSEL_DEFAULT_EVENTS_ARRAY_SIZE</a></div><div class="ttdeci">#define WSEL_DEFAULT_EVENTS_ARRAY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01774">rxwinsys.cpp:1774</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a0b8dab23e0c8f6aa54b19ae8e5163afd"><div class="ttname"><a href="rxwinsys_8cpp.html#a0b8dab23e0c8f6aa54b19ae8e5163afd">HandleArgError</a></div><div class="ttdeci">LONG HandleArgError(PRXSTRING r, BOOL ToMuch)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00102">rxwinsys.cpp:102</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a0bb43c76e5cefb507fab2e661b85cb83"><div class="ttname"><a href="rxwinsys_8cpp.html#a0bb43c76e5cefb507fab2e661b85cb83">checkReadRecordsArgs</a></div><div class="ttdeci">bool checkReadRecordsArgs(RexxMethodContext *context, HANDLE hLog, CSTRING direction, uint32_t start, uint32_t *count, DWORD *flags, DWORD *rc)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02452">rxwinsys.cpp:2452</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a0cc508fd4b3f33e8ff784f41ec969dff"><div class="ttname"><a href="rxwinsys_8cpp.html#a0cc508fd4b3f33e8ff784f41ec969dff">RETERR</a></div><div class="ttdeci">#define RETERR</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00123">rxwinsys.cpp:123</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a13ff8b1b17cbc0e24ffc50eef5beb06e"><div class="ttname"><a href="rxwinsys_8cpp.html#a13ff8b1b17cbc0e24ffc50eef5beb06e">RexxMethod3</a></div><div class="ttdeci">RexxMethod3(RexxObjectPtr, WSRegistry_open, OPTIONAL_CSTRING, hkParent, OPTIONAL_CSTRING, subKeyName, OPTIONAL_CSTRING, access)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00461">rxwinsys.cpp:461</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a1db2acf5671b1ab1a6162ca716a9188a"><div class="ttname"><a href="rxwinsys_8cpp.html#a1db2acf5671b1ab1a6162ca716a9188a">RETVAL</a></div><div class="ttdeci">#define RETVAL(retvalue)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00131">rxwinsys.cpp:131</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a243a5aef8a802b5fb9479e8c0285a3cb"><div class="ttname"><a href="rxwinsys_8cpp.html#a243a5aef8a802b5fb9479e8c0285a3cb">getOpenEventLog</a></div><div class="ttdeci">bool getOpenEventLog(RexxMethodContext *context, const char *server, const char *source, HANDLE *pHandle, DWORD *pRC)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02287">rxwinsys.cpp:2287</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a263f89989778bb5d216f48c65bc38cd6"><div class="ttname"><a href="rxwinsys_8cpp.html#a263f89989778bb5d216f48c65bc38cd6">RexxMethod4</a></div><div class="ttdeci">RexxMethod4(int, WSEventLog_test, RexxStringObject, data, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source, ARGLIST, args)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l03284">rxwinsys.cpp:3284</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a2ba6a26e3358ebece0f37fc1b8f73337"><div class="ttname"><a href="rxwinsys_8cpp.html#a2ba6a26e3358ebece0f37fc1b8f73337">SET_VARIABLE</a></div><div class="ttdeci">#define SET_VARIABLE(varname, data, retc)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00165">rxwinsys.cpp:165</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a2bf76a4c885462297fa33be50621f23d"><div class="ttname"><a href="rxwinsys_8cpp.html#a2bf76a4c885462297fa33be50621f23d">InstWinSysFuncs</a></div><div class="ttdeci">size_t RexxEntry InstWinSysFuncs(const char *funcname, size_t argc, CONSTRXSTRING *argv, const char *qname, RXSTRING *retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l04048">rxwinsys.cpp:4048</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a2d3d1d62890a860f95780130bf735f1d"><div class="ttname"><a href="rxwinsys_8cpp.html#a2d3d1d62890a860f95780130bf735f1d">BAD_RECORD_ARRAY_MSG</a></div><div class="ttdeci">#define BAD_RECORD_ARRAY_MSG</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01792">rxwinsys.cpp:1792</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a3640418d6a7f42f9d410735abf1a9700"><div class="ttname"><a href="rxwinsys_8cpp.html#a3640418d6a7f42f9d410735abf1a9700">IDS_ALL_NT_DESKTOP</a></div><div class="ttdeci">#define IDS_ALL_NT_DESKTOP</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01437">rxwinsys.cpp:1437</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a368e6727c639f7b558a93a5d90e17e71"><div class="ttname"><a href="rxwinsys_8cpp.html#a368e6727c639f7b558a93a5d90e17e71">START_RECORD_OUT_OF_RANGE_MSG</a></div><div class="ttdeci">#define START_RECORD_OUT_OF_RANGE_MSG</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01795">rxwinsys.cpp:1795</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a3770181092e510c5e03cd5c5a87412bb"><div class="ttname"><a href="rxwinsys_8cpp.html#a3770181092e510c5e03cd5c5a87412bb">AddPMItem</a></div><div class="ttdeci">BOOL AddPMItem(const char *lpszCmdLine, const char *lpszCaption, const char *lpszIconPath, WORD wIconIndex, const char *lpszDir, BOOL bLast, const char *lpszHotKey, const char *lpszModifier, BOOL bMin)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01297">rxwinsys.cpp:1297</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a38366f94d2b029adc212fe72dcb0104f"><div class="ttname"><a href="rxwinsys_8cpp.html#a38366f94d2b029adc212fe72dcb0104f">findAndFormatDescription</a></div><div class="ttdeci">BOOL findAndFormatDescription(char *files, DWORD msgID, char **ppInserts, LPVOID *lpMsgBuf)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01871">rxwinsys.cpp:1871</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a3c09713e3a14c7c05f47d67c13bbc993"><div class="ttname"><a href="rxwinsys_8cpp.html#a3c09713e3a14c7c05f47d67c13bbc993">RETC</a></div><div class="ttdeci">#define RETC(retcode)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00116">rxwinsys.cpp:116</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a3f2d72d2d742fcd1b1304b1416e42fc1"><div class="ttname"><a href="rxwinsys_8cpp.html#a3f2d72d2d742fcd1b1304b1416e42fc1">WSRegistryFile</a></div><div class="ttdeci">size_t RexxEntry WSRegistryFile(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01018">rxwinsys.cpp:1018</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a43db62bb156d454cda719114b57c7ad7"><div class="ttname"><a href="rxwinsys_8cpp.html#a43db62bb156d454cda719114b57c7ad7">lookupMessageFile</a></div><div class="ttdeci">void lookupMessageFile(char *pValueName, char *logName, char *source, char *fileBuffer)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01815">rxwinsys.cpp:1815</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a488502d996bd507bcc41951bac8a158b"><div class="ttname"><a href="rxwinsys_8cpp.html#a488502d996bd507bcc41951bac8a158b">IDS_REGISTRY_KEY_CURRENT_SHELLFOLDER</a></div><div class="ttdeci">#define IDS_REGISTRY_KEY_CURRENT_SHELLFOLDER</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01384">rxwinsys.cpp:1384</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a4c604199aba0fbfcec58cf158e43bc48"><div class="ttname"><a href="rxwinsys_8cpp.html#a4c604199aba0fbfcec58cf158e43bc48">setCurrentHandle</a></div><div class="ttdeci">void setCurrentHandle(RexxMethodContext *context, HANDLE h)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02170">rxwinsys.cpp:2170</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a4cd8b7f46126137e3d9c80126cc5eacd"><div class="ttname"><a href="rxwinsys_8cpp.html#a4cd8b7f46126137e3d9c80126cc5eacd">RexxMethod7</a></div><div class="ttdeci">RexxMethod7(uint32_t, WSEventLog_write, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source, OPTIONAL_uint16_t, t, OPTIONAL_uint16_t, category, OPTIONAL_uint32_t, id, OPTIONAL_RexxStringObject, rawData, ARGLIST, args)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02826">rxwinsys.cpp:2826</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a5001452594e8e2af620e4961102bfd86"><div class="ttname"><a href="rxwinsys_8cpp.html#a5001452594e8e2af620e4961102bfd86">GET_HANDLE</a></div><div class="ttdeci">#define GET_HANDLE(argum, ghk)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00162">rxwinsys.cpp:162</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a5079b0d1d4bcfb81c4b54d4619201952"><div class="ttname"><a href="rxwinsys_8cpp.html#a5079b0d1d4bcfb81c4b54d4619201952">RexxMethod0</a></div><div class="ttdeci">RexxMethod0(RexxObjectPtr, WSRegistry_init)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00359">rxwinsys.cpp:359</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a5142b3ed1ad258383f04d09023220574"><div class="ttname"><a href="rxwinsys_8cpp.html#a5142b3ed1ad258383f04d09023220574">GET_HKEY</a></div><div class="ttdeci">#define GET_HKEY(argum, ghk)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00149">rxwinsys.cpp:149</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a518a7a5ade9839384bae06ec5751ac40"><div class="ttname"><a href="rxwinsys_8cpp.html#a518a7a5ade9839384bae06ec5751ac40">getRecordArray</a></div><div class="ttdeci">RexxArrayObject getRecordArray(RexxMethodContext *context)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02229">rxwinsys.cpp:2229</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a553d6a324d3fe6f2ba079a73b3d3d938"><div class="ttname"><a href="rxwinsys_8cpp.html#a553d6a324d3fe6f2ba079a73b3d3d938">WSProgManager</a></div><div class="ttdeci">size_t RexxEntry WSProgManager(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01689">rxwinsys.cpp:1689</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a56f833879bcc8e4e40bfa5703ef90150"><div class="ttname"><a href="rxwinsys_8cpp.html#a56f833879bcc8e4e40bfa5703ef90150">INITCODE_ATTRIBUTE</a></div><div class="ttdeci">#define INITCODE_ATTRIBUTE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01778">rxwinsys.cpp:1778</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a618659792e71825430e8054f92f5f49b"><div class="ttname"><a href="rxwinsys_8cpp.html#a618659792e71825430e8054f92f5f49b">OOREXX_GET_PACKAGE</a></div><div class="ttdeci">OOREXX_GET_PACKAGE(rxwinsys)</div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a641bab07262677c041b5a24836568a3b"><div class="ttname"><a href="rxwinsys_8cpp.html#a641bab07262677c041b5a24836568a3b">AddPMGroup</a></div><div class="ttdeci">BOOL AddPMGroup(const char *lpszGroup, const char *lpszPath)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01246">rxwinsys.cpp:1246</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a64769fa0a2d68f0f904e1b9cc10b33f7"><div class="ttname"><a href="rxwinsys_8cpp.html#a64769fa0a2d68f0f904e1b9cc10b33f7">WSCtrlSend</a></div><div class="ttdeci">size_t RexxEntry WSCtrlSend(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l03645">rxwinsys.cpp:3645</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a6891bcb6f438ab4b0c39b0bbafeda798"><div class="ttname"><a href="rxwinsys_8cpp.html#a6891bcb6f438ab4b0c39b0bbafeda798">WSRegistryKey</a></div><div class="ttdeci">size_t RexxEntry WSRegistryKey(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00500">rxwinsys.cpp:500</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a6aebe62a6353288e498c27ba2b73fd06"><div class="ttname"><a href="rxwinsys_8cpp.html#a6aebe62a6353288e498c27ba2b73fd06">LeavePM</a></div><div class="ttdeci">BOOL LeavePM(BOOL bSaveGroups)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01356">rxwinsys.cpp:1356</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a6cd77c4a2df65c8fec4fd2d81260b0bb"><div class="ttname"><a href="rxwinsys_8cpp.html#a6cd77c4a2df65c8fec4fd2d81260b0bb">pointer2string</a></div><div class="ttdeci">void pointer2string(PRXSTRING result, void *pointer)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00244">rxwinsys.cpp:244</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a6f29f77dec6b904b670cbaa9a30d9ac4"><div class="ttname"><a href="rxwinsys_8cpp.html#a6f29f77dec6b904b670cbaa9a30d9ac4">getEventUserName</a></div><div class="ttdeci">char * getEventUserName(PEVENTLOGRECORD pEvLogRecord)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02055">rxwinsys.cpp:2055</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a70a2a0fc201636e21395c65e53cd6a45"><div class="ttname"><a href="rxwinsys_8cpp.html#a70a2a0fc201636e21395c65e53cd6a45">MAX_REGISTRY_KEY_SIZE</a></div><div class="ttdeci">#define MAX_REGISTRY_KEY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00053">rxwinsys.cpp:53</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a74f1846a02d7f8b0ad0599c7a3a041da"><div class="ttname"><a href="rxwinsys_8cpp.html#a74f1846a02d7f8b0ad0599c7a3a041da">MAX_READ_KB_COUNT</a></div><div class="ttdeci">#define MAX_READ_KB_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01787">rxwinsys.cpp:1787</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a7b184a37509bbcfe3cb46b4f60ac879f"><div class="ttname"><a href="rxwinsys_8cpp.html#a7b184a37509bbcfe3cb46b4f60ac879f">getMinimumReadBufferSize</a></div><div class="ttdeci">DWORD getMinimumReadBufferSize(RexxMethodContext *c)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02204">rxwinsys.cpp:2204</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a7b8407ca317e5b94252f24c3d4278634"><div class="ttname"><a href="rxwinsys_8cpp.html#a7b8407ca317e5b94252f24c3d4278634">WSCtrlMenu</a></div><div class="ttdeci">size_t RexxEntry WSCtrlMenu(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l03827">rxwinsys.cpp:3827</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a82cce9a1e31e2c1fad15be7aed51ea5e"><div class="ttname"><a href="rxwinsys_8cpp.html#a82cce9a1e31e2c1fad15be7aed51ea5e">MSG_TIMEOUT_OPTS</a></div><div class="ttdeci">#define MSG_TIMEOUT_OPTS</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00059">rxwinsys.cpp:59</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a8358f05531abd3a6714a285702ea2cf8"><div class="ttname"><a href="rxwinsys_8cpp.html#a8358f05531abd3a6714a285702ea2cf8">RexxMethod5</a></div><div class="ttdeci">RexxMethod5(uint32_t, WSEventLog_readRecords, OPTIONAL_CSTRING, direction, OPTIONAL_CSTRING, server, OPTIONAL_CSTRING, source, OPTIONAL_uint32_t, start, OPTIONAL_uint32_t, count)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02987">rxwinsys.cpp:2987</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a863767a09c485a9508bd5c2691cc176b"><div class="ttname"><a href="rxwinsys_8cpp.html#a863767a09c485a9508bd5c2691cc176b">STR_BUFFER</a></div><div class="ttdeci">#define STR_BUFFER</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00049">rxwinsys.cpp:49</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a898de5d3084088a18a1ad49afd09fcce"><div class="ttname"><a href="rxwinsys_8cpp.html#a898de5d3084088a18a1ad49afd09fcce">MAX_TIME_DATE</a></div><div class="ttdeci">#define MAX_TIME_DATE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00050">rxwinsys.cpp:50</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a89f130df48a2cead2ca86ede05b19785"><div class="ttname"><a href="rxwinsys_8cpp.html#a89f130df48a2cead2ca86ede05b19785">isGoodEventType</a></div><div class="ttdeci">bool isGoodEventType(uint16_t type)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02552">rxwinsys.cpp:2552</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a8a2ff3f536c0889cf1579cd8e19bfc77"><div class="ttname"><a href="rxwinsys_8cpp.html#a8a2ff3f536c0889cf1579cd8e19bfc77">RET_HANDLE</a></div><div class="ttdeci">#define RET_HANDLE(retvalue)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00138">rxwinsys.cpp:138</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a8f9110a61183846d9639d03fcc472e6d"><div class="ttname"><a href="rxwinsys_8cpp.html#a8f9110a61183846d9639d03fcc472e6d">WSRegistryValue</a></div><div class="ttdeci">size_t RexxEntry WSRegistryValue(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00630">rxwinsys.cpp:630</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a916703b7b817e3f0dd920db2e66e79b9"><div class="ttname"><a href="rxwinsys_8cpp.html#a916703b7b817e3f0dd920db2e66e79b9">rxwinsys_package_entry</a></div><div class="ttdeci">RexxPackageEntry rxwinsys_package_entry</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l04101">rxwinsys.cpp:4101</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a94cb90524f59e324cf51d65819c4002f"><div class="ttname"><a href="rxwinsys_8cpp.html#a94cb90524f59e324cf51d65819c4002f">getEventBinaryData</a></div><div class="ttdeci">size_t getEventBinaryData(PEVENTLOGRECORD pEvLogRecord, char **ppBinData)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02113">rxwinsys.cpp:2113</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a953f077e4879920ecb6f4fa8a06d5454"><div class="ttname"><a href="rxwinsys_8cpp.html#a953f077e4879920ecb6f4fa8a06d5454">TOO_SMALLBUFFER_MSG</a></div><div class="ttdeci">#define TOO_SMALLBUFFER_MSG</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01794">rxwinsys.cpp:1794</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a95805306813e3e6ced3700d40a30bc57"><div class="ttname"><a href="rxwinsys_8cpp.html#a95805306813e3e6ced3700d40a30bc57">DDECallback</a></div><div class="ttdeci">HDDEDATA CALLBACK DDECallback(UINT wType, UINT wFmt, HCONV hConv, HSZ hsz1, HSZ hsz2, HDDEDATA hDDEData, DWORD dwData1, DWORD dwData2)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01172">rxwinsys.cpp:1172</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a95a1da4c78960210d661cf18315fab81"><div class="ttname"><a href="rxwinsys_8cpp.html#a95a1da4c78960210d661cf18315fab81">GetAllUserDesktopLocation</a></div><div class="ttdeci">BOOL GetAllUserDesktopLocation(LPBYTE szDesktopDir, LPDWORD lpcbData)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01443">rxwinsys.cpp:1443</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a979f67d6cbf3d7a5ae0e2a1138243055"><div class="ttname"><a href="rxwinsys_8cpp.html#a979f67d6cbf3d7a5ae0e2a1138243055">isHex</a></div><div class="ttdeci">bool isHex(CSTRING value)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00206">rxwinsys.cpp:206</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a98884c42b72ef3d5412e4cb75329427d"><div class="ttname"><a href="rxwinsys_8cpp.html#a98884c42b72ef3d5412e4cb75329427d">DeletePMItem</a></div><div class="ttdeci">BOOL DeletePMItem(const char *lpszItem)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01341">rxwinsys.cpp:1341</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a9912094b274bf4ae8401bb08305e27fe"><div class="ttname"><a href="rxwinsys_8cpp.html#a9912094b274bf4ae8401bb08305e27fe">AddPMDesktopIcon</a></div><div class="ttdeci">BOOL AddPMDesktopIcon(const char *lpszName, const char *lpszProgram, const char *lpszIcon, int iIconIndex, const char *lpszWorkDir, const char *lpszLocation, const char *lpszArguments, int iScKey, int iScModifier, const char *lpszRun)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01511">rxwinsys.cpp:1511</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a9a375c99e3f826aa1479b4ae4923888e"><div class="ttname"><a href="rxwinsys_8cpp.html#a9a375c99e3f826aa1479b4ae4923888e">DelPMDesktopIcon</a></div><div class="ttdeci">INT DelPMDesktopIcon(const char *lpszName, const char *lpszLocation)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01659">rxwinsys.cpp:1659</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_a9e2ac1c349c2c1c1314f3ca7bc783d76"><div class="ttname"><a href="rxwinsys_8cpp.html#a9e2ac1c349c2c1c1314f3ca7bc783d76">ShowPMGroup</a></div><div class="ttdeci">BOOL ShowPMGroup(const char *lpszGroup, WORD wCmd)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01281">rxwinsys.cpp:1281</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aa36257908629d82200dfd8cffd7588aa"><div class="ttname"><a href="rxwinsys_8cpp.html#aa36257908629d82200dfd8cffd7588aa">RexxMethod1</a></div><div class="ttdeci">RexxMethod1(RexxObjectPtr, setCurrent_Key, RexxStringObject, regKeyHandle)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00370">rxwinsys.cpp:370</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aa3b951437d28fe25587e5d05377b2404"><div class="ttname"><a href="rxwinsys_8cpp.html#aa3b951437d28fe25587e5d05377b2404">RexxMethod2</a></div><div class="ttdeci">RexxMethod2(uint32_t, WSRegistry_delete, OPTIONAL_CSTRING, hkParent, CSTRING, subKeyName)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00425">rxwinsys.cpp:425</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aa4b024b952732c31c2d25e166e5b135e"><div class="ttname"><a href="rxwinsys_8cpp.html#aa4b024b952732c31c2d25e166e5b135e">MIN_READ_BUFFER</a></div><div class="ttdeci">#define MIN_READ_BUFFER</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01790">rxwinsys.cpp:1790</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aa4f1da35c2a9292a48922975f164f1a9"><div class="ttname"><a href="rxwinsys_8cpp.html#aa4f1da35c2a9292a48922975f164f1a9">dwordPtrToRexx</a></div><div class="ttdeci">size_t dwordPtrToRexx(DWORD_PTR val, PRXSTRING r)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00095">rxwinsys.cpp:95</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aa7e90d24d2e874254636c77f97d91457"><div class="ttname"><a href="rxwinsys_8cpp.html#aa7e90d24d2e874254636c77f97d91457">CHECKARG</a></div><div class="ttdeci">#define CHECKARG(argexpctl, argexpcth)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00111">rxwinsys.cpp:111</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aaaec8ce37979776accc70e9a83b8e3bb"><div class="ttname"><a href="rxwinsys_8cpp.html#aaaec8ce37979776accc70e9a83b8e3bb">getEventLogNumber</a></div><div class="ttdeci">int32_t getEventLogNumber(RexxMethodContext *context, LogNumberOp numberType, CSTRING server, CSTRING source)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02359">rxwinsys.cpp:2359</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aab5e324ac01f845f5194a0b3bd0d850a"><div class="ttname"><a href="rxwinsys_8cpp.html#aab5e324ac01f845f5194a0b3bd0d850a">wrongClassException</a></div><div class="ttdeci">unsigned int wrongClassException(RexxMethodContext *c, int pos, const char *n)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02163">rxwinsys.cpp:2163</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab14501d93a4200a18cab8bfd014cea85"><div class="ttname"><a href="rxwinsys_8cpp.html#ab14501d93a4200a18cab8bfd014cea85">getEventDescription</a></div><div class="ttdeci">void getEventDescription(PEVENTLOGRECORD pEvLogRecord, const char *pchSource, char **ppMessage)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01921">rxwinsys.cpp:1921</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab1ba7ecdbacc376bc6415d4bc01846ec"><div class="ttname"><a href="rxwinsys_8cpp.html#ab1ba7ecdbacc376bc6415d4bc01846ec">MSG_TIMEOUT</a></div><div class="ttdeci">#define MSG_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00055">rxwinsys.cpp:55</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab25c779b25621573c1ae0bbfd588d988"><div class="ttname"><a href="rxwinsys_8cpp.html#ab25c779b25621573c1ae0bbfd588d988">WSClipboard</a></div><div class="ttdeci">size_t RexxEntry WSClipboard(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l03938">rxwinsys.cpp:3938</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab5384a0ced990b4c4cd4148fc52c66cd"><div class="ttname"><a href="rxwinsys_8cpp.html#ab5384a0ced990b4c4cd4148fc52c66cd">outOfMemoryException</a></div><div class="ttdeci">void outOfMemoryException(RexxMethodContext *c)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02147">rxwinsys.cpp:2147</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab646f82c393af4916b407863aaac0299"><div class="ttname"><a href="rxwinsys_8cpp.html#ab646f82c393af4916b407863aaac0299">MIN_READ_MAX_ATTRIBUTE</a></div><div class="ttdeci">#define MIN_READ_MAX_ATTRIBUTE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01781">rxwinsys.cpp:1781</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab80971a64f26cbbb73989c0d7a9718dc"><div class="ttname"><a href="rxwinsys_8cpp.html#ab80971a64f26cbbb73989c0d7a9718dc">wrongArgValueException</a></div><div class="ttdeci">void wrongArgValueException(RexxMethodContext *c, int pos, const char *list, RexxObjectPtr actual)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02152">rxwinsys.cpp:2152</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ab9ca6ff3dfca8bcd984786209f13eb6f"><div class="ttname"><a href="rxwinsys_8cpp.html#ab9ca6ff3dfca8bcd984786209f13eb6f">DeletePMGroup</a></div><div class="ttdeci">BOOL DeletePMGroup(const char *lpszGroup)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01267">rxwinsys.cpp:1267</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_abc4960e61cfba1fc781c802c1ab019ce"><div class="ttname"><a href="rxwinsys_8cpp.html#abc4960e61cfba1fc781c802c1ab019ce">getCurrentHandle</a></div><div class="ttdeci">HANDLE getCurrentHandle(RexxMethodContext *context)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02183">rxwinsys.cpp:2183</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ac39d1e16ee52dc59170c491859b46cde"><div class="ttname"><a href="rxwinsys_8cpp.html#ac39d1e16ee52dc59170c491859b46cde">WSEL_DEFAULT_SOURCE</a></div><div class="ttdeci">#define WSEL_DEFAULT_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01775">rxwinsys.cpp:1775</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ac45ef67420c753c3fca077db710e87d8"><div class="ttname"><a href="rxwinsys_8cpp.html#ac45ef67420c753c3fca077db710e87d8">GetCurrentUserDesktopLocation</a></div><div class="ttdeci">BOOL GetCurrentUserDesktopLocation(LPBYTE szDesktopDir, LPDWORD lpcbData)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01387">rxwinsys.cpp:1387</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ac4c60d2bbdb36c3210f28ecbb571e06c"><div class="ttname"><a href="rxwinsys_8cpp.html#ac4c60d2bbdb36c3210f28ecbb571e06c">WSCtrlWindow</a></div><div class="ttdeci">size_t RexxEntry WSCtrlWindow(const char *funcname, size_t argc, CONSTRXSTRING argv[], const char *qname, PRXSTRING retstr)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l03291">rxwinsys.cpp:3291</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ac6683912e961b3a2992e58f6a9d6d9a7"><div class="ttname"><a href="rxwinsys_8cpp.html#ac6683912e961b3a2992e58f6a9d6d9a7">IDS_REGISTRY_KEY_ALL_NT_SHELLFOLDER</a></div><div class="ttdeci">#define IDS_REGISTRY_KEY_ALL_NT_SHELLFOLDER</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01436">rxwinsys.cpp:1436</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ac83e426576b8f8f96731edaca025157d"><div class="ttname"><a href="rxwinsys_8cpp.html#ac83e426576b8f8f96731edaca025157d">closeEventLog</a></div><div class="ttdeci">DWORD closeEventLog(RexxMethodContext *context)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l02328">rxwinsys.cpp:2328</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_acd4df271e9d7f1d95ad77935c918829c"><div class="ttname"><a href="rxwinsys_8cpp.html#acd4df271e9d7f1d95ad77935c918829c">RECORDS_ATTRIBUTE</a></div><div class="ttdeci">#define RECORDS_ATTRIBUTE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01777">rxwinsys.cpp:1777</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_acfb938f3543ca035196470d762cf7b0e"><div class="ttname"><a href="rxwinsys_8cpp.html#acfb938f3543ca035196470d762cf7b0e">MAX_READ_BUFFER</a></div><div class="ttdeci">#define MAX_READ_BUFFER</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01788">rxwinsys.cpp:1788</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ad39997964eafc3b9de2b4a2bfbe47b92"><div class="ttname"><a href="rxwinsys_8cpp.html#ad39997964eafc3b9de2b4a2bfbe47b92">MIN_READ_MIN_ATTRIBUTE</a></div><div class="ttdeci">#define MIN_READ_MIN_ATTRIBUTE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01780">rxwinsys.cpp:1780</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ad42c2318880b503ec1233da392dbc8a3"><div class="ttname"><a href="rxwinsys_8cpp.html#ad42c2318880b503ec1233da392dbc8a3">IDS_CURRENT_DESKTOP</a></div><div class="ttdeci">#define IDS_CURRENT_DESKTOP</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01385">rxwinsys.cpp:1385</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_adc61f50ce845794946655e4e64a0b1ce"><div class="ttname"><a href="rxwinsys_8cpp.html#adc61f50ce845794946655e4e64a0b1ce">string2pointer</a></div><div class="ttdeci">BOOL string2pointer(const char *string, void **pointer)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00224">rxwinsys.cpp:224</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ade9d152280c1d2af148410b016cd7eb0"><div class="ttname"><a href="rxwinsys_8cpp.html#ade9d152280c1d2af148410b016cd7eb0">GET_TYPE_INDEX</a></div><div class="ttdeci">#define GET_TYPE_INDEX(type, index)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00179">rxwinsys.cpp:179</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ae2ae07cabb9563d821ca8deec2e453e4"><div class="ttname"><a href="rxwinsys_8cpp.html#ae2ae07cabb9563d821ca8deec2e453e4">Little2BigEndian</a></div><div class="ttdeci">VOID Little2BigEndian(BYTE *pbInt, INT iSize)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l04026">rxwinsys.cpp:4026</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ae59e555854effc5f3f936f271ca3e15b"><div class="ttname"><a href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15b">LogNumberOp</a></div><div class="ttdeci">LogNumberOp</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01798">rxwinsys.cpp:1798</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ae59e555854effc5f3f936f271ca3e15ba062e05b5bc3b37029e8ba3c3a32d6d1f"><div class="ttname"><a href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba062e05b5bc3b37029e8ba3c3a32d6d1f">record_count</a></div><div class="ttdeci">@ record_count</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01798">rxwinsys.cpp:1798</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ae59e555854effc5f3f936f271ca3e15ba19c5aa8fcb5755c3ec2a835229ac6ba2"><div class="ttname"><a href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15ba19c5aa8fcb5755c3ec2a835229ac6ba2">youngest_record</a></div><div class="ttdeci">@ youngest_record</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01798">rxwinsys.cpp:1798</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_ae59e555854effc5f3f936f271ca3e15baa7a345feda2b0e57c9c1628e29af6f88"><div class="ttname"><a href="rxwinsys_8cpp.html#ae59e555854effc5f3f936f271ca3e15baa7a345feda2b0e57c9c1628e29af6f88">oldest_record</a></div><div class="ttdeci">@ oldest_record</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01798">rxwinsys.cpp:1798</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aea6576dd77c5ea1e5f74559f9d8e2c72"><div class="ttname"><a href="rxwinsys_8cpp.html#aea6576dd77c5ea1e5f74559f9d8e2c72">rxwinsys_functions</a></div><div class="ttdeci">RexxRoutineEntry rxwinsys_functions[]</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l04055">rxwinsys.cpp:4055</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_aec33b06d90ac834899b86039851abced"><div class="ttname"><a href="rxwinsys_8cpp.html#aec33b06d90ac834899b86039851abced">memupper</a></div><div class="ttdeci">void memupper(char *location, size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l00076">rxwinsys.cpp:76</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_af00eef1f14766857695424b90e5442c6"><div class="ttname"><a href="rxwinsys_8cpp.html#af00eef1f14766857695424b90e5442c6">MIN_READ_BUFFER_ATTRIBUTE</a></div><div class="ttdeci">#define MIN_READ_BUFFER_ATTRIBUTE</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01779">rxwinsys.cpp:1779</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_af85cb3e5706068130b1b79176164c83f"><div class="ttname"><a href="rxwinsys_8cpp.html#af85cb3e5706068130b1b79176164c83f">ProgmanCmd</a></div><div class="ttdeci">BOOL ProgmanCmd(LPSTR lpszCmd)</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l01184">rxwinsys.cpp:1184</a></div></div>
<div class="ttc" id="arxwinsys_8cpp_html_af95a969590a9d7254ba1bd81dee2fb7a"><div class="ttname"><a href="rxwinsys_8cpp.html#af95a969590a9d7254ba1bd81dee2fb7a">rxwinsys_methods</a></div><div class="ttdeci">RexxMethodEntry rxwinsys_methods[]</div><div class="ttdef"><b>Definition:</b> <a href="rxwinsys_8cpp_source.html#l04070">rxwinsys.cpp:4070</a></div></div>
<div class="ttc" id="astruct___c_o_n_s_t_r_x_s_t_r_i_n_g_html"><div class="ttname"><a href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html">_CONSTRXSTRING</a></div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00161">rexx.h:161</a></div></div>
<div class="ttc" id="astruct___c_o_n_s_t_r_x_s_t_r_i_n_g_html_a2e9404fe02b081d420a3fe7412152219"><div class="ttname"><a href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a2e9404fe02b081d420a3fe7412152219">_CONSTRXSTRING::strptr</a></div><div class="ttdeci">const char * strptr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00163">rexx.h:163</a></div></div>
<div class="ttc" id="astruct___c_o_n_s_t_r_x_s_t_r_i_n_g_html_a38efa660780cb5cfa52aab2881660378"><div class="ttname"><a href="struct___c_o_n_s_t_r_x_s_t_r_i_n_g.html#a38efa660780cb5cfa52aab2881660378">_CONSTRXSTRING::strlength</a></div><div class="ttdeci">size_t strlength</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00162">rexx.h:162</a></div></div>
<div class="ttc" id="astruct___r_x_s_t_r_i_n_g_html"><div class="ttname"><a href="struct___r_x_s_t_r_i_n_g.html">_RXSTRING</a></div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00156">rexx.h:156</a></div></div>
<div class="ttc" id="astruct___r_x_s_t_r_i_n_g_html_a12a97290b407e2e98317b583d6169d9e"><div class="ttname"><a href="struct___r_x_s_t_r_i_n_g.html#a12a97290b407e2e98317b583d6169d9e">_RXSTRING::strlength</a></div><div class="ttdeci">size_t strlength</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00157">rexx.h:157</a></div></div>
<div class="ttc" id="astruct___r_x_s_t_r_i_n_g_html_ad6b644e71513de3413346382f7850aa5"><div class="ttname"><a href="struct___r_x_s_t_r_i_n_g.html#ad6b644e71513de3413346382f7850aa5">_RXSTRING::strptr</a></div><div class="ttdeci">char * strptr</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00158">rexx.h:158</a></div></div>
<div class="ttc" id="astruct___rexx_method_entry_html"><div class="ttname"><a href="struct___rexx_method_entry.html">_RexxMethodEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00197">oorexxapi.h:198</a></div></div>
<div class="ttc" id="astruct___rexx_package_entry_html"><div class="ttname"><a href="struct___rexx_package_entry.html">_RexxPackageEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00241">oorexxapi.h:242</a></div></div>
<div class="ttc" id="astruct___rexx_routine_entry_html"><div class="ttname"><a href="struct___rexx_routine_entry.html">_RexxRoutineEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l00176">oorexxapi.h:177</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html">_SHVBLOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00204">rexx.h:204</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a5712597e70a0e887aee58b7af0f48fbb"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a5712597e70a0e887aee58b7af0f48fbb">_SHVBLOCK::shvvaluelen</a></div><div class="ttdeci">size_t shvvaluelen</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00209">rexx.h:209</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a72db975b914c95c3a3fc8d44fa305bc9"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a72db975b914c95c3a3fc8d44fa305bc9">_SHVBLOCK::shvname</a></div><div class="ttdeci">CONSTANT_RXSTRING shvname</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00206">rexx.h:206</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a7c6a6cadc29672a515765c717393a859"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a7c6a6cadc29672a515765c717393a859">_SHVBLOCK::shvret</a></div><div class="ttdeci">unsigned char shvret</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00211">rexx.h:211</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a810460c51dc48bffd7a8eb8031c21571"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a810460c51dc48bffd7a8eb8031c21571">_SHVBLOCK::shvcode</a></div><div class="ttdeci">unsigned char shvcode</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00210">rexx.h:210</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_a938afba1f8b39879615e74ce4e2b2b62"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#a938afba1f8b39879615e74ce4e2b2b62">_SHVBLOCK::shvvalue</a></div><div class="ttdeci">RXSTRING shvvalue</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00207">rexx.h:207</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_aa41396aac73894df176fde7d02e995a3"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#aa41396aac73894df176fde7d02e995a3">_SHVBLOCK::shvnamelen</a></div><div class="ttdeci">size_t shvnamelen</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00208">rexx.h:208</a></div></div>
<div class="ttc" id="astruct___s_h_v_b_l_o_c_k_html_ab0c25e93257d4e78cea5bd42ae515333"><div class="ttname"><a href="struct___s_h_v_b_l_o_c_k.html#ab0c25e93257d4e78cea5bd42ae515333">_SHVBLOCK::shvnext</a></div><div class="ttdeci">struct _SHVBLOCK * shvnext</div><div class="ttdef"><b>Definition:</b> <a href="rexx_8h_source.html#l00205">rexx.h:205</a></div></div>
<div class="ttc" id="astruct_rexx_method_context___html"><div class="ttname"><a href="struct_rexx_method_context__.html">RexxMethodContext_</a></div><div class="ttdef"><b>Definition:</b> <a href="oorexxapi_8h_source.html#l01428">oorexxapi.h:1429</a></div></div>
<div class="ttc" id="aunix_2hostemu_8cpp_html_a6a253ffc6474551afe541ca14ac7c679"><div class="ttname"><a href="unix_2hostemu_8cpp.html#a6a253ffc6474551afe541ca14ac7c679">pTail</a></div><div class="ttdeci">static PLL pTail</div><div class="ttdef"><b>Definition:</b> <a href="unix_2hostemu_8cpp_source.html#l00096">unix/hostemu.cpp:96</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a273cf69d639a59973b6019625df33e30"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a></div><div class="ttdeci">unsigned short uint16_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00071">windows/rexxapitypes.h:71</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a32f2e37ee053cf2ce8ca28d1f74630e5"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a></div><div class="ttdeci">int int32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00072">windows/rexxapitypes.h:72</a></div></div>
<div class="ttc" id="awindows_2rexxapitypes_8h_html_a435d1572bf3f880d55459d9805097f62"><div class="ttname"><a href="windows_2rexxapitypes_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a></div><div class="ttdeci">unsigned int uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="windows_2rexxapitypes_8h_source.html#l00073">windows/rexxapitypes.h:73</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_8b29bd360d363874c010699c0e4edfe4.html">executor</a></li><li class="navelem"><a class="el" href="dir_b12c9cdd073ecc75d378afe044a8807c.html">sandbox</a></li><li class="navelem"><a class="el" href="dir_6f8e204b311fad1e21be914fb6af8fc9.html">jlf</a></li><li class="navelem"><a class="el" href="dir_4796bfee7d29ff8f3ba63e631cf48035.html">trunk</a></li><li class="navelem"><a class="el" href="dir_810b14902c641731e177eb53eeb0aca8.html">extensions</a></li><li class="navelem"><a class="el" href="dir_e0d02a1fad55735a61049d22c0c72dff.html">platform</a></li><li class="navelem"><a class="el" href="dir_5181161d942f53de53ce227b615c6f54.html">windows</a></li><li class="navelem"><a class="el" href="dir_9abf806aa5191df25af53dab6c77cef2.html">rxwinsys</a></li><li class="navelem"><a class="el" href="rxwinsys_8cpp.html">rxwinsys.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">executor.master</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
