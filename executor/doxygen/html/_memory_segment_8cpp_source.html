<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>executor.master: MemorySegment.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!--
    Removed completely the TITLEAREA because I don't like the loss of space.
    I want the title in the condensed index (tabs) at top of each HTML page.
    The insertion of the title is managed by javascript code in the footer,
    because this code must be executed AFTER the creation of the condensed index.
    Must have this setting to display the condensed index:
    DISABLE_INDEX = NO
-->
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_memory_segment_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">MemorySegment.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_memory_segment_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">/* Copyright (c) 1995, 2004 IBM Corporation. All rights reserved.             */</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* Copyright (c) 2005-2009 Rexx Language Association. All rights reserved.    */</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">/* This program and the accompanying materials are made available under       */</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">/* the terms of the Common Public License v1.0 which accompanies this         */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">/* distribution. A copy is also available at the following address:           */</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/* http://www.oorexx.org/license.html                          */</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/* Redistribution and use in source and binary forms, with or                 */</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/* without modification, are permitted provided that the following            */</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/* conditions are met:                                                        */</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/* Redistributions of source code must retain the above copyright             */</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer.              */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* Redistributions in binary form must reproduce the above copyright          */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/* notice, this list of conditions and the following disclaimer in            */</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/* the documentation and/or other materials provided with the distribution.   */</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/* Neither the name of Rexx Language Association nor the names                */</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/* of its contributors may be used to endorse or promote products             */</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* derived from this software without specific prior written permission.      */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/* &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/* REXX Kernel                                                                */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/* Primitive Memory segment management                                        */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_rexx_core_8h.html">RexxCore.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_activity_manager_8hpp.html">ActivityManager.hpp</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="class_memory_segment.html#a98a4369bac6e25800ea487a331b46561">   48</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment.html#a98a4369bac6e25800ea487a331b46561">MemorySegment::dump</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *owner, <span class="keywordtype">size_t</span> counter, FILE *keyfile, FILE *dumpfile)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/* Function:  Dump information about an individual segment                    */</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                       <span class="comment">/* print header for segment          */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      fprintf(stderr,<span class="stringliteral">&quot;Dumping %s Segment %lu from %p for %lu\n&quot;</span>, owner, counter, &amp;<a class="code" href="class_memory_segment.html#a72ef6000bb72985c90f711a792d83b9f">segmentStart</a>, <a class="code" href="class_memory_segment_header.html#a6c0acd2a09e144750258e317978a2910">segmentSize</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                       <span class="comment">/* now dump the segment              */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      fprintf(keyfile, <span class="stringliteral">&quot;%s addr.%lu = %p\n&quot;</span>, owner, counter, &amp;<a class="code" href="class_memory_segment.html#a72ef6000bb72985c90f711a792d83b9f">segmentStart</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      fprintf(keyfile, <span class="stringliteral">&quot;%s size.%lu = %lu\n&quot;</span>, owner, counter, <a class="code" href="class_memory_segment_header.html#a6c0acd2a09e144750258e317978a2910">segmentSize</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      fwrite(&amp;<a class="code" href="class_memory_segment.html#a72ef6000bb72985c90f711a792d83b9f">segmentStart</a>, 1, <a class="code" href="class_memory_segment_header.html#a6c0acd2a09e144750258e317978a2910">segmentSize</a>, dumpfile);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="class_memory_segment.html#a5e776095ff13cb958be9bbc88bd41506">   62</a></span>&#160;<a class="code" href="class_dead_object.html">DeadObject</a> *<a class="code" href="class_memory_segment.html#a5e776095ff13cb958be9bbc88bd41506">MemorySegment::lastDeadObject</a>()</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">/* Function:  return a pointer to the last object in a segment if, and only if*/</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/* the object is a dead one.  This is used to check the trailing deadspace    */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">/* in the segment for purposes of combining the segments.                     */</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">char</span> *objectPtr, *endPtr;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">char</span> *lastObjectPtr = NULL;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">/* just scan all of the objects until we&#39;ve reached the end of */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/* the segment */</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">for</span> (objectPtr = <a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>(), endPtr = <a class="code" href="class_memory_segment.html#a972ff8fbdd4236a9c9ea40784a0945f2">end</a>();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        objectPtr &lt; endPtr;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        objectPtr += ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)objectPtr)-&gt;getObjectSize())</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        lastObjectPtr = objectPtr;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (!((<a class="code" href="class_rexx_object.html">RexxObject</a> *)lastObjectPtr)-&gt;isObjectLive(<a class="code" href="_rexx_memory_8cpp.html#a717cb8a2480b5e878894c63fc86b585f">memoryObject</a>.<a class="code" href="class_rexx_memory.html#a7ebb2420f97deb2aedb9ebee487e9ff2">markWord</a>))</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="class_dead_object.html">DeadObject</a> *)lastObjectPtr;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="class_memory_segment.html#a90170d3af7b0490dc608466b357589dc">   89</a></span>&#160;<a class="code" href="class_dead_object.html">DeadObject</a> *<a class="code" href="class_memory_segment.html#a90170d3af7b0490dc608466b357589dc">MemorySegment::firstDeadObject</a>()</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/* Function:  return a pointer to the first object in a segment if, and only  */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">/* if the object is a dead one.  This is used to check the leading deadspace  */</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">/* in the segment for purposes of combining the segments.                     */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">if</span> (!((<a class="code" href="class_rexx_object.html">RexxObject</a> *)<a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>())-&gt;isObjectLive(<a class="code" href="_rexx_memory_8cpp.html#a717cb8a2480b5e878894c63fc86b585f">memoryObject</a>.<a class="code" href="class_rexx_memory.html#a7ebb2420f97deb2aedb9ebee487e9ff2">markWord</a>))</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="class_dead_object.html">DeadObject</a> *)<a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="class_memory_segment.html#a32b221f5b8192e3c8f6179e786b49f62">  104</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment.html#a32b221f5b8192e3c8f6179e786b49f62">MemorySegment::gatherObjectStats</a>(<a class="code" href="class_memory_stats.html">MemoryStats</a> *memStats, <a class="code" href="class_segment_stats.html">SegmentStats</a> *stats)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">/* Function:  Accumulate memory statistics for a segment                      */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">char</span> *op;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">char</span> *ep;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">/* for all objects in this segment   */</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (op = <a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>(), ep = <a class="code" href="class_memory_segment.html#a972ff8fbdd4236a9c9ea40784a0945f2">end</a>(); op &lt; ep; op += ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)op)-&gt;getObjectSize())</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="comment">/* record the information about this object */</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        stats-&gt;<a class="code" href="class_segment_stats.html#abdcd157f699e291d3a416538568d0c79">recordObject</a>(memStats, op);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a03636135836a91d328829444fd3a453b">  120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a03636135836a91d328829444fd3a453b">MemorySegmentSet::dumpSegments</a>(FILE *keyfile, FILE *dumpfile)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">/* Function:  Dump information about the each of the segments                 */</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">size_t</span> counter = 0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">for</span> (segment = <a class="code" href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">first</a>(); segment != NULL; segment = <a class="code" href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">next</a>(segment))</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        segment-&gt;<a class="code" href="class_memory_segment.html#a98a4369bac6e25800ea487a331b46561">dump</a>(<a class="code" href="class_memory_segment_set.html#a145bf8586274f7d4a804141e4fa67623">name</a>, ++counter, keyfile, dumpfile);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#ae50003ea8be96293f5ce776ee954822b">  134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#ae50003ea8be96293f5ce776ee954822b">MemorySegmentSet::dumpMemoryProfile</a>(FILE *outfile)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">/* Function:  Dump profile informaton about a segment set (empty for base     */</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">/* class)                                                                     */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a4005ec9219573b25a608488f5a066654">  142</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#a4005ec9219573b25a608488f5a066654">LargeSegmentSet::dumpMemoryProfile</a>(FILE *outfile)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">/* Function:  Dump profile informaton about the large allocation segment set  */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    fprintf(outfile, <span class="stringliteral">&quot;Memory profile for large object allocations\n\n&quot;</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">/* all the work is done by the dead caches */</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="class_large_segment_set.html#a084c3dbb390dc5ac34132c37918514b5">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a457703fb40e02ac8330dde5d359e3ffb">dumpMemoryProfile</a>(outfile);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a55a5c1a67d650232679a397e0f7caec4">  153</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a55a5c1a67d650232679a397e0f7caec4">NormalSegmentSet::dumpMemoryProfile</a>(FILE *outfile)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/* Function:  Dump profile informaton about the normal allocation segment set */</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;{</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    fprintf(outfile, <span class="stringliteral">&quot;Memory profile for normal object allocations\n\n&quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">/* all the work is done by the dead caches */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">largeDead</a>.<a class="code" href="class_dead_object_pool.html#a457703fb40e02ac8330dde5d359e3ffb">dumpMemoryProfile</a>(outfile);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">for</span> (i = <a class="code" href="_memory_segment_8hpp.html#a9fcdf92cdd1489267738b6cd14880a19">FirstDeadPool</a>; i &lt; <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>; i++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].<a class="code" href="class_dead_object_pool.html#a457703fb40e02ac8330dde5d359e3ffb">dumpMemoryProfile</a>(outfile);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a92fb3c72b863ae7ffa9d2deb67bda275">  170</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a92fb3c72b863ae7ffa9d2deb67bda275">NormalSegmentSet::checkObjectOverlap</a>(<a class="code" href="class_dead_object.html">DeadObject</a> *obj)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">/* Function:  do dead object overlap validation checking.                     */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">/* all the work is done by the dead caches */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">largeDead</a>.<a class="code" href="class_dead_object_pool.html#a93b6edd6b4300f451734432734445fa5">checkObjectOverlap</a>(obj);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="_memory_segment_8hpp.html#a9fcdf92cdd1489267738b6cd14880a19">FirstDeadPool</a> - 1; i &lt; <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>; i++)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].<a class="code" href="class_dead_object_pool.html#a93b6edd6b4300f451734432734445fa5">checkObjectOverlap</a>(obj);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/* Function:  Constructor for the large segment pool.                         */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a84fe903afc43835ee765061de7b036fb">  188</a></span>&#160;<a class="code" href="class_large_segment_set.html#a6589632e959b5f5a5df501d1ca8e54ff">LargeSegmentSet::LargeSegmentSet</a>(<a class="code" href="class_rexx_memory.html">RexxMemory</a> *mem) :</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="class_memory_segment_set.html">MemorySegmentSet</a>(mem, SET_NORMAL, <span class="stringliteral">&quot;Large Allocation Segments&quot;</span>),</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    deadCache(<span class="stringliteral">&quot;Large Block Allocation Pool&quot;</span>), requests(0), smallestObject(0), largestObject(0) { }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/* Function:  Constructor for the large segment pool.                         */</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="class_old_space_segment_set.html#ac09701f0191ecc9d78771f6f867a2b71">  196</a></span>&#160;<a class="code" href="class_old_space_segment_set.html#a62c07fdcd9edf1838dc5033e9266cc6c">OldSpaceSegmentSet::OldSpaceSegmentSet</a>(<a class="code" href="class_rexx_memory.html">RexxMemory</a> *mem) :</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="class_memory_segment_set.html">MemorySegmentSet</a>(mem, SET_OLDSPACE, <span class="stringliteral">&quot;Old Space Segments&quot;</span>),</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    deadCache(<span class="stringliteral">&quot;Old Space Allocation Pool&quot;</span>)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">/* Function:  Constructor for the normal segment pool.                        */</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a0c8926bd04cd2e63f8e8ca8a9863cd15">  207</a></span>&#160;<a class="code" href="class_normal_segment_set.html#ac782818c3b2b503faeebba5af4421262">NormalSegmentSet::NormalSegmentSet</a>(<a class="code" href="class_rexx_memory.html">RexxMemory</a> *mem) :</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="class_memory_segment_set.html">MemorySegmentSet</a>(mem, SET_NORMAL, <span class="stringliteral">&quot;Normal Allocation Segments&quot;</span>),</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    largeDead(<span class="stringliteral">&quot;Large Normal Allocation Pool&quot;</span>)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">/* finish setting up the allocation subpools.  We set up one    */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">/* additional one, to act as a guard pool to redirect things to */</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">/* the large pool. */</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>; i++)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    {  <span class="comment">/* there are only                    */</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">/* DeadPools subpools! (&lt;, not &lt;=)   */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordtype">char</span> buffer[100];</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        sprintf(buffer, <span class="stringliteral">&quot;Normal allocation subpool %d for blocks of size %d&quot;</span>, i, <a class="code" href="_memory_segment_8hpp.html#ac4533b24654421bb15ae9ff7b459b632">DeadPoolToLength</a>(i));</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].<a class="code" href="class_dead_object_pool.html#a0e54863d918466ac6b65187a02a034d9">setID</a>(buffer);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="comment">/* make sure these are properly set up as single size */</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">/* keepers */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].<a class="code" href="class_dead_object_pool.html#a508d03b5240889c90370969df2b885d8">emptySingle</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">/* initially, all subpools are empty, so have them skip */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="comment">/* directly to the dead chains. */</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">lastUsedSubpool</a>[i] = <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">lastUsedSubpool</a>[i] = <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>;    <span class="comment">/* add the final entry in            */</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                       <span class="comment">/* the lastUsedSubpool table (extra) */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                       <span class="comment">/* This must be the first seg created*/</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                       <span class="comment">/* Create a segment for recovery     */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                       <span class="comment">/* doesn&#39;t need to be a full segment */</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                       <span class="comment">/* worth, 1/2 should do              */</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="class_normal_segment_set.html#a46247417b1f4b4fece9559c00c3328ef">recoverSegment</a> = <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#a49f20428166eb0eb71cf5c64ade44658">newSegment</a>(<a class="code" href="_memory_segment_8hpp.html#a798be6ed29e2c4112f7602d317ac3b23">RecoverSegmentSize</a>, <a class="code" href="_memory_segment_8hpp.html#a798be6ed29e2c4112f7602d317ac3b23">RecoverSegmentSize</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a6a863dffe8483a6d557016748c9cc117">  239</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a6a863dffe8483a6d557016748c9cc117">NormalSegmentSet::getInitialSet</a>()</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">/* Function:  Set up the intial normal memory allocation.                     */</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">/* get our first set of segments */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="class_memory_segment_set.html#a7925bd1039f535cadff00ad2a5b9f7d2">addSegments</a>(<a class="code" href="_memory_segment_8hpp.html#a0da52df813466fef9a09f525d0b48635">InitialNormalSegmentSpace</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">  249</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">MemorySegmentSet::allocateSegment</a>(<span class="keywordtype">size_t</span> requestLength, <span class="keywordtype">size_t</span> minimumLength)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">/* Function:  Allocate a segment...designed for subclass overrides            */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;{</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#a49f20428166eb0eb71cf5c64ade44658">newSegment</a>(requestLength, minimumLength);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a9e821586ca4c7943169432f0936a7145">  258</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_large_segment_set.html#a9e821586ca4c7943169432f0936a7145">LargeSegmentSet::allocateSegment</a>(<span class="keywordtype">size_t</span> requestLength, <span class="keywordtype">size_t</span> minimumLength)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">/* Function:  Allocate a segment...designed for subclass overrides            */</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#a5dac31a980220f421b126995f78e26d6">newLargeSegment</a>(requestLength, minimumLength);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#aa354d2e325284f4bf31ed57369b30fad">  267</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#aa354d2e325284f4bf31ed57369b30fad">MemorySegmentSet::getSegment</a>(<span class="keywordtype">size_t</span> requestLength, <span class="keywordtype">size_t</span> minimumLength)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/* Function:  Locate a for a request.  We try to allocate one first from      */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">/* the pool of empty segments, then go to the memory pool manager if we don&#39;t */</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">/* have one in reserve.                                                       */</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">/* see if we have an empty segment available for the full size */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">findEmptySegment</a>(requestLength);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">/* if we can&#39;t find one, check for the minimum size first, */</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">/* before we go to the memory pool manager to get more. */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">if</span> (segment == NULL) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        segment = <a class="code" href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">findEmptySegment</a>(minimumLength);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">/* No luck, go get a real thing to add to this. */</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (segment == NULL) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            segment = <a class="code" href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">allocateSegment</a>(requestLength, minimumLength);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> segment;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">  289</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">MemorySegmentSet::findEmptySegment</a>(<span class="keywordtype">size_t</span> requestLength)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">/* Function:  Find a segment in our empty segment cache.                      */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;{</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">/* scan the empty segments list */</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a5a8aec10366589bc791aada94fe0d181">emptySegments</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">while</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>())</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">/* if this one is large enough, use it. */</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &gt; requestLength)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            segment-&gt;<a class="code" href="class_memory_segment.html#a05f1080941e07fa90af5978ab4c1123a">remove</a>();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">return</span> segment;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        segment = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a08b11e8b7a7209dc327040e842ad40ed">  310</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a08b11e8b7a7209dc327040e842ad40ed">MemorySegmentSet::activateEmptySegments</a>()</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">/* Function:  Move all of our active segments back into the active cache.  We */</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">/* do this because we want to try to merge segments to create larger blocks.  */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">/* scan the empty segments list */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a5a8aec10366589bc791aada94fe0d181">emptySegments</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">while</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>())</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">/* grab the next segment in the chain */</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="class_memory_segment.html">MemorySegment</a> *nextSeg = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">/* remove the current one from the chain */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        segment-&gt;<a class="code" href="class_memory_segment.html#a05f1080941e07fa90af5978ab4c1123a">remove</a>();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">/* insert back into the active list */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(segment);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        segment = nextSeg;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">  332</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">MemorySegmentSet::newSegment</a>(<span class="keywordtype">size_t</span> requestLength, <span class="keywordtype">size_t</span> minimumLength)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/* Function:  Allocate a segment and add it to the segment pool               */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;{</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">/* try to allocate a segment, and add it to the list if */</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">/* successful.  This also adds the space to our dead object */</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">/* pool. */</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">allocateSegment</a>(requestLength, minimumLength);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">if</span> (segment != NULL)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(segment);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">  350</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">MemorySegmentSet::addDeadObject</a>(<a class="code" href="class_dead_object.html">DeadObject</a> *<span class="keywordtype">object</span>)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; <span class="comment">// The base class doesn&#39;t maintain a dead object pool, so this is a nop</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#af98302a7793857bcd1bc2fae8f99665e">  359</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#af98302a7793857bcd1bc2fae8f99665e">LargeSegmentSet::addDeadObject</a>(<a class="code" href="class_dead_object.html">DeadObject</a> *<span class="keywordtype">object</span>)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;{</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">/* we want to keep our cache sorted by the size. */</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="class_large_segment_set.html#a084c3dbb390dc5ac34132c37918514b5">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a8155c6ba4af04d8a7c055ef34a764005">addSortedBySize</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="class_old_space_segment_set.html#a67919a52f7ea8f406ddfc8ac30b8c4bb">  369</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_old_space_segment_set.html#a67919a52f7ea8f406ddfc8ac30b8c4bb">OldSpaceSegmentSet::addDeadObject</a>(<a class="code" href="class_dead_object.html">DeadObject</a> *<span class="keywordtype">object</span>)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">/* we want to keep our cache sorted by the size. */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="class_old_space_segment_set.html#abc73af5db4e6fe3ef7afe56cbd752660">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a8155c6ba4af04d8a7c055ef34a764005">addSortedBySize</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a141f8eeff1a51dc36324f9b559357faa">  379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a141f8eeff1a51dc36324f9b559357faa">NormalSegmentSet::addDeadObject</a>(<a class="code" href="class_dead_object.html">DeadObject</a> *<span class="keywordtype">object</span>)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">//  checkObjectOverlap(object);</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordtype">size_t</span> length = <span class="keywordtype">object</span>-&gt;getObjectSize();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">/* if the length is larger than the biggest subpool we */</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">/* maintain, we add this to the large block list. */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (length &gt; <a class="code" href="_memory_segment_8hpp.html#ab87287e5c507520d6ac780850041becd">LargestSubpool</a>)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">/* ideally, we&#39;d like to add this sorted by size, but */</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">/* this is called so frequently, attempting to sort */</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">/* degrades performance by about 10%. */</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">largeDead</a>.<a class="code" href="class_dead_object_pool.html#ab77431236ca8dd7daee695df8bbd14e2">add</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">/* calculate the dead chain          */</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">/* and add that to the appropriate chain */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordtype">size_t</span> deadChain = <a class="code" href="_memory_segment_8hpp.html#a3fc78b01b8bc0b974411ad506a1e273d">LengthToDeadPool</a>(length);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[deadChain].<a class="code" href="class_dead_object_pool.html#acd4f081dc71cb164e4271ada01da5e73">addSingle</a>(<span class="keywordtype">object</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">/* we can mark this subpool as having items again */</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">lastUsedSubpool</a>[deadChain] = deadChain;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;}</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a06daaaf4c5a3a1b42eb47a9c68f8d8c6">  408</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">MemorySegmentSet::addDeadObject</a>(<span class="keywordtype">char</span> *<span class="keywordtype">object</span>, <span class="keywordtype">size_t</span> length)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;{</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; <span class="comment">// The base class doesn&#39;t maintain a dead object pool, so this is a nop</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#ab214b1bb94610b3d61596e1e3959f7f7">  417</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#af98302a7793857bcd1bc2fae8f99665e">LargeSegmentSet::addDeadObject</a>(<span class="keywordtype">char</span> *<span class="keywordtype">object</span>, <span class="keywordtype">size_t</span> length)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;{</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#ifdef VERBOSE_GC</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (length &gt; <a class="code" href="class_large_segment_set.html#a6e70daef4cd5141ef6fd0c7af65f72e0">largestObject</a>)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="class_large_segment_set.html#a6e70daef4cd5141ef6fd0c7af65f72e0">largestObject</a> = length;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (length &lt; <a class="code" href="class_large_segment_set.html#abe5f58ce25f514baf594af822ab29a3a">smallestObject</a>)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="class_large_segment_set.html#abe5f58ce25f514baf594af822ab29a3a">smallestObject</a> = length;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">/* we want to keep our cache sorted by the size. */</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="class_large_segment_set.html#a084c3dbb390dc5ac34132c37918514b5">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a8155c6ba4af04d8a7c055ef34a764005">addSortedBySize</a>(<span class="keyword">new</span> (<span class="keywordtype">object</span>) <a class="code" href="class_dead_object.html">DeadObject</a>(length));</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="class_old_space_segment_set.html#aa23afd80125fa356a6be0c4b5676a531">  437</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_old_space_segment_set.html#a67919a52f7ea8f406ddfc8ac30b8c4bb">OldSpaceSegmentSet::addDeadObject</a>(<span class="keywordtype">char</span> *<span class="keywordtype">object</span>, <span class="keywordtype">size_t</span> length)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">/* we want to keep our cache sorted by the size. */</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="class_old_space_segment_set.html#abc73af5db4e6fe3ef7afe56cbd752660">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a8155c6ba4af04d8a7c055ef34a764005">addSortedBySize</a>(<span class="keyword">new</span> (<span class="keywordtype">object</span>) <a class="code" href="class_dead_object.html">DeadObject</a>(length));</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a0f52ea2915723176e59591cab5b32b59">  447</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a141f8eeff1a51dc36324f9b559357faa">NormalSegmentSet::addDeadObject</a>(<span class="keywordtype">char</span> *<span class="keywordtype">object</span>, <span class="keywordtype">size_t</span> length)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">/* Function:  Add a dead object to the segment set.                           */</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">/* if the length is larger than the biggest subpool we */</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">/* maintain, we add this to the large block list. */</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (length &gt; <a class="code" href="_memory_segment_8hpp.html#ab87287e5c507520d6ac780850041becd">LargestSubpool</a>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">/* ideally, we&#39;d like to add this sorted by size, but */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">/* this is called so frequently, attempting to sort */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">/* degrades performance by about 10%. */</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <a class="code" href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">largeDead</a>.<a class="code" href="class_dead_object_pool.html#ab77431236ca8dd7daee695df8bbd14e2">add</a>(<span class="keyword">new</span> (<span class="keywordtype">object</span>) <a class="code" href="class_dead_object.html">DeadObject</a>(length));</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">/* calculate the dead chain          */</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">/* and add that to the appropriate chain */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordtype">size_t</span> deadChain = <a class="code" href="_memory_segment_8hpp.html#a3fc78b01b8bc0b974411ad506a1e273d">LengthToDeadPool</a>(length);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[deadChain].<a class="code" href="class_dead_object_pool.html#acd4f081dc71cb164e4271ada01da5e73">addSingle</a>(<span class="keyword">new</span> (<span class="keywordtype">object</span>) <a class="code" href="class_dead_object.html">DeadObject</a>(length));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">/* we can mark this subpool as having items again */</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <a class="code" href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">lastUsedSubpool</a>[deadChain] = deadChain;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">  473</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">MemorySegmentSet::addSegment</a>(<a class="code" href="class_memory_segment.html">MemorySegment</a> *segment, <span class="keywordtype">bool</span> createDeadObject)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">/* Function:  Add a segment to the segment pool.                              */</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;{</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">/* we want to keep these segments ordered by address so we can */</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">/* potentially combine them later. */</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *insertPosition = <a class="code" href="class_memory_segment_set.html#a124455ab929d1b2eb35e7a1b7f19e743">anchor</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">while</span> (insertPosition-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>())</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">/* we want to insert these in sorted order, by address. */</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">/* This allows us to merge segments later, if necessary. */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">if</span> (segment &lt; insertPosition)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        insertPosition = insertPosition-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">/* first check to see if we can merge this with the previous */</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">/* segment.  This will give us larger segment sections for reuse. */</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *previous = insertPosition-&gt;<a class="code" href="class_memory_segment_header.html#a860b767f8d2a95b753a26cad678e5e3e">previous</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (previous-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>() &amp;&amp; previous-&gt;<a class="code" href="class_memory_segment.html#aae8cce0d3ee0f3385c64722a1d50c283">isAdjacentTo</a>(segment))</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="comment">/* just combine this with the previous segment and add the */</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="comment">/* entire block as a dead object. */</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordtype">size_t</span> deadLength = segment-&gt;<a class="code" href="class_memory_segment.html#a2c0cd2972305dc02299a93c1268503ad">realSize</a>();</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        previous-&gt;<a class="code" href="class_memory_segment.html#a57f879b5e8daeefb0131326ac797e5f3">combine</a>(segment);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Combining newly allocated segment of %d bytes to create new segment of %d bytes\n&quot;</span>, deadLength, previous-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>());</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">addDeadObject</a>((<span class="keywordtype">char</span> *)segment, deadLength);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="comment">/* insert this into position */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        insertPosition-&gt;<a class="code" href="class_memory_segment.html#af5eedb6412193837c0e0bdc6f909f7a7">insertBefore</a>(segment);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">/* Insert the segment&#39;s dead space into the proper chain */</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">if</span> (createDeadObject)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <a class="code" href="class_dead_object.html">DeadObject</a> *ptr = segment-&gt;<a class="code" href="class_memory_segment.html#aac924598f86a8bfb94375e83784238a4">createDeadObject</a>();</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">addDeadObject</a>(ptr);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#acdc687287a5eb7de71eb924daba194d5">  518</a></span>&#160;<a class="code" href="class_dead_object.html">DeadObject</a> *<a class="code" href="class_memory_segment_set.html#acdc687287a5eb7de71eb924daba194d5">MemorySegmentSet::donateObject</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/* Function:  Search the cache of dead objects for an object of sufficient    */</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">/* size to fulfill this request.  For the default implementation, we always   */</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">/* return NULL.  Different segment sets may have different strategies for     */</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">/* determining which block is most suitable for donation.                     */</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a50e91263b4c77ab35acc766b21b99634">  530</a></span>&#160;<a class="code" href="class_dead_object.html">DeadObject</a> *<a class="code" href="class_normal_segment_set.html#a50e91263b4c77ab35acc766b21b99634">NormalSegmentSet::donateObject</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">/* Function:  Search the cache of dead objects for an object of sufficient    */</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/* size to fulfill this request.  This just uses normal large block           */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">/* allocation strategy to decide on the block to donate, give a best fit      */</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">/* for the allocation.                                                        */</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="comment">/* find a large object and return it */</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="class_dead_object.html">DeadObject</a> *)<a class="code" href="class_normal_segment_set.html#a8374d91f07d84aca1e810e026489a6dc">findLargeDeadObject</a>(allocationLength);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;}</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a777c56b0f705ad0f1f0471c433a25483">  543</a></span>&#160;<a class="code" href="class_dead_object.html">DeadObject</a> *<a class="code" href="class_large_segment_set.html#a777c56b0f705ad0f1f0471c433a25483">LargeSegmentSet::donateObject</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">/* Function:  Search the cache of dead objects for an object of sufficient    */</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">/* size to fulfill this request.  This just uses normal large block           */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">/* allocation strategy to decide on the block to donate, give a best fit      */</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">/* for the allocation.                                                        */</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;{</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="comment">/* find an object in the cache return it.  This will likely be */</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">/* larger than the request, as we shouldn&#39;t have may small */</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">/* objects in the dead chains. */</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_large_segment_set.html#a084c3dbb390dc5ac34132c37918514b5">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a2996357280429e455965f05231479ce4">findSmallestFit</a>(allocationLength);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;}</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#afba8acc0061aeb8f2b976bcc5a0d2bc8">  558</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#afba8acc0061aeb8f2b976bcc5a0d2bc8">MemorySegmentSet::donateSegment</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">/* Function:  Search the set of segments to see if it is possible to donate   */</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">/* a segment to another segment set.  Our preference is to give up an empty   */</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">/* segment.  If we don&#39;t have an empty one of sufficient size, then we&#39;ll     */</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">/* see if we can split one of our segments to create a new one.               */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">/* first check for the empty one... */</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">findEmptySegment</a>(allocationLength);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">/* if no empties available, we might still be able to split off */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">/* an empty bit. */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (segment == NULL)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        segment = <a class="code" href="class_memory_segment_set.html#abef797a5a96a5ef49e17d3fb376a75f7">splitSegment</a>(allocationLength);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">return</span> segment;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;}</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#abef797a5a96a5ef49e17d3fb376a75f7">  578</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#abef797a5a96a5ef49e17d3fb376a75f7">MemorySegmentSet::splitSegment</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">/* Function:  Search the set of large segments looking for a dead block large */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">/* enough that we can split the segment and give part to the normal           */</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">/* allocation heap.   Our preference is a block that is at the start or end   */</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">/* of a segment, but since we&#39;re in a critical memory situation right now,    */</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">/* any block of sufficient size will do.  NOTE:  This routine can             */</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">/* only be called immediately after a complete mark and sweep operation has   */</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">/* been performed.  We are dependent on there having been no object           */</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">/* allocations since the segment information was updated.                     */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;{</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        NO_SEGMENT, SPLIT_FRONT, SPLIT_REAR, SPLIT_MIDDLE</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    } SplitType;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    SplitType split = NO_SEGMENT;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *candidateSegment = NULL;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">char</span>    *splitBlock = NULL;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">size_t</span>   splitLength = <a class="code" href="_rexx_memory_8hpp.html#abaf1a460f90100184a5761ff7fa344a9">MaximumObjectSize</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">char</span> *objectPtr;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">/* We&#39;re basically going to perform a sweep operation on the */</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">/* large heap segment looking for a candidate segment to split. */</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">/* Our preference is for an empty block at the end of a */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">/* segment.  Second choice is an empty block at the beginning */</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">/* of the segment.  Failing either of these, we&#39;ll split in the */</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">/* middle to create 3 segments. */</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">first</a>();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">while</span> (segment != NULL)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordtype">char</span> *endPtr;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordtype">size_t</span> deadLength;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">/* ok, sweep all of the objects in this segment, looking */</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="comment">/* for one large enough. */</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">for</span> (objectPtr = segment-&gt;<a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>(), endPtr = segment-&gt;<a class="code" href="class_memory_segment.html#a972ff8fbdd4236a9c9ea40784a0945f2">end</a>(), deadLength = ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)objectPtr)-&gt;getObjectSize();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            objectPtr &lt; endPtr;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            objectPtr += deadLength, deadLength = ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)objectPtr)-&gt;<a class="code" href="class_rexx_internal_object.html#a035eb8bf67ca1b43d4238e806a0db0a0">getObjectSize</a>())</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="comment">/* We&#39;re only interested in the dead objects.  Note */</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="comment">/* that since we&#39;ve just finished a GC operation, we */</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="comment">/* shouldn&#39;t see any adjacent dead objects. */</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">if</span> (!((<a class="code" href="class_rexx_object.html">RexxObject</a> *)objectPtr)-&gt;isObjectLive(<a class="code" href="_rexx_memory_8cpp.html#a717cb8a2480b5e878894c63fc86b585f">memoryObject</a>.<a class="code" href="class_rexx_memory.html#a7ebb2420f97deb2aedb9ebee487e9ff2">markWord</a>))</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="comment">/* have we found an empty part large enough to */</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="comment">/* convert into a segment? */</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keywordflow">if</span> (deadLength &gt;= allocationLength &amp;&amp; deadLength&gt;= <a class="code" href="_memory_segment_8hpp.html#afd9ced7d94e5cff9fc6053ca97f7a4f1">MinimumSegmentSize</a>)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    <span class="comment">/* is this at the end of the segment?  This is a */</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                    <span class="comment">/* perfect candidate.  we&#39;ll remember this for */</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    <span class="comment">/* later. */</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a4a378020d01dc55a36fd3d8d0e6dfb5b">isLastBlock</a>(objectPtr, deadLength))</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        <span class="comment">/* we might already have a rear split candidate. */</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        <span class="comment">/* Take the smaller of the possibilities. */</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        <span class="keywordflow">if</span> (split == SPLIT_REAR)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                            <span class="comment">/* already have a smaller one?  We&#39;ll just skip this */</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                            <span class="keywordflow">if</span> (splitLength &lt; deadLength)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                            {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                            }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                        }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        <span class="comment">/* record the information, and skip to the next */</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                        <span class="comment">/* segment. */</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        split = SPLIT_REAR;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        candidateSegment = segment;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        splitBlock = objectPtr;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                        splitLength = deadLength;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    <span class="comment">/* This might be at the beginning of the */</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    <span class="comment">/* segment.  We only use this if we don&#39;t have */</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <span class="comment">/* something more suitable already. */</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a3d5dff71c6e0a47466d530fc7864546f">isFirstBlock</a>(objectPtr))</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                        <span class="comment">/* if we&#39;ve already found a rear split, we */</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                        <span class="comment">/* don&#39;t want this one. */</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                        <span class="keywordflow">if</span> (split == SPLIT_REAR)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                        {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                        <span class="comment">/* we&#39;ll also ignore this if we&#39;ve found a shorter front block */</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                        <span class="keywordflow">if</span> (split == SPLIT_FRONT &amp;&amp; splitLength &lt; deadLength)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                        {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                        }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        split = SPLIT_FRONT;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                        candidateSegment = segment;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                        splitBlock = objectPtr;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                        splitLength = deadLength;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                        <span class="comment">/* we continue rather than break here, */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                        <span class="comment">/* because this segment might have a better */</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        <span class="comment">/* candidate on the end. */</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="comment">/* we&#39;ve found a block on the middle.  This is */</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    <span class="comment">/* our last choice, so we only use this if we */</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                    <span class="comment">/* haven&#39;t found anything better. */</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                    {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                        <span class="comment">/* we&#39;ll also ignore this if we&#39;ve found a */</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                        <span class="comment">/* shorter front block */</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                        <span class="keywordflow">if</span> ((split == SPLIT_MIDDLE &amp;&amp; splitLength &lt; deadLength))</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                        }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                        <span class="comment">/* have we found any of the other options?  Skip it also. */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                        <span class="keywordflow">if</span> (split != NO_SEGMENT)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                        {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        split = SPLIT_MIDDLE;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                        candidateSegment = segment;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                        splitBlock = objectPtr;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                        splitLength = deadLength;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        <span class="comment">/* we continue rather than break here, */</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                        <span class="comment">/* because this segment might have a better */</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                        <span class="comment">/* candidate on the end. */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        segment = <a class="code" href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">next</a>(segment);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">/* now we need to process the &quot;best&quot; split candidate block. */</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">switch</span> (split)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">/* no block found that we can convert into a segment. */</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="comment">/* We&#39;ll just have to steal a dead block off of the chain. */</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        <span class="keywordflow">case</span> NO_SEGMENT: {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="comment">/* The preferred (and easiest split).  Just remove the */</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="comment">/* block from the dead chain, adjust the original segment */</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="comment">/* size, and make a new one from this block. */</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">case</span> SPLIT_REAR: {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                <a class="code" href="class_dead_object.html">DeadObject</a> *deadObject = (<a class="code" href="class_dead_object.html">DeadObject</a> *)splitBlock;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                <span class="comment">/* remove this from the dead chain. */</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                deadObject-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <span class="comment">/* And turn this into a segment */</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <a class="code" href="class_memory_segment.html">MemorySegment</a> *newSeg = <span class="keyword">new</span> (splitBlock) <a class="code" href="class_memory_segment.html">MemorySegment</a>(splitLength - <a class="code" href="_memory_segment_8hpp.html#a827d5656c218e9227654dd2c42e5fc12">MemorySegmentOverhead</a>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="comment">/* reduce the length of the segment we took this from */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                candidateSegment-&gt;<a class="code" href="class_memory_segment.html#a4eedcaf184067d854ee9d2c01d01a3c4">shrink</a>(splitLength);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="keywordflow">return</span> newSeg;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <span class="comment">/* split a segment in the front.  We need to create two */</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="comment">/* segments for this one. */</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">case</span> SPLIT_FRONT: {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                <a class="code" href="class_dead_object.html">DeadObject</a> *deadObject = (<a class="code" href="class_dead_object.html">DeadObject</a> *)splitBlock;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                <span class="comment">/* remove this from the dead chain. */</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                deadObject-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="comment">/* remove the existing segment from the chain. */</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <a class="code" href="class_memory_segment_set.html#ac9a05831e53c99a38ab61eadee6c6311">removeSegment</a>(candidateSegment);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                <span class="comment">/* calculate the adjusted length of this */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                <span class="keywordtype">size_t</span> tailLength = candidateSegment-&gt;<a class="code" href="class_memory_segment.html#a2c0cd2972305dc02299a93c1268503ad">realSize</a>() - splitLength;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                <span class="comment">/* go to the start of the tail end segment we&#39;re */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="comment">/* leaving behind.  Note that since we increment the */</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="comment">/* length of the starting block from the front of the */</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <span class="comment">/* segment, we end up leaving a header space at the */</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="comment">/* front of the created tail portion. */</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <a class="code" href="class_memory_segment.html">MemorySegment</a> *tailSegment = (<a class="code" href="class_memory_segment.html">MemorySegment</a> *)( ((<span class="keywordtype">char</span>*) candidateSegment) + splitLength);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <span class="comment">/* create two segments out of this */</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <a class="code" href="class_memory_segment.html">MemorySegment</a> *newSeg = <span class="keyword">new</span> (candidateSegment) <a class="code" href="class_memory_segment.html">MemorySegment</a>(splitLength);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                tailSegment = <span class="keyword">new</span> (tailSegment) <a class="code" href="class_memory_segment.html">MemorySegment</a>(tailLength);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="comment">/* Anchor new segment at end of list */</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(tailSegment, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="keywordflow">return</span> newSeg;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="comment">/* we&#39;re taking a block from the middle of the segment.  We */</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="comment">/* need to create segments in front, and back. */</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">case</span> SPLIT_MIDDLE: {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <a class="code" href="class_dead_object.html">DeadObject</a> *deadObject = (<a class="code" href="class_dead_object.html">DeadObject</a> *)splitBlock;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="comment">/* remove this from the dead chain. */</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                deadObject-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="comment">/* remove the existing segment from the chain. */</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                <a class="code" href="class_memory_segment_set.html#ac9a05831e53c99a38ab61eadee6c6311">removeSegment</a>(candidateSegment);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <span class="comment">/* get the length of data in the front segment part */</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                <span class="keywordtype">size_t</span> frontLength = splitBlock - candidateSegment-&gt;<a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>();</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="comment">/* calculate the size of the data in the tail end piece */</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="keywordtype">size_t</span> tailLength = candidateSegment-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() - (frontLength + splitLength);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="comment">/* address the start of the tail segment, accounting */</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                <span class="comment">/* for the segment header we&#39;re adding on to the front */</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="comment">/* of it (which comes from the end of the segment block */</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="comment">/* we&#39;re stealing) */</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                <a class="code" href="class_memory_segment.html">MemorySegment</a> *tailSegment = (<a class="code" href="class_memory_segment.html">MemorySegment</a> *)(splitBlock + splitLength - <a class="code" href="_memory_segment_8hpp.html#a827d5656c218e9227654dd2c42e5fc12">MemorySegmentOverhead</a>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="comment">/* we need to reduce this by two segment headers...one */</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="comment">/* for the segment we&#39;re stealing, and one for the */</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                <span class="comment">/* trailing segment */</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                splitLength -= (2 * <a class="code" href="_memory_segment_8hpp.html#a827d5656c218e9227654dd2c42e5fc12">MemorySegmentOverhead</a>);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="comment">/* create two segments out of this */</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <a class="code" href="class_memory_segment.html">MemorySegment</a> *newSeg = <span class="keyword">new</span> (splitBlock) <a class="code" href="class_memory_segment.html">MemorySegment</a>(splitLength);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                tailSegment = <span class="keyword">new</span> (tailSegment) <a class="code" href="class_memory_segment.html">MemorySegment</a>(tailLength);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                candidateSegment = <span class="keyword">new</span> (candidateSegment) <a class="code" href="class_memory_segment.html">MemorySegment</a>(frontLength);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                <span class="comment">/* Anchor the original pieces on the segment chain */</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(tailSegment, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(candidateSegment, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                <span class="keywordflow">return</span> newSeg;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;}</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#af2cef0bc2610af9a53c3af7a2538f965">  786</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="class_normal_segment_set.html#af2cef0bc2610af9a53c3af7a2538f965">NormalSegmentSet::suggestMemoryExpansion</a>()</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment">/* Function:  Decide if we should add additional segments to the normal heap  */</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">/* based on the amount of free space we have after a garbage collection.  If  */</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">/* we&#39;re starting to run full, then we should expand the heap to prevent      */</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">/* recycling the garbage collector to reclaim minimal amounts of storage that */</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">/* is immediately reused, causing another GC cycle.                           */</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;{</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">float</span> freePercent = <a class="code" href="class_memory_segment_set.html#aabdb564ac4a2f34cbffc741817bfddc9">freeMemoryPercentage</a>();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Normal segment set free memory percentage is %d\n&quot;</span>, (<span class="keywordtype">int</span>)(freePercent * 100.0));</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="comment">/* if we are less than 30% full, we should try to expand to the */</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="comment">/* 30% mark. */</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (freePercent &lt; <a class="code" href="_memory_segment_8hpp.html#a81878194fdf60918882dea751c4a5ff9">NormalMemoryExpansionThreshold</a>)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">/* get a recommendation on how large the heap should be */</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordtype">size_t</span> recommendedSize = <a class="code" href="class_normal_segment_set.html#ac61049646d46e3293f706cfb6557643d">recommendedMemorySize</a>();</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordtype">size_t</span> newDeadBytes = recommendedSize - <a class="code" href="class_memory_segment_set.html#a3d3811d09e36ae1fe1060a585534ffea">liveObjectBytes</a>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">/* calculate the number of new bytes we need to add reach */</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">/* our memory threshold.  It will be the job of others to */</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <span class="comment">/* translate this into segment sized units. */</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordtype">size_t</span> expansionSize = newDeadBytes - <a class="code" href="class_memory_segment_set.html#a7261a480da3ecae054b3cd1be0b30ead">deadObjectBytes</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">return</span> expansionSize;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">/* no expansion required yet. */</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a8b91ff7fd6370e4f54900a99ef9b4f27">  817</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="class_memory_segment_set.html#a8b91ff7fd6370e4f54900a99ef9b4f27">MemorySegmentSet::suggestMemoryExpansion</a>()</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">/* Function:  Decide if we should add additional segments to the normal heap  */</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">/* based on the amount of free space we have after a garbage collection.  If  */</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">/* we&#39;re starting to run full, then we should expand the heap to prevent      */</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">/* recycling the garbage collector to reclaim minimal amounts of storage that */</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">/* is immediately reused, causing another GC cycle.                           */</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;{</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">/* the base memory set has no expansion algorithm...always return 0 */</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;}</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a4f62f365c719d6b41ff72af9ca32945f">  831</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="class_memory_segment_set.html#a4f62f365c719d6b41ff72af9ca32945f">MemorySegmentSet::suggestMemoryContraction</a>()</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">/* Function:  Decide if we should add try to remove memory from a segment set.*/</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">/* The value returned is the suggested number of bytes we should try to.      */</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">/* This is only a suggestion based on a best guess, and we&#39;ll only remove     */</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">/* things in full segment units.                                              */</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;{</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">/* the base memory set has no contraction algorithm...always return 0 */</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;}</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a318a7460c27133c5a48756ab5f522411">  844</a></span>&#160;<span class="keywordtype">size_t</span> <a class="code" href="class_normal_segment_set.html#a318a7460c27133c5a48756ab5f522411">NormalSegmentSet::suggestMemoryContraction</a>()</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">/* Function:  Decide if we should add try to remove memory from a segment set.*/</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">/* The value returned is the suggested number of bytes we should try to.      */</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">/* This is only a suggestion based on a best guess, and we&#39;ll only remove     */</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">/* things in full segment units.                                              */</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;{</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">float</span> freePercent = <a class="code" href="class_memory_segment_set.html#aabdb564ac4a2f34cbffc741817bfddc9">freeMemoryPercentage</a>();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="comment">/* if we have predominately free space in the heap, we should try to give some back */</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (freePercent &gt; <a class="code" href="_memory_segment_8hpp.html#a9b53c99f99871162ef8ea943eae3879c">NormalMemoryContractionThreshold</a>)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">/* if we&#39;re still working on our initial allocation set, we */</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="comment">/* don&#39;t want to try to shrink that. */</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_memory_segment_set.html#a5e69013d44776da1867020f293ae09b6">totalFreeMemory</a>() &lt;= <a class="code" href="_memory_segment_8hpp.html#a0da52df813466fef9a09f525d0b48635">InitialNormalSegmentSpace</a>)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="comment">/* Calculate an amount to shrink this by.  If it ends up */</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="comment">/* being a small amount, we&#39;ll live with the overage. */</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_memory_segment_set.html#a5e69013d44776da1867020f293ae09b6">totalFreeMemory</a>() - <a class="code" href="class_normal_segment_set.html#a0494bfe08376b08535753a86235283c0">recommendedMaximumMemorySize</a>();</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">/* no expansion required yet. */</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;}</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a11b567e97ec08847b5f4c4cd01bceafc">  872</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a11b567e97ec08847b5f4c4cd01bceafc">MemorySegmentSet::adjustMemorySize</a>()</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">/* Function:  Decide if we should add or removed segments from the segment    */</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">/* set based on the current state of the heap immediately following a sweep.  */</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">/* We want to avoid thrashing the garbage collector because of chronic low    */</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">/* memory conditions.  If we wait until we get an actual allocation failure,  */</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">/* we will end up in a state where we&#39;re constantly running a mark-and-sweep  */</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">/*to  reclaim just a tiny amount of storage, and then repeat.  We will try to */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">/* keep the heap with appropriate free space limits.                          */</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">/* Conversely, if we find ourselves with a lot of empty space, we&#39;ll see if   */</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">/* we can remove segments from the segment set.  For the small allocation     */</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">/* pools, it is not likley we&#39;d be able to do this, but since we try to       */</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">/* maintain large blocks whenever possible, it can happen.  For the larger    */</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">/* allocation pool, we are more likely to end up with empty segments we can   */</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">/* give back.                                                                 */</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;{</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">/* see if a proactive expansion is advised, based on our */</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="comment">/* current state. */</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordtype">size_t</span> suggestedExpansion = <a class="code" href="class_memory_segment_set.html#a8b91ff7fd6370e4f54900a99ef9b4f27">suggestMemoryExpansion</a>();</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">/* if we&#39;ve decided we need to expand,  */</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">if</span> (suggestedExpansion &gt; 0)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="comment">/* go add as many segments as are required to reach that */</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="comment">/* level. */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Expanding normal segment set by %d\n&quot;</span>, suggestedExpansion);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="class_memory_segment_set.html#a7925bd1039f535cadff00ad2a5b9f7d2">addSegments</a>(suggestedExpansion);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment">//  else {</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="comment">/* get a suggested contraction amount.  There is no sense */</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="comment">/* in trying to release less than a segment. */</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">//      size_t suggestedContraction = suggestMemoryContraction();</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">//      if (suggestedContraction &gt;= SegmentDeadSpace) {</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="comment">/* see if we can&#39;t release some of the space we have. */</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">//          releaseEmptySegments(suggestedContraction);</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;}</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a57fc11caaa79e8677c8d094d7adfb2c3">  915</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a57fc11caaa79e8677c8d094d7adfb2c3">MemorySegmentSet::releaseEmptySegments</a>(<span class="keywordtype">size_t</span> releaseSize)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">/* Function:  Scan the loaded segments, searching for empty segments that     */</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">/* can be released.  We will release up to the maximum recommended amount.    */</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;{</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">/* round this up to the next segment boundary. We&#39;re already at */</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">/* a pretty good overage point, so we can afford to round this */</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="comment">/* up. */</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    releaseSize = <a class="code" href="_memory_segment_8hpp.html#a8f62aa3cd5c5a0ae1eff3951ea1fd671">roundSegmentBoundary</a>(releaseSize);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">first</a>();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">for</span> (;segment != NULL; segment = <a class="code" href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">next</a>(segment))</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">/* is this an empty segment that fits within our criteria? */</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a600233405db51678164f8553bb73d938">isEmpty</a>() &amp;&amp; segment-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &lt;= releaseSize)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            <span class="comment">/* we need to step back one segment for the looping, as */</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="comment">/* we&#39;re going to cut this segment out from the herd. */</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <a class="code" href="class_memory_segment.html">MemorySegment</a> *previous = segment-&gt;<a class="code" href="class_memory_segment_header.html#a860b767f8d2a95b753a26cad678e5e3e">previous</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <span class="comment">/* remove this from the pool */</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="class_memory_segment_set.html#a3893ae7c04fb800b3f465285ffbcc467">removeSegmentAndStorage</a>(segment);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <span class="comment">/* return this segment to the memory pool */</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <a class="code" href="class_memory_segment_set.html#aa0f7b1c3c50aae8a9dfd8a271f4cffaf">releaseSegment</a>(segment);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <span class="comment">/* pick up the loop with the previous segment (which */</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="comment">/* will immediately step to the segment following the */</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="comment">/* one we just released). */</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            segment = previous;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#aa0f7b1c3c50aae8a9dfd8a271f4cffaf">  947</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#aa0f7b1c3c50aae8a9dfd8a271f4cffaf">MemorySegmentSet::releaseSegment</a>(<a class="code" href="class_memory_segment.html">MemorySegment</a> *segment)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;{</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="comment">/* just move this to the empty segment chain */</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <a class="code" href="class_memory_segment_set.html#a5a8aec10366589bc791aada94fe0d181">emptySegments</a>.<a class="code" href="class_memory_segment.html#af5eedb6412193837c0e0bdc6f909f7a7">insertBefore</a>(segment);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">/* the count is only of the active segments */</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <a class="code" href="class_memory_segment_set.html#a9e1c69fb1b32ca37d643bf839ae665b4">count</a>--;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;}</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a7925bd1039f535cadff00ad2a5b9f7d2">  956</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a7925bd1039f535cadff00ad2a5b9f7d2">MemorySegmentSet::addSegments</a>(<span class="keywordtype">size_t</span> requiredSpace)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">/* Function:  Add segments to the segment set until the required space is     */</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">/* achieved or we&#39;ve had a real memory failure.  Our preference is to add this*/</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">/* in one chunk, but we&#39;ll subdivide down to smaller units as long as we&#39;re   */</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">/* still getting the segments we require.                                     */</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;{</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">/* this may take several passes to achieve */</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">for</span> (;;)</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">/* figure out how large this should be */</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordtype">size_t</span> segmentSize = <a class="code" href="class_memory_segment_set.html#a5047a2cb5b670257e525747da90c70af">calculateSegmentAllocation</a>(requiredSpace);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordtype">size_t</span> minSize = segmentSize &gt;= <a class="code" href="_memory_segment_8hpp.html#ab16f6f4e9c8d51805cfb5dfa9c0662ab">LargeSegmentDeadSpace</a> ? <a class="code" href="_memory_segment_8hpp.html#ab16f6f4e9c8d51805cfb5dfa9c0662ab">LargeSegmentDeadSpace</a> : <a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="comment">/* try to allocate a new segment */</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="class_memory_segment.html">MemorySegment</a> *newSeg = <a class="code" href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">allocateSegment</a>(segmentSize, minSize);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">if</span> (newSeg == NULL)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="comment">/* if we already failed to get our &quot;minimum minimum&quot;, just quit now. */</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <span class="keywordflow">if</span> (minSize == <a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <span class="comment">/* try for a single segment allocation.  If that */</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="comment">/* fails...we have nothing else we can do. */</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            newSeg = <a class="code" href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">allocateSegment</a>(<a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>, <a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <span class="keywordflow">if</span> (newSeg == NULL)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">/* we have a segment.  Add this to the segment pool */</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="comment">/* (and add the dead space to the available memory). */</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(newSeg);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        segmentSize = newSeg-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>();</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="comment">/* if we&#39;ve got what&#39;s needed, we&#39;re out of here. */</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span> (segmentSize &gt;= requiredSpace)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="comment">/* reduce the size and try for some more */</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        requiredSpace -= segmentSize;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#aa2caa0bde362ae2ff82b82f33bd536e7"> 1003</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#aa2caa0bde362ae2ff82b82f33bd536e7">MemorySegmentSet::prepareForSweep</a>()</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">/* Function:  Handle all segment set pre-sweep initialization.                */</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;{</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="class_memory_segment_set.html#a3d3811d09e36ae1fe1060a585534ffea">liveObjectBytes</a> = 0;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <a class="code" href="class_memory_segment_set.html#a7261a480da3ecae054b3cd1be0b30ead">deadObjectBytes</a> = 0;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;}</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a74dc65ef70fa15612f38d8b90ca25c65"> 1013</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a74dc65ef70fa15612f38d8b90ca25c65">NormalSegmentSet::prepareForSweep</a>()</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">/* Function:  Handle all segment set pre-sweep initialization.                */</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;{</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <a class="code" href="class_memory_segment_set.html#aa2caa0bde362ae2ff82b82f33bd536e7">MemorySegmentSet::prepareForSweep</a>();</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">/* we&#39;re about to rebuild the dead chains during the sweep, so */</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">/* initialize all of these now. */</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">largeDead</a>.<a class="code" href="class_dead_object_pool.html#a305566ec5dba8c4e41f940933589db79">empty</a>();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="_memory_segment_8hpp.html#a9fcdf92cdd1489267738b6cd14880a19">FirstDeadPool</a>; i &lt; <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>; i++)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].<a class="code" href="class_dead_object_pool.html#a508d03b5240889c90370969df2b885d8">emptySingle</a>();</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;}</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a2f246f4ed8e500fbd4da3a01123ff635"> 1030</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#a2f246f4ed8e500fbd4da3a01123ff635">LargeSegmentSet::prepareForSweep</a>()</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">/* Function:  Handle all segment set pre-sweep initialization.                */</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;{</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="class_memory_segment_set.html#aa2caa0bde362ae2ff82b82f33bd536e7">MemorySegmentSet::prepareForSweep</a>();</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">/* we&#39;re about to rebuild the dead chains during the sweep, so */</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">/* initialize all of these now. */</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="class_large_segment_set.html#a084c3dbb390dc5ac34132c37918514b5">deadCache</a>.<a class="code" href="class_dead_object_pool.html#a305566ec5dba8c4e41f940933589db79">empty</a>();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="class_large_segment_set.html#a5e3a6cfdc23172c833c8bbf2227afa66">requests</a> = 0;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="class_large_segment_set.html#a6e70daef4cd5141ef6fd0c7af65f72e0">largestObject</a> = 0;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="class_large_segment_set.html#abe5f58ce25f514baf594af822ab29a3a">smallestObject</a> = 999999999;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;}</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a7c1385f115ca05b55e03dc9468e08f39"> 1046</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a7c1385f115ca05b55e03dc9468e08f39">MemorySegmentSet::completeSweepOperation</a>()</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">/* Function:  Handle all segment set post sweep activities.                   */</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;{</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;}</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a8d543da5d1ad0f6dbf606c2f5c398951"> 1054</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_normal_segment_set.html#a8d543da5d1ad0f6dbf606c2f5c398951">NormalSegmentSet::completeSweepOperation</a>()</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">/* Function:  Handle all segment set post sweep activities.                   */</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;{</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">/* Now we can optimize the look-aside entries for the small */</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="comment">/* dead chains.  By checking to see which chains have blocks in */</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="comment">/* them, we can potentially skip a lot of check/searching on an */</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">/* allocation request. */</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="_memory_segment_8hpp.html#a9fcdf92cdd1489267738b6cd14880a19">FirstDeadPool</a>; i &lt; <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>; i++)</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].isEmptySingle())</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="comment">/* point this back at itself */</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            <a class="code" href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">lastUsedSubpool</a>[i] = i;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="comment">/* default to the &quot;skip to the end&quot; location */</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <span class="keywordtype">int</span> usePool = <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordtype">int</span> j;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="comment">/* scan all of the higher pools looking for the first hit */</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">for</span> (j = i + 1; j &lt; <a class="code" href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a>; j++)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">subpools</a>[i].isEmptySingle())</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                {</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    usePool = j;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            <span class="comment">/* this will now be guaranteed to go to the correct */</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="comment">/* location on each request. */</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            <a class="code" href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">lastUsedSubpool</a>[i] = usePool;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;}</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#af536ff08e1058b27d14d8fb4318211f1"> 1093</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#af536ff08e1058b27d14d8fb4318211f1">LargeSegmentSet::completeSweepOperation</a>()</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">/* Function:  Handle all segment set post sweep activities.                   */</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="preprocessor">#ifdef VERBOSE_GC</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Large segment sweep complete.  Largest block is %d, smallest block is %d\n&quot;</span>, <a class="code" href="class_large_segment_set.html#a6e70daef4cd5141ef6fd0c7af65f72e0">largestObject</a>, <a class="code" href="class_large_segment_set.html#abe5f58ce25f514baf594af822ab29a3a">smallestObject</a>);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160; </div>
<div class="line"><a name="l01103"></a><span class="lineno"><a class="line" href="_memory_segment_8cpp.html#aec62b2e84adb188bf3eacb70ca54d974"> 1103</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="_memory_segment_8cpp.html#aec62b2e84adb188bf3eacb70ca54d974">objectIsLive</a>(<span class="keywordtype">char</span> *obj, <span class="keywordtype">size_t</span> mark) {<span class="keywordflow">return</span> ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)obj)-&gt;isObjectLive(mark); }</div>
<div class="line"><a name="l01104"></a><span class="lineno"><a class="line" href="_memory_segment_8cpp.html#a7df9091edeb14c7634b59d608c9df708"> 1104</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="_memory_segment_8cpp.html#a7df9091edeb14c7634b59d608c9df708">objectIsNotLive</a>(<span class="keywordtype">char</span> *obj, <span class="keywordtype">size_t</span> mark) {<span class="keywordflow">return</span> ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)obj)-&gt;isObjectDead(mark); }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a4e6465f0009cd59107df1bee01627c4b"> 1106</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a4e6465f0009cd59107df1bee01627c4b">MemorySegmentSet::sweep</a>()</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">/* This routine does a sweep of all segments devoted to &quot;normal&quot; size storage */</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">/* allocations.                                                               */</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;{</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *sweepSegment;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keywordtype">char</span>  *objectPtr, *endPtr, *nextObjectPtr;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordtype">size_t</span> deadLength;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="keywordtype">size_t</span> bytes;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordtype">size_t</span> mark = <a class="code" href="_rexx_memory_8cpp.html#a717cb8a2480b5e878894c63fc86b585f">memoryObject</a>.<a class="code" href="class_rexx_memory.html#a7ebb2420f97deb2aedb9ebee487e9ff2">markWord</a>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">/* do the sweep preparation (this differs for particular segment */</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="comment">/* set implemenation) */</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <a class="code" href="class_memory_segment_set.html#aa2caa0bde362ae2ff82b82f33bd536e7">prepareForSweep</a>();</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">/* go through the segments in order, until we&#39;ve swept the */</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">/* entire set */</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    sweepSegment = <a class="code" href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">first</a>();</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">while</span> (sweepSegment != NULL)</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">/* clear our live objects counter    */</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        sweepSegment-&gt;<a class="code" href="class_memory_segment_header.html#aa6555c2a4239d9911f4f8a177a4c2c8b">liveObjects</a> = 0;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">/* for all objects in segment */</span></div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordflow">for</span> (objectPtr = sweepSegment-&gt;<a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>(), endPtr = sweepSegment-&gt;<a class="code" href="class_memory_segment.html#a972ff8fbdd4236a9c9ea40784a0945f2">end</a>(); objectPtr &lt; endPtr; )</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            <span class="comment">/* this a live object?               */</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_memory_segment_8cpp.html#aec62b2e84adb188bf3eacb70ca54d974">objectIsLive</a>(objectPtr, mark))</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                <span class="comment">/* Get size of object for stats and  */</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                bytes = ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)objectPtr)-&gt;getObjectSize();</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                <span class="comment">/* do any reference checking         */</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <a class="code" href="class_memory_segment_set.html#af5b8842f68f567a91ce7af98d7a6f908">validateObject</a>(bytes);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                <span class="comment">/* update our tracking counters */</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                <a class="code" href="class_memory_segment_set.html#a3d3811d09e36ae1fe1060a585534ffea">liveObjectBytes</a> += bytes;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                <span class="comment">/* point to next object in segment.  */</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                objectPtr += bytes;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="comment">/* bump the live object counter      */</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                sweepSegment-&gt;<a class="code" href="class_memory_segment_header.html#aa6555c2a4239d9911f4f8a177a4c2c8b">liveObjects</a>++;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;            }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                <span class="comment">/* get the object&#39;s size */</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                deadLength = ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)objectPtr)-&gt;getObjectSize();</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                <span class="comment">/* do any reference checking         */</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                <a class="code" href="class_memory_segment_set.html#af5b8842f68f567a91ce7af98d7a6f908">validateObject</a>(deadLength);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                <span class="keywordflow">for</span> (nextObjectPtr = objectPtr + deadLength;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                    (nextObjectPtr &lt; endPtr) &amp;&amp; <a class="code" href="_memory_segment_8cpp.html#a7df9091edeb14c7634b59d608c9df708">objectIsNotLive</a>(nextObjectPtr, mark);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                    nextObjectPtr += bytes)</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                    <span class="comment">/* get the object size */</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                    bytes = ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)nextObjectPtr)-&gt;getObjectSize();</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    <span class="comment">/* do any reference checking         */</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                    <a class="code" href="class_memory_segment_set.html#af5b8842f68f567a91ce7af98d7a6f908">validateObject</a>(bytes);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                    <span class="comment">/* add in the size of this dead body */</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    deadLength += bytes;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                <span class="comment">/* add this to the dead counters     */</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                <a class="code" href="class_memory_segment_set.html#a7261a480da3ecae054b3cd1be0b30ead">deadObjectBytes</a> += deadLength;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                <span class="comment">/* now add to the dead chain */</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">addDeadObject</a>((<span class="keywordtype">char</span> *)objectPtr, deadLength);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                <span class="comment">/* update object Pointers.           */</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                objectPtr += deadLength;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;        }</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="comment">/* go to the next segment in the pool*/</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        sweepSegment = <a class="code" href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">next</a>(sweepSegment);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="comment">/* now do any of the sweep post-processing. */</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <a class="code" href="class_memory_segment_set.html#a7c1385f115ca05b55e03dc9468e08f39">completeSweepOperation</a>();</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#aa2ded42b44ea5780673a0585f62629df"> 1181</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#aa2ded42b44ea5780673a0585f62629df">MemorySegmentSet::collectEmptySegments</a>()</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">/* Function:  Scan a segment set after a sweep operation, collecting          */</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">/* any empty segments.  This is a nop for the base MemorySegmentSet class.    */</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;{</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;}</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160; </div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a5dd45c0ad87274387d0847b7d38bc3d5"> 1190</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_memory_segment_set.html#a5dd45c0ad87274387d0847b7d38bc3d5">MemorySegmentSet::splitDeadObject</a>(</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="class_dead_object.html">DeadObject</a> *<span class="keywordtype">object</span>,                <span class="comment">/* the object we&#39;re splitting */</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="keywordtype">size_t</span> allocationLength,           <span class="comment">/* the request length, already rounded to an appropriate boundary */</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordtype">size_t</span> splitMinimum)               <span class="comment">/* the minimum size we&#39;re willing to split */</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">/* Function:  Process a dead object and potentially split the object into     */</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">/* an allocated object and a second dead object that will be added back into  */</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">/* the appropriate pool of dead objects.                                      */</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;{</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordtype">size_t</span> deadLength = <span class="keywordtype">object</span>-&gt;<a class="code" href="class_rexx_internal_object.html#a035eb8bf67ca1b43d4238e806a0db0a0">getObjectSize</a>() - allocationLength;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="comment">/* we need to keep all of these sizes as ObjectGrain multiples, */</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">/* so round it down...the allocation will get all of the extra. */</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">/* deadLength = rounddown(deadLength, ObjectGrain);             */</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">/* remainder too small or this is a very large request */</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="comment">/* is the remainder two small to reuse? */</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">if</span> (deadLength &lt; splitMinimum)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="comment">/* over allocate this object */</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        allocationLength += deadLength;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">/* Yes, so pull new object out of the front of the dead */</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="comment">/* object, adjust the size of the Dead object.  We want */</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="comment">/* to use the front rather than the back so that if we */</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="comment">/* hit the need to split a segment because of low memory */</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <span class="comment">/* conditions, we increase the probability that we&#39;ll be */</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="comment">/* able to use the end of the segment. */</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <a class="code" href="class_dead_object.html">DeadObject</a> *largeObject = (<a class="code" href="class_dead_object.html">DeadObject</a> *)(((<span class="keywordtype">char</span> *)<span class="keywordtype">object</span>) + allocationLength);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <span class="comment">/* and reinsert into the the dead object pool */</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">addDeadObject</a>((<span class="keywordtype">char</span> *)largeObject, deadLength);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="comment">/* Adjust the size of this object to the requested allocation length */</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)<span class="keywordtype">object</span>)-&gt;setObjectSize(allocationLength);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">return</span>(<a class="code" href="class_rexx_object.html">RexxObject</a> *)object;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a8374d91f07d84aca1e810e026489a6dc"> 1230</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_normal_segment_set.html#a8374d91f07d84aca1e810e026489a6dc">NormalSegmentSet::findLargeDeadObject</a>(</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordtype">size_t</span> allocationLength)           <span class="comment">/* the request length, already rounded to an appropriate boundary */</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">/* Function:  Search the segment set for a block of the requested length.     */</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">/* If a block is found, the block will be subdivided if necessary, with the   */</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">/* remainder portion placed back on the proper chain.                         */</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;{</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">/* Go through the LARGEDEAD object looking for the 1st */</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">/* one we can use either our object is too big for all the */</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">/* small chains, or the small chains are depleted.... */</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <a class="code" href="class_dead_object.html">DeadObject</a> *largeObject = <a class="code" href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">largeDead</a>.<a class="code" href="class_dead_object_pool.html#ad9bfe30ddf396486fa47c7e90f383d6b">findFit</a>(allocationLength);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keywordflow">if</span> (largeObject != NULL)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    {         <span class="comment">/* did we find an object?            */</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        <span class="comment">/* potentially split this object into a smaller unit so we */</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="comment">/* can reuse the remainder. */</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_memory_segment_set.html#a5dd45c0ad87274387d0847b7d38bc3d5">splitDeadObject</a>(largeObject, allocationLength, <a class="code" href="_rexx_memory_8hpp.html#aaa88a73c097a27a32d272bbe9ed169ad">MinimumObjectSize</a>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;}</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160; </div>
<div class="line"><a name="l01252"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865"> 1252</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865">NormalSegmentSet::findObject</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">/* Function:  Find a dead object in the caches for the NormalSegmentSet.      */</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;{</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="comment">/* this is just a non-inline version of the allocation routine */</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">/* routine to be used during low memory situations. */</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_normal_segment_set.html#af8ed711532e1ee74d72128ef69532b83">allocateObject</a>(allocationLength);</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;}</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="class_normal_segment_set.html#a77df9525fcdbdfb8d9295d53b008afa6"> 1263</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_normal_segment_set.html#a77df9525fcdbdfb8d9295d53b008afa6">NormalSegmentSet::handleAllocationFailure</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">/* Function:  Allocate an object from the normal object segment pool.         */</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;{</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="comment">/* Step 2, force a GC */</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#a086abfcb645a1aa742913e359b070282">collect</a>();</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="comment">/* now that we have good GC data, decide if we need to adjust */</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">/* the heap size. */</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <a class="code" href="class_memory_segment_set.html#a11b567e97ec08847b5f4c4cd01bceafc">adjustMemorySize</a>();</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">/* Step 3, see if can allocate now */</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <a class="code" href="class_rexx_object.html">RexxObject</a> *newObject = <a class="code" href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="comment">/* still no luck?                    */</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">/* it is possible that the adjustment routines did not add */</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="comment">/* anything because, yet we were unable to allocate a block */</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="comment">/* because we&#39;re highly fragmented.  Try adding a new segment */</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="comment">/* now, before going to the extreme methods. */</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <a class="code" href="class_memory_segment_set.html#a7925bd1039f535cadff00ad2a5b9f7d2">addSegments</a>(<a class="code" href="_memory_segment_8hpp.html#ad342935bb33c8d33312ad45982c79ded">SegmentSize</a>);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="comment">/* see if can allocate now */</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        newObject = <a class="code" href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="comment">/* still no luck?                    */</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="comment">/* We might be able to steal something from the */</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="comment">/* large allocations.  This will also steal the recovery */</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            <span class="comment">/* segment as a last ditch effort */</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#af8422ebe37c1a4a26348623b28c3fcc8">scavengeSegmentSets</a>(<span class="keyword">this</span>, allocationLength);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            <span class="comment">/* see if can allocate now */</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            newObject = <a class="code" href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="comment">/* still no luck?                    */</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                <span class="comment">/* absolute last chance to fix this.  We allocated a */</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                <span class="comment">/* recovery segment at start up and have been hiding this */</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                <span class="comment">/* in our back pocket.  It is now time to bring this into */</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                <span class="comment">/* play, because we&#39;re running on fumes! */</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="class_normal_segment_set.html#a46247417b1f4b4fece9559c00c3328ef">recoverSegment</a> != NULL)</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                {</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(<a class="code" href="class_normal_segment_set.html#a46247417b1f4b4fece9559c00c3328ef">recoverSegment</a>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                    <a class="code" href="class_normal_segment_set.html#a46247417b1f4b4fece9559c00c3328ef">recoverSegment</a> = NULL;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                    <span class="comment">/* And try to find it once more */</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                    newObject = <a class="code" href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                    <span class="comment">/* can&#39;t allocate, report resource error. */</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                    <a class="code" href="_activity_manager_8hpp.html#a4b24a98df9a8a5f6778c759ecf5d21b0">reportException</a>(<a class="code" href="_rexx_error_codes_8h.html#a05e10e5ca821e6c0ee43f61a1007b468">Error_System_resources</a>);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            }</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        }</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">return</span> newObject;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;}</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a0d243792d8db3554fce0b0450c220d53"> 1320</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_large_segment_set.html#a0d243792d8db3554fce0b0450c220d53">LargeSegmentSet::findObject</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">/* Function:  Locate an object is the dead object cache maintained for large  */</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">/* object allocations.                                                        */</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;{</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="comment">/* this is just a space-saving non-inline version of allocateObject */</span></div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_large_segment_set.html#a3e3f8c730ca5b018b0c92ba6f9c7db8a">allocateObject</a>(allocationLength);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;}</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#a8f4aa2625c44f9ee2da78303cdc31e8c"> 1331</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_large_segment_set.html#a8f4aa2625c44f9ee2da78303cdc31e8c">LargeSegmentSet::handleAllocationFailure</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">/* Function:  Allocate a large block of memory.  This will manage allocation  */</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="comment">/* of larger memory requests.  This will search our large block allocation    */</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="comment">/* chains, and if a block is not found, will decide whether to immediately    */</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="comment">/* allocate additional memory for large allocations or force a garbage        */</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">/* collection cycle.  As a last gasp effort, we&#39;ll also try to &quot;borrow&quot; a     */</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">/* block of memory from the pool reserved for smaller allocations.            */</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;{</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="comment">/* Step 2, decide to expand the heap or GC, or both */</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="class_large_segment_set.html#ac4f4904fa169f20fdffd54222f938ba5">expandOrCollect</a>(allocationLength);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="comment">/* Step 3, see if can allocate now */</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <a class="code" href="class_rexx_object.html">RexxObject</a> *newObject = <a class="code" href="class_large_segment_set.html#a0d243792d8db3554fce0b0450c220d53">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    {    <span class="comment">/* still no luck?                    */</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="comment">/* Step 4, force a heap expansion, if we can */</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <a class="code" href="class_large_segment_set.html#ace7f34cf0d63489a930972159d52a3a6">expandSegmentSet</a>(allocationLength);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="comment">/* merge the expanded segments into our current set. */</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <span class="comment">/* This could potentially prolong the interval between */</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="comment">/* collection cycles. */</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <a class="code" href="class_memory_segment_set.html#a6319216bcf0e0f90cc1701b152d3416d">mergeSegments</a>(allocationLength);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="comment">/* Step 5, see if can allocate now */</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        newObject = <a class="code" href="class_large_segment_set.html#a0d243792d8db3554fce0b0450c220d53">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        <span class="comment">/* still no luck?                    */</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <span class="comment">/* We&#39;ll take one last chance.  We don&#39;t really like */</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            <span class="comment">/* to do this, but we might be able to steal a block */</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <span class="comment">/* off of the normal allocation chain. */</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#af8422ebe37c1a4a26348623b28c3fcc8">scavengeSegmentSets</a>(<span class="keyword">this</span>, allocationLength);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            <span class="comment">/* Last chance, see if can allocate now */</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            newObject = <a class="code" href="class_large_segment_set.html#a0d243792d8db3554fce0b0450c220d53">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            {<span class="comment">/* still no luck?                    */</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                <span class="comment">/* can&#39;t allocate, report resource error. */</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                <a class="code" href="_activity_manager_8hpp.html#a4b24a98df9a8a5f6778c759ecf5d21b0">reportException</a>(<a class="code" href="_rexx_error_codes_8h.html#a05e10e5ca821e6c0ee43f61a1007b468">Error_System_resources</a>);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="comment">/* if we got a real object, count this.... */</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">if</span> (newObject != <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <a class="code" href="class_large_segment_set.html#a5e3a6cfdc23172c833c8bbf2227afa66">requests</a>++;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">/* return our allocated object       */</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">return</span> newObject;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;}</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"><a class="line" href="class_old_space_segment_set.html#ab93152b1a44fadb231869325570e236f"> 1381</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_old_space_segment_set.html#ab93152b1a44fadb231869325570e236f">OldSpaceSegmentSet::findObject</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">/* Function:  Locate an object is the dead object cache maintained for large  */</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">/* object allocations.                                                        */</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;{</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="comment">/* go through the LARGEDEAD object looking for the 1st one we can */</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="comment">/* use either our object is too big for all the small chains, or */</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">/* the small chain are depleted.... */</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <a class="code" href="class_dead_object.html">DeadObject</a> *largeObject = <a class="code" href="class_old_space_segment_set.html#abc73af5db4e6fe3ef7afe56cbd752660">deadCache</a>.<a class="code" href="class_dead_object_pool.html#ad9bfe30ddf396486fa47c7e90f383d6b">findFit</a>(allocationLength);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">/* did we find an object?            */</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span> (largeObject != NULL)</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        <span class="comment">/* split and prepare this object for use */</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_memory_segment_set.html#a5dd45c0ad87274387d0847b7d38bc3d5">splitDeadObject</a>(largeObject, allocationLength, <a class="code" href="_rexx_memory_8hpp.html#a8f985d2dcd4c6b46e6e5f66538a0dbad">LargeAllocationUnit</a>);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>;                    <span class="comment">/* we couldn&#39;t get this              */</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;}</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"><a class="line" href="class_old_space_segment_set.html#a56a063e3219e4ae6a53f354adaeddcf0"> 1401</a></span>&#160;<a class="code" href="class_rexx_object.html">RexxObject</a> *<a class="code" href="class_old_space_segment_set.html#a56a063e3219e4ae6a53f354adaeddcf0">OldSpaceSegmentSet::allocateObject</a>(<span class="keywordtype">size_t</span> requestLength)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">/* Function:  Allocate an object from the old space.  This is a very simple   */</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">/* management strategy, with no heroic efforts made to locate memory.  Since  */</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="comment">/* objects here can only come from the OldSpace area, there is no garbage     */</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="comment">/* collection forced for failures.                                            */</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;{</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">/* round this allocation up to the appropriate large boundary */</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordtype">size_t</span> allocationLength = <a class="code" href="_rexx_memory_8hpp.html#a8fce8e74e9631f3ff5cc41af4fbde4ff">roundLargeObjectAllocation</a>(requestLength);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="comment">/* Step 1, try to find an object in the current heap.  We don&#39;t */</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="comment">/* try to round the object size up at all.  This will take place */</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="comment">/* once we&#39;ve found a fit.  The allocations will be rounded up to */</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">/* the next appropriate boundary. */</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="class_rexx_object.html">RexxObject</a> *newObject = <a class="code" href="class_old_space_segment_set.html#ab93152b1a44fadb231869325570e236f">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="comment">/* can&#39;t allocate one?               */</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (newObject == <a class="code" href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a>)</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="comment">/* add space to this and try again */</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <a class="code" href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">newSegment</a>(allocationLength, allocationLength);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="comment">/* Step 3, see if can allocate now */</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        newObject = <a class="code" href="class_old_space_segment_set.html#ab93152b1a44fadb231869325570e236f">findObject</a>(allocationLength);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="comment">/* return our allocated object       */</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">return</span> newObject;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#af79ceb6b8f31b9852445a6a07f51f605"> 1429</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#af79ceb6b8f31b9852445a6a07f51f605">MemorySegmentSet::largestActiveSegment</a>()</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="comment">/* Function:  Find the largest segment in the segment set.                    */</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;{</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *largest = &amp;<a class="code" href="class_memory_segment_set.html#a124455ab929d1b2eb35e7a1b7f19e743">anchor</a>;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">for</span> (segment = <a class="code" href="class_memory_segment_set.html#a124455ab929d1b2eb35e7a1b7f19e743">anchor</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>; segment-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>(); segment = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>)</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &gt; largest-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>())</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            largest = segment;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    }</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">/* we return this unconditionally, as our anchor segment will */</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="comment">/* report a size of zero. */</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">return</span> largest;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;}</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a6abde102ece644a1f399c289e67dff26"> 1451</a></span>&#160;<a class="code" href="class_memory_segment.html">MemorySegment</a> *<a class="code" href="class_memory_segment_set.html#a6abde102ece644a1f399c289e67dff26">MemorySegmentSet::largestEmptySegment</a>()</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="comment">/* Function:  Find the largest empty segment in the segment set.              */</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;{</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *largest = &amp;<a class="code" href="class_memory_segment_set.html#a5a8aec10366589bc791aada94fe0d181">emptySegments</a>;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">for</span> (segment = <a class="code" href="class_memory_segment_set.html#a5a8aec10366589bc791aada94fe0d181">emptySegments</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>; segment-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>(); segment = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &gt; largest-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>())</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            largest = segment;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">/* we return this unconditionally, as our anchor segment will */</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="comment">/* report a size of zero. */</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <span class="keywordflow">return</span> largest;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;}</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#ac4f4904fa169f20fdffd54222f938ba5"> 1473</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#ac4f4904fa169f20fdffd54222f938ba5">LargeSegmentSet::expandOrCollect</a>(</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">/* Function:  Handle the decision process for a failed large block allocation.*/</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="comment">/* This function will decide whether to force a garbage collection, or add    */</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="comment">/* additional segments to the heap.  The cheaper alternative is to avoid      */</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">/* forcing the mark and sweep operations, so we see if we can predict if a    */</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">/* garbage collection is likely to fail to find a block large enough.         */</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;{</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <span class="comment">/* first check our set of empty segments.  If we have an empty */</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">/* in our list big enough for this, we&#39;ll just reactivate it, */</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="comment">/* and go on.  We don&#39;t need to (and shouldn&#39;t) force a garbage */</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="comment">/* collection yet. */</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *largestEmpty = <a class="code" href="class_memory_segment_set.html#a6abde102ece644a1f399c289e67dff26">largestEmptySegment</a>();</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">if</span> (largestEmpty-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &gt; allocationLength)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        <span class="comment">/* just move this over, and get out of here...we should be */</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="comment">/* able to satisfy this request now. */</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment = <a class="code" href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">findEmptySegment</a>(allocationLength);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <a class="code" href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">addSegment</a>(segment);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    }</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *largestActive = <a class="code" href="class_memory_segment_set.html#af79ceb6b8f31b9852445a6a07f51f605">largestActiveSegment</a>();</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="comment">/* if our largest segment can&#39;t hold this block, then this is a */</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    <span class="comment">/* certain failure.  It is time to add more segments for large */</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">/* allocations. */</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keywordflow">if</span> (largestActive-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &lt; allocationLength)</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <a class="code" href="class_large_segment_set.html#ace7f34cf0d63489a930972159d52a3a6">expandSegmentSet</a>(allocationLength);</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="comment">/* we can get into a situation where we need to expand */</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="comment">/* frequently.  If we&#39;ve reached that point, just add */</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="comment">/* additional memorhy. */</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_large_segment_set.html#a5e3a6cfdc23172c833c8bbf2227afa66">requests</a> &lt;= <a class="code" href="_memory_segment_8hpp.html#a84f6091fd4787ca29c546e5720c454b6">MemoryThrashingThreshold</a>)</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <a class="code" href="class_large_segment_set.html#ace7f34cf0d63489a930972159d52a3a6">expandSegmentSet</a>(allocationLength);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="comment">/* we only do the expansion once per cycle for this.  Bump */</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        <span class="comment">/* the requests count up so we don&#39;t keep expanding without */</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="comment">/* a collection. */</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <a class="code" href="class_large_segment_set.html#a5e3a6cfdc23172c833c8bbf2227afa66">requests</a> = <a class="code" href="_memory_segment_8hpp.html#a84f6091fd4787ca29c546e5720c454b6">MemoryThrashingThreshold</a> + 1;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="comment">/* make sure all of our empty segments are included.  This */</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="comment">/* will allow us to merge these into larger blocks. */</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <a class="code" href="class_memory_segment_set.html#a08b11e8b7a7209dc327040e842ad40ed">activateEmptySegments</a>();</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="comment">/* go ahead and try to reclaim everything.  We may still */</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="comment">/* end up expanding after this is done. */</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#a086abfcb645a1aa742913e359b070282">collect</a>();</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="comment">/* see if we can merge segments together to create a block large enough to satisfy this request. */</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <a class="code" href="class_memory_segment_set.html#a6319216bcf0e0f90cc1701b152d3416d">mergeSegments</a>(allocationLength);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;}</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a6319216bcf0e0f90cc1701b152d3416d"> 1533</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a6319216bcf0e0f90cc1701b152d3416d">MemorySegmentSet::mergeSegments</a>(<span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">/* Function:  Attempt to merge the set of large segments to create a dead     */</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">/* block of at least the requested size.  This process can only be done       */</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">/* immediately after a complete GC cycle has been performed, as we need to    */</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">/* have accurate information about the live and dead blocks within the        */</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">/* segments.                                                                  */</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment">/* We&#39;ll attempt the merger in multiple passes to see if we can create a      */</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">/* block large enough.  If we already have a block of at least this size on   */</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">/* the chains, then we&#39;ll do nothing.                                         */</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">/* For the first pass, we&#39;ll combine adjacent empty segments to create a      */</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">/* larger block.  If the first pass fails, then we&#39;ll try to find adjacent    */</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">/* segments with trailing and leading deadblocks we can combine into a larger */</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">/* unit (possibly including intervening empty segments).                      */</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;{</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="comment">/* check our largest block.  If we can allocate something of */</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">/* this length, we don&#39;t combine empties now.  Deferring this */</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">/* makes it easier for use to give segments back. */</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *largestEmpty = <a class="code" href="class_memory_segment_set.html#af79ceb6b8f31b9852445a6a07f51f605">largestActiveSegment</a>();</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordflow">if</span> (largestEmpty-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &gt; allocationLength)</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="comment">/* the segments are sorted in ascending order, so we can easily */</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="comment">/* find the adjacent segments. */</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="comment">/* scan the entire list */</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">for</span> (segment = <a class="code" href="class_memory_segment_set.html#a124455ab929d1b2eb35e7a1b7f19e743">anchor</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>; segment-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>(); segment = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#a600233405db51678164f8553bb73d938">isEmpty</a>())</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        {</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            <a class="code" href="class_memory_segment.html">MemorySegment</a> *nextSeg = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            <span class="comment">/* loop until we we&#39;ve collapsed all of the adjacent */</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            <span class="comment">/* empty segments */</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            <span class="keywordflow">for</span> (;segment-&gt;<a class="code" href="class_memory_segment.html#aae8cce0d3ee0f3385c64722a1d50c283">isAdjacentTo</a>(nextSeg) &amp;&amp; nextSeg-&gt;<a class="code" href="class_memory_segment.html#a600233405db51678164f8553bb73d938">isEmpty</a>(); nextSeg = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>)</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;            {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Combining two empty segments\n&quot;</span>);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                <span class="comment">/* combine these segments */</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                <a class="code" href="class_memory_segment_set.html#a784e71233b6851fb91f880192be6e9ad">combineEmptySegments</a>(segment, nextSeg);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        }</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    }</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160; </div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <span class="comment">/* Check our largest block again.  If combining the empty */</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="comment">/* segments created a new large block, we&#39;re finished.  If not, */</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">/* then we&#39;ve got a hard job ahead of us */</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    largestEmpty = <a class="code" href="class_memory_segment_set.html#af79ceb6b8f31b9852445a6a07f51f605">largestActiveSegment</a>();</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">if</span> (largestEmpty-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>() &gt; allocationLength)</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    {</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <span class="comment">/* scan the entire list again, looking for opportunities to */</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="comment">/* combine partially empty segments.  This could potentially */</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">/* create a contiguous block large enough for our purposes. */</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordflow">for</span> (segment = <a class="code" href="class_memory_segment_set.html#a124455ab929d1b2eb35e7a1b7f19e743">anchor</a>.<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>; segment-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>(); segment = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="comment">/* this segment is only a candidate for merging if it has a */</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="comment">/* dead object on the end (fairly common, since we allocate */</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="comment">/* from the front) */</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <a class="code" href="class_dead_object.html">DeadObject</a> *lastBlock = segment-&gt;<a class="code" href="class_memory_segment.html#a5e776095ff13cb958be9bbc88bd41506">lastDeadObject</a>();</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <a class="code" href="class_memory_segment.html">MemorySegment</a> *emptySegment = NULL;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <a class="code" href="class_memory_segment.html">MemorySegment</a> *tailSegment = NULL;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="keywordflow">if</span> (lastBlock != NULL)</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <span class="comment">/* we only do this if we can get a block of sufficient */</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            <span class="comment">/* size for the request we&#39;ve received.  So see how */</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;            <span class="comment">/* much we can reclaim first. */</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;            <span class="keywordtype">size_t</span> deadLength = lastBlock-&gt;<a class="code" href="class_dead_object.html#ae9b73f921df89439f3f56b3dacd1d2dd">getObjectSize</a>();</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="comment">/* now go to the next segment, but only continue if */</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            <span class="comment">/* they abutt */</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <a class="code" href="class_memory_segment.html">MemorySegment</a> *nextSeg = segment-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="keywordflow">if</span> (!segment-&gt;<a class="code" href="class_memory_segment.html#aae8cce0d3ee0f3385c64722a1d50c283">isAdjacentTo</a>(nextSeg) || !nextSeg-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>())</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            <span class="comment">/* we could have a single empty segment after us, as */</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="comment">/* we&#39;ve already merged multiples. */</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            <span class="keywordflow">if</span> (nextSeg-&gt;<a class="code" href="class_memory_segment.html#a600233405db51678164f8553bb73d938">isEmpty</a>())</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <span class="comment">/* add the size in and continue */</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                deadLength += nextSeg-&gt;<a class="code" href="class_memory_segment.html#a2c0cd2972305dc02299a93c1268503ad">realSize</a>();</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                emptySegment = nextSeg;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                nextSeg = nextSeg-&gt;<a class="code" href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">next</a>;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;            <span class="comment">/* we should now be looking at a potential merger */</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            <span class="comment">/* candidate. */</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            <span class="keywordflow">if</span> (segment-&gt;<a class="code" href="class_memory_segment.html#aae8cce0d3ee0f3385c64722a1d50c283">isAdjacentTo</a>(nextSeg) &amp;&amp; nextSeg-&gt;<a class="code" href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">isReal</a>())</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                <span class="comment">/* see if we have an empty block at the front of this */</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                <a class="code" href="class_dead_object.html">DeadObject</a> *firstBlock = nextSeg-&gt;<a class="code" href="class_memory_segment.html#a90170d3af7b0490dc608466b357589dc">firstDeadObject</a>();</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                <span class="keywordflow">if</span> (firstBlock != NULL)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                    deadLength += firstBlock-&gt;<a class="code" href="class_dead_object.html#ae9b73f921df89439f3f56b3dacd1d2dd">getObjectSize</a>() + <a class="code" href="_memory_segment_8hpp.html#a827d5656c218e9227654dd2c42e5fc12">MemorySegmentOverhead</a>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                    tailSegment = nextSeg;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            <span class="comment">/* start by removing the last block from the deadchain. */</span></div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            lastBlock-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <span class="comment">/* if there is an intervening empty segment, merge this */</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            <span class="comment">/* into this segment. */</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;            <span class="keywordflow">if</span> (emptySegment != NULL)</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            {</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                <span class="comment">/* remove all of the dead blocks from the chain */</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                emptySegment-&gt;<a class="code" href="class_memory_segment.html#add3c9cd5130b4cb0ebcb8dd4df610c0c">removeAll</a>();</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                <span class="comment">/* remove the segment, and combine with this one. */</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                <a class="code" href="class_memory_segment_set.html#ac9a05831e53c99a38ab61eadee6c6311">removeSegment</a>(emptySegment);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                segment-&gt;<a class="code" href="class_memory_segment.html#a57f879b5e8daeefb0131326ac797e5f3">combine</a>(emptySegment);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;            }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;            <span class="comment">/* we may be able to combine the front block  */</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            <span class="keywordflow">if</span> (tailSegment != NULL)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                <span class="comment">/* remove the first dead block from the chain */</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                tailSegment-&gt;<a class="code" href="class_memory_segment.html#a90170d3af7b0490dc608466b357589dc">firstDeadObject</a>()-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                <span class="comment">/* merge these two segments together. */</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                <a class="code" href="class_memory_segment_set.html#ac9a05831e53c99a38ab61eadee6c6311">removeSegment</a>(tailSegment);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                segment-&gt;<a class="code" href="class_memory_segment.html#a57f879b5e8daeefb0131326ac797e5f3">combine</a>(tailSegment);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Non-empty segments combined to create segment of %d bytes\n&quot;</span>, segment-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>());</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                <span class="comment">/* Now that this has been combined with one or more */</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                <span class="comment">/* segments, the merged segment may still be a */</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                <span class="comment">/* candidate for one more level of merge.  Step to the */</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                <span class="comment">/* previous one so we take a second look at this. */</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                segment = segment-&gt;<a class="code" href="class_memory_segment_header.html#a860b767f8d2a95b753a26cad678e5e3e">previous</a>;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;            }</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            <span class="comment">/* finally resize this block to the combined size. */</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            lastBlock-&gt;<a class="code" href="class_dead_object.html#a789634642e901ad59420ddea84d38285">setObjectSize</a>(deadLength);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            <span class="comment">/* add this back into the chain as appropriate. */</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">addDeadObject</a>(lastBlock);</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    }</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;}</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#a784e71233b6851fb91f880192be6e9ad"> 1672</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#a784e71233b6851fb91f880192be6e9ad">MemorySegmentSet::combineEmptySegments</a>(</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *front,</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *back)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="comment">/* Function:  Merge two empty segments into a single segment and add the block*/</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">/* create to the dead object cache.                                           */</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;{</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <a class="code" href="class_dead_object.html">DeadObject</a> *frontObject = front-&gt;<a class="code" href="class_memory_segment.html#ad5d99e8d6a858c8fa483dfc798c29e05">firstObject</a>();</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <a class="code" href="class_dead_object.html">DeadObject</a> *backObject = back-&gt;<a class="code" href="class_memory_segment.html#ad5d99e8d6a858c8fa483dfc798c29e05">firstObject</a>();</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="comment">/* remove the dead space for these two objects from the cache */</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    frontObject-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    backObject-&gt;<a class="code" href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">remove</a>();</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">/* remove the back segment */</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <a class="code" href="class_memory_segment_set.html#ac9a05831e53c99a38ab61eadee6c6311">removeSegment</a>(back);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="comment">/* add the space to the front segment */</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    front-&gt;<a class="code" href="class_memory_segment.html#a57f879b5e8daeefb0131326ac797e5f3">combine</a>(back);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Two segments combined to create segment of %d bytes\n&quot;</span>, front-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>());</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="comment">/* and add the resulting dead object to the cache */</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="class_dead_object.html">DeadObject</a> *ptr = front-&gt;<a class="code" href="class_memory_segment.html#aac924598f86a8bfb94375e83784238a4">createDeadObject</a>();</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">addDeadObject</a>(ptr);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;}</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"><a class="line" href="class_large_segment_set.html#ace7f34cf0d63489a930972159d52a3a6"> 1700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_large_segment_set.html#ace7f34cf0d63489a930972159d52a3a6">LargeSegmentSet::expandSegmentSet</a>(</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordtype">size_t</span> allocationLength)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">/* Function:  Expand the size of the large allocation heap by adding an       */</span></div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">/* additional segment.  We&#39;ll employ three different strategies for adding    */</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">/* a segment to the heap.  For &quot;really, really big&quot; requests, we&#39;ll just      */</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">/* round to the a page boundary and allocate.                                 */</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="comment">/* For requests larger than a single segment, but not large enough  to qualify*/</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">/* &quot;really, really big&quot;, we&#39;ll round up to the next &quot;convenient segment&quot; to   */</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">/* add some additional usable storage.  The convenience factor will           */</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">/* over allocate by at least SEGMENT/2 bytes.  If the overallocation request  */</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="comment">/* fails, then we&#39;ll just round up to the page boundary and try again.        */</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="comment">/*                                                                            */</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="comment">/* For the smaller allocations, we&#39;ll add this heap space in LARGESEGMENT     */</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="comment">/* increments so we can get more suballocations before needing to force       */</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="comment">/* another GC cycle.  If the attempt to allocate a LARGESEGMENT fails, we&#39;ll  */</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="comment">/* try again with just a single SEGMENT size allocation.                      */</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;{</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="comment">/* do we have a really big request? */</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keywordflow">if</span> (allocationLength &gt; <a class="code" href="_memory_segment_8hpp.html#ab16f6f4e9c8d51805cfb5dfa9c0662ab">LargeSegmentDeadSpace</a>)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="comment">/* we allocate this as the size we need.  No sense in */</span></div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="comment">/* trying to over allocate here, as we&#39;d like to free */</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="comment">/* this up as soon as we can. */</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Expanding large segment set by %d\n&quot;</span>, allocationLength);</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <a class="code" href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">newSegment</a>(allocationLength, allocationLength);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">/* for the smaller of the large blocks, we expand by a full */</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">/* LargeSegment so we can fit more allocations in a segment. */</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">/* If we can&#39;t get a full real on, then fall back to the */</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">/* smaller size segment. */</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (allocationLength &lt; <a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Expanding large segment set by %d\n&quot;</span>, <a class="code" href="_memory_segment_8hpp.html#ab16f6f4e9c8d51805cfb5dfa9c0662ab">LargeSegmentDeadSpace</a>);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <a class="code" href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">newSegment</a>(<a class="code" href="_memory_segment_8hpp.html#ab16f6f4e9c8d51805cfb5dfa9c0662ab">LargeSegmentDeadSpace</a>, <a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <span class="comment">/* we&#39;ve got a &quot;tweener&quot; block.  We&#39;ll round up to the next */</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">/* segment boundary to give a little extra.  If the extra is */</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">/* less than half a segment in size, add one more segment unit */</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">/* to the allocation to increase the probability we&#39;d be able */</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">/* to use the extra. */</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordtype">size_t</span> requestLength = <a class="code" href="_memory_segment_8hpp.html#a8f62aa3cd5c5a0ae1eff3951ea1fd671">roundSegmentBoundary</a>(allocationLength);</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="keywordflow">if</span> ((requestLength - allocationLength) &lt; <a class="code" href="_memory_segment_8hpp.html#afd9ced7d94e5cff9fc6053ca97f7a4f1">MinimumSegmentSize</a>)</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        {</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            requestLength += <a class="code" href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a>;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <a class="code" href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">memory</a>-&gt;<a class="code" href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">verboseMessage</a>(<span class="stringliteral">&quot;Expanding large segment set by %d\n&quot;</span>, requestLength);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <a class="code" href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">newSegment</a>(requestLength, allocationLength);</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;}</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"><a class="line" href="class_memory_segment_set.html#abab6a3bfe74ce7d2ff87a934f667b6ab"> 1756</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#abab6a3bfe74ce7d2ff87a934f667b6ab">MemorySegmentSet::gatherStats</a>(<a class="code" href="class_memory_stats.html">MemoryStats</a> *memStats, <a class="code" href="class_segment_stats.html">SegmentStats</a> *stats)</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">/* Function:  Accumulate memory statistics for a segment                      */</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;{</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    stats-&gt;<a class="code" href="class_segment_stats.html#a8568adaea65e4258ef4fb3e25c51ea4f">count</a> = <a class="code" href="class_memory_segment_set.html#a9e1c69fb1b32ca37d643bf839ae665b4">count</a>;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160; </div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *seg;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="keywordflow">for</span> (seg = <a class="code" href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">first</a>(); seg != NULL; seg = <a class="code" href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">next</a>(seg))</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        seg-&gt;<a class="code" href="class_memory_segment.html#a32b221f5b8192e3c8f6179e786b49f62">gatherObjectStats</a>(memStats, stats);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        stats-&gt;<a class="code" href="class_segment_stats.html#a593319ffb90cc8b3116dbfaf3f499bb6">largestSegment</a> = <a class="code" href="class_numerics.html#a70730b87332edd5c38015b93013e7afa">Numerics::maxVal</a>(stats-&gt;<a class="code" href="class_segment_stats.html#a593319ffb90cc8b3116dbfaf3f499bb6">largestSegment</a>, seg-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>());</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        stats-&gt;<a class="code" href="class_segment_stats.html#a01b51d8c43b4c967b3ed7c9c439cf470">smallestSegment</a> = <a class="code" href="class_numerics.html#a70730b87332edd5c38015b93013e7afa">Numerics::maxVal</a>(stats-&gt;<a class="code" href="class_segment_stats.html#a01b51d8c43b4c967b3ed7c9c439cf470">smallestSegment</a>, seg-&gt;<a class="code" href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">size</a>());</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    }</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;}</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"><a class="line" href="class_memory_segment.html#af64ed95595657c43475b549e2f825279"> 1773</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment.html#af64ed95595657c43475b549e2f825279">MemorySegment::markAllObjects</a>()</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;<span class="comment">/* Function:  Perform a marking operation on all objects in a segment         */</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;{</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordtype">char</span> *op, *ep;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">for</span> (op = <a class="code" href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">start</a>(), ep = <a class="code" href="class_memory_segment.html#a972ff8fbdd4236a9c9ea40784a0945f2">end</a>(); op &lt; ep; )</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="comment">/* mark behaviour live               */</span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <a class="code" href="_rexx_memory_8hpp.html#ad740c29e8223b639f6f3fcbb910ce21a">memory_mark_general</a>(((<a class="code" href="class_rexx_object.html">RexxObject</a> *)op)-&gt;behaviour);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="comment">/* Does this object have other Obj   */</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <span class="comment">/*refs?                              */</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="keywordflow">if</span> (((<a class="code" href="class_rexx_object.html">RexxObject</a> *)op)-&gt;hasReferences())</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        {</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            <span class="comment">/*  yes, Then lets mark them         */</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)op)-&gt;liveGeneral(<a class="code" href="_rexx_memory_8hpp.html#adf764cbdea00d65edcd07bb9953ad2b7a616602f628d1c90b4ef49d34ea01b820">RESTORINGIMAGE</a>);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        }</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        op += ((<a class="code" href="class_rexx_object.html">RexxObject</a> *)op)-&gt;<a class="code" href="class_rexx_internal_object.html#a035eb8bf67ca1b43d4238e806a0db0a0">getObjectSize</a>();   <span class="comment">/* move to next object               */</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;}</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"><a class="line" href="class_old_space_segment_set.html#afe2cb98ec19c68fd39a9914c7547ab57"> 1796</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_old_space_segment_set.html#afe2cb98ec19c68fd39a9914c7547ab57">OldSpaceSegmentSet::markOldSpaceObjects</a>()</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="comment">/* Function:  Perform a marking operation on all OldSpace objects             */</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="comment">/******************************************************************************/</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;{</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="comment">/* mark the restored image segment */</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <a class="code" href="class_memory_segment.html">MemorySegment</a> *segment;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">for</span> (segment = <a class="code" href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">first</a>(); segment != NULL; segment = <a class="code" href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">next</a>(segment))</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    {</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        segment-&gt;<a class="code" href="class_memory_segment.html#af64ed95595657c43475b549e2f825279">markAllObjects</a>();</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;}</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="preprocessor">#ifdef CHECKOREFS</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_memory_segment_set.html#af5b8842f68f567a91ce7af98d7a6f908">MemorySegmentSet::validateObject</a>(<span class="keywordtype">size_t</span> bytes)</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;{</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="comment">/* is object invalid size?           */</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="_rexx_memory_8hpp.html#a97aba57a927c426aa29219f56776c5f0">IsValidSize</a>(bytes)) {</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      <span class="comment">/* Yes, this is not good.  Exit      */</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      <span class="comment">/* Critical Section and report       */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="comment">/* unrecoverable error.              */</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      <a class="code" href="class_interpreter.html#a35ac2ba024b6581b6542ab04e2f2e1a3">Interpreter::logicError</a>(<span class="stringliteral">&quot;Bad object detected during Garbage Collection, unable to continue&quot;</span>);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;}</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="ttc" id="a_activity_manager_8hpp_html"><div class="ttname"><a href="_activity_manager_8hpp.html">ActivityManager.hpp</a></div></div>
<div class="ttc" id="a_activity_manager_8hpp_html_a4b24a98df9a8a5f6778c759ecf5d21b0"><div class="ttname"><a href="_activity_manager_8hpp.html#a4b24a98df9a8a5f6778c759ecf5d21b0">reportException</a></div><div class="ttdeci">void reportException(wholenumber_t error)</div><div class="ttdef"><b>Definition:</b> <a href="_activity_manager_8hpp_source.html#l00139">ActivityManager.hpp:139</a></div></div>
<div class="ttc" id="a_memory_segment_8cpp_html_a7df9091edeb14c7634b59d608c9df708"><div class="ttname"><a href="_memory_segment_8cpp.html#a7df9091edeb14c7634b59d608c9df708">objectIsNotLive</a></div><div class="ttdeci">bool objectIsNotLive(char *obj, size_t mark)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01104">MemorySegment.cpp:1104</a></div></div>
<div class="ttc" id="a_memory_segment_8cpp_html_aec62b2e84adb188bf3eacb70ca54d974"><div class="ttname"><a href="_memory_segment_8cpp.html#aec62b2e84adb188bf3eacb70ca54d974">objectIsLive</a></div><div class="ttdeci">bool objectIsLive(char *obj, size_t mark)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01103">MemorySegment.cpp:1103</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a0da52df813466fef9a09f525d0b48635"><div class="ttname"><a href="_memory_segment_8hpp.html#a0da52df813466fef9a09f525d0b48635">InitialNormalSegmentSpace</a></div><div class="ttdeci">#define InitialNormalSegmentSpace</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00079">MemorySegment.hpp:79</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a3fc78b01b8bc0b974411ad506a1e273d"><div class="ttname"><a href="_memory_segment_8hpp.html#a3fc78b01b8bc0b974411ad506a1e273d">LengthToDeadPool</a></div><div class="ttdeci">#define LengthToDeadPool(l)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00091">MemorySegment.hpp:91</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a5e6853df19804867912d8b244795cc5e"><div class="ttname"><a href="_memory_segment_8hpp.html#a5e6853df19804867912d8b244795cc5e">DeadPools</a></div><div class="ttdeci">#define DeadPools</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00106">MemorySegment.hpp:106</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a798be6ed29e2c4112f7602d317ac3b23"><div class="ttname"><a href="_memory_segment_8hpp.html#a798be6ed29e2c4112f7602d317ac3b23">RecoverSegmentSize</a></div><div class="ttdeci">#define RecoverSegmentSize</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00075">MemorySegment.hpp:75</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a81878194fdf60918882dea751c4a5ff9"><div class="ttname"><a href="_memory_segment_8hpp.html#a81878194fdf60918882dea751c4a5ff9">NormalMemoryExpansionThreshold</a></div><div class="ttdeci">#define NormalMemoryExpansionThreshold</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00109">MemorySegment.hpp:109</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a827d5656c218e9227654dd2c42e5fc12"><div class="ttname"><a href="_memory_segment_8hpp.html#a827d5656c218e9227654dd2c42e5fc12">MemorySegmentOverhead</a></div><div class="ttdeci">#define MemorySegmentOverhead</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00052">MemorySegment.hpp:52</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a84f6091fd4787ca29c546e5720c454b6"><div class="ttname"><a href="_memory_segment_8hpp.html#a84f6091fd4787ca29c546e5720c454b6">MemoryThrashingThreshold</a></div><div class="ttdeci">#define MemoryThrashingThreshold</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00087">MemorySegment.hpp:87</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a8f62aa3cd5c5a0ae1eff3951ea1fd671"><div class="ttname"><a href="_memory_segment_8hpp.html#a8f62aa3cd5c5a0ae1eff3951ea1fd671">roundSegmentBoundary</a></div><div class="ttdeci">size_t roundSegmentBoundary(size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00118">MemorySegment.hpp:118</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a9b53c99f99871162ef8ea943eae3879c"><div class="ttname"><a href="_memory_segment_8hpp.html#a9b53c99f99871162ef8ea943eae3879c">NormalMemoryContractionThreshold</a></div><div class="ttdeci">#define NormalMemoryContractionThreshold</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00111">MemorySegment.hpp:111</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_a9fcdf92cdd1489267738b6cd14880a19"><div class="ttname"><a href="_memory_segment_8hpp.html#a9fcdf92cdd1489267738b6cd14880a19">FirstDeadPool</a></div><div class="ttdeci">#define FirstDeadPool</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00099">MemorySegment.hpp:99</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_ab16f6f4e9c8d51805cfb5dfa9c0662ab"><div class="ttname"><a href="_memory_segment_8hpp.html#ab16f6f4e9c8d51805cfb5dfa9c0662ab">LargeSegmentDeadSpace</a></div><div class="ttdeci">#define LargeSegmentDeadSpace</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00077">MemorySegment.hpp:77</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_ab87287e5c507520d6ac780850041becd"><div class="ttname"><a href="_memory_segment_8hpp.html#ab87287e5c507520d6ac780850041becd">LargestSubpool</a></div><div class="ttdeci">#define LargestSubpool</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00101">MemorySegment.hpp:101</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_ac4533b24654421bb15ae9ff7b459b632"><div class="ttname"><a href="_memory_segment_8hpp.html#ac4533b24654421bb15ae9ff7b459b632">DeadPoolToLength</a></div><div class="ttdeci">#define DeadPoolToLength(d)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00094">MemorySegment.hpp:94</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_ad342935bb33c8d33312ad45982c79ded"><div class="ttname"><a href="_memory_segment_8hpp.html#ad342935bb33c8d33312ad45982c79ded">SegmentSize</a></div><div class="ttdeci">#define SegmentSize</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00062">MemorySegment.hpp:62</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_aec82a516be9adda0d1f0d9b05b480d49"><div class="ttname"><a href="_memory_segment_8hpp.html#aec82a516be9adda0d1f0d9b05b480d49">SegmentDeadSpace</a></div><div class="ttdeci">#define SegmentDeadSpace</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00073">MemorySegment.hpp:73</a></div></div>
<div class="ttc" id="a_memory_segment_8hpp_html_afd9ced7d94e5cff9fc6053ca97f7a4f1"><div class="ttname"><a href="_memory_segment_8hpp.html#afd9ced7d94e5cff9fc6053ca97f7a4f1">MinimumSegmentSize</a></div><div class="ttdeci">#define MinimumSegmentSize</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00067">MemorySegment.hpp:67</a></div></div>
<div class="ttc" id="a_rexx_core_8h_html"><div class="ttname"><a href="_rexx_core_8h.html">RexxCore.h</a></div></div>
<div class="ttc" id="a_rexx_core_8h_html_a181a36438ba4535dd7d22ab63239d1e1"><div class="ttname"><a href="_rexx_core_8h.html#a181a36438ba4535dd7d22ab63239d1e1">OREF_NULL</a></div><div class="ttdeci">#define OREF_NULL</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_core_8h_source.html#l00060">RexxCore.h:60</a></div></div>
<div class="ttc" id="a_rexx_error_codes_8h_html_a05e10e5ca821e6c0ee43f61a1007b468"><div class="ttname"><a href="_rexx_error_codes_8h.html#a05e10e5ca821e6c0ee43f61a1007b468">Error_System_resources</a></div><div class="ttdeci">#define Error_System_resources</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_error_codes_8h_source.html#l00067">RexxErrorCodes.h:67</a></div></div>
<div class="ttc" id="a_rexx_memory_8cpp_html_a717cb8a2480b5e878894c63fc86b585f"><div class="ttname"><a href="_rexx_memory_8cpp.html#a717cb8a2480b5e878894c63fc86b585f">memoryObject</a></div><div class="ttdeci">RexxMemory memoryObject</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8cpp_source.html#l00085">RexxMemory.cpp:85</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_a8f985d2dcd4c6b46e6e5f66538a0dbad"><div class="ttname"><a href="_rexx_memory_8hpp.html#a8f985d2dcd4c6b46e6e5f66538a0dbad">LargeAllocationUnit</a></div><div class="ttdeci">#define LargeAllocationUnit</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00076">RexxMemory.hpp:76</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_a8fce8e74e9631f3ff5cc41af4fbde4ff"><div class="ttname"><a href="_rexx_memory_8hpp.html#a8fce8e74e9631f3ff5cc41af4fbde4ff">roundLargeObjectAllocation</a></div><div class="ttdeci">size_t roundLargeObjectAllocation(size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00096">RexxMemory.hpp:96</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_a97aba57a927c426aa29219f56776c5f0"><div class="ttname"><a href="_rexx_memory_8hpp.html#a97aba57a927c426aa29219f56776c5f0">IsValidSize</a></div><div class="ttdeci">#define IsValidSize(s)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00093">RexxMemory.hpp:93</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_aaa88a73c097a27a32d272bbe9ed169ad"><div class="ttname"><a href="_rexx_memory_8hpp.html#aaa88a73c097a27a32d272bbe9ed169ad">MinimumObjectSize</a></div><div class="ttdeci">#define MinimumObjectSize</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00085">RexxMemory.hpp:85</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_abaf1a460f90100184a5761ff7fa344a9"><div class="ttname"><a href="_rexx_memory_8hpp.html#abaf1a460f90100184a5761ff7fa344a9">MaximumObjectSize</a></div><div class="ttdeci">#define MaximumObjectSize</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00086">RexxMemory.hpp:86</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_ad740c29e8223b639f6f3fcbb910ce21a"><div class="ttname"><a href="_rexx_memory_8hpp.html#ad740c29e8223b639f6f3fcbb910ce21a">memory_mark_general</a></div><div class="ttdeci">#define memory_mark_general(oref)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00446">RexxMemory.hpp:446</a></div></div>
<div class="ttc" id="a_rexx_memory_8hpp_html_adf764cbdea00d65edcd07bb9953ad2b7a616602f628d1c90b4ef49d34ea01b820"><div class="ttname"><a href="_rexx_memory_8hpp.html#adf764cbdea00d65edcd07bb9953ad2b7a616602f628d1c90b4ef49d34ea01b820">RESTORINGIMAGE</a></div><div class="ttdeci">@ RESTORINGIMAGE</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00116">RexxMemory.hpp:116</a></div></div>
<div class="ttc" id="aclass_dead_object_html"><div class="ttname"><a href="class_dead_object.html">DeadObject</a></div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00059">DeadObject.hpp:59</a></div></div>
<div class="ttc" id="aclass_dead_object_html_a26d7bb66fc3c946edadddf01c85be3fb"><div class="ttname"><a href="class_dead_object.html#a26d7bb66fc3c946edadddf01c85be3fb">DeadObject::remove</a></div><div class="ttdeci">void remove()</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00101">DeadObject.hpp:101</a></div></div>
<div class="ttc" id="aclass_dead_object_html_a789634642e901ad59420ddea84d38285"><div class="ttname"><a href="class_dead_object.html#a789634642e901ad59420ddea84d38285">DeadObject::setObjectSize</a></div><div class="ttdeci">void setObjectSize(size_t newSize)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00084">DeadObject.hpp:84</a></div></div>
<div class="ttc" id="aclass_dead_object_html_ae9b73f921df89439f3f56b3dacd1d2dd"><div class="ttname"><a href="class_dead_object.html#ae9b73f921df89439f3f56b3dacd1d2dd">DeadObject::getObjectSize</a></div><div class="ttdeci">size_t getObjectSize()</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00085">DeadObject.hpp:85</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a0e54863d918466ac6b65187a02a034d9"><div class="ttname"><a href="class_dead_object_pool.html#a0e54863d918466ac6b65187a02a034d9">DeadObjectPool::setID</a></div><div class="ttdeci">void setID(const char *poolID)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00154">DeadObject.hpp:154</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a2996357280429e455965f05231479ce4"><div class="ttname"><a href="class_dead_object_pool.html#a2996357280429e455965f05231479ce4">DeadObjectPool::findSmallestFit</a></div><div class="ttdeci">DeadObject * findSmallestFit(size_t minSize)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8cpp_source.html#l00112">DeadObject.cpp:112</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a305566ec5dba8c4e41f940933589db79"><div class="ttname"><a href="class_dead_object_pool.html#a305566ec5dba8c4e41f940933589db79">DeadObjectPool::empty</a></div><div class="ttdeci">void empty()</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00155">DeadObject.hpp:155</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a457703fb40e02ac8330dde5d359e3ffb"><div class="ttname"><a href="class_dead_object_pool.html#a457703fb40e02ac8330dde5d359e3ffb">DeadObjectPool::dumpMemoryProfile</a></div><div class="ttdeci">void dumpMemoryProfile(FILE *outfile)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8cpp_source.html#l00051">DeadObject.cpp:51</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a508d03b5240889c90370969df2b885d8"><div class="ttname"><a href="class_dead_object_pool.html#a508d03b5240889c90370969df2b885d8">DeadObjectPool::emptySingle</a></div><div class="ttdeci">void emptySingle()</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00157">DeadObject.hpp:157</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a8155c6ba4af04d8a7c055ef34a764005"><div class="ttname"><a href="class_dead_object_pool.html#a8155c6ba4af04d8a7c055ef34a764005">DeadObjectPool::addSortedBySize</a></div><div class="ttdeci">void addSortedBySize(DeadObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8cpp_source.html#l00148">DeadObject.cpp:148</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_a93b6edd6b4300f451734432734445fa5"><div class="ttname"><a href="class_dead_object_pool.html#a93b6edd6b4300f451734432734445fa5">DeadObjectPool::checkObjectOverlap</a></div><div class="ttdeci">void checkObjectOverlap(DeadObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8cpp_source.html#l00212">DeadObject.cpp:212</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_ab77431236ca8dd7daee695df8bbd14e2"><div class="ttname"><a href="class_dead_object_pool.html#ab77431236ca8dd7daee695df8bbd14e2">DeadObjectPool::add</a></div><div class="ttdeci">void add(DeadObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00161">DeadObject.hpp:161</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_acd4f081dc71cb164e4271ada01da5e73"><div class="ttname"><a href="class_dead_object_pool.html#acd4f081dc71cb164e4271ada01da5e73">DeadObjectPool::addSingle</a></div><div class="ttdeci">void addSingle(DeadObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00262">DeadObject.hpp:262</a></div></div>
<div class="ttc" id="aclass_dead_object_pool_html_ad9bfe30ddf396486fa47c7e90f383d6b"><div class="ttname"><a href="class_dead_object_pool.html#ad9bfe30ddf396486fa47c7e90f383d6b">DeadObjectPool::findFit</a></div><div class="ttdeci">DeadObject * findFit(size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="_dead_object_8hpp_source.html#l00193">DeadObject.hpp:193</a></div></div>
<div class="ttc" id="aclass_interpreter_html_a35ac2ba024b6581b6542ab04e2f2e1a3"><div class="ttname"><a href="class_interpreter.html#a35ac2ba024b6581b6542ab04e2f2e1a3">Interpreter::logicError</a></div><div class="ttdeci">static void logicError(const char *desc)</div><div class="ttdef"><b>Definition:</b> <a href="_interpreter_8cpp_source.html#l00556">Interpreter.cpp:556</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a084c3dbb390dc5ac34132c37918514b5"><div class="ttname"><a href="class_large_segment_set.html#a084c3dbb390dc5ac34132c37918514b5">LargeSegmentSet::deadCache</a></div><div class="ttdeci">DeadObjectPool deadCache</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00583">MemorySegment.hpp:583</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a0d243792d8db3554fce0b0450c220d53"><div class="ttname"><a href="class_large_segment_set.html#a0d243792d8db3554fce0b0450c220d53">LargeSegmentSet::findObject</a></div><div class="ttdeci">RexxObject * findObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01320">MemorySegment.cpp:1320</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a2f246f4ed8e500fbd4da3a01123ff635"><div class="ttname"><a href="class_large_segment_set.html#a2f246f4ed8e500fbd4da3a01123ff635">LargeSegmentSet::prepareForSweep</a></div><div class="ttdeci">virtual void prepareForSweep()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01030">MemorySegment.cpp:1030</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a3e3f8c730ca5b018b0c92ba6f9c7db8a"><div class="ttname"><a href="class_large_segment_set.html#a3e3f8c730ca5b018b0c92ba6f9c7db8a">LargeSegmentSet::allocateObject</a></div><div class="ttdeci">RexxObject * allocateObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00549">MemorySegment.hpp:549</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a4005ec9219573b25a608488f5a066654"><div class="ttname"><a href="class_large_segment_set.html#a4005ec9219573b25a608488f5a066654">LargeSegmentSet::dumpMemoryProfile</a></div><div class="ttdeci">virtual void dumpMemoryProfile(FILE *outfile)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00142">MemorySegment.cpp:142</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a5e3a6cfdc23172c833c8bbf2227afa66"><div class="ttname"><a href="class_large_segment_set.html#a5e3a6cfdc23172c833c8bbf2227afa66">LargeSegmentSet::requests</a></div><div class="ttdeci">size_t requests</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00584">MemorySegment.hpp:584</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a6589632e959b5f5a5df501d1ca8e54ff"><div class="ttname"><a href="class_large_segment_set.html#a6589632e959b5f5a5df501d1ca8e54ff">LargeSegmentSet::LargeSegmentSet</a></div><div class="ttdeci">LargeSegmentSet()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00544">MemorySegment.hpp:544</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a6e70daef4cd5141ef6fd0c7af65f72e0"><div class="ttname"><a href="class_large_segment_set.html#a6e70daef4cd5141ef6fd0c7af65f72e0">LargeSegmentSet::largestObject</a></div><div class="ttdeci">size_t largestObject</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00586">MemorySegment.hpp:586</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a777c56b0f705ad0f1f0471c433a25483"><div class="ttname"><a href="class_large_segment_set.html#a777c56b0f705ad0f1f0471c433a25483">LargeSegmentSet::donateObject</a></div><div class="ttdeci">virtual DeadObject * donateObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00543">MemorySegment.cpp:543</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a8f4aa2625c44f9ee2da78303cdc31e8c"><div class="ttname"><a href="class_large_segment_set.html#a8f4aa2625c44f9ee2da78303cdc31e8c">LargeSegmentSet::handleAllocationFailure</a></div><div class="ttdeci">RexxObject * handleAllocationFailure(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01331">MemorySegment.cpp:1331</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_a9e821586ca4c7943169432f0936a7145"><div class="ttname"><a href="class_large_segment_set.html#a9e821586ca4c7943169432f0936a7145">LargeSegmentSet::allocateSegment</a></div><div class="ttdeci">virtual MemorySegment * allocateSegment(size_t requestLength, size_t minimumLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00258">MemorySegment.cpp:258</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_abe5f58ce25f514baf594af822ab29a3a"><div class="ttname"><a href="class_large_segment_set.html#abe5f58ce25f514baf594af822ab29a3a">LargeSegmentSet::smallestObject</a></div><div class="ttdeci">size_t smallestObject</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00585">MemorySegment.hpp:585</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_ac4f4904fa169f20fdffd54222f938ba5"><div class="ttname"><a href="class_large_segment_set.html#ac4f4904fa169f20fdffd54222f938ba5">LargeSegmentSet::expandOrCollect</a></div><div class="ttdeci">void expandOrCollect(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01473">MemorySegment.cpp:1473</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_ace7f34cf0d63489a930972159d52a3a6"><div class="ttname"><a href="class_large_segment_set.html#ace7f34cf0d63489a930972159d52a3a6">LargeSegmentSet::expandSegmentSet</a></div><div class="ttdeci">void expandSegmentSet(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01700">MemorySegment.cpp:1700</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_af536ff08e1058b27d14d8fb4318211f1"><div class="ttname"><a href="class_large_segment_set.html#af536ff08e1058b27d14d8fb4318211f1">LargeSegmentSet::completeSweepOperation</a></div><div class="ttdeci">void completeSweepOperation()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01093">MemorySegment.cpp:1093</a></div></div>
<div class="ttc" id="aclass_large_segment_set_html_af98302a7793857bcd1bc2fae8f99665e"><div class="ttname"><a href="class_large_segment_set.html#af98302a7793857bcd1bc2fae8f99665e">LargeSegmentSet::addDeadObject</a></div><div class="ttdeci">virtual void addDeadObject(DeadObject *object)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00359">MemorySegment.cpp:359</a></div></div>
<div class="ttc" id="aclass_memory_segment_header_html_a6c0acd2a09e144750258e317978a2910"><div class="ttname"><a href="class_memory_segment_header.html#a6c0acd2a09e144750258e317978a2910">MemorySegmentHeader::segmentSize</a></div><div class="ttdeci">size_t segmentSize</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00134">MemorySegment.hpp:134</a></div></div>
<div class="ttc" id="aclass_memory_segment_header_html_a79d5ea5c0d969eaea4442d3fed563090"><div class="ttname"><a href="class_memory_segment_header.html#a79d5ea5c0d969eaea4442d3fed563090">MemorySegmentHeader::next</a></div><div class="ttdeci">MemorySegment * next</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00136">MemorySegment.hpp:136</a></div></div>
<div class="ttc" id="aclass_memory_segment_header_html_a860b767f8d2a95b753a26cad678e5e3e"><div class="ttname"><a href="class_memory_segment_header.html#a860b767f8d2a95b753a26cad678e5e3e">MemorySegmentHeader::previous</a></div><div class="ttdeci">MemorySegment * previous</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00137">MemorySegment.hpp:137</a></div></div>
<div class="ttc" id="aclass_memory_segment_header_html_aa6555c2a4239d9911f4f8a177a4c2c8b"><div class="ttname"><a href="class_memory_segment_header.html#aa6555c2a4239d9911f4f8a177a4c2c8b">MemorySegmentHeader::liveObjects</a></div><div class="ttdeci">size_t liveObjects</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00135">MemorySegment.hpp:135</a></div></div>
<div class="ttc" id="aclass_memory_segment_html"><div class="ttname"><a href="class_memory_segment.html">MemorySegment</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00143">MemorySegment.hpp:143</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a05f1080941e07fa90af5978ab4c1123a"><div class="ttname"><a href="class_memory_segment.html#a05f1080941e07fa90af5978ab4c1123a">MemorySegment::remove</a></div><div class="ttdeci">void remove()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00181">MemorySegment.hpp:181</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a2c0cd2972305dc02299a93c1268503ad"><div class="ttname"><a href="class_memory_segment.html#a2c0cd2972305dc02299a93c1268503ad">MemorySegment::realSize</a></div><div class="ttdeci">size_t realSize()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00205">MemorySegment.hpp:205</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a2ddc33173de811d5a32dadab64218e69"><div class="ttname"><a href="class_memory_segment.html#a2ddc33173de811d5a32dadab64218e69">MemorySegment::size</a></div><div class="ttdeci">size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00204">MemorySegment.hpp:204</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a32b221f5b8192e3c8f6179e786b49f62"><div class="ttname"><a href="class_memory_segment.html#a32b221f5b8192e3c8f6179e786b49f62">MemorySegment::gatherObjectStats</a></div><div class="ttdeci">void gatherObjectStats(MemoryStats *memStats, SegmentStats *stats)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00104">MemorySegment.cpp:104</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a3d5dff71c6e0a47466d530fc7864546f"><div class="ttname"><a href="class_memory_segment.html#a3d5dff71c6e0a47466d530fc7864546f">MemorySegment::isFirstBlock</a></div><div class="ttdeci">bool isFirstBlock(char *addr)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00202">MemorySegment.hpp:202</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a4a378020d01dc55a36fd3d8d0e6dfb5b"><div class="ttname"><a href="class_memory_segment.html#a4a378020d01dc55a36fd3d8d0e6dfb5b">MemorySegment::isLastBlock</a></div><div class="ttdeci">bool isLastBlock(char *addr, size_t length)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00201">MemorySegment.hpp:201</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a4eedcaf184067d854ee9d2c01d01a3c4"><div class="ttname"><a href="class_memory_segment.html#a4eedcaf184067d854ee9d2c01d01a3c4">MemorySegment::shrink</a></div><div class="ttdeci">void shrink(size_t delta)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00199">MemorySegment.hpp:199</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a57f879b5e8daeefb0131326ac797e5f3"><div class="ttname"><a href="class_memory_segment.html#a57f879b5e8daeefb0131326ac797e5f3">MemorySegment::combine</a></div><div class="ttdeci">void combine(MemorySegment *nextSegment)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00198">MemorySegment.hpp:198</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a5e776095ff13cb958be9bbc88bd41506"><div class="ttname"><a href="class_memory_segment.html#a5e776095ff13cb958be9bbc88bd41506">MemorySegment::lastDeadObject</a></div><div class="ttdeci">DeadObject * lastDeadObject()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00062">MemorySegment.cpp:62</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a600233405db51678164f8553bb73d938"><div class="ttname"><a href="class_memory_segment.html#a600233405db51678164f8553bb73d938">MemorySegment::isEmpty</a></div><div class="ttdeci">bool isEmpty()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00209">MemorySegment.hpp:209</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a724c1d54f0b5e272fcdfb4f63cb90ac3"><div class="ttname"><a href="class_memory_segment.html#a724c1d54f0b5e272fcdfb4f63cb90ac3">MemorySegment::isReal</a></div><div class="ttdeci">bool isReal()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00208">MemorySegment.hpp:208</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a72ef6000bb72985c90f711a792d83b9f"><div class="ttname"><a href="class_memory_segment.html#a72ef6000bb72985c90f711a792d83b9f">MemorySegment::segmentStart</a></div><div class="ttdeci">char segmentStart[8]</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00217">MemorySegment.hpp:217</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a90170d3af7b0490dc608466b357589dc"><div class="ttname"><a href="class_memory_segment.html#a90170d3af7b0490dc608466b357589dc">MemorySegment::firstDeadObject</a></div><div class="ttdeci">DeadObject * firstDeadObject()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00089">MemorySegment.cpp:89</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a972ff8fbdd4236a9c9ea40784a0945f2"><div class="ttname"><a href="class_memory_segment.html#a972ff8fbdd4236a9c9ea40784a0945f2">MemorySegment::end</a></div><div class="ttdeci">char * end()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00207">MemorySegment.hpp:207</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_a98a4369bac6e25800ea487a331b46561"><div class="ttname"><a href="class_memory_segment.html#a98a4369bac6e25800ea487a331b46561">MemorySegment::dump</a></div><div class="ttdeci">void dump(const char *owner, size_t counter, FILE *keyfile, FILE *dumpfile)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00048">MemorySegment.cpp:48</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_aac924598f86a8bfb94375e83784238a4"><div class="ttname"><a href="class_memory_segment.html#aac924598f86a8bfb94375e83784238a4">MemorySegment::createDeadObject</a></div><div class="ttdeci">DeadObject * createDeadObject()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00195">MemorySegment.hpp:195</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_aae8cce0d3ee0f3385c64722a1d50c283"><div class="ttname"><a href="class_memory_segment.html#aae8cce0d3ee0f3385c64722a1d50c283">MemorySegment::isAdjacentTo</a></div><div class="ttdeci">bool isAdjacentTo(MemorySegment *seg)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00200">MemorySegment.hpp:200</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_abe72dc5cb9c83ea42b437384be60965d"><div class="ttname"><a href="class_memory_segment.html#abe72dc5cb9c83ea42b437384be60965d">MemorySegment::start</a></div><div class="ttdeci">char * start()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00206">MemorySegment.hpp:206</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_ad5d99e8d6a858c8fa483dfc798c29e05"><div class="ttname"><a href="class_memory_segment.html#ad5d99e8d6a858c8fa483dfc798c29e05">MemorySegment::firstObject</a></div><div class="ttdeci">DeadObject * firstObject()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00197">MemorySegment.hpp:197</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_add3c9cd5130b4cb0ebcb8dd4df610c0c"><div class="ttname"><a href="class_memory_segment.html#add3c9cd5130b4cb0ebcb8dd4df610c0c">MemorySegment::removeAll</a></div><div class="ttdeci">void removeAll()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00186">MemorySegment.hpp:186</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_af5eedb6412193837c0e0bdc6f909f7a7"><div class="ttname"><a href="class_memory_segment.html#af5eedb6412193837c0e0bdc6f909f7a7">MemorySegment::insertBefore</a></div><div class="ttdeci">void insertBefore(MemorySegment *newSegment)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00174">MemorySegment.hpp:174</a></div></div>
<div class="ttc" id="aclass_memory_segment_html_af64ed95595657c43475b549e2f825279"><div class="ttname"><a href="class_memory_segment.html#af64ed95595657c43475b549e2f825279">MemorySegment::markAllObjects</a></div><div class="ttdeci">void markAllObjects()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01773">MemorySegment.cpp:1773</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html"><div class="ttname"><a href="class_memory_segment_set.html">MemorySegmentSet</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00227">MemorySegment.hpp:227</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a03636135836a91d328829444fd3a453b"><div class="ttname"><a href="class_memory_segment_set.html#a03636135836a91d328829444fd3a453b">MemorySegmentSet::dumpSegments</a></div><div class="ttdeci">void dumpSegments(FILE *keyfile, FILE *dumpfile)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00120">MemorySegment.cpp:120</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a08b11e8b7a7209dc327040e842ad40ed"><div class="ttname"><a href="class_memory_segment_set.html#a08b11e8b7a7209dc327040e842ad40ed">MemorySegmentSet::activateEmptySegments</a></div><div class="ttdeci">void activateEmptySegments()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00310">MemorySegment.cpp:310</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a11b567e97ec08847b5f4c4cd01bceafc"><div class="ttname"><a href="class_memory_segment_set.html#a11b567e97ec08847b5f4c4cd01bceafc">MemorySegmentSet::adjustMemorySize</a></div><div class="ttdeci">void adjustMemorySize()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00872">MemorySegment.cpp:872</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a124455ab929d1b2eb35e7a1b7f19e743"><div class="ttname"><a href="class_memory_segment_set.html#a124455ab929d1b2eb35e7a1b7f19e743">MemorySegmentSet::anchor</a></div><div class="ttdeci">MemorySegment anchor</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00368">MemorySegment.hpp:361</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a145bf8586274f7d4a804141e4fa67623"><div class="ttname"><a href="class_memory_segment_set.html#a145bf8586274f7d4a804141e4fa67623">MemorySegmentSet::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00374">MemorySegment.hpp:374</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a20315484983b7a50fb3c1547c31d2243"><div class="ttname"><a href="class_memory_segment_set.html#a20315484983b7a50fb3c1547c31d2243">MemorySegmentSet::findEmptySegment</a></div><div class="ttdeci">MemorySegment * findEmptySegment(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00289">MemorySegment.cpp:289</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a26619224a68f7887ffa925793d3e093b"><div class="ttname"><a href="class_memory_segment_set.html#a26619224a68f7887ffa925793d3e093b">MemorySegmentSet::addSegment</a></div><div class="ttdeci">void addSegment(MemorySegment *segment, bool createDeadObject=1)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00473">MemorySegment.cpp:473</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a3893ae7c04fb800b3f465285ffbcc467"><div class="ttname"><a href="class_memory_segment_set.html#a3893ae7c04fb800b3f465285ffbcc467">MemorySegmentSet::removeSegmentAndStorage</a></div><div class="ttdeci">void removeSegmentAndStorage(MemorySegment *segment)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00266">MemorySegment.hpp:266</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a3d3811d09e36ae1fe1060a585534ffea"><div class="ttname"><a href="class_memory_segment_set.html#a3d3811d09e36ae1fe1060a585534ffea">MemorySegmentSet::liveObjectBytes</a></div><div class="ttdeci">size_t liveObjectBytes</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00371">MemorySegment.hpp:371</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a4e6465f0009cd59107df1bee01627c4b"><div class="ttname"><a href="class_memory_segment_set.html#a4e6465f0009cd59107df1bee01627c4b">MemorySegmentSet::sweep</a></div><div class="ttdeci">void sweep()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01106">MemorySegment.cpp:1106</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a4f62f365c719d6b41ff72af9ca32945f"><div class="ttname"><a href="class_memory_segment_set.html#a4f62f365c719d6b41ff72af9ca32945f">MemorySegmentSet::suggestMemoryContraction</a></div><div class="ttdeci">virtual size_t suggestMemoryContraction()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00831">MemorySegment.cpp:831</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a5047a2cb5b670257e525747da90c70af"><div class="ttname"><a href="class_memory_segment_set.html#a5047a2cb5b670257e525747da90c70af">MemorySegmentSet::calculateSegmentAllocation</a></div><div class="ttdeci">size_t calculateSegmentAllocation(size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00346">MemorySegment.hpp:346</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a57fc11caaa79e8677c8d094d7adfb2c3"><div class="ttname"><a href="class_memory_segment_set.html#a57fc11caaa79e8677c8d094d7adfb2c3">MemorySegmentSet::releaseEmptySegments</a></div><div class="ttdeci">void releaseEmptySegments(size_t releaseSize)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00915">MemorySegment.cpp:915</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a5a8aec10366589bc791aada94fe0d181"><div class="ttname"><a href="class_memory_segment_set.html#a5a8aec10366589bc791aada94fe0d181">MemorySegmentSet::emptySegments</a></div><div class="ttdeci">MemorySegment emptySegments</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00369">MemorySegment.hpp:369</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a5dd45c0ad87274387d0847b7d38bc3d5"><div class="ttname"><a href="class_memory_segment_set.html#a5dd45c0ad87274387d0847b7d38bc3d5">MemorySegmentSet::splitDeadObject</a></div><div class="ttdeci">RexxObject * splitDeadObject(DeadObject *object, size_t allocationLength, size_t splitMinimum)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01190">MemorySegment.cpp:1190</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a5e69013d44776da1867020f293ae09b6"><div class="ttname"><a href="class_memory_segment_set.html#a5e69013d44776da1867020f293ae09b6">MemorySegmentSet::totalFreeMemory</a></div><div class="ttdeci">size_t totalFreeMemory()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00343">MemorySegment.hpp:343</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a61ed7810741de1e17e28791f0ad673e2"><div class="ttname"><a href="class_memory_segment_set.html#a61ed7810741de1e17e28791f0ad673e2">MemorySegmentSet::first</a></div><div class="ttdeci">MemorySegment * first()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00278">MemorySegment.hpp:278</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a6319216bcf0e0f90cc1701b152d3416d"><div class="ttname"><a href="class_memory_segment_set.html#a6319216bcf0e0f90cc1701b152d3416d">MemorySegmentSet::mergeSegments</a></div><div class="ttdeci">void mergeSegments(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01533">MemorySegment.cpp:1533</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a6abde102ece644a1f399c289e67dff26"><div class="ttname"><a href="class_memory_segment_set.html#a6abde102ece644a1f399c289e67dff26">MemorySegmentSet::largestEmptySegment</a></div><div class="ttdeci">MemorySegment * largestEmptySegment()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01451">MemorySegment.cpp:1451</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a7261a480da3ecae054b3cd1be0b30ead"><div class="ttname"><a href="class_memory_segment_set.html#a7261a480da3ecae054b3cd1be0b30ead">MemorySegmentSet::deadObjectBytes</a></div><div class="ttdeci">size_t deadObjectBytes</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00372">MemorySegment.hpp:372</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a784e71233b6851fb91f880192be6e9ad"><div class="ttname"><a href="class_memory_segment_set.html#a784e71233b6851fb91f880192be6e9ad">MemorySegmentSet::combineEmptySegments</a></div><div class="ttdeci">void combineEmptySegments(MemorySegment *front, MemorySegment *back)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01672">MemorySegment.cpp:1672</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a7925bd1039f535cadff00ad2a5b9f7d2"><div class="ttname"><a href="class_memory_segment_set.html#a7925bd1039f535cadff00ad2a5b9f7d2">MemorySegmentSet::addSegments</a></div><div class="ttdeci">void addSegments(size_t requiredSpace)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00956">MemorySegment.cpp:956</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a7bf421c9c93bf255135415e55814e6a7"><div class="ttname"><a href="class_memory_segment_set.html#a7bf421c9c93bf255135415e55814e6a7">MemorySegmentSet::allocateSegment</a></div><div class="ttdeci">virtual MemorySegment * allocateSegment(size_t requestLength, size_t minimumLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00249">MemorySegment.cpp:249</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a7c1385f115ca05b55e03dc9468e08f39"><div class="ttname"><a href="class_memory_segment_set.html#a7c1385f115ca05b55e03dc9468e08f39">MemorySegmentSet::completeSweepOperation</a></div><div class="ttdeci">virtual void completeSweepOperation()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01046">MemorySegment.cpp:1046</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a8b91ff7fd6370e4f54900a99ef9b4f27"><div class="ttname"><a href="class_memory_segment_set.html#a8b91ff7fd6370e4f54900a99ef9b4f27">MemorySegmentSet::suggestMemoryExpansion</a></div><div class="ttdeci">virtual size_t suggestMemoryExpansion()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00817">MemorySegment.cpp:817</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a968b7b9c2c6ff89c2d5c46bbcd4f62dd"><div class="ttname"><a href="class_memory_segment_set.html#a968b7b9c2c6ff89c2d5c46bbcd4f62dd">MemorySegmentSet::memory</a></div><div class="ttdeci">RexxMemory * memory</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00375">MemorySegment.hpp:375</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_a9e1c69fb1b32ca37d643bf839ae665b4"><div class="ttname"><a href="class_memory_segment_set.html#a9e1c69fb1b32ca37d643bf839ae665b4">MemorySegmentSet::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00370">MemorySegment.hpp:370</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aa0f7b1c3c50aae8a9dfd8a271f4cffaf"><div class="ttname"><a href="class_memory_segment_set.html#aa0f7b1c3c50aae8a9dfd8a271f4cffaf">MemorySegmentSet::releaseSegment</a></div><div class="ttdeci">void releaseSegment(MemorySegment *segment)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00947">MemorySegment.cpp:947</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aa2caa0bde362ae2ff82b82f33bd536e7"><div class="ttname"><a href="class_memory_segment_set.html#aa2caa0bde362ae2ff82b82f33bd536e7">MemorySegmentSet::prepareForSweep</a></div><div class="ttdeci">virtual void prepareForSweep()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01003">MemorySegment.cpp:1003</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aa2ded42b44ea5780673a0585f62629df"><div class="ttname"><a href="class_memory_segment_set.html#aa2ded42b44ea5780673a0585f62629df">MemorySegmentSet::collectEmptySegments</a></div><div class="ttdeci">virtual void collectEmptySegments()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01181">MemorySegment.cpp:1181</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aa354d2e325284f4bf31ed57369b30fad"><div class="ttname"><a href="class_memory_segment_set.html#aa354d2e325284f4bf31ed57369b30fad">MemorySegmentSet::getSegment</a></div><div class="ttdeci">MemorySegment * getSegment(size_t requestLength, size_t minimumLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00267">MemorySegment.cpp:267</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aabdb564ac4a2f34cbffc741817bfddc9"><div class="ttname"><a href="class_memory_segment_set.html#aabdb564ac4a2f34cbffc741817bfddc9">MemorySegmentSet::freeMemoryPercentage</a></div><div class="ttdeci">float freeMemoryPercentage()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00342">MemorySegment.hpp:342</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_abab6a3bfe74ce7d2ff87a934f667b6ab"><div class="ttname"><a href="class_memory_segment_set.html#abab6a3bfe74ce7d2ff87a934f667b6ab">MemorySegmentSet::gatherStats</a></div><div class="ttdeci">void gatherStats(MemoryStats *memStats, SegmentStats *stats)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01756">MemorySegment.cpp:1756</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_abef797a5a96a5ef49e17d3fb376a75f7"><div class="ttname"><a href="class_memory_segment_set.html#abef797a5a96a5ef49e17d3fb376a75f7">MemorySegmentSet::splitSegment</a></div><div class="ttdeci">MemorySegment * splitSegment(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00578">MemorySegment.cpp:578</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_ac9a05831e53c99a38ab61eadee6c6311"><div class="ttname"><a href="class_memory_segment_set.html#ac9a05831e53c99a38ab61eadee6c6311">MemorySegmentSet::removeSegment</a></div><div class="ttdeci">void removeSegment(MemorySegment *segment)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00259">MemorySegment.hpp:259</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_acdc687287a5eb7de71eb924daba194d5"><div class="ttname"><a href="class_memory_segment_set.html#acdc687287a5eb7de71eb924daba194d5">MemorySegmentSet::donateObject</a></div><div class="ttdeci">virtual DeadObject * donateObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00518">MemorySegment.cpp:518</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_ae50003ea8be96293f5ce776ee954822b"><div class="ttname"><a href="class_memory_segment_set.html#ae50003ea8be96293f5ce776ee954822b">MemorySegmentSet::dumpMemoryProfile</a></div><div class="ttdeci">virtual void dumpMemoryProfile(FILE *outfile)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00134">MemorySegment.cpp:134</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aedcb4e8810fcd3236e073032b8529049"><div class="ttname"><a href="class_memory_segment_set.html#aedcb4e8810fcd3236e073032b8529049">MemorySegmentSet::next</a></div><div class="ttdeci">MemorySegment * next(MemorySegment *segment)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00287">MemorySegment.hpp:287</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_aeedd3721553ad8312d07ad4895166265"><div class="ttname"><a href="class_memory_segment_set.html#aeedd3721553ad8312d07ad4895166265">MemorySegmentSet::newSegment</a></div><div class="ttdeci">bool newSegment(size_t requestLength, size_t minimumLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00332">MemorySegment.cpp:332</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_af5b8842f68f567a91ce7af98d7a6f908"><div class="ttname"><a href="class_memory_segment_set.html#af5b8842f68f567a91ce7af98d7a6f908">MemorySegmentSet::validateObject</a></div><div class="ttdeci">void validateObject(size_t bytes)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00361">MemorySegment.hpp:361</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_af79ceb6b8f31b9852445a6a07f51f605"><div class="ttname"><a href="class_memory_segment_set.html#af79ceb6b8f31b9852445a6a07f51f605">MemorySegmentSet::largestActiveSegment</a></div><div class="ttdeci">MemorySegment * largestActiveSegment()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01429">MemorySegment.cpp:1429</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_afba8acc0061aeb8f2b976bcc5a0d2bc8"><div class="ttname"><a href="class_memory_segment_set.html#afba8acc0061aeb8f2b976bcc5a0d2bc8">MemorySegmentSet::donateSegment</a></div><div class="ttdeci">virtual MemorySegment * donateSegment(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00558">MemorySegment.cpp:558</a></div></div>
<div class="ttc" id="aclass_memory_segment_set_html_afcf45cd1bb986f7c3541fc577a69def3"><div class="ttname"><a href="class_memory_segment_set.html#afcf45cd1bb986f7c3541fc577a69def3">MemorySegmentSet::addDeadObject</a></div><div class="ttdeci">virtual void addDeadObject(DeadObject *object)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00350">MemorySegment.cpp:350</a></div></div>
<div class="ttc" id="aclass_memory_stats_html"><div class="ttname"><a href="class_memory_stats.html">MemoryStats</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_stats_8hpp_source.html#l00097">MemoryStats.hpp:97</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a0494bfe08376b08535753a86235283c0"><div class="ttname"><a href="class_normal_segment_set.html#a0494bfe08376b08535753a86235283c0">NormalSegmentSet::recommendedMaximumMemorySize</a></div><div class="ttdeci">size_t recommendedMaximumMemorySize()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00492">MemorySegment.hpp:492</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a141f8eeff1a51dc36324f9b559357faa"><div class="ttname"><a href="class_normal_segment_set.html#a141f8eeff1a51dc36324f9b559357faa">NormalSegmentSet::addDeadObject</a></div><div class="ttdeci">virtual void addDeadObject(DeadObject *object)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00379">MemorySegment.cpp:379</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a318a7460c27133c5a48756ab5f522411"><div class="ttname"><a href="class_normal_segment_set.html#a318a7460c27133c5a48756ab5f522411">NormalSegmentSet::suggestMemoryContraction</a></div><div class="ttdeci">virtual size_t suggestMemoryContraction()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00844">MemorySegment.cpp:844</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a31d58541bb128116fa059a840db84865"><div class="ttname"><a href="class_normal_segment_set.html#a31d58541bb128116fa059a840db84865">NormalSegmentSet::findObject</a></div><div class="ttdeci">RexxObject * findObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01252">MemorySegment.cpp:1252</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a46247417b1f4b4fece9559c00c3328ef"><div class="ttname"><a href="class_normal_segment_set.html#a46247417b1f4b4fece9559c00c3328ef">NormalSegmentSet::recoverSegment</a></div><div class="ttdeci">MemorySegment * recoverSegment</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00535">MemorySegment.hpp:535</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a50e91263b4c77ab35acc766b21b99634"><div class="ttname"><a href="class_normal_segment_set.html#a50e91263b4c77ab35acc766b21b99634">NormalSegmentSet::donateObject</a></div><div class="ttdeci">virtual DeadObject * donateObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00530">MemorySegment.cpp:530</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a55a5c1a67d650232679a397e0f7caec4"><div class="ttname"><a href="class_normal_segment_set.html#a55a5c1a67d650232679a397e0f7caec4">NormalSegmentSet::dumpMemoryProfile</a></div><div class="ttdeci">virtual void dumpMemoryProfile(FILE *outfile)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00153">MemorySegment.cpp:153</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a6931728c87ac47644de894630e6e291d"><div class="ttname"><a href="class_normal_segment_set.html#a6931728c87ac47644de894630e6e291d">NormalSegmentSet::subpools</a></div><div class="ttdeci">DeadObjectPool subpools[DeadPools]</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00533">MemorySegment.hpp:533</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a6a863dffe8483a6d557016748c9cc117"><div class="ttname"><a href="class_normal_segment_set.html#a6a863dffe8483a6d557016748c9cc117">NormalSegmentSet::getInitialSet</a></div><div class="ttdeci">void getInitialSet()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00239">MemorySegment.cpp:239</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a74dc65ef70fa15612f38d8b90ca25c65"><div class="ttname"><a href="class_normal_segment_set.html#a74dc65ef70fa15612f38d8b90ca25c65">NormalSegmentSet::prepareForSweep</a></div><div class="ttdeci">virtual void prepareForSweep()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01013">MemorySegment.cpp:1013</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a766ab6a1566c1302bd4b8e4b449a300a"><div class="ttname"><a href="class_normal_segment_set.html#a766ab6a1566c1302bd4b8e4b449a300a">NormalSegmentSet::largeDead</a></div><div class="ttdeci">DeadObjectPool largeDead</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00532">MemorySegment.hpp:532</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a77df9525fcdbdfb8d9295d53b008afa6"><div class="ttname"><a href="class_normal_segment_set.html#a77df9525fcdbdfb8d9295d53b008afa6">NormalSegmentSet::handleAllocationFailure</a></div><div class="ttdeci">RexxObject * handleAllocationFailure(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01263">MemorySegment.cpp:1263</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a8374d91f07d84aca1e810e026489a6dc"><div class="ttname"><a href="class_normal_segment_set.html#a8374d91f07d84aca1e810e026489a6dc">NormalSegmentSet::findLargeDeadObject</a></div><div class="ttdeci">RexxObject * findLargeDeadObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01230">MemorySegment.cpp:1230</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a8d543da5d1ad0f6dbf606c2f5c398951"><div class="ttname"><a href="class_normal_segment_set.html#a8d543da5d1ad0f6dbf606c2f5c398951">NormalSegmentSet::completeSweepOperation</a></div><div class="ttdeci">void completeSweepOperation()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01054">MemorySegment.cpp:1054</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_a92fb3c72b863ae7ffa9d2deb67bda275"><div class="ttname"><a href="class_normal_segment_set.html#a92fb3c72b863ae7ffa9d2deb67bda275">NormalSegmentSet::checkObjectOverlap</a></div><div class="ttdeci">void checkObjectOverlap(DeadObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00170">MemorySegment.cpp:170</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_ab83fecc011405c69e0b15849144cf571"><div class="ttname"><a href="class_normal_segment_set.html#ab83fecc011405c69e0b15849144cf571">NormalSegmentSet::lastUsedSubpool</a></div><div class="ttdeci">size_t lastUsedSubpool[DeadPools+1]</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00534">MemorySegment.hpp:534</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_ac61049646d46e3293f706cfb6557643d"><div class="ttname"><a href="class_normal_segment_set.html#ac61049646d46e3293f706cfb6557643d">NormalSegmentSet::recommendedMemorySize</a></div><div class="ttdeci">size_t recommendedMemorySize()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00491">MemorySegment.hpp:491</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_ac782818c3b2b503faeebba5af4421262"><div class="ttname"><a href="class_normal_segment_set.html#ac782818c3b2b503faeebba5af4421262">NormalSegmentSet::NormalSegmentSet</a></div><div class="ttdeci">NormalSegmentSet()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00384">MemorySegment.hpp:384</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_af2cef0bc2610af9a53c3af7a2538f965"><div class="ttname"><a href="class_normal_segment_set.html#af2cef0bc2610af9a53c3af7a2538f965">NormalSegmentSet::suggestMemoryExpansion</a></div><div class="ttdeci">virtual size_t suggestMemoryExpansion()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00786">MemorySegment.cpp:786</a></div></div>
<div class="ttc" id="aclass_normal_segment_set_html_af8ed711532e1ee74d72128ef69532b83"><div class="ttname"><a href="class_normal_segment_set.html#af8ed711532e1ee74d72128ef69532b83">NormalSegmentSet::allocateObject</a></div><div class="ttdeci">RexxObject * allocateObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00388">MemorySegment.hpp:388</a></div></div>
<div class="ttc" id="aclass_numerics_html_a70730b87332edd5c38015b93013e7afa"><div class="ttname"><a href="class_numerics.html#a70730b87332edd5c38015b93013e7afa">Numerics::maxVal</a></div><div class="ttdeci">static wholenumber_t maxVal(wholenumber_t n1, wholenumber_t n2)</div><div class="ttdef"><b>Definition:</b> <a href="_numerics_8hpp_source.html#l00122">Numerics.hpp:122</a></div></div>
<div class="ttc" id="aclass_old_space_segment_set_html_a56a063e3219e4ae6a53f354adaeddcf0"><div class="ttname"><a href="class_old_space_segment_set.html#a56a063e3219e4ae6a53f354adaeddcf0">OldSpaceSegmentSet::allocateObject</a></div><div class="ttdeci">RexxObject * allocateObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01401">MemorySegment.cpp:1401</a></div></div>
<div class="ttc" id="aclass_old_space_segment_set_html_a62c07fdcd9edf1838dc5033e9266cc6c"><div class="ttname"><a href="class_old_space_segment_set.html#a62c07fdcd9edf1838dc5033e9266cc6c">OldSpaceSegmentSet::OldSpaceSegmentSet</a></div><div class="ttdeci">OldSpaceSegmentSet()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00595">MemorySegment.hpp:595</a></div></div>
<div class="ttc" id="aclass_old_space_segment_set_html_a67919a52f7ea8f406ddfc8ac30b8c4bb"><div class="ttname"><a href="class_old_space_segment_set.html#a67919a52f7ea8f406ddfc8ac30b8c4bb">OldSpaceSegmentSet::addDeadObject</a></div><div class="ttdeci">virtual void addDeadObject(DeadObject *object)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l00369">MemorySegment.cpp:369</a></div></div>
<div class="ttc" id="aclass_old_space_segment_set_html_ab93152b1a44fadb231869325570e236f"><div class="ttname"><a href="class_old_space_segment_set.html#ab93152b1a44fadb231869325570e236f">OldSpaceSegmentSet::findObject</a></div><div class="ttdeci">RexxObject * findObject(size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01381">MemorySegment.cpp:1381</a></div></div>
<div class="ttc" id="aclass_old_space_segment_set_html_abc73af5db4e6fe3ef7afe56cbd752660"><div class="ttname"><a href="class_old_space_segment_set.html#abc73af5db4e6fe3ef7afe56cbd752660">OldSpaceSegmentSet::deadCache</a></div><div class="ttdeci">DeadObjectPool deadCache</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8hpp_source.html#l00608">MemorySegment.hpp:608</a></div></div>
<div class="ttc" id="aclass_old_space_segment_set_html_afe2cb98ec19c68fd39a9914c7547ab57"><div class="ttname"><a href="class_old_space_segment_set.html#afe2cb98ec19c68fd39a9914c7547ab57">OldSpaceSegmentSet::markOldSpaceObjects</a></div><div class="ttdeci">void markOldSpaceObjects()</div><div class="ttdef"><b>Definition:</b> <a href="_memory_segment_8cpp_source.html#l01796">MemorySegment.cpp:1796</a></div></div>
<div class="ttc" id="aclass_rexx_internal_object_html_a035eb8bf67ca1b43d4238e806a0db0a0"><div class="ttname"><a href="class_rexx_internal_object.html#a035eb8bf67ca1b43d4238e806a0db0a0">RexxInternalObject::getObjectSize</a></div><div class="ttdeci">size_t getObjectSize()</div><div class="ttdef"><b>Definition:</b> <a href="_object_class_8hpp_source.html#l00236">ObjectClass.hpp:236</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html"><div class="ttname"><a href="class_rexx_memory.html">RexxMemory</a></div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00169">RexxMemory.hpp:170</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html_a086abfcb645a1aa742913e359b070282"><div class="ttname"><a href="class_rexx_memory.html#a086abfcb645a1aa742913e359b070282">RexxMemory::collect</a></div><div class="ttdeci">void collect()</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8cpp_source.html#l01021">RexxMemory.cpp:1021</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html_a49f20428166eb0eb71cf5c64ade44658"><div class="ttname"><a href="class_rexx_memory.html#a49f20428166eb0eb71cf5c64ade44658">RexxMemory::newSegment</a></div><div class="ttdeci">MemorySegment * newSegment(size_t requestLength, size_t minLength)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8cpp_source.html#l00733">RexxMemory.cpp:733</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html_a5dac31a980220f421b126995f78e26d6"><div class="ttname"><a href="class_rexx_memory.html#a5dac31a980220f421b126995f78e26d6">RexxMemory::newLargeSegment</a></div><div class="ttdeci">MemorySegment * newLargeSegment(size_t requestLength, size_t minLength)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8cpp_source.html#l00773">RexxMemory.cpp:773</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html_a7ebb2420f97deb2aedb9ebee487e9ff2"><div class="ttname"><a href="class_rexx_memory.html#a7ebb2420f97deb2aedb9ebee487e9ff2">RexxMemory::markWord</a></div><div class="ttdeci">size_t markWord</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00301">RexxMemory.hpp:301</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html_acaf448e70a1b7f4ef81da46b59e34b39"><div class="ttname"><a href="class_rexx_memory.html#acaf448e70a1b7f4ef81da46b59e34b39">RexxMemory::verboseMessage</a></div><div class="ttdeci">void verboseMessage(const char *message)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8hpp_source.html#l00240">RexxMemory.hpp:240</a></div></div>
<div class="ttc" id="aclass_rexx_memory_html_af8422ebe37c1a4a26348623b28c3fcc8"><div class="ttname"><a href="class_rexx_memory.html#af8422ebe37c1a4a26348623b28c3fcc8">RexxMemory::scavengeSegmentSets</a></div><div class="ttdeci">void scavengeSegmentSets(MemorySegmentSet *requester, size_t allocationLength)</div><div class="ttdef"><b>Definition:</b> <a href="_rexx_memory_8cpp_source.html#l01313">RexxMemory.cpp:1313</a></div></div>
<div class="ttc" id="aclass_rexx_object_html"><div class="ttname"><a href="class_rexx_object.html">RexxObject</a></div><div class="ttdef"><b>Definition:</b> <a href="_object_class_8hpp_source.html#l00323">ObjectClass.hpp:323</a></div></div>
<div class="ttc" id="aclass_segment_stats_html"><div class="ttname"><a href="class_segment_stats.html">SegmentStats</a></div><div class="ttdef"><b>Definition:</b> <a href="_memory_stats_8hpp_source.html#l00068">MemoryStats.hpp:68</a></div></div>
<div class="ttc" id="aclass_segment_stats_html_a01b51d8c43b4c967b3ed7c9c439cf470"><div class="ttname"><a href="class_segment_stats.html#a01b51d8c43b4c967b3ed7c9c439cf470">SegmentStats::smallestSegment</a></div><div class="ttdeci">size_t smallestSegment</div><div class="ttdef"><b>Definition:</b> <a href="_memory_stats_8hpp_source.html#l00087">MemoryStats.hpp:87</a></div></div>
<div class="ttc" id="aclass_segment_stats_html_a593319ffb90cc8b3116dbfaf3f499bb6"><div class="ttname"><a href="class_segment_stats.html#a593319ffb90cc8b3116dbfaf3f499bb6">SegmentStats::largestSegment</a></div><div class="ttdeci">size_t largestSegment</div><div class="ttdef"><b>Definition:</b> <a href="_memory_stats_8hpp_source.html#l00086">MemoryStats.hpp:86</a></div></div>
<div class="ttc" id="aclass_segment_stats_html_a8568adaea65e4258ef4fb3e25c51ea4f"><div class="ttname"><a href="class_segment_stats.html#a8568adaea65e4258ef4fb3e25c51ea4f">SegmentStats::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> <a href="_memory_stats_8hpp_source.html#l00085">MemoryStats.hpp:85</a></div></div>
<div class="ttc" id="aclass_segment_stats_html_abdcd157f699e291d3a416538568d0c79"><div class="ttname"><a href="class_segment_stats.html#abdcd157f699e291d3a416538568d0c79">SegmentStats::recordObject</a></div><div class="ttdeci">void recordObject(MemoryStats *memStats, char *obj)</div><div class="ttdef"><b>Definition:</b> <a href="_memory_stats_8cpp_source.html#l00063">MemoryStats.cpp:63</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2b8d323c7289fed1299e6f1b6909d41b.html">oorexx</a></li><li class="navelem"><a class="el" href="dir_8b29bd360d363874c010699c0e4edfe4.html">executor</a></li><li class="navelem"><a class="el" href="dir_b12c9cdd073ecc75d378afe044a8807c.html">sandbox</a></li><li class="navelem"><a class="el" href="dir_6f8e204b311fad1e21be914fb6af8fc9.html">jlf</a></li><li class="navelem"><a class="el" href="dir_4796bfee7d29ff8f3ba63e631cf48035.html">trunk</a></li><li class="navelem"><a class="el" href="dir_568b253ddbf98cea92a6c65945d41c59.html">interpreter</a></li><li class="navelem"><a class="el" href="dir_910a6aafc9e52b85d7e58d06157539a0.html">memory</a></li><li class="navelem"><a class="el" href="_memory_segment_8cpp.html">MemorySegment.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<!-- javascript code to insert the title in the condensed index (tabs) -->
<!-- See the function initMenu in menu.js:
     The condensed index is a list <ul> of several items <li>: Main Page, Classes, Files.
     I append a new item <li> which display the project name. -->
<script type="text/javascript">
$(function() {
  $('#main-menu').append('<li class="title" style="margin-left:3mm">executor.master</li>')
});
</script>
<!-- end of javascript code -->
</body>
</html>
